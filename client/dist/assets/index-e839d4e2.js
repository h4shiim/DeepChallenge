function _mergeNamespaces(i,e){for(var s=0;s<e.length;s++){const o=e[s];if(typeof o!="string"&&!Array.isArray(o)){for(const a in o)if(a!=="default"&&!(a in i)){const c=Object.getOwnPropertyDescriptor(o,a);c&&Object.defineProperty(i,a,c.get?c:{enumerable:!0,get:()=>o[a]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerpolicy&&(c.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?c.credentials="include":a.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();function getDefaultExportFromCjs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jsxRuntimeExports={},jsxRuntime={get exports(){return jsxRuntimeExports},set exports(i){jsxRuntimeExports=i}},reactJsxRuntime_production_min={},reactExports={},react={get exports(){return reactExports},set exports(i){reactExports=i}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$3=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$2(i){return i===null||typeof i!="object"?null:(i=z$3&&i[z$3]||i["@@iterator"],typeof i=="function"?i:null)}var B$3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$3=Object.assign,D$3={};function E$2(i,e,s){this.props=i,this.context=e,this.refs=D$3,this.updater=s||B$3}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};E$2.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$3(i,e,s){this.props=i,this.context=e,this.refs=D$3,this.updater=s||B$3}var H$3=G$3.prototype=new F$1;H$3.constructor=G$3;C$3(H$3,E$2.prototype);H$3.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$3={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$3(i,e,s){var o,a={},c=null,d=null;if(e!=null)for(o in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(c=""+e.key),e)J$1.call(e,o)&&!L$3.hasOwnProperty(o)&&(a[o]=e[o]);var h=arguments.length-2;if(h===1)a.children=s;else if(1<h){for(var g=Array(h),_=0;_<h;_++)g[_]=arguments[_+2];a.children=g}if(i&&i.defaultProps)for(o in h=i.defaultProps,h)a[o]===void 0&&(a[o]=h[o]);return{$$typeof:l$2,type:i,key:c,ref:d,props:a,_owner:K$3.current}}function N$3(i,e){return{$$typeof:l$2,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function O$3(i){return typeof i=="object"&&i!==null&&i.$$typeof===l$2}function escape(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(s){return e[s]})}var P$3=/\/+/g;function Q$3(i,e){return typeof i=="object"&&i!==null&&i.key!=null?escape(""+i.key):e.toString(36)}function R$2(i,e,s,o,a){var c=typeof i;(c==="undefined"||c==="boolean")&&(i=null);var d=!1;if(i===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(i.$$typeof){case l$2:case n$1:d=!0}}if(d)return d=i,a=a(d),i=o===""?"."+Q$3(d,0):o,I$2(a)?(s="",i!=null&&(s=i.replace(P$3,"$&/")+"/"),R$2(a,e,s,"",function(_){return _})):a!=null&&(O$3(a)&&(a=N$3(a,s+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(P$3,"$&/")+"/")+i)),e.push(a)),1;if(d=0,o=o===""?".":o+":",I$2(i))for(var h=0;h<i.length;h++){c=i[h];var g=o+Q$3(c,h);d+=R$2(c,e,s,g,a)}else if(g=A$2(i),typeof g=="function")for(i=g.call(i),h=0;!(c=i.next()).done;)c=c.value,g=o+Q$3(c,h++),d+=R$2(c,e,s,g,a);else if(c==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function S$3(i,e,s){if(i==null)return i;var o=[],a=0;return R$2(i,o,"","",function(c){return e.call(s,c,a++)}),o}function T$2(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(s){(i._status===0||i._status===-1)&&(i._status=1,i._result=s)},function(s){(i._status===0||i._status===-1)&&(i._status=2,i._result=s)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var U$3={current:null},V$3={transition:null},W$3={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$3,ReactCurrentOwner:K$3};react_production_min.Children={map:S$3,forEach:function(i,e,s){S$3(i,function(){e.apply(this,arguments)},s)},count:function(i){var e=0;return S$3(i,function(){e++}),e},toArray:function(i){return S$3(i,function(e){return e})||[]},only:function(i){if(!O$3(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r;react_production_min.PureComponent=G$3;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$3;react_production_min.cloneElement=function(i,e,s){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var o=C$3({},i.props),a=i.key,c=i.ref,d=i._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,d=K$3.current),e.key!==void 0&&(a=""+e.key),i.type&&i.type.defaultProps)var h=i.type.defaultProps;for(g in e)J$1.call(e,g)&&!L$3.hasOwnProperty(g)&&(o[g]=e[g]===void 0&&h!==void 0?h[g]:e[g])}var g=arguments.length-2;if(g===1)o.children=s;else if(1<g){h=Array(g);for(var _=0;_<g;_++)h[_]=arguments[_+2];o.children=h}return{$$typeof:l$2,type:i.type,key:a,ref:c,props:o,_owner:d}};react_production_min.createContext=function(i){return i={$$typeof:u,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:t$1,_context:i},i.Consumer=i};react_production_min.createElement=M$3;react_production_min.createFactory=function(i){var e=M$3.bind(null,i);return e.type=i,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(i){return{$$typeof:v$3,render:i}};react_production_min.isValidElement=O$3;react_production_min.lazy=function(i){return{$$typeof:y$1,_payload:{_status:-1,_result:i},_init:T$2}};react_production_min.memo=function(i,e){return{$$typeof:x$2,type:i,compare:e===void 0?null:e}};react_production_min.startTransition=function(i){var e=V$3.transition;V$3.transition={};try{i()}finally{V$3.transition=e}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(i,e){return U$3.current.useCallback(i,e)};react_production_min.useContext=function(i){return U$3.current.useContext(i)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(i){return U$3.current.useDeferredValue(i)};react_production_min.useEffect=function(i,e){return U$3.current.useEffect(i,e)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(i,e,s){return U$3.current.useImperativeHandle(i,e,s)};react_production_min.useInsertionEffect=function(i,e){return U$3.current.useInsertionEffect(i,e)};react_production_min.useLayoutEffect=function(i,e){return U$3.current.useLayoutEffect(i,e)};react_production_min.useMemo=function(i,e){return U$3.current.useMemo(i,e)};react_production_min.useReducer=function(i,e,s){return U$3.current.useReducer(i,e,s)};react_production_min.useRef=function(i){return U$3.current.useRef(i)};react_production_min.useState=function(i){return U$3.current.useState(i)};react_production_min.useSyncExternalStore=function(i,e,s){return U$3.current.useSyncExternalStore(i,e,s)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.2.0";(function(i){i.exports=react_production_min})(react);const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k$2=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$2(i,e,s){var o,a={},c=null,d=null;s!==void 0&&(c=""+s),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(o in e)m$1.call(e,o)&&!p$2.hasOwnProperty(o)&&(a[o]=e[o]);if(i&&i.defaultProps)for(o in e=i.defaultProps,e)a[o]===void 0&&(a[o]=e[o]);return{$$typeof:k$2,type:i,key:c,ref:d,props:a,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;(function(i){i.exports=reactJsxRuntime_production_min})(jsxRuntime);const Fragment=jsxRuntimeExports.Fragment,jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs;var client={},reactDomExports={},reactDom={get exports(){return reactDomExports},set exports(i){reactDomExports=i}},reactDom_production_min={},schedulerExports={},scheduler={get exports(){return schedulerExports},set exports(i){schedulerExports=i}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(sp,lp){var ip=sp.length;sp.push(lp);e:for(;0<ip;){var cp=ip-1>>>1,mp=sp[cp];if(0<a(mp,lp))sp[cp]=lp,sp[ip]=mp,ip=cp;else break e}}function s(sp){return sp.length===0?null:sp[0]}function o(sp){if(sp.length===0)return null;var lp=sp[0],ip=sp.pop();if(ip!==lp){sp[0]=ip;e:for(var cp=0,mp=sp.length,wp=mp>>>1;cp<wp;){var _p=2*(cp+1)-1,vp=sp[_p],Ep=_p+1,$p=sp[Ep];if(0>a(vp,ip))Ep<mp&&0>a($p,vp)?(sp[cp]=$p,sp[Ep]=ip,cp=Ep):(sp[cp]=vp,sp[_p]=ip,cp=_p);else if(Ep<mp&&0>a($p,ip))sp[cp]=$p,sp[Ep]=ip,cp=Ep;else break e}}return lp}function a(sp,lp){var ip=sp.sortIndex-lp.sortIndex;return ip!==0?ip:sp.id-lp.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;i.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();i.unstable_now=function(){return d.now()-h}}var g=[],_=[],ft=1,_t=null,$t=3,Mt=!1,Ft=!1,Ol=!1,Vl=typeof setTimeout=="function"?setTimeout:null,Nl=typeof clearTimeout=="function"?clearTimeout:null,xl=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ml(sp){for(var lp=s(_);lp!==null;){if(lp.callback===null)o(_);else if(lp.startTime<=sp)o(_),lp.sortIndex=lp.expirationTime,e(g,lp);else break;lp=s(_)}}function Su(sp){if(Ol=!1,Ml(sp),!Ft)if(s(g)!==null)Ft=!0,gp(_d);else{var lp=s(_);lp!==null&&pp(Su,lp.startTime-sp)}}function _d(sp,lp){Ft=!1,Ol&&(Ol=!1,Nl(np),np=-1),Mt=!0;var ip=$t;try{for(Ml(lp),_t=s(g);_t!==null&&(!(_t.expirationTime>lp)||sp&&!ap());){var cp=_t.callback;if(typeof cp=="function"){_t.callback=null,$t=_t.priorityLevel;var mp=cp(_t.expirationTime<=lp);lp=i.unstable_now(),typeof mp=="function"?_t.callback=mp:_t===s(g)&&o(g),Ml(lp)}else o(g);_t=s(g)}if(_t!==null)var wp=!0;else{var _p=s(_);_p!==null&&pp(Su,_p.startTime-lp),wp=!1}return wp}finally{_t=null,$t=ip,Mt=!1}}var ep=!1,tp=null,np=-1,op=5,rp=-1;function ap(){return!(i.unstable_now()-rp<op)}function up(){if(tp!==null){var sp=i.unstable_now();rp=sp;var lp=!0;try{lp=tp(!0,sp)}finally{lp?dp():(ep=!1,tp=null)}}else ep=!1}var dp;if(typeof xl=="function")dp=function(){xl(up)};else if(typeof MessageChannel<"u"){var hp=new MessageChannel,fp=hp.port2;hp.port1.onmessage=up,dp=function(){fp.postMessage(null)}}else dp=function(){Vl(up,0)};function gp(sp){tp=sp,ep||(ep=!0,dp())}function pp(sp,lp){np=Vl(function(){sp(i.unstable_now())},lp)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(sp){sp.callback=null},i.unstable_continueExecution=function(){Ft||Mt||(Ft=!0,gp(_d))},i.unstable_forceFrameRate=function(sp){0>sp||125<sp?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):op=0<sp?Math.floor(1e3/sp):5},i.unstable_getCurrentPriorityLevel=function(){return $t},i.unstable_getFirstCallbackNode=function(){return s(g)},i.unstable_next=function(sp){switch($t){case 1:case 2:case 3:var lp=3;break;default:lp=$t}var ip=$t;$t=lp;try{return sp()}finally{$t=ip}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(sp,lp){switch(sp){case 1:case 2:case 3:case 4:case 5:break;default:sp=3}var ip=$t;$t=sp;try{return lp()}finally{$t=ip}},i.unstable_scheduleCallback=function(sp,lp,ip){var cp=i.unstable_now();switch(typeof ip=="object"&&ip!==null?(ip=ip.delay,ip=typeof ip=="number"&&0<ip?cp+ip:cp):ip=cp,sp){case 1:var mp=-1;break;case 2:mp=250;break;case 5:mp=1073741823;break;case 4:mp=1e4;break;default:mp=5e3}return mp=ip+mp,sp={id:ft++,callback:lp,priorityLevel:sp,startTime:ip,expirationTime:mp,sortIndex:-1},ip>cp?(sp.sortIndex=ip,e(_,sp),s(g)===null&&sp===s(_)&&(Ol?(Nl(np),np=-1):Ol=!0,pp(Su,ip-cp))):(sp.sortIndex=mp,e(g,sp),Ft||Mt||(Ft=!0,gp(_d))),sp},i.unstable_shouldYield=ap,i.unstable_wrapCallback=function(sp){var lp=$t;return function(){var ip=$t;$t=lp;try{return sp.apply(this,arguments)}finally{$t=ip}}}})(scheduler_production_min);(function(i){i.exports=scheduler_production_min})(scheduler);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$2=reactExports,ca$2=schedulerExports;function p$1(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,s=1;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$2=new Set,ea$2={};function fa$2(i,e){ha$2(i,e),ha$2(i+"Capture",e)}function ha$2(i,e){for(ea$2[i]=e,i=0;i<e.length;i++)da$2.add(e[i])}var ia$2=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$2=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$2={},ma$2={};function oa$2(i){return ja$2.call(ma$2,i)?!0:ja$2.call(la$2,i)?!1:ka$1.test(i)?ma$2[i]=!0:(la$2[i]=!0,!1)}function pa$2(i,e,s,o){if(s!==null&&s.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:s!==null?!s.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function qa$2(i,e,s,o){if(e===null||typeof e>"u"||pa$2(i,e,s,o))return!0;if(o)return!1;if(s!==null)switch(s.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v$2(i,e,s,o,a,c,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=i,this.type=e,this.sanitizeURL=c,this.removeEmptyString=d}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){z$2[i]=new v$2(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];z$2[e]=new v$2(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){z$2[i]=new v$2(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){z$2[i]=new v$2(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){z$2[i]=new v$2(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){z$2[i]=new v$2(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){z$2[i]=new v$2(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){z$2[i]=new v$2(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){z$2[i]=new v$2(i,5,!1,i.toLowerCase(),null,!1,!1)});var ra$2=/[\-:]([a-z])/g;function sa$2(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(ra$2,sa$2);z$2[e]=new v$2(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(ra$2,sa$2);z$2[e]=new v$2(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(ra$2,sa$2);z$2[e]=new v$2(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){z$2[i]=new v$2(i,1,!1,i.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$2("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){z$2[i]=new v$2(i,1,!1,i.toLowerCase(),null,!0,!0)});function ta$2(i,e,s,o){var a=z$2.hasOwnProperty(e)?z$2[e]:null;(a!==null?a.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa$2(e,s,a,o)&&(s=null),o||a===null?oa$2(e)&&(s===null?i.removeAttribute(e):i.setAttribute(e,""+s)):a.mustUseProperty?i[a.propertyName]=s===null?a.type===3?!1:"":s:(e=a.attributeName,o=a.attributeNamespace,s===null?i.removeAttribute(e):(a=a.type,s=a===3||a===4&&s===!0?"":""+s,o?i.setAttributeNS(o,e,s):i.setAttribute(e,s))))}var ua$2=aa$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$2=Symbol.for("react.element"),wa$2=Symbol.for("react.portal"),ya$2=Symbol.for("react.fragment"),za$2=Symbol.for("react.strict_mode"),Aa$2=Symbol.for("react.profiler"),Ba$2=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$2=Symbol.for("react.suspense"),Fa$2=Symbol.for("react.suspense_list"),Ga$2=Symbol.for("react.memo"),Ha$2=Symbol.for("react.lazy"),Ia$2=Symbol.for("react.offscreen"),Ja$2=Symbol.iterator;function Ka$2(i){return i===null||typeof i!="object"?null:(i=Ja$2&&i[Ja$2]||i["@@iterator"],typeof i=="function"?i:null)}var A$1=Object.assign,La$2;function Ma$2(i){if(La$2===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);La$2=e&&e[1]||""}return`
`+La$2+i}var Na$2=!1;function Oa$2(i,e){if(!i||Na$2)return"";Na$2=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var o=_}Reflect.construct(i,[],e)}else{try{e.call()}catch(_){o=_}i.call(e.prototype)}else{try{throw Error()}catch(_){o=_}i()}}catch(_){if(_&&o&&typeof _.stack=="string"){for(var a=_.stack.split(`
`),c=o.stack.split(`
`),d=a.length-1,h=c.length-1;1<=d&&0<=h&&a[d]!==c[h];)h--;for(;1<=d&&0<=h;d--,h--)if(a[d]!==c[h]){if(d!==1||h!==1)do if(d--,h--,0>h||a[d]!==c[h]){var g=`
`+a[d].replace(" at new "," at ");return i.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",i.displayName)),g}while(1<=d&&0<=h);break}}}finally{Na$2=!1,Error.prepareStackTrace=s}return(i=i?i.displayName||i.name:"")?Ma$2(i):""}function Pa$2(i){switch(i.tag){case 5:return Ma$2(i.type);case 16:return Ma$2("Lazy");case 13:return Ma$2("Suspense");case 19:return Ma$2("SuspenseList");case 0:case 2:case 15:return i=Oa$2(i.type,!1),i;case 11:return i=Oa$2(i.type.render,!1),i;case 1:return i=Oa$2(i.type,!0),i;default:return""}}function Qa$2(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ya$2:return"Fragment";case wa$2:return"Portal";case Aa$2:return"Profiler";case za$2:return"StrictMode";case Ea$2:return"Suspense";case Fa$2:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Ca$1:return(i.displayName||"Context")+".Consumer";case Ba$2:return(i._context.displayName||"Context")+".Provider";case Da$1:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ga$2:return e=i.displayName||null,e!==null?e:Qa$2(i.type)||"Memo";case Ha$2:e=i._payload,i=i._init;try{return Qa$2(i(e))}catch{}}return null}function Ra$2(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$2(e);case 8:return e===za$2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa$2(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ta$2(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua$2(i){var e=Ta$2(i)?"checked":"value",s=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),o=""+i[e];if(!i.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var a=s.get,c=s.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return a.call(this)},set:function(d){o=""+d,c.call(this,d)}}),Object.defineProperty(i,e,{enumerable:s.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Va$2(i){i._valueTracker||(i._valueTracker=Ua$2(i))}function Wa$2(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var s=e.getValue(),o="";return i&&(o=Ta$2(i)?i.checked?"true":"false":i.value),i=o,i!==s?(e.setValue(i),!0):!1}function Xa$2(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ya$2(i,e){var s=e.checked;return A$1({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??i._wrapperState.initialChecked})}function Za$1(i,e){var s=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;s=Sa$2(e.value!=null?e.value:s),i._wrapperState={initialChecked:o,initialValue:s,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab$1(i,e){e=e.checked,e!=null&&ta$2(i,"checked",e,!1)}function bb$1(i,e){ab$1(i,e);var s=Sa$2(e.value),o=e.type;if(s!=null)o==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+s):i.value!==""+s&&(i.value=""+s);else if(o==="submit"||o==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?cb$1(i,e.type,s):e.hasOwnProperty("defaultValue")&&cb$1(i,e.type,Sa$2(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function db$2(i,e,s){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,s||e===i.value||(i.value=e),i.defaultValue=e}s=i.name,s!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,s!==""&&(i.name=s)}function cb$1(i,e,s){(e!=="number"||Xa$2(i.ownerDocument)!==i)&&(s==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+s&&(i.defaultValue=""+s))}var eb$1=Array.isArray;function fb$1(i,e,s,o){if(i=i.options,e){e={};for(var a=0;a<s.length;a++)e["$"+s[a]]=!0;for(s=0;s<i.length;s++)a=e.hasOwnProperty("$"+i[s].value),i[s].selected!==a&&(i[s].selected=a),a&&o&&(i[s].defaultSelected=!0)}else{for(s=""+Sa$2(s),e=null,a=0;a<i.length;a++){if(i[a].value===s){i[a].selected=!0,o&&(i[a].defaultSelected=!0);return}e!==null||i[a].disabled||(e=i[a])}e!==null&&(e.selected=!0)}}function gb$1(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function hb$1(i,e){var s=e.value;if(s==null){if(s=e.children,e=e.defaultValue,s!=null){if(e!=null)throw Error(p$1(92));if(eb$1(s)){if(1<s.length)throw Error(p$1(93));s=s[0]}e=s}e==null&&(e=""),s=e}i._wrapperState={initialValue:Sa$2(s)}}function ib$1(i,e){var s=Sa$2(e.value),o=Sa$2(e.defaultValue);s!=null&&(s=""+s,s!==i.value&&(i.value=s),e.defaultValue==null&&i.defaultValue!==s&&(i.defaultValue=s)),o!=null&&(i.defaultValue=""+o)}function jb$1(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function kb$1(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb$1(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?kb$1(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var mb$1,nb$1=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,s,o,a){MSApp.execUnsafeLocalFunction(function(){return i(e,s,o,a)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(mb$1=mb$1||document.createElement("div"),mb$1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb$1.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function ob$1(i,e){if(e){var s=i.firstChild;if(s&&s===i.lastChild&&s.nodeType===3){s.nodeValue=e;return}}i.textContent=e}var pb$1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb$1=["Webkit","ms","Moz","O"];Object.keys(pb$1).forEach(function(i){qb$1.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),pb$1[e]=pb$1[i]})});function rb$1(i,e,s){return e==null||typeof e=="boolean"||e===""?"":s||typeof e!="number"||e===0||pb$1.hasOwnProperty(i)&&pb$1[i]?(""+e).trim():e+"px"}function sb$1(i,e){i=i.style;for(var s in e)if(e.hasOwnProperty(s)){var o=s.indexOf("--")===0,a=rb$1(s,e[s],o);s==="float"&&(s="cssFloat"),o?i.setProperty(s,a):i[s]=a}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub$1(i,e){if(e){if(tb[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p$1(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p$1(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p$1(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p$1(62))}}function vb$1(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb$1=null;function xb$1(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var yb$1=null,zb$1=null,Ab$1=null;function Bb$1(i){if(i=Cb$1(i)){if(typeof yb$1!="function")throw Error(p$1(280));var e=i.stateNode;e&&(e=Db$1(e),yb$1(i.stateNode,i.type,e))}}function Eb$1(i){zb$1?Ab$1?Ab$1.push(i):Ab$1=[i]:zb$1=i}function Fb$1(){if(zb$1){var i=zb$1,e=Ab$1;if(Ab$1=zb$1=null,Bb$1(i),e)for(i=0;i<e.length;i++)Bb$1(e[i])}}function Gb$1(i,e){return i(e)}function Hb$1(){}var Ib$1=!1;function Jb$1(i,e,s){if(Ib$1)return i(e,s);Ib$1=!0;try{return Gb$1(i,e,s)}finally{Ib$1=!1,(zb$1!==null||Ab$1!==null)&&(Hb$1(),Fb$1())}}function Kb$1(i,e){var s=i.stateNode;if(s===null)return null;var o=Db$1(s);if(o===null)return null;s=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(i=i.type,o=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!o;break e;default:i=!1}if(i)return null;if(s&&typeof s!="function")throw Error(p$1(231,e,typeof s));return s}var Lb$1=!1;if(ia$2)try{var Mb$1={};Object.defineProperty(Mb$1,"passive",{get:function(){Lb$1=!0}}),window.addEventListener("test",Mb$1,Mb$1),window.removeEventListener("test",Mb$1,Mb$1)}catch{Lb$1=!1}function Nb$1(i,e,s,o,a,c,d,h,g){var _=Array.prototype.slice.call(arguments,3);try{e.apply(s,_)}catch(ft){this.onError(ft)}}var Ob$1=!1,Pb$1=null,Qb$1=!1,Rb$1=null,Sb$1={onError:function(i){Ob$1=!0,Pb$1=i}};function Tb$1(i,e,s,o,a,c,d,h,g){Ob$1=!1,Pb$1=null,Nb$1.apply(Sb$1,arguments)}function Ub$1(i,e,s,o,a,c,d,h,g){if(Tb$1.apply(this,arguments),Ob$1){if(Ob$1){var _=Pb$1;Ob$1=!1,Pb$1=null}else throw Error(p$1(198));Qb$1||(Qb$1=!0,Rb$1=_)}}function Vb$1(i){var e=i,s=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(s=e.return),i=e.return;while(i)}return e.tag===3?s:null}function Wb$1(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Xb$1(i){if(Vb$1(i)!==i)throw Error(p$1(188))}function Yb$1(i){var e=i.alternate;if(!e){if(e=Vb$1(i),e===null)throw Error(p$1(188));return e!==i?null:i}for(var s=i,o=e;;){var a=s.return;if(a===null)break;var c=a.alternate;if(c===null){if(o=a.return,o!==null){s=o;continue}break}if(a.child===c.child){for(c=a.child;c;){if(c===s)return Xb$1(a),i;if(c===o)return Xb$1(a),e;c=c.sibling}throw Error(p$1(188))}if(s.return!==o.return)s=a,o=c;else{for(var d=!1,h=a.child;h;){if(h===s){d=!0,s=a,o=c;break}if(h===o){d=!0,o=a,s=c;break}h=h.sibling}if(!d){for(h=c.child;h;){if(h===s){d=!0,s=c,o=a;break}if(h===o){d=!0,o=c,s=a;break}h=h.sibling}if(!d)throw Error(p$1(189))}}if(s.alternate!==o)throw Error(p$1(190))}if(s.tag!==3)throw Error(p$1(188));return s.stateNode.current===s?i:e}function Zb$1(i){return i=Yb$1(i),i!==null?$b$1(i):null}function $b$1(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=$b$1(i);if(e!==null)return e;i=i.sibling}return null}var ac$2=ca$2.unstable_scheduleCallback,bc$2=ca$2.unstable_cancelCallback,cc$2=ca$2.unstable_shouldYield,dc$2=ca$2.unstable_requestPaint,B$2=ca$2.unstable_now,ec$2=ca$2.unstable_getCurrentPriorityLevel,fc$2=ca$2.unstable_ImmediatePriority,gc$2=ca$2.unstable_UserBlockingPriority,hc$2=ca$2.unstable_NormalPriority,ic$2=ca$2.unstable_LowPriority,jc$2=ca$2.unstable_IdlePriority,kc$2=null,lc$2=null;function mc$2(i){if(lc$2&&typeof lc$2.onCommitFiberRoot=="function")try{lc$2.onCommitFiberRoot(kc$2,i,void 0,(i.current.flags&128)===128)}catch{}}var oc$2=Math.clz32?Math.clz32:nc$2,pc$2=Math.log,qc$2=Math.LN2;function nc$2(i){return i>>>=0,i===0?32:31-(pc$2(i)/qc$2|0)|0}var rc$2=64,sc$2=4194304;function tc$2(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function uc$2(i,e){var s=i.pendingLanes;if(s===0)return 0;var o=0,a=i.suspendedLanes,c=i.pingedLanes,d=s&268435455;if(d!==0){var h=d&~a;h!==0?o=tc$2(h):(c&=d,c!==0&&(o=tc$2(c)))}else d=s&~a,d!==0?o=tc$2(d):c!==0&&(o=tc$2(c));if(o===0)return 0;if(e!==0&&e!==o&&!(e&a)&&(a=o&-o,c=e&-e,a>=c||a===16&&(c&4194240)!==0))return e;if(o&4&&(o|=s&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=o;0<e;)s=31-oc$2(e),a=1<<s,o|=i[s],e&=~a;return o}function vc$2(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc$2(i,e){for(var s=i.suspendedLanes,o=i.pingedLanes,a=i.expirationTimes,c=i.pendingLanes;0<c;){var d=31-oc$2(c),h=1<<d,g=a[d];g===-1?(!(h&s)||h&o)&&(a[d]=vc$2(h,e)):g<=e&&(i.expiredLanes|=h),c&=~h}}function xc$2(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function yc$2(){var i=rc$2;return rc$2<<=1,!(rc$2&4194240)&&(rc$2=64),i}function zc$2(i){for(var e=[],s=0;31>s;s++)e.push(i);return e}function Ac$2(i,e,s){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-oc$2(e),i[e]=s}function Bc$2(i,e){var s=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var o=i.eventTimes;for(i=i.expirationTimes;0<s;){var a=31-oc$2(s),c=1<<a;e[a]=0,o[a]=-1,i[a]=-1,s&=~c}}function Cc$2(i,e){var s=i.entangledLanes|=e;for(i=i.entanglements;s;){var o=31-oc$2(s),a=1<<o;a&e|i[o]&e&&(i[o]|=e),s&=~a}}var C$2=0;function Dc$2(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Ec$2,Fc$2,Gc$2,Hc$2,Ic$2,Jc$2=!1,Kc$2=[],Lc$2=null,Mc$2=null,Nc$2=null,Oc$2=new Map,Pc$2=new Map,Qc$2=[],Rc$2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc$2(i,e){switch(i){case"focusin":case"focusout":Lc$2=null;break;case"dragenter":case"dragleave":Mc$2=null;break;case"mouseover":case"mouseout":Nc$2=null;break;case"pointerover":case"pointerout":Oc$2.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc$2.delete(e.pointerId)}}function Tc$2(i,e,s,o,a,c){return i===null||i.nativeEvent!==c?(i={blockedOn:e,domEventName:s,eventSystemFlags:o,nativeEvent:c,targetContainers:[a]},e!==null&&(e=Cb$1(e),e!==null&&Fc$2(e)),i):(i.eventSystemFlags|=o,e=i.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),i)}function Uc$2(i,e,s,o,a){switch(e){case"focusin":return Lc$2=Tc$2(Lc$2,i,e,s,o,a),!0;case"dragenter":return Mc$2=Tc$2(Mc$2,i,e,s,o,a),!0;case"mouseover":return Nc$2=Tc$2(Nc$2,i,e,s,o,a),!0;case"pointerover":var c=a.pointerId;return Oc$2.set(c,Tc$2(Oc$2.get(c)||null,i,e,s,o,a)),!0;case"gotpointercapture":return c=a.pointerId,Pc$2.set(c,Tc$2(Pc$2.get(c)||null,i,e,s,o,a)),!0}return!1}function Vc$2(i){var e=Wc$2(i.target);if(e!==null){var s=Vb$1(e);if(s!==null){if(e=s.tag,e===13){if(e=Wb$1(s),e!==null){i.blockedOn=e,Ic$2(i.priority,function(){Gc$2(s)});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){i.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Xc$2(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var s=Yc$2(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(s===null){s=i.nativeEvent;var o=new s.constructor(s.type,s);wb$1=o,s.target.dispatchEvent(o),wb$1=null}else return e=Cb$1(s),e!==null&&Fc$2(e),i.blockedOn=s,!1;e.shift()}return!0}function Zc$2(i,e,s){Xc$2(i)&&s.delete(e)}function $c$2(){Jc$2=!1,Lc$2!==null&&Xc$2(Lc$2)&&(Lc$2=null),Mc$2!==null&&Xc$2(Mc$2)&&(Mc$2=null),Nc$2!==null&&Xc$2(Nc$2)&&(Nc$2=null),Oc$2.forEach(Zc$2),Pc$2.forEach(Zc$2)}function ad$1(i,e){i.blockedOn===e&&(i.blockedOn=null,Jc$2||(Jc$2=!0,ca$2.unstable_scheduleCallback(ca$2.unstable_NormalPriority,$c$2)))}function bd$1(i){function e(a){return ad$1(a,i)}if(0<Kc$2.length){ad$1(Kc$2[0],i);for(var s=1;s<Kc$2.length;s++){var o=Kc$2[s];o.blockedOn===i&&(o.blockedOn=null)}}for(Lc$2!==null&&ad$1(Lc$2,i),Mc$2!==null&&ad$1(Mc$2,i),Nc$2!==null&&ad$1(Nc$2,i),Oc$2.forEach(e),Pc$2.forEach(e),s=0;s<Qc$2.length;s++)o=Qc$2[s],o.blockedOn===i&&(o.blockedOn=null);for(;0<Qc$2.length&&(s=Qc$2[0],s.blockedOn===null);)Vc$2(s),s.blockedOn===null&&Qc$2.shift()}var cd$1=ua$2.ReactCurrentBatchConfig,dd$1=!0;function ed$1(i,e,s,o){var a=C$2,c=cd$1.transition;cd$1.transition=null;try{C$2=1,fd$1(i,e,s,o)}finally{C$2=a,cd$1.transition=c}}function gd$1(i,e,s,o){var a=C$2,c=cd$1.transition;cd$1.transition=null;try{C$2=4,fd$1(i,e,s,o)}finally{C$2=a,cd$1.transition=c}}function fd$1(i,e,s,o){if(dd$1){var a=Yc$2(i,e,s,o);if(a===null)hd$1(i,e,o,id$1,s),Sc$2(i,o);else if(Uc$2(a,i,e,s,o))o.stopPropagation();else if(Sc$2(i,o),e&4&&-1<Rc$2.indexOf(i)){for(;a!==null;){var c=Cb$1(a);if(c!==null&&Ec$2(c),c=Yc$2(i,e,s,o),c===null&&hd$1(i,e,o,id$1,s),c===a)break;a=c}a!==null&&o.stopPropagation()}else hd$1(i,e,o,null,s)}}var id$1=null;function Yc$2(i,e,s,o){if(id$1=null,i=xb$1(o),i=Wc$2(i),i!==null)if(e=Vb$1(i),e===null)i=null;else if(s=e.tag,s===13){if(i=Wb$1(e),i!==null)return i;i=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return id$1=i,null}function jd$1(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$2()){case fc$2:return 1;case gc$2:return 4;case hc$2:case ic$2:return 16;case jc$2:return 536870912;default:return 16}default:return 16}}var kd$1=null,ld$1=null,md$1=null;function nd$1(){if(md$1)return md$1;var i,e=ld$1,s=e.length,o,a="value"in kd$1?kd$1.value:kd$1.textContent,c=a.length;for(i=0;i<s&&e[i]===a[i];i++);var d=s-i;for(o=1;o<=d&&e[s-o]===a[c-o];o++);return md$1=a.slice(i,1<o?1-o:void 0)}function od$1(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function pd$1(){return!0}function qd$1(){return!1}function rd$1(i){function e(s,o,a,c,d){this._reactName=s,this._targetInst=a,this.type=o,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var h in i)i.hasOwnProperty(h)&&(s=i[h],this[h]=s?s(c):c[h]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd$1:qd$1,this.isPropagationStopped=qd$1,this}return A$1(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd$1)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd$1)},persist:function(){},isPersistent:pd$1}),e}var sd$1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd$1(sd$1),ud$1=A$1({},sd$1,{view:0,detail:0}),vd$1=rd$1(ud$1),wd$1,xd$1,yd$1,Ad$1=A$1({},ud$1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd$1,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yd$1&&(yd$1&&i.type==="mousemove"?(wd$1=i.screenX-yd$1.screenX,xd$1=i.screenY-yd$1.screenY):xd$1=wd$1=0,yd$1=i),wd$1)},movementY:function(i){return"movementY"in i?i.movementY:xd$1}}),Bd$1=rd$1(Ad$1),Cd$1=A$1({},Ad$1,{dataTransfer:0}),Dd$1=rd$1(Cd$1),Ed$1=A$1({},ud$1,{relatedTarget:0}),Fd$1=rd$1(Ed$1),Gd$1=A$1({},sd$1,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd$1=rd$1(Gd$1),Id$1=A$1({},sd$1,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Jd$1=rd$1(Id$1),Kd=A$1({},sd$1,{data:0}),Ld=rd$1(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Od[i])?!!e[i]:!1}function zd$1(){return Pd}var Qd=A$1({},ud$1,{key:function(i){if(i.key){var e=Md[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=od$1(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Nd[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd$1,charCode:function(i){return i.type==="keypress"?od$1(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?od$1(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Rd=rd$1(Qd),Sd=A$1({},Ad$1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd$1(Sd),Ud=A$1({},ud$1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd$1}),Vd=rd$1(Ud),Wd=A$1({},sd$1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd$1(Wd),Yd=A$1({},Ad$1,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd$1(Yd),$d=[9,13,27,32],ae$1=ia$2&&"CompositionEvent"in window,be$1=null;ia$2&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia$2&&"TextEvent"in window&&!be$1,de$1=ia$2&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=String.fromCharCode(32),fe$1=!1;function ge$1(i,e){switch(i){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ie$1=!1;function je$1(i,e){switch(i){case"compositionend":return he$1(e);case"keypress":return e.which!==32?null:(fe$1=!0,ee$1);case"textInput":return i=e.data,i===ee$1&&fe$1?null:i;default:return null}}function ke$1(i,e){if(ie$1)return i==="compositionend"||!ae$1&&ge$1(i,e)?(i=nd$1(),md$1=ld$1=kd$1=null,ie$1=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de$1&&e.locale!=="ko"?null:e.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!le$1[i.type]:e==="textarea"}function ne$1(i,e,s,o){Eb$1(o),e=oe$1(e,"onChange"),0<e.length&&(s=new td$1("onChange","change",null,s,o),i.push({event:s,listeners:e}))}var pe$1=null,qe$1=null;function re$1(i){se$1(i,0)}function te$1(i){var e=ue$1(i);if(Wa$2(e))return i}function ve$1(i,e){if(i==="change")return e}var we$1=!1;if(ia$2){var xe$1;if(ia$2){var ye$1="oninput"in document;if(!ye$1){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$1=typeof ze$1.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$1&&(pe$1.detachEvent("onpropertychange",Be$1),qe$1=pe$1=null)}function Be$1(i){if(i.propertyName==="value"&&te$1(qe$1)){var e=[];ne$1(e,qe$1,i,xb$1(i)),Jb$1(re$1,e)}}function Ce$1(i,e,s){i==="focusin"?(Ae$1(),pe$1=e,qe$1=s,pe$1.attachEvent("onpropertychange",Be$1)):i==="focusout"&&Ae$1()}function De$1(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return te$1(qe$1)}function Ee$1(i,e){if(i==="click")return te$1(e)}function Fe$1(i,e){if(i==="input"||i==="change")return te$1(e)}function Ge$1(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var He$1=typeof Object.is=="function"?Object.is:Ge$1;function Ie$1(i,e){if(He$1(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var s=Object.keys(i),o=Object.keys(e);if(s.length!==o.length)return!1;for(o=0;o<s.length;o++){var a=s[o];if(!ja$2.call(e,a)||!He$1(i[a],e[a]))return!1}return!0}function Je$1(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ke$1(i,e){var s=Je$1(i);i=0;for(var o;s;){if(s.nodeType===3){if(o=i+s.textContent.length,i<=e&&o>=e)return{node:s,offset:e-i};i=o}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Je$1(s)}}function Le$1(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?Le$1(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function Me$1(){for(var i=window,e=Xa$2();e instanceof i.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)i=e.contentWindow;else break;e=Xa$2(i.document)}return e}function Ne$1(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Oe$1(i){var e=Me$1(),s=i.focusedElem,o=i.selectionRange;if(e!==s&&s&&s.ownerDocument&&Le$1(s.ownerDocument.documentElement,s)){if(o!==null&&Ne$1(s)){if(e=o.start,i=o.end,i===void 0&&(i=e),"selectionStart"in s)s.selectionStart=e,s.selectionEnd=Math.min(i,s.value.length);else if(i=(e=s.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var a=s.textContent.length,c=Math.min(o.start,a);o=o.end===void 0?c:Math.min(o.end,a),!i.extend&&c>o&&(a=o,o=c,c=a),a=Ke$1(s,c);var d=Ke$1(s,o);a&&d&&(i.rangeCount!==1||i.anchorNode!==a.node||i.anchorOffset!==a.offset||i.focusNode!==d.node||i.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),i.removeAllRanges(),c>o?(i.addRange(e),i.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),i.addRange(e)))}}for(e=[],i=s;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<e.length;s++)i=e[s],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Pe$1=ia$2&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re$1=null,Se$1=null,Te$1=!1;function Ue$1(i,e,s){var o=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te$1||Qe$1==null||Qe$1!==Xa$2(o)||(o=Qe$1,"selectionStart"in o&&Ne$1(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Se$1&&Ie$1(Se$1,o)||(Se$1=o,o=oe$1(Re$1,"onSelect"),0<o.length&&(e=new td$1("onSelect","select",null,e,s),i.push({event:e,listeners:o}),e.target=Qe$1)))}function Ve$1(i,e){var s={};return s[i.toLowerCase()]=e.toLowerCase(),s["Webkit"+i]="webkit"+e,s["Moz"+i]="moz"+e,s}var We$1={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia$2&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze$1(i){if(Xe$1[i])return Xe$1[i];if(!We$1[i])return i;var e=We$1[i],s;for(s in e)if(e.hasOwnProperty(s)&&s in Ye$1)return Xe$1[i]=e[s];return i}var $e$1=Ze$1("animationend"),af$1=Ze$1("animationiteration"),bf=Ze$1("animationstart"),cf$1=Ze$1("transitionend"),df$1=new Map,ef$1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$1(i,e){df$1.set(i,e),fa$2(e,[i])}for(var gf=0;gf<ef$1.length;gf++){var hf$1=ef$1[gf],jf=hf$1.toLowerCase(),kf=hf$1[0].toUpperCase()+hf$1.slice(1);ff$1(jf,"on"+kf)}ff$1($e$1,"onAnimationEnd");ff$1(af$1,"onAnimationIteration");ff$1(bf,"onAnimationStart");ff$1("dblclick","onDoubleClick");ff$1("focusin","onFocus");ff$1("focusout","onBlur");ff$1(cf$1,"onTransitionEnd");ha$2("onMouseEnter",["mouseout","mouseover"]);ha$2("onMouseLeave",["mouseout","mouseover"]);ha$2("onPointerEnter",["pointerout","pointerover"]);ha$2("onPointerLeave",["pointerout","pointerover"]);fa$2("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$2("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$2("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$2("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$2("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$2("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$1=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$1));function nf$1(i,e,s){var o=i.type||"unknown-event";i.currentTarget=s,Ub$1(o,e,void 0,i),i.currentTarget=null}function se$1(i,e){e=(e&4)!==0;for(var s=0;s<i.length;s++){var o=i[s],a=o.event;o=o.listeners;e:{var c=void 0;if(e)for(var d=o.length-1;0<=d;d--){var h=o[d],g=h.instance,_=h.currentTarget;if(h=h.listener,g!==c&&a.isPropagationStopped())break e;nf$1(a,h,_),c=g}else for(d=0;d<o.length;d++){if(h=o[d],g=h.instance,_=h.currentTarget,h=h.listener,g!==c&&a.isPropagationStopped())break e;nf$1(a,h,_),c=g}}}if(Qb$1)throw i=Rb$1,Qb$1=!1,Rb$1=null,i}function D$2(i,e){var s=e[of];s===void 0&&(s=e[of]=new Set);var o=i+"__bubble";s.has(o)||(pf(e,i,2,!1),s.add(o))}function qf(i,e,s){var o=0;e&&(o|=4),pf(s,i,o,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf$1(i){if(!i[rf]){i[rf]=!0,da$2.forEach(function(s){s!=="selectionchange"&&(mf$1.has(s)||qf(s,!1,i),qf(s,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(i,e,s,o){switch(jd$1(e)){case 1:var a=ed$1;break;case 4:a=gd$1;break;default:a=fd$1}s=a.bind(null,e,s,i),a=void 0,!Lb$1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),o?a!==void 0?i.addEventListener(e,s,{capture:!0,passive:a}):i.addEventListener(e,s,!0):a!==void 0?i.addEventListener(e,s,{passive:a}):i.addEventListener(e,s,!1)}function hd$1(i,e,s,o,a){var c=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var h=o.stateNode.containerInfo;if(h===a||h.nodeType===8&&h.parentNode===a)break;if(d===4)for(d=o.return;d!==null;){var g=d.tag;if((g===3||g===4)&&(g=d.stateNode.containerInfo,g===a||g.nodeType===8&&g.parentNode===a))return;d=d.return}for(;h!==null;){if(d=Wc$2(h),d===null)return;if(g=d.tag,g===5||g===6){o=c=d;continue e}h=h.parentNode}}o=o.return}Jb$1(function(){var _=c,ft=xb$1(s),_t=[];e:{var $t=df$1.get(i);if($t!==void 0){var Mt=td$1,Ft=i;switch(i){case"keypress":if(od$1(s)===0)break e;case"keydown":case"keyup":Mt=Rd;break;case"focusin":Ft="focus",Mt=Fd$1;break;case"focusout":Ft="blur",Mt=Fd$1;break;case"beforeblur":case"afterblur":Mt=Fd$1;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Mt=Bd$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Mt=Dd$1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Mt=Vd;break;case $e$1:case af$1:case bf:Mt=Hd$1;break;case cf$1:Mt=Xd;break;case"scroll":Mt=vd$1;break;case"wheel":Mt=Zd;break;case"copy":case"cut":case"paste":Mt=Jd$1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Mt=Td}var Ol=(e&4)!==0,Vl=!Ol&&i==="scroll",Nl=Ol?$t!==null?$t+"Capture":null:$t;Ol=[];for(var xl=_,Ml;xl!==null;){Ml=xl;var Su=Ml.stateNode;if(Ml.tag===5&&Su!==null&&(Ml=Su,Nl!==null&&(Su=Kb$1(xl,Nl),Su!=null&&Ol.push(tf$1(xl,Su,Ml)))),Vl)break;xl=xl.return}0<Ol.length&&($t=new Mt($t,Ft,null,s,ft),_t.push({event:$t,listeners:Ol}))}}if(!(e&7)){e:{if($t=i==="mouseover"||i==="pointerover",Mt=i==="mouseout"||i==="pointerout",$t&&s!==wb$1&&(Ft=s.relatedTarget||s.fromElement)&&(Wc$2(Ft)||Ft[uf$1]))break e;if((Mt||$t)&&($t=ft.window===ft?ft:($t=ft.ownerDocument)?$t.defaultView||$t.parentWindow:window,Mt?(Ft=s.relatedTarget||s.toElement,Mt=_,Ft=Ft?Wc$2(Ft):null,Ft!==null&&(Vl=Vb$1(Ft),Ft!==Vl||Ft.tag!==5&&Ft.tag!==6)&&(Ft=null)):(Mt=null,Ft=_),Mt!==Ft)){if(Ol=Bd$1,Su="onMouseLeave",Nl="onMouseEnter",xl="mouse",(i==="pointerout"||i==="pointerover")&&(Ol=Td,Su="onPointerLeave",Nl="onPointerEnter",xl="pointer"),Vl=Mt==null?$t:ue$1(Mt),Ml=Ft==null?$t:ue$1(Ft),$t=new Ol(Su,xl+"leave",Mt,s,ft),$t.target=Vl,$t.relatedTarget=Ml,Su=null,Wc$2(ft)===_&&(Ol=new Ol(Nl,xl+"enter",Ft,s,ft),Ol.target=Ml,Ol.relatedTarget=Vl,Su=Ol),Vl=Su,Mt&&Ft)t:{for(Ol=Mt,Nl=Ft,xl=0,Ml=Ol;Ml;Ml=vf(Ml))xl++;for(Ml=0,Su=Nl;Su;Su=vf(Su))Ml++;for(;0<xl-Ml;)Ol=vf(Ol),xl--;for(;0<Ml-xl;)Nl=vf(Nl),Ml--;for(;xl--;){if(Ol===Nl||Nl!==null&&Ol===Nl.alternate)break t;Ol=vf(Ol),Nl=vf(Nl)}Ol=null}else Ol=null;Mt!==null&&wf$1(_t,$t,Mt,Ol,!1),Ft!==null&&Vl!==null&&wf$1(_t,Vl,Ft,Ol,!0)}}e:{if($t=_?ue$1(_):window,Mt=$t.nodeName&&$t.nodeName.toLowerCase(),Mt==="select"||Mt==="input"&&$t.type==="file")var _d=ve$1;else if(me$1($t))if(we$1)_d=Fe$1;else{_d=De$1;var ep=Ce$1}else(Mt=$t.nodeName)&&Mt.toLowerCase()==="input"&&($t.type==="checkbox"||$t.type==="radio")&&(_d=Ee$1);if(_d&&(_d=_d(i,_))){ne$1(_t,_d,s,ft);break e}ep&&ep(i,$t,_),i==="focusout"&&(ep=$t._wrapperState)&&ep.controlled&&$t.type==="number"&&cb$1($t,"number",$t.value)}switch(ep=_?ue$1(_):window,i){case"focusin":(me$1(ep)||ep.contentEditable==="true")&&(Qe$1=ep,Re$1=_,Se$1=null);break;case"focusout":Se$1=Re$1=Qe$1=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$1(_t,s,ft);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$1(_t,s,ft)}var tp;if(ae$1)e:{switch(i){case"compositionstart":var np="onCompositionStart";break e;case"compositionend":np="onCompositionEnd";break e;case"compositionupdate":np="onCompositionUpdate";break e}np=void 0}else ie$1?ge$1(i,s)&&(np="onCompositionEnd"):i==="keydown"&&s.keyCode===229&&(np="onCompositionStart");np&&(de$1&&s.locale!=="ko"&&(ie$1||np!=="onCompositionStart"?np==="onCompositionEnd"&&ie$1&&(tp=nd$1()):(kd$1=ft,ld$1="value"in kd$1?kd$1.value:kd$1.textContent,ie$1=!0)),ep=oe$1(_,np),0<ep.length&&(np=new Ld(np,i,null,s,ft),_t.push({event:np,listeners:ep}),tp?np.data=tp:(tp=he$1(s),tp!==null&&(np.data=tp)))),(tp=ce$1?je$1(i,s):ke$1(i,s))&&(_=oe$1(_,"onBeforeInput"),0<_.length&&(ft=new Ld("onBeforeInput","beforeinput",null,s,ft),_t.push({event:ft,listeners:_}),ft.data=tp))}se$1(_t,e)})}function tf$1(i,e,s){return{instance:i,listener:e,currentTarget:s}}function oe$1(i,e){for(var s=e+"Capture",o=[];i!==null;){var a=i,c=a.stateNode;a.tag===5&&c!==null&&(a=c,c=Kb$1(i,s),c!=null&&o.unshift(tf$1(i,c,a)),c=Kb$1(i,e),c!=null&&o.push(tf$1(i,c,a))),i=i.return}return o}function vf(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function wf$1(i,e,s,o,a){for(var c=e._reactName,d=[];s!==null&&s!==o;){var h=s,g=h.alternate,_=h.stateNode;if(g!==null&&g===o)break;h.tag===5&&_!==null&&(h=_,a?(g=Kb$1(s,c),g!=null&&d.unshift(tf$1(s,g,h))):a||(g=Kb$1(s,c),g!=null&&d.push(tf$1(s,g,h)))),s=s.return}d.length!==0&&i.push({event:e,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(i){return(typeof i=="string"?i:""+i).replace(xf,`
`).replace(yf,"")}function Af(i,e,s){if(e=zf(e),zf(i)!==e&&s)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(i){return Hf.resolve(null).then(i).catch(If)}:Ff;function If(i){setTimeout(function(){throw i})}function Kf(i,e){var s=e,o=0;do{var a=s.nextSibling;if(i.removeChild(s),a&&a.nodeType===8)if(s=a.data,s==="/$"){if(o===0){i.removeChild(a),bd$1(e);return}o--}else s!=="$"&&s!=="$?"&&s!=="$!"||o++;s=a}while(s);bd$1(e)}function Lf(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Mf(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var s=i.data;if(s==="$"||s==="$!"||s==="$?"){if(e===0)return i;e--}else s==="/$"&&e++}i=i.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf$1="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc$2(i){var e=i[Of];if(e)return e;for(var s=i.parentNode;s;){if(e=s[uf$1]||s[Of]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(i=Mf(i);i!==null;){if(s=i[Of])return s;i=Mf(i)}return e}i=s,s=i.parentNode}return null}function Cb$1(i){return i=i[Of]||i[uf$1],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ue$1(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(p$1(33))}function Db$1(i){return i[Pf]||null}var Sf=[],Tf=-1;function Uf(i){return{current:i}}function E$1(i){0>Tf||(i.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$2(i,e){Tf++,Sf[Tf]=i.current,i.current=e}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(i,e){var s=i.type.contextTypes;if(!s)return Vf;var o=i.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var a={},c;for(c in s)a[c]=e[c];return o&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=a),a}function Zf(i){return i=i.childContextTypes,i!=null}function $f(){E$1(Wf),E$1(H$2)}function ag(i,e,s){if(H$2.current!==Vf)throw Error(p$1(168));G$2(H$2,e),G$2(Wf,s)}function bg(i,e,s){var o=i.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return s;o=o.getChildContext();for(var a in o)if(!(a in e))throw Error(p$1(108,Ra$2(i)||"Unknown",a));return A$1({},s,o)}function cg(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G$2(H$2,i),G$2(Wf,Wf.current),!0}function dg(i,e,s){var o=i.stateNode;if(!o)throw Error(p$1(169));s?(i=bg(i,e,Xf),o.__reactInternalMemoizedMergedChildContext=i,E$1(Wf),E$1(H$2),G$2(H$2,i)):E$1(Wf),G$2(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(i){eg===null?eg=[i]:eg.push(i)}function ig(i){fg=!0,hg(i)}function jg(){if(!gg&&eg!==null){gg=!0;var i=0,e=C$2;try{var s=eg;for(C$2=1;i<s.length;i++){var o=s[i];do o=o(!0);while(o!==null)}eg=null,fg=!1}catch(a){throw eg!==null&&(eg=eg.slice(i+1)),ac$2(fc$2,jg),a}finally{C$2=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(i,e){kg[lg++]=ng,kg[lg++]=mg,mg=i,ng=e}function ug(i,e,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=i;var o=rg;i=sg;var a=32-oc$2(o)-1;o&=~(1<<a),s+=1;var c=32-oc$2(e)+a;if(30<c){var d=a-a%5;c=(o&(1<<d)-1).toString(32),o>>=d,a-=d,rg=1<<32-oc$2(e)+a|s<<a|o,sg=c+i}else rg=1<<c|s<<a|o,sg=i}function vg(i){i.return!==null&&(tg(i,1),ug(i,1,0))}function wg(i){for(;i===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;i===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(i,e){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=e,s.return=i,e=i.deletions,e===null?(i.deletions=[s],i.flags|=16):e.push(s)}function Cg(i,e){switch(i.tag){case 5:var s=i.type;return e=e.nodeType!==1||s.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,xg=i,yg=Lf(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,xg=i,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(s=qg!==null?{id:rg,overflow:sg}:null,i.memoizedState={dehydrated:e,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=e,s.return=i,i.child=s,xg=i,yg=null,!0):!1;default:return!1}}function Dg(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Eg(i){if(I$1){var e=yg;if(e){var s=e;if(!Cg(i,e)){if(Dg(i))throw Error(p$1(418));e=Lf(s.nextSibling);var o=xg;e&&Cg(i,e)?Ag(o,s):(i.flags=i.flags&-4097|2,I$1=!1,xg=i)}}else{if(Dg(i))throw Error(p$1(418));i.flags=i.flags&-4097|2,I$1=!1,xg=i}}}function Fg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;xg=i}function Gg(i){if(i!==xg)return!1;if(!I$1)return Fg(i),I$1=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Ef(i.type,i.memoizedProps)),e&&(e=yg)){if(Dg(i))throw Hg(),Error(p$1(418));for(;e;)Ag(i,e),e=Lf(e.nextSibling)}if(Fg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(p$1(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var s=i.data;if(s==="/$"){if(e===0){yg=Lf(i.nextSibling);break e}e--}else s!=="$"&&s!=="$!"&&s!=="$?"||e++}i=i.nextSibling}yg=null}}else yg=xg?Lf(i.stateNode.nextSibling):null;return!0}function Hg(){for(var i=yg;i;)i=Lf(i.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(i){zg===null?zg=[i]:zg.push(i)}var Kg=ua$2.ReactCurrentBatchConfig;function Lg(i,e){if(i&&i.defaultProps){e=A$1({},e),i=i.defaultProps;for(var s in i)e[s]===void 0&&(e[s]=i[s]);return e}return e}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(i){var e=Mg.current;E$1(Mg),i._currentValue=e}function Sg(i,e,s){for(;i!==null;){var o=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),i===s)break;i=i.return}}function Tg(i,e){Ng=i,Pg=Og=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Ug=!0),i.firstContext=null)}function Vg(i){var e=i._currentValue;if(Pg!==i)if(i={context:i,memoizedValue:e,next:null},Og===null){if(Ng===null)throw Error(p$1(308));Og=i,Ng.dependencies={lanes:0,firstContext:i}}else Og=Og.next=i;return e}var Wg=null;function Xg(i){Wg===null?Wg=[i]:Wg.push(i)}function Yg(i,e,s,o){var a=e.interleaved;return a===null?(s.next=s,Xg(e)):(s.next=a.next,a.next=s),e.interleaved=s,Zg(i,o)}function Zg(i,e){i.lanes|=e;var s=i.alternate;for(s!==null&&(s.lanes|=e),s=i,i=i.return;i!==null;)i.childLanes|=e,s=i.alternate,s!==null&&(s.childLanes|=e),s=i,i=i.return;return s.tag===3?s.stateNode:null}var $g=!1;function ah$1(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ch$1(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function dh$1(i,e,s){var o=i.updateQueue;if(o===null)return null;if(o=o.shared,K$2&2){var a=o.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),o.pending=e,Zg(i,s)}return a=o.interleaved,a===null?(e.next=e,Xg(o)):(e.next=a.next,a.next=e),o.interleaved=e,Zg(i,s)}function eh$1(i,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194240)!==0)){var o=e.lanes;o&=i.pendingLanes,s|=o,e.lanes=s,Cc$2(i,s)}}function fh$1(i,e){var s=i.updateQueue,o=i.alternate;if(o!==null&&(o=o.updateQueue,s===o)){var a=null,c=null;if(s=s.firstBaseUpdate,s!==null){do{var d={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};c===null?a=c=d:c=c.next=d,s=s.next}while(s!==null);c===null?a=c=e:c=c.next=e}else a=c=e;s={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:c,shared:o.shared,effects:o.effects},i.updateQueue=s;return}i=s.lastBaseUpdate,i===null?s.firstBaseUpdate=e:i.next=e,s.lastBaseUpdate=e}function gh(i,e,s,o){var a=i.updateQueue;$g=!1;var c=a.firstBaseUpdate,d=a.lastBaseUpdate,h=a.shared.pending;if(h!==null){a.shared.pending=null;var g=h,_=g.next;g.next=null,d===null?c=_:d.next=_,d=g;var ft=i.alternate;ft!==null&&(ft=ft.updateQueue,h=ft.lastBaseUpdate,h!==d&&(h===null?ft.firstBaseUpdate=_:h.next=_,ft.lastBaseUpdate=g))}if(c!==null){var _t=a.baseState;d=0,ft=_=g=null,h=c;do{var $t=h.lane,Mt=h.eventTime;if((o&$t)===$t){ft!==null&&(ft=ft.next={eventTime:Mt,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var Ft=i,Ol=h;switch($t=e,Mt=s,Ol.tag){case 1:if(Ft=Ol.payload,typeof Ft=="function"){_t=Ft.call(Mt,_t,$t);break e}_t=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=Ol.payload,$t=typeof Ft=="function"?Ft.call(Mt,_t,$t):Ft,$t==null)break e;_t=A$1({},_t,$t);break e;case 2:$g=!0}}h.callback!==null&&h.lane!==0&&(i.flags|=64,$t=a.effects,$t===null?a.effects=[h]:$t.push(h))}else Mt={eventTime:Mt,lane:$t,tag:h.tag,payload:h.payload,callback:h.callback,next:null},ft===null?(_=ft=Mt,g=_t):ft=ft.next=Mt,d|=$t;if(h=h.next,h===null){if(h=a.shared.pending,h===null)break;$t=h,h=$t.next,$t.next=null,a.lastBaseUpdate=$t,a.shared.pending=null}}while(1);if(ft===null&&(g=_t),a.baseState=g,a.firstBaseUpdate=_,a.lastBaseUpdate=ft,e=a.shared.interleaved,e!==null){a=e;do d|=a.lane,a=a.next;while(a!==e)}else c===null&&(a.shared.lanes=0);hh$1|=d,i.lanes=d,i.memoizedState=_t}}function ih$1(i,e,s){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var o=i[e],a=o.callback;if(a!==null){if(o.callback=null,o=s,typeof a!="function")throw Error(p$1(191,a));a.call(o)}}}var jh$1=new aa$2.Component().refs;function kh$1(i,e,s,o){e=i.memoizedState,s=s(o,e),s=s==null?e:A$1({},e,s),i.memoizedState=s,i.lanes===0&&(i.updateQueue.baseState=s)}var nh$1={isMounted:function(i){return(i=i._reactInternals)?Vb$1(i)===i:!1},enqueueSetState:function(i,e,s){i=i._reactInternals;var o=L$2(),a=lh$1(i),c=ch$1(o,a);c.payload=e,s!=null&&(c.callback=s),e=dh$1(i,c,a),e!==null&&(mh$1(e,i,a,o),eh$1(e,i,a))},enqueueReplaceState:function(i,e,s){i=i._reactInternals;var o=L$2(),a=lh$1(i),c=ch$1(o,a);c.tag=1,c.payload=e,s!=null&&(c.callback=s),e=dh$1(i,c,a),e!==null&&(mh$1(e,i,a,o),eh$1(e,i,a))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var s=L$2(),o=lh$1(i),a=ch$1(s,o);a.tag=2,e!=null&&(a.callback=e),e=dh$1(i,a,o),e!==null&&(mh$1(e,i,o,s),eh$1(e,i,o))}};function oh(i,e,s,o,a,c,d){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(o,c,d):e.prototype&&e.prototype.isPureReactComponent?!Ie$1(s,o)||!Ie$1(a,c):!0}function ph$1(i,e,s){var o=!1,a=Vf,c=e.contextType;return typeof c=="object"&&c!==null?c=Vg(c):(a=Zf(e)?Xf:H$2.current,o=e.contextTypes,c=(o=o!=null)?Yf(i,a):Vf),e=new e(s,c),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nh$1,i.stateNode=e,e._reactInternals=i,o&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=a,i.__reactInternalMemoizedMaskedChildContext=c),e}function qh$1(i,e,s,o){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,o),e.state!==i&&nh$1.enqueueReplaceState(e,e.state,null)}function rh$1(i,e,s,o){var a=i.stateNode;a.props=s,a.state=i.memoizedState,a.refs=jh$1,ah$1(i);var c=e.contextType;typeof c=="object"&&c!==null?a.context=Vg(c):(c=Zf(e)?Xf:H$2.current,a.context=Yf(i,c)),a.state=i.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(kh$1(i,e,c,s),a.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&nh$1.enqueueReplaceState(a,a.state,null),gh(i,s,a,o),a.state=i.memoizedState),typeof a.componentDidMount=="function"&&(i.flags|=4194308)}function sh$1(i,e,s){if(i=s.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p$1(309));var o=s.stateNode}if(!o)throw Error(p$1(147,i));var a=o,c=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(d){var h=a.refs;h===jh$1&&(h=a.refs={}),d===null?delete h[c]:h[c]=d},e._stringRef=c,e)}if(typeof i!="string")throw Error(p$1(284));if(!s._owner)throw Error(p$1(290,i))}return i}function th$1(i,e){throw i=Object.prototype.toString.call(e),Error(p$1(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function uh(i){var e=i._init;return e(i._payload)}function vh$1(i){function e(Nl,xl){if(i){var Ml=Nl.deletions;Ml===null?(Nl.deletions=[xl],Nl.flags|=16):Ml.push(xl)}}function s(Nl,xl){if(!i)return null;for(;xl!==null;)e(Nl,xl),xl=xl.sibling;return null}function o(Nl,xl){for(Nl=new Map;xl!==null;)xl.key!==null?Nl.set(xl.key,xl):Nl.set(xl.index,xl),xl=xl.sibling;return Nl}function a(Nl,xl){return Nl=wh$1(Nl,xl),Nl.index=0,Nl.sibling=null,Nl}function c(Nl,xl,Ml){return Nl.index=Ml,i?(Ml=Nl.alternate,Ml!==null?(Ml=Ml.index,Ml<xl?(Nl.flags|=2,xl):Ml):(Nl.flags|=2,xl)):(Nl.flags|=1048576,xl)}function d(Nl){return i&&Nl.alternate===null&&(Nl.flags|=2),Nl}function h(Nl,xl,Ml,Su){return xl===null||xl.tag!==6?(xl=xh$1(Ml,Nl.mode,Su),xl.return=Nl,xl):(xl=a(xl,Ml),xl.return=Nl,xl)}function g(Nl,xl,Ml,Su){var _d=Ml.type;return _d===ya$2?ft(Nl,xl,Ml.props.children,Su,Ml.key):xl!==null&&(xl.elementType===_d||typeof _d=="object"&&_d!==null&&_d.$$typeof===Ha$2&&uh(_d)===xl.type)?(Su=a(xl,Ml.props),Su.ref=sh$1(Nl,xl,Ml),Su.return=Nl,Su):(Su=yh$1(Ml.type,Ml.key,Ml.props,null,Nl.mode,Su),Su.ref=sh$1(Nl,xl,Ml),Su.return=Nl,Su)}function _(Nl,xl,Ml,Su){return xl===null||xl.tag!==4||xl.stateNode.containerInfo!==Ml.containerInfo||xl.stateNode.implementation!==Ml.implementation?(xl=zh$1(Ml,Nl.mode,Su),xl.return=Nl,xl):(xl=a(xl,Ml.children||[]),xl.return=Nl,xl)}function ft(Nl,xl,Ml,Su,_d){return xl===null||xl.tag!==7?(xl=Ah$1(Ml,Nl.mode,Su,_d),xl.return=Nl,xl):(xl=a(xl,Ml),xl.return=Nl,xl)}function _t(Nl,xl,Ml){if(typeof xl=="string"&&xl!==""||typeof xl=="number")return xl=xh$1(""+xl,Nl.mode,Ml),xl.return=Nl,xl;if(typeof xl=="object"&&xl!==null){switch(xl.$$typeof){case va$2:return Ml=yh$1(xl.type,xl.key,xl.props,null,Nl.mode,Ml),Ml.ref=sh$1(Nl,null,xl),Ml.return=Nl,Ml;case wa$2:return xl=zh$1(xl,Nl.mode,Ml),xl.return=Nl,xl;case Ha$2:var Su=xl._init;return _t(Nl,Su(xl._payload),Ml)}if(eb$1(xl)||Ka$2(xl))return xl=Ah$1(xl,Nl.mode,Ml,null),xl.return=Nl,xl;th$1(Nl,xl)}return null}function $t(Nl,xl,Ml,Su){var _d=xl!==null?xl.key:null;if(typeof Ml=="string"&&Ml!==""||typeof Ml=="number")return _d!==null?null:h(Nl,xl,""+Ml,Su);if(typeof Ml=="object"&&Ml!==null){switch(Ml.$$typeof){case va$2:return Ml.key===_d?g(Nl,xl,Ml,Su):null;case wa$2:return Ml.key===_d?_(Nl,xl,Ml,Su):null;case Ha$2:return _d=Ml._init,$t(Nl,xl,_d(Ml._payload),Su)}if(eb$1(Ml)||Ka$2(Ml))return _d!==null?null:ft(Nl,xl,Ml,Su,null);th$1(Nl,Ml)}return null}function Mt(Nl,xl,Ml,Su,_d){if(typeof Su=="string"&&Su!==""||typeof Su=="number")return Nl=Nl.get(Ml)||null,h(xl,Nl,""+Su,_d);if(typeof Su=="object"&&Su!==null){switch(Su.$$typeof){case va$2:return Nl=Nl.get(Su.key===null?Ml:Su.key)||null,g(xl,Nl,Su,_d);case wa$2:return Nl=Nl.get(Su.key===null?Ml:Su.key)||null,_(xl,Nl,Su,_d);case Ha$2:var ep=Su._init;return Mt(Nl,xl,Ml,ep(Su._payload),_d)}if(eb$1(Su)||Ka$2(Su))return Nl=Nl.get(Ml)||null,ft(xl,Nl,Su,_d,null);th$1(xl,Su)}return null}function Ft(Nl,xl,Ml,Su){for(var _d=null,ep=null,tp=xl,np=xl=0,op=null;tp!==null&&np<Ml.length;np++){tp.index>np?(op=tp,tp=null):op=tp.sibling;var rp=$t(Nl,tp,Ml[np],Su);if(rp===null){tp===null&&(tp=op);break}i&&tp&&rp.alternate===null&&e(Nl,tp),xl=c(rp,xl,np),ep===null?_d=rp:ep.sibling=rp,ep=rp,tp=op}if(np===Ml.length)return s(Nl,tp),I$1&&tg(Nl,np),_d;if(tp===null){for(;np<Ml.length;np++)tp=_t(Nl,Ml[np],Su),tp!==null&&(xl=c(tp,xl,np),ep===null?_d=tp:ep.sibling=tp,ep=tp);return I$1&&tg(Nl,np),_d}for(tp=o(Nl,tp);np<Ml.length;np++)op=Mt(tp,Nl,np,Ml[np],Su),op!==null&&(i&&op.alternate!==null&&tp.delete(op.key===null?np:op.key),xl=c(op,xl,np),ep===null?_d=op:ep.sibling=op,ep=op);return i&&tp.forEach(function(ap){return e(Nl,ap)}),I$1&&tg(Nl,np),_d}function Ol(Nl,xl,Ml,Su){var _d=Ka$2(Ml);if(typeof _d!="function")throw Error(p$1(150));if(Ml=_d.call(Ml),Ml==null)throw Error(p$1(151));for(var ep=_d=null,tp=xl,np=xl=0,op=null,rp=Ml.next();tp!==null&&!rp.done;np++,rp=Ml.next()){tp.index>np?(op=tp,tp=null):op=tp.sibling;var ap=$t(Nl,tp,rp.value,Su);if(ap===null){tp===null&&(tp=op);break}i&&tp&&ap.alternate===null&&e(Nl,tp),xl=c(ap,xl,np),ep===null?_d=ap:ep.sibling=ap,ep=ap,tp=op}if(rp.done)return s(Nl,tp),I$1&&tg(Nl,np),_d;if(tp===null){for(;!rp.done;np++,rp=Ml.next())rp=_t(Nl,rp.value,Su),rp!==null&&(xl=c(rp,xl,np),ep===null?_d=rp:ep.sibling=rp,ep=rp);return I$1&&tg(Nl,np),_d}for(tp=o(Nl,tp);!rp.done;np++,rp=Ml.next())rp=Mt(tp,Nl,np,rp.value,Su),rp!==null&&(i&&rp.alternate!==null&&tp.delete(rp.key===null?np:rp.key),xl=c(rp,xl,np),ep===null?_d=rp:ep.sibling=rp,ep=rp);return i&&tp.forEach(function(up){return e(Nl,up)}),I$1&&tg(Nl,np),_d}function Vl(Nl,xl,Ml,Su){if(typeof Ml=="object"&&Ml!==null&&Ml.type===ya$2&&Ml.key===null&&(Ml=Ml.props.children),typeof Ml=="object"&&Ml!==null){switch(Ml.$$typeof){case va$2:e:{for(var _d=Ml.key,ep=xl;ep!==null;){if(ep.key===_d){if(_d=Ml.type,_d===ya$2){if(ep.tag===7){s(Nl,ep.sibling),xl=a(ep,Ml.props.children),xl.return=Nl,Nl=xl;break e}}else if(ep.elementType===_d||typeof _d=="object"&&_d!==null&&_d.$$typeof===Ha$2&&uh(_d)===ep.type){s(Nl,ep.sibling),xl=a(ep,Ml.props),xl.ref=sh$1(Nl,ep,Ml),xl.return=Nl,Nl=xl;break e}s(Nl,ep);break}else e(Nl,ep);ep=ep.sibling}Ml.type===ya$2?(xl=Ah$1(Ml.props.children,Nl.mode,Su,Ml.key),xl.return=Nl,Nl=xl):(Su=yh$1(Ml.type,Ml.key,Ml.props,null,Nl.mode,Su),Su.ref=sh$1(Nl,xl,Ml),Su.return=Nl,Nl=Su)}return d(Nl);case wa$2:e:{for(ep=Ml.key;xl!==null;){if(xl.key===ep)if(xl.tag===4&&xl.stateNode.containerInfo===Ml.containerInfo&&xl.stateNode.implementation===Ml.implementation){s(Nl,xl.sibling),xl=a(xl,Ml.children||[]),xl.return=Nl,Nl=xl;break e}else{s(Nl,xl);break}else e(Nl,xl);xl=xl.sibling}xl=zh$1(Ml,Nl.mode,Su),xl.return=Nl,Nl=xl}return d(Nl);case Ha$2:return ep=Ml._init,Vl(Nl,xl,ep(Ml._payload),Su)}if(eb$1(Ml))return Ft(Nl,xl,Ml,Su);if(Ka$2(Ml))return Ol(Nl,xl,Ml,Su);th$1(Nl,Ml)}return typeof Ml=="string"&&Ml!==""||typeof Ml=="number"?(Ml=""+Ml,xl!==null&&xl.tag===6?(s(Nl,xl.sibling),xl=a(xl,Ml),xl.return=Nl,Nl=xl):(s(Nl,xl),xl=xh$1(Ml,Nl.mode,Su),xl.return=Nl,Nl=xl),d(Nl)):s(Nl,xl)}return Vl}var Bh$1=vh$1(!0),Ch$1=vh$1(!1),Dh$1={},Eh=Uf(Dh$1),Fh$1=Uf(Dh$1),Gh$1=Uf(Dh$1);function Hh$1(i){if(i===Dh$1)throw Error(p$1(174));return i}function Ih$1(i,e){switch(G$2(Gh$1,e),G$2(Fh$1,i),G$2(Eh,Dh$1),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb$1(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=lb$1(e,i)}E$1(Eh),G$2(Eh,e)}function Jh$1(){E$1(Eh),E$1(Fh$1),E$1(Gh$1)}function Kh$1(i){Hh$1(Gh$1.current);var e=Hh$1(Eh.current),s=lb$1(e,i.type);e!==s&&(G$2(Fh$1,i),G$2(Eh,s))}function Lh$1(i){Fh$1.current===i&&(E$1(Eh),E$1(Fh$1))}var M$2=Uf(0);function Mh$1(i){for(var e=i;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nh$1=[];function Oh$1(){for(var i=0;i<Nh$1.length;i++)Nh$1[i]._workInProgressVersionPrimary=null;Nh$1.length=0}var Ph$1=ua$2.ReactCurrentDispatcher,Qh$1=ua$2.ReactCurrentBatchConfig,Rh$1=0,N$2=null,O$2=null,P$2=null,Sh$1=!1,Th=!1,Uh$1=0,Vh$1=0;function Q$2(){throw Error(p$1(321))}function Wh$1(i,e){if(e===null)return!1;for(var s=0;s<e.length&&s<i.length;s++)if(!He$1(i[s],e[s]))return!1;return!0}function Xh$1(i,e,s,o,a,c){if(Rh$1=c,N$2=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ph$1.current=i===null||i.memoizedState===null?Yh$1:Zh$1,i=s(o,a),Th){c=0;do{if(Th=!1,Uh$1=0,25<=c)throw Error(p$1(301));c+=1,P$2=O$2=null,e.updateQueue=null,Ph$1.current=$h$1,i=s(o,a)}while(Th)}if(Ph$1.current=ai$1,e=O$2!==null&&O$2.next!==null,Rh$1=0,P$2=O$2=N$2=null,Sh$1=!1,e)throw Error(p$1(300));return i}function bi$1(){var i=Uh$1!==0;return Uh$1=0,i}function ci$1(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P$2===null?N$2.memoizedState=P$2=i:P$2=P$2.next=i,P$2}function di$1(){if(O$2===null){var i=N$2.alternate;i=i!==null?i.memoizedState:null}else i=O$2.next;var e=P$2===null?N$2.memoizedState:P$2.next;if(e!==null)P$2=e,O$2=i;else{if(i===null)throw Error(p$1(310));O$2=i,i={memoizedState:O$2.memoizedState,baseState:O$2.baseState,baseQueue:O$2.baseQueue,queue:O$2.queue,next:null},P$2===null?N$2.memoizedState=P$2=i:P$2=P$2.next=i}return P$2}function ei$1(i,e){return typeof e=="function"?e(i):e}function fi$1(i){var e=di$1(),s=e.queue;if(s===null)throw Error(p$1(311));s.lastRenderedReducer=i;var o=O$2,a=o.baseQueue,c=s.pending;if(c!==null){if(a!==null){var d=a.next;a.next=c.next,c.next=d}o.baseQueue=a=c,s.pending=null}if(a!==null){c=a.next,o=o.baseState;var h=d=null,g=null,_=c;do{var ft=_.lane;if((Rh$1&ft)===ft)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),o=_.hasEagerState?_.eagerState:i(o,_.action);else{var _t={lane:ft,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(h=g=_t,d=o):g=g.next=_t,N$2.lanes|=ft,hh$1|=ft}_=_.next}while(_!==null&&_!==c);g===null?d=o:g.next=h,He$1(o,e.memoizedState)||(Ug=!0),e.memoizedState=o,e.baseState=d,e.baseQueue=g,s.lastRenderedState=o}if(i=s.interleaved,i!==null){a=i;do c=a.lane,N$2.lanes|=c,hh$1|=c,a=a.next;while(a!==i)}else a===null&&(s.lanes=0);return[e.memoizedState,s.dispatch]}function gi$1(i){var e=di$1(),s=e.queue;if(s===null)throw Error(p$1(311));s.lastRenderedReducer=i;var o=s.dispatch,a=s.pending,c=e.memoizedState;if(a!==null){s.pending=null;var d=a=a.next;do c=i(c,d.action),d=d.next;while(d!==a);He$1(c,e.memoizedState)||(Ug=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),s.lastRenderedState=c}return[c,o]}function hi$1(){}function ii$1(i,e){var s=N$2,o=di$1(),a=e(),c=!He$1(o.memoizedState,a);if(c&&(o.memoizedState=a,Ug=!0),o=o.queue,ji$1(ki$1.bind(null,s,o,i),[i]),o.getSnapshot!==e||c||P$2!==null&&P$2.memoizedState.tag&1){if(s.flags|=2048,li$1(9,mi$1.bind(null,s,o,a,e),void 0,null),R$1===null)throw Error(p$1(349));Rh$1&30||ni$1(s,e,a)}return a}function ni$1(i,e,s){i.flags|=16384,i={getSnapshot:e,value:s},e=N$2.updateQueue,e===null?(e={lastEffect:null,stores:null},N$2.updateQueue=e,e.stores=[i]):(s=e.stores,s===null?e.stores=[i]:s.push(i))}function mi$1(i,e,s,o){e.value=s,e.getSnapshot=o,oi$1(e)&&pi$1(i)}function ki$1(i,e,s){return s(function(){oi$1(e)&&pi$1(i)})}function oi$1(i){var e=i.getSnapshot;i=i.value;try{var s=e();return!He$1(i,s)}catch{return!0}}function pi$1(i){var e=Zg(i,1);e!==null&&mh$1(e,i,1,-1)}function qi$1(i){var e=ci$1();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei$1,lastRenderedState:i},e.queue=i,i=i.dispatch=ri$1.bind(null,N$2,i),[e.memoizedState,i]}function li$1(i,e,s,o){return i={tag:i,create:e,destroy:s,deps:o,next:null},e=N$2.updateQueue,e===null?(e={lastEffect:null,stores:null},N$2.updateQueue=e,e.lastEffect=i.next=i):(s=e.lastEffect,s===null?e.lastEffect=i.next=i:(o=s.next,s.next=i,i.next=o,e.lastEffect=i)),i}function si$1(){return di$1().memoizedState}function ti$1(i,e,s,o){var a=ci$1();N$2.flags|=i,a.memoizedState=li$1(1|e,s,void 0,o===void 0?null:o)}function ui$1(i,e,s,o){var a=di$1();o=o===void 0?null:o;var c=void 0;if(O$2!==null){var d=O$2.memoizedState;if(c=d.destroy,o!==null&&Wh$1(o,d.deps)){a.memoizedState=li$1(e,s,c,o);return}}N$2.flags|=i,a.memoizedState=li$1(1|e,s,c,o)}function vi$1(i,e){return ti$1(8390656,8,i,e)}function ji$1(i,e){return ui$1(2048,8,i,e)}function wi$1(i,e){return ui$1(4,2,i,e)}function xi$1(i,e){return ui$1(4,4,i,e)}function yi$1(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function zi$1(i,e,s){return s=s!=null?s.concat([i]):null,ui$1(4,4,yi$1.bind(null,e,i),s)}function Ai$1(){}function Bi$1(i,e){var s=di$1();e=e===void 0?null:e;var o=s.memoizedState;return o!==null&&e!==null&&Wh$1(e,o[1])?o[0]:(s.memoizedState=[i,e],i)}function Ci$1(i,e){var s=di$1();e=e===void 0?null:e;var o=s.memoizedState;return o!==null&&e!==null&&Wh$1(e,o[1])?o[0]:(i=i(),s.memoizedState=[i,e],i)}function Di$1(i,e,s){return Rh$1&21?(He$1(s,e)||(s=yc$2(),N$2.lanes|=s,hh$1|=s,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Ug=!0),i.memoizedState=s)}function Ei$1(i,e){var s=C$2;C$2=s!==0&&4>s?s:4,i(!0);var o=Qh$1.transition;Qh$1.transition={};try{i(!1),e()}finally{C$2=s,Qh$1.transition=o}}function Fi$1(){return di$1().memoizedState}function Gi$1(i,e,s){var o=lh$1(i);if(s={lane:o,action:s,hasEagerState:!1,eagerState:null,next:null},Hi$1(i))Ii$1(e,s);else if(s=Yg(i,e,s,o),s!==null){var a=L$2();mh$1(s,i,o,a),Ji$1(s,e,o)}}function ri$1(i,e,s){var o=lh$1(i),a={lane:o,action:s,hasEagerState:!1,eagerState:null,next:null};if(Hi$1(i))Ii$1(e,a);else{var c=i.alternate;if(i.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var d=e.lastRenderedState,h=c(d,s);if(a.hasEagerState=!0,a.eagerState=h,He$1(h,d)){var g=e.interleaved;g===null?(a.next=a,Xg(e)):(a.next=g.next,g.next=a),e.interleaved=a;return}}catch{}finally{}s=Yg(i,e,a,o),s!==null&&(a=L$2(),mh$1(s,i,o,a),Ji$1(s,e,o))}}function Hi$1(i){var e=i.alternate;return i===N$2||e!==null&&e===N$2}function Ii$1(i,e){Th=Sh$1=!0;var s=i.pending;s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e}function Ji$1(i,e,s){if(s&4194240){var o=e.lanes;o&=i.pendingLanes,s|=o,e.lanes=s,Cc$2(i,s)}}var ai$1={readContext:Vg,useCallback:Q$2,useContext:Q$2,useEffect:Q$2,useImperativeHandle:Q$2,useInsertionEffect:Q$2,useLayoutEffect:Q$2,useMemo:Q$2,useReducer:Q$2,useRef:Q$2,useState:Q$2,useDebugValue:Q$2,useDeferredValue:Q$2,useTransition:Q$2,useMutableSource:Q$2,useSyncExternalStore:Q$2,useId:Q$2,unstable_isNewReconciler:!1},Yh$1={readContext:Vg,useCallback:function(i,e){return ci$1().memoizedState=[i,e===void 0?null:e],i},useContext:Vg,useEffect:vi$1,useImperativeHandle:function(i,e,s){return s=s!=null?s.concat([i]):null,ti$1(4194308,4,yi$1.bind(null,e,i),s)},useLayoutEffect:function(i,e){return ti$1(4194308,4,i,e)},useInsertionEffect:function(i,e){return ti$1(4,2,i,e)},useMemo:function(i,e){var s=ci$1();return e=e===void 0?null:e,i=i(),s.memoizedState=[i,e],i},useReducer:function(i,e,s){var o=ci$1();return e=s!==void 0?s(e):e,o.memoizedState=o.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},o.queue=i,i=i.dispatch=Gi$1.bind(null,N$2,i),[o.memoizedState,i]},useRef:function(i){var e=ci$1();return i={current:i},e.memoizedState=i},useState:qi$1,useDebugValue:Ai$1,useDeferredValue:function(i){return ci$1().memoizedState=i},useTransition:function(){var i=qi$1(!1),e=i[0];return i=Ei$1.bind(null,i[1]),ci$1().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,s){var o=N$2,a=ci$1();if(I$1){if(s===void 0)throw Error(p$1(407));s=s()}else{if(s=e(),R$1===null)throw Error(p$1(349));Rh$1&30||ni$1(o,e,s)}a.memoizedState=s;var c={value:s,getSnapshot:e};return a.queue=c,vi$1(ki$1.bind(null,o,c,i),[i]),o.flags|=2048,li$1(9,mi$1.bind(null,o,c,s,e),void 0,null),s},useId:function(){var i=ci$1(),e=R$1.identifierPrefix;if(I$1){var s=sg,o=rg;s=(o&~(1<<32-oc$2(o)-1)).toString(32)+s,e=":"+e+"R"+s,s=Uh$1++,0<s&&(e+="H"+s.toString(32)),e+=":"}else s=Vh$1++,e=":"+e+"r"+s.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},Zh$1={readContext:Vg,useCallback:Bi$1,useContext:Vg,useEffect:ji$1,useImperativeHandle:zi$1,useInsertionEffect:wi$1,useLayoutEffect:xi$1,useMemo:Ci$1,useReducer:fi$1,useRef:si$1,useState:function(){return fi$1(ei$1)},useDebugValue:Ai$1,useDeferredValue:function(i){var e=di$1();return Di$1(e,O$2.memoizedState,i)},useTransition:function(){var i=fi$1(ei$1)[0],e=di$1().memoizedState;return[i,e]},useMutableSource:hi$1,useSyncExternalStore:ii$1,useId:Fi$1,unstable_isNewReconciler:!1},$h$1={readContext:Vg,useCallback:Bi$1,useContext:Vg,useEffect:ji$1,useImperativeHandle:zi$1,useInsertionEffect:wi$1,useLayoutEffect:xi$1,useMemo:Ci$1,useReducer:gi$1,useRef:si$1,useState:function(){return gi$1(ei$1)},useDebugValue:Ai$1,useDeferredValue:function(i){var e=di$1();return O$2===null?e.memoizedState=i:Di$1(e,O$2.memoizedState,i)},useTransition:function(){var i=gi$1(ei$1)[0],e=di$1().memoizedState;return[i,e]},useMutableSource:hi$1,useSyncExternalStore:ii$1,useId:Fi$1,unstable_isNewReconciler:!1};function Ki$1(i,e){try{var s="",o=e;do s+=Pa$2(o),o=o.return;while(o);var a=s}catch(c){a=`
Error generating stack: `+c.message+`
`+c.stack}return{value:i,source:e,stack:a,digest:null}}function Li$1(i,e,s){return{value:i,source:null,stack:s??null,digest:e??null}}function Mi$1(i,e){try{console.error(e.value)}catch(s){setTimeout(function(){throw s})}}var Ni$1=typeof WeakMap=="function"?WeakMap:Map;function Oi$1(i,e,s){s=ch$1(-1,s),s.tag=3,s.payload={element:null};var o=e.value;return s.callback=function(){Pi$1||(Pi$1=!0,Qi$1=o),Mi$1(i,e)},s}function Ri$1(i,e,s){s=ch$1(-1,s),s.tag=3;var o=i.type.getDerivedStateFromError;if(typeof o=="function"){var a=e.value;s.payload=function(){return o(a)},s.callback=function(){Mi$1(i,e)}}var c=i.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(s.callback=function(){Mi$1(i,e),typeof o!="function"&&(Si$1===null?Si$1=new Set([this]):Si$1.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),s}function Ti$1(i,e,s){var o=i.pingCache;if(o===null){o=i.pingCache=new Ni$1;var a=new Set;o.set(e,a)}else a=o.get(e),a===void 0&&(a=new Set,o.set(e,a));a.has(s)||(a.add(s),i=Ui$1.bind(null,i,e,s),e.then(i,i))}function Vi$1(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Wi$1(i,e,s,o,a){return i.mode&1?(i.flags|=65536,i.lanes=a,i):(i===e?i.flags|=65536:(i.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(e=ch$1(-1,1),e.tag=2,dh$1(s,e,1))),s.lanes|=1),i)}var Xi$1=ua$2.ReactCurrentOwner,Ug=!1;function Yi$1(i,e,s,o){e.child=i===null?Ch$1(e,null,s,o):Bh$1(e,i.child,s,o)}function Zi$1(i,e,s,o,a){s=s.render;var c=e.ref;return Tg(e,a),o=Xh$1(i,e,s,o,c,a),s=bi$1(),i!==null&&!Ug?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~a,$i$1(i,e,a)):(I$1&&s&&vg(e),e.flags|=1,Yi$1(i,e,o,a),e.child)}function aj(i,e,s,o,a){if(i===null){var c=s.type;return typeof c=="function"&&!bj(c)&&c.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(e.tag=15,e.type=c,cj(i,e,c,o,a)):(i=yh$1(s.type,null,o,e,e.mode,a),i.ref=e.ref,i.return=e,e.child=i)}if(c=i.child,!(i.lanes&a)){var d=c.memoizedProps;if(s=s.compare,s=s!==null?s:Ie$1,s(d,o)&&i.ref===e.ref)return $i$1(i,e,a)}return e.flags|=1,i=wh$1(c,o),i.ref=e.ref,i.return=e,e.child=i}function cj(i,e,s,o,a){if(i!==null){var c=i.memoizedProps;if(Ie$1(c,o)&&i.ref===e.ref)if(Ug=!1,e.pendingProps=o=c,(i.lanes&a)!==0)i.flags&131072&&(Ug=!0);else return e.lanes=i.lanes,$i$1(i,e,a)}return dj(i,e,s,o,a)}function ej(i,e,s){var o=e.pendingProps,a=o.children,c=i!==null?i.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$2(fj,gj),gj|=s;else{if(!(s&1073741824))return i=c!==null?c.baseLanes|s:s,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,G$2(fj,gj),gj|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:s,G$2(fj,gj),gj|=o}else c!==null?(o=c.baseLanes|s,e.memoizedState=null):o=s,G$2(fj,gj),gj|=o;return Yi$1(i,e,a,s),e.child}function hj(i,e){var s=e.ref;(i===null&&s!==null||i!==null&&i.ref!==s)&&(e.flags|=512,e.flags|=2097152)}function dj(i,e,s,o,a){var c=Zf(s)?Xf:H$2.current;return c=Yf(e,c),Tg(e,a),s=Xh$1(i,e,s,o,c,a),o=bi$1(),i!==null&&!Ug?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~a,$i$1(i,e,a)):(I$1&&o&&vg(e),e.flags|=1,Yi$1(i,e,s,a),e.child)}function ij(i,e,s,o,a){if(Zf(s)){var c=!0;cg(e)}else c=!1;if(Tg(e,a),e.stateNode===null)jj(i,e),ph$1(e,s,o),rh$1(e,s,o,a),o=!0;else if(i===null){var d=e.stateNode,h=e.memoizedProps;d.props=h;var g=d.context,_=s.contextType;typeof _=="object"&&_!==null?_=Vg(_):(_=Zf(s)?Xf:H$2.current,_=Yf(e,_));var ft=s.getDerivedStateFromProps,_t=typeof ft=="function"||typeof d.getSnapshotBeforeUpdate=="function";_t||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==o||g!==_)&&qh$1(e,d,o,_),$g=!1;var $t=e.memoizedState;d.state=$t,gh(e,o,d,a),g=e.memoizedState,h!==o||$t!==g||Wf.current||$g?(typeof ft=="function"&&(kh$1(e,s,ft,o),g=e.memoizedState),(h=$g||oh(e,s,h,o,$t,g,_))?(_t||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=g),d.props=o,d.state=g,d.context=_,o=h):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{d=e.stateNode,bh(i,e),h=e.memoizedProps,_=e.type===e.elementType?h:Lg(e.type,h),d.props=_,_t=e.pendingProps,$t=d.context,g=s.contextType,typeof g=="object"&&g!==null?g=Vg(g):(g=Zf(s)?Xf:H$2.current,g=Yf(e,g));var Mt=s.getDerivedStateFromProps;(ft=typeof Mt=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==_t||$t!==g)&&qh$1(e,d,o,g),$g=!1,$t=e.memoizedState,d.state=$t,gh(e,o,d,a);var Ft=e.memoizedState;h!==_t||$t!==Ft||Wf.current||$g?(typeof Mt=="function"&&(kh$1(e,s,Mt,o),Ft=e.memoizedState),(_=$g||oh(e,s,_,o,$t,Ft,g)||!1)?(ft||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,Ft,g),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,Ft,g)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||h===i.memoizedProps&&$t===i.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===i.memoizedProps&&$t===i.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=Ft),d.props=o,d.state=Ft,d.context=g,o=_):(typeof d.componentDidUpdate!="function"||h===i.memoizedProps&&$t===i.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===i.memoizedProps&&$t===i.memoizedState||(e.flags|=1024),o=!1)}return kj(i,e,s,o,c,a)}function kj(i,e,s,o,a,c){hj(i,e);var d=(e.flags&128)!==0;if(!o&&!d)return a&&dg(e,s,!1),$i$1(i,e,c);o=e.stateNode,Xi$1.current=e;var h=d&&typeof s.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,i!==null&&d?(e.child=Bh$1(e,i.child,null,c),e.child=Bh$1(e,null,h,c)):Yi$1(i,e,h,c),e.memoizedState=o.state,a&&dg(e,s,!0),e.child}function lj(i){var e=i.stateNode;e.pendingContext?ag(i,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(i,e.context,!1),Ih$1(i,e.containerInfo)}function mj(i,e,s,o,a){return Ig(),Jg(a),e.flags|=256,Yi$1(i,e,s,o),e.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(i){return{baseLanes:i,cachePool:null,transitions:null}}function pj(i,e,s){var o=e.pendingProps,a=M$2.current,c=!1,d=(e.flags&128)!==0,h;if((h=d)||(h=i!==null&&i.memoizedState===null?!1:(a&2)!==0),h?(c=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(a|=1),G$2(M$2,a&1),i===null)return Eg(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=o.children,i=o.fallback,c?(o=e.mode,c=e.child,d={mode:"hidden",children:d},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=qj(d,o,0,null),i=Ah$1(i,o,s,null),c.return=e,i.return=e,c.sibling=i,e.child=c,e.child.memoizedState=oj(s),e.memoizedState=nj,i):rj(e,d));if(a=i.memoizedState,a!==null&&(h=a.dehydrated,h!==null))return sj(i,e,d,o,h,a,s);if(c){c=o.fallback,d=e.mode,a=i.child,h=a.sibling;var g={mode:"hidden",children:o.children};return!(d&1)&&e.child!==a?(o=e.child,o.childLanes=0,o.pendingProps=g,e.deletions=null):(o=wh$1(a,g),o.subtreeFlags=a.subtreeFlags&14680064),h!==null?c=wh$1(h,c):(c=Ah$1(c,d,s,null),c.flags|=2),c.return=e,o.return=e,o.sibling=c,e.child=o,o=c,c=e.child,d=i.child.memoizedState,d=d===null?oj(s):{baseLanes:d.baseLanes|s,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=i.childLanes&~s,e.memoizedState=nj,o}return c=i.child,i=c.sibling,o=wh$1(c,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=s),o.return=e,o.sibling=null,i!==null&&(s=e.deletions,s===null?(e.deletions=[i],e.flags|=16):s.push(i)),e.child=o,e.memoizedState=null,o}function rj(i,e){return e=qj({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function tj(i,e,s,o){return o!==null&&Jg(o),Bh$1(e,i.child,null,s),i=rj(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function sj(i,e,s,o,a,c,d){if(s)return e.flags&256?(e.flags&=-257,o=Li$1(Error(p$1(422))),tj(i,e,d,o)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(c=o.fallback,a=e.mode,o=qj({mode:"visible",children:o.children},a,0,null),c=Ah$1(c,a,d,null),c.flags|=2,o.return=e,c.return=e,o.sibling=c,e.child=o,e.mode&1&&Bh$1(e,i.child,null,d),e.child.memoizedState=oj(d),e.memoizedState=nj,c);if(!(e.mode&1))return tj(i,e,d,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var h=o.dgst;return o=h,c=Error(p$1(419)),o=Li$1(c,o,void 0),tj(i,e,d,o)}if(h=(d&i.childLanes)!==0,Ug||h){if(o=R$1,o!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(o.suspendedLanes|d)?0:a,a!==0&&a!==c.retryLane&&(c.retryLane=a,Zg(i,a),mh$1(o,i,a,-1))}return uj(),o=Li$1(Error(p$1(421))),tj(i,e,d,o)}return a.data==="$?"?(e.flags|=128,e.child=i.child,e=vj.bind(null,i),a._reactRetry=e,null):(i=c.treeContext,yg=Lf(a.nextSibling),xg=e,I$1=!0,zg=null,i!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=i.id,sg=i.overflow,qg=e),e=rj(e,o.children),e.flags|=4096,e)}function wj(i,e,s){i.lanes|=e;var o=i.alternate;o!==null&&(o.lanes|=e),Sg(i.return,e,s)}function xj(i,e,s,o,a){var c=i.memoizedState;c===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:s,tailMode:a}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=s,c.tailMode=a)}function yj(i,e,s){var o=e.pendingProps,a=o.revealOrder,c=o.tail;if(Yi$1(i,e,o.children,s),o=M$2.current,o&2)o=o&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&wj(i,s,e);else if(i.tag===19)wj(i,s,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}o&=1}if(G$2(M$2,o),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(s=e.child,a=null;s!==null;)i=s.alternate,i!==null&&Mh$1(i)===null&&(a=s),s=s.sibling;s=a,s===null?(a=e.child,e.child=null):(a=s.sibling,s.sibling=null),xj(e,!1,a,s,c);break;case"backwards":for(s=null,a=e.child,e.child=null;a!==null;){if(i=a.alternate,i!==null&&Mh$1(i)===null){e.child=a;break}i=a.sibling,a.sibling=s,s=a,a=i}xj(e,!0,s,null,c);break;case"together":xj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jj(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function $i$1(i,e,s){if(i!==null&&(e.dependencies=i.dependencies),hh$1|=e.lanes,!(s&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(p$1(153));if(e.child!==null){for(i=e.child,s=wh$1(i,i.pendingProps),e.child=s,s.return=e;i.sibling!==null;)i=i.sibling,s=s.sibling=wh$1(i,i.pendingProps),s.return=e;s.sibling=null}return e.child}function zj(i,e,s){switch(e.tag){case 3:lj(e),Ig();break;case 5:Kh$1(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:Ih$1(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,a=e.memoizedProps.value;G$2(Mg,o._currentValue),o._currentValue=a;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(G$2(M$2,M$2.current&1),e.flags|=128,null):s&e.child.childLanes?pj(i,e,s):(G$2(M$2,M$2.current&1),i=$i$1(i,e,s),i!==null?i.sibling:null);G$2(M$2,M$2.current&1);break;case 19:if(o=(s&e.childLanes)!==0,i.flags&128){if(o)return yj(i,e,s);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),G$2(M$2,M$2.current),o)break;return null;case 22:case 23:return e.lanes=0,ej(i,e,s)}return $i$1(i,e,s)}var Aj,Bj,Cj,Dj;Aj=function(i,e){for(var s=e.child;s!==null;){if(s.tag===5||s.tag===6)i.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Bj=function(){};Cj=function(i,e,s,o){var a=i.memoizedProps;if(a!==o){i=e.stateNode,Hh$1(Eh.current);var c=null;switch(s){case"input":a=Ya$2(i,a),o=Ya$2(i,o),c=[];break;case"select":a=A$1({},a,{value:void 0}),o=A$1({},o,{value:void 0}),c=[];break;case"textarea":a=gb$1(i,a),o=gb$1(i,o),c=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(i.onclick=Bf)}ub$1(s,o);var d;s=null;for(_ in a)if(!o.hasOwnProperty(_)&&a.hasOwnProperty(_)&&a[_]!=null)if(_==="style"){var h=a[_];for(d in h)h.hasOwnProperty(d)&&(s||(s={}),s[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea$2.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in o){var g=o[_];if(h=a!=null?a[_]:void 0,o.hasOwnProperty(_)&&g!==h&&(g!=null||h!=null))if(_==="style")if(h){for(d in h)!h.hasOwnProperty(d)||g&&g.hasOwnProperty(d)||(s||(s={}),s[d]="");for(d in g)g.hasOwnProperty(d)&&h[d]!==g[d]&&(s||(s={}),s[d]=g[d])}else s||(c||(c=[]),c.push(_,s)),s=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,h=h?h.__html:void 0,g!=null&&h!==g&&(c=c||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(c=c||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea$2.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&D$2("scroll",i),c||h===g||(c=[])):(c=c||[]).push(_,g))}s&&(c=c||[]).push("style",s);var _=c;(e.updateQueue=_)&&(e.flags|=4)}};Dj=function(i,e,s,o){s!==o&&(e.flags|=4)};function Ej(i,e){if(!I$1)switch(i.tailMode){case"hidden":e=i.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?i.tail=null:s.sibling=null;break;case"collapsed":s=i.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:o.sibling=null}}function S$2(i){var e=i.alternate!==null&&i.alternate.child===i.child,s=0,o=0;if(e)for(var a=i.child;a!==null;)s|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=i,a=a.sibling;else for(a=i.child;a!==null;)s|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=i,a=a.sibling;return i.subtreeFlags|=o,i.childLanes=s,e}function Fj(i,e,s){var o=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$2(e),null;case 1:return Zf(e.type)&&$f(),S$2(e),null;case 3:return o=e.stateNode,Jh$1(),E$1(Wf),E$1(H$2),Oh$1(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Gg(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(i,e),S$2(e),null;case 5:Lh$1(e);var a=Hh$1(Gh$1.current);if(s=e.type,i!==null&&e.stateNode!=null)Cj(i,e,s,o,a),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(p$1(166));return S$2(e),null}if(i=Hh$1(Eh.current),Gg(e)){o=e.stateNode,s=e.type;var c=e.memoizedProps;switch(o[Of]=e,o[Pf]=c,i=(e.mode&1)!==0,s){case"dialog":D$2("cancel",o),D$2("close",o);break;case"iframe":case"object":case"embed":D$2("load",o);break;case"video":case"audio":for(a=0;a<lf$1.length;a++)D$2(lf$1[a],o);break;case"source":D$2("error",o);break;case"img":case"image":case"link":D$2("error",o),D$2("load",o);break;case"details":D$2("toggle",o);break;case"input":Za$1(o,c),D$2("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},D$2("invalid",o);break;case"textarea":hb$1(o,c),D$2("invalid",o)}ub$1(s,c),a=null;for(var d in c)if(c.hasOwnProperty(d)){var h=c[d];d==="children"?typeof h=="string"?o.textContent!==h&&(c.suppressHydrationWarning!==!0&&Af(o.textContent,h,i),a=["children",h]):typeof h=="number"&&o.textContent!==""+h&&(c.suppressHydrationWarning!==!0&&Af(o.textContent,h,i),a=["children",""+h]):ea$2.hasOwnProperty(d)&&h!=null&&d==="onScroll"&&D$2("scroll",o)}switch(s){case"input":Va$2(o),db$2(o,c,!0);break;case"textarea":Va$2(o),jb$1(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=Bf)}o=a,e.updateQueue=o,o!==null&&(e.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=kb$1(s)),i==="http://www.w3.org/1999/xhtml"?s==="script"?(i=d.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof o.is=="string"?i=d.createElement(s,{is:o.is}):(i=d.createElement(s),s==="select"&&(d=i,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):i=d.createElementNS(i,s),i[Of]=e,i[Pf]=o,Aj(i,e,!1,!1),e.stateNode=i;e:{switch(d=vb$1(s,o),s){case"dialog":D$2("cancel",i),D$2("close",i),a=o;break;case"iframe":case"object":case"embed":D$2("load",i),a=o;break;case"video":case"audio":for(a=0;a<lf$1.length;a++)D$2(lf$1[a],i);a=o;break;case"source":D$2("error",i),a=o;break;case"img":case"image":case"link":D$2("error",i),D$2("load",i),a=o;break;case"details":D$2("toggle",i),a=o;break;case"input":Za$1(i,o),a=Ya$2(i,o),D$2("invalid",i);break;case"option":a=o;break;case"select":i._wrapperState={wasMultiple:!!o.multiple},a=A$1({},o,{value:void 0}),D$2("invalid",i);break;case"textarea":hb$1(i,o),a=gb$1(i,o),D$2("invalid",i);break;default:a=o}ub$1(s,a),h=a;for(c in h)if(h.hasOwnProperty(c)){var g=h[c];c==="style"?sb$1(i,g):c==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&nb$1(i,g)):c==="children"?typeof g=="string"?(s!=="textarea"||g!=="")&&ob$1(i,g):typeof g=="number"&&ob$1(i,""+g):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea$2.hasOwnProperty(c)?g!=null&&c==="onScroll"&&D$2("scroll",i):g!=null&&ta$2(i,c,g,d))}switch(s){case"input":Va$2(i),db$2(i,o,!1);break;case"textarea":Va$2(i),jb$1(i);break;case"option":o.value!=null&&i.setAttribute("value",""+Sa$2(o.value));break;case"select":i.multiple=!!o.multiple,c=o.value,c!=null?fb$1(i,!!o.multiple,c,!1):o.defaultValue!=null&&fb$1(i,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(i.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S$2(e),null;case 6:if(i&&e.stateNode!=null)Dj(i,e,i.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(p$1(166));if(s=Hh$1(Gh$1.current),Hh$1(Eh.current),Gg(e)){if(o=e.stateNode,s=e.memoizedProps,o[Of]=e,(c=o.nodeValue!==s)&&(i=xg,i!==null))switch(i.tag){case 3:Af(o.nodeValue,s,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Af(o.nodeValue,s,(i.mode&1)!==0)}c&&(e.flags|=4)}else o=(s.nodeType===9?s:s.ownerDocument).createTextNode(o),o[Of]=e,e.stateNode=o}return S$2(e),null;case 13:if(E$1(M$2),o=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,c=!1;else if(c=Gg(e),o!==null&&o.dehydrated!==null){if(i===null){if(!c)throw Error(p$1(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p$1(317));c[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S$2(e),c=!1}else zg!==null&&(Gj(zg),zg=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=s,e):(o=o!==null,o!==(i!==null&&i.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(i===null||M$2.current&1?T$1===0&&(T$1=3):uj())),e.updateQueue!==null&&(e.flags|=4),S$2(e),null);case 4:return Jh$1(),Bj(i,e),i===null&&sf$1(e.stateNode.containerInfo),S$2(e),null;case 10:return Rg(e.type._context),S$2(e),null;case 17:return Zf(e.type)&&$f(),S$2(e),null;case 19:if(E$1(M$2),c=e.memoizedState,c===null)return S$2(e),null;if(o=(e.flags&128)!==0,d=c.rendering,d===null)if(o)Ej(c,!1);else{if(T$1!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(d=Mh$1(i),d!==null){for(e.flags|=128,Ej(c,!1),o=d.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=s,s=e.child;s!==null;)c=s,i=o,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=i,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,i=d.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s=s.sibling;return G$2(M$2,M$2.current&1|2),e.child}i=i.sibling}c.tail!==null&&B$2()>Hj&&(e.flags|=128,o=!0,Ej(c,!1),e.lanes=4194304)}else{if(!o)if(i=Mh$1(d),i!==null){if(e.flags|=128,o=!0,s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),Ej(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!I$1)return S$2(e),null}else 2*B$2()-c.renderingStartTime>Hj&&s!==1073741824&&(e.flags|=128,o=!0,Ej(c,!1),e.lanes=4194304);c.isBackwards?(d.sibling=e.child,e.child=d):(s=c.last,s!==null?s.sibling=d:e.child=d,c.last=d)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=B$2(),e.sibling=null,s=M$2.current,G$2(M$2,o?s&1|2:s&1),e):(S$2(e),null);case 22:case 23:return Ij(),o=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?gj&1073741824&&(S$2(e),e.subtreeFlags&6&&(e.flags|=8192)):S$2(e),null;case 24:return null;case 25:return null}throw Error(p$1(156,e.tag))}function Jj(i,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Jh$1(),E$1(Wf),E$1(H$2),Oh$1(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return Lh$1(e),null;case 13:if(E$1(M$2),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(p$1(340));Ig()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return E$1(M$2),null;case 4:return Jh$1(),null;case 10:return Rg(e.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$2=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$2=null;function Mj(i,e){var s=i.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(o){W$2(i,e,o)}else s.current=null}function Nj(i,e,s){try{s()}catch(o){W$2(i,e,o)}}var Oj=!1;function Pj(i,e){if(Cf=dd$1,i=Me$1(),Ne$1(i)){if("selectionStart"in i)var s={start:i.selectionStart,end:i.selectionEnd};else e:{s=(s=i.ownerDocument)&&s.defaultView||window;var o=s.getSelection&&s.getSelection();if(o&&o.rangeCount!==0){s=o.anchorNode;var a=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{s.nodeType,c.nodeType}catch{s=null;break e}var d=0,h=-1,g=-1,_=0,ft=0,_t=i,$t=null;t:for(;;){for(var Mt;_t!==s||a!==0&&_t.nodeType!==3||(h=d+a),_t!==c||o!==0&&_t.nodeType!==3||(g=d+o),_t.nodeType===3&&(d+=_t.nodeValue.length),(Mt=_t.firstChild)!==null;)$t=_t,_t=Mt;for(;;){if(_t===i)break t;if($t===s&&++_===a&&(h=d),$t===c&&++ft===o&&(g=d),(Mt=_t.nextSibling)!==null)break;_t=$t,$t=_t.parentNode}_t=Mt}s=h===-1||g===-1?null:{start:h,end:g}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:i,selectionRange:s},dd$1=!1,V$2=e;V$2!==null;)if(e=V$2,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,V$2=i;else for(;V$2!==null;){e=V$2;try{var Ft=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(Ft!==null){var Ol=Ft.memoizedProps,Vl=Ft.memoizedState,Nl=e.stateNode,xl=Nl.getSnapshotBeforeUpdate(e.elementType===e.type?Ol:Lg(e.type,Ol),Vl);Nl.__reactInternalSnapshotBeforeUpdate=xl}break;case 3:var Ml=e.stateNode.containerInfo;Ml.nodeType===1?Ml.textContent="":Ml.nodeType===9&&Ml.documentElement&&Ml.removeChild(Ml.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(Su){W$2(e,e.return,Su)}if(i=e.sibling,i!==null){i.return=e.return,V$2=i;break}V$2=e.return}return Ft=Oj,Oj=!1,Ft}function Qj(i,e,s){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&i)===i){var c=a.destroy;a.destroy=void 0,c!==void 0&&Nj(e,s,c)}a=a.next}while(a!==o)}}function Rj(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var s=e=e.next;do{if((s.tag&i)===i){var o=s.create;s.destroy=o()}s=s.next}while(s!==e)}}function Sj(i){var e=i.ref;if(e!==null){var s=i.stateNode;switch(i.tag){case 5:i=s;break;default:i=s}typeof e=="function"?e(i):e.current=i}}function Tj(i){var e=i.alternate;e!==null&&(i.alternate=null,Tj(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Uj(i){return i.tag===5||i.tag===3||i.tag===4}function Vj(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Uj(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Wj(i,e,s){var o=i.tag;if(o===5||o===6)i=i.stateNode,e?s.nodeType===8?s.parentNode.insertBefore(i,e):s.insertBefore(i,e):(s.nodeType===8?(e=s.parentNode,e.insertBefore(i,s)):(e=s,e.appendChild(i)),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=Bf));else if(o!==4&&(i=i.child,i!==null))for(Wj(i,e,s),i=i.sibling;i!==null;)Wj(i,e,s),i=i.sibling}function Xj(i,e,s){var o=i.tag;if(o===5||o===6)i=i.stateNode,e?s.insertBefore(i,e):s.appendChild(i);else if(o!==4&&(i=i.child,i!==null))for(Xj(i,e,s),i=i.sibling;i!==null;)Xj(i,e,s),i=i.sibling}var X$2=null,Yj=!1;function Zj(i,e,s){for(s=s.child;s!==null;)ak(i,e,s),s=s.sibling}function ak(i,e,s){if(lc$2&&typeof lc$2.onCommitFiberUnmount=="function")try{lc$2.onCommitFiberUnmount(kc$2,s)}catch{}switch(s.tag){case 5:U$2||Mj(s,e);case 6:var o=X$2,a=Yj;X$2=null,Zj(i,e,s),X$2=o,Yj=a,X$2!==null&&(Yj?(i=X$2,s=s.stateNode,i.nodeType===8?i.parentNode.removeChild(s):i.removeChild(s)):X$2.removeChild(s.stateNode));break;case 18:X$2!==null&&(Yj?(i=X$2,s=s.stateNode,i.nodeType===8?Kf(i.parentNode,s):i.nodeType===1&&Kf(i,s),bd$1(i)):Kf(X$2,s.stateNode));break;case 4:o=X$2,a=Yj,X$2=s.stateNode.containerInfo,Yj=!0,Zj(i,e,s),X$2=o,Yj=a;break;case 0:case 11:case 14:case 15:if(!U$2&&(o=s.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var c=a,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Nj(s,e,d),a=a.next}while(a!==o)}Zj(i,e,s);break;case 1:if(!U$2&&(Mj(s,e),o=s.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=s.memoizedProps,o.state=s.memoizedState,o.componentWillUnmount()}catch(h){W$2(s,e,h)}Zj(i,e,s);break;case 21:Zj(i,e,s);break;case 22:s.mode&1?(U$2=(o=U$2)||s.memoizedState!==null,Zj(i,e,s),U$2=o):Zj(i,e,s);break;default:Zj(i,e,s)}}function bk(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var s=i.stateNode;s===null&&(s=i.stateNode=new Lj),e.forEach(function(o){var a=ck.bind(null,i,o);s.has(o)||(s.add(o),o.then(a,a))})}}function dk(i,e){var s=e.deletions;if(s!==null)for(var o=0;o<s.length;o++){var a=s[o];try{var c=i,d=e,h=d;e:for(;h!==null;){switch(h.tag){case 5:X$2=h.stateNode,Yj=!1;break e;case 3:X$2=h.stateNode.containerInfo,Yj=!0;break e;case 4:X$2=h.stateNode.containerInfo,Yj=!0;break e}h=h.return}if(X$2===null)throw Error(p$1(160));ak(c,d,a),X$2=null,Yj=!1;var g=a.alternate;g!==null&&(g.return=null),a.return=null}catch(_){W$2(a,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ek(e,i),e=e.sibling}function ek(i,e){var s=i.alternate,o=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(dk(e,i),fk(i),o&4){try{Qj(3,i,i.return),Rj(3,i)}catch(Ol){W$2(i,i.return,Ol)}try{Qj(5,i,i.return)}catch(Ol){W$2(i,i.return,Ol)}}break;case 1:dk(e,i),fk(i),o&512&&s!==null&&Mj(s,s.return);break;case 5:if(dk(e,i),fk(i),o&512&&s!==null&&Mj(s,s.return),i.flags&32){var a=i.stateNode;try{ob$1(a,"")}catch(Ol){W$2(i,i.return,Ol)}}if(o&4&&(a=i.stateNode,a!=null)){var c=i.memoizedProps,d=s!==null?s.memoizedProps:c,h=i.type,g=i.updateQueue;if(i.updateQueue=null,g!==null)try{h==="input"&&c.type==="radio"&&c.name!=null&&ab$1(a,c),vb$1(h,d);var _=vb$1(h,c);for(d=0;d<g.length;d+=2){var ft=g[d],_t=g[d+1];ft==="style"?sb$1(a,_t):ft==="dangerouslySetInnerHTML"?nb$1(a,_t):ft==="children"?ob$1(a,_t):ta$2(a,ft,_t,_)}switch(h){case"input":bb$1(a,c);break;case"textarea":ib$1(a,c);break;case"select":var $t=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!c.multiple;var Mt=c.value;Mt!=null?fb$1(a,!!c.multiple,Mt,!1):$t!==!!c.multiple&&(c.defaultValue!=null?fb$1(a,!!c.multiple,c.defaultValue,!0):fb$1(a,!!c.multiple,c.multiple?[]:"",!1))}a[Pf]=c}catch(Ol){W$2(i,i.return,Ol)}}break;case 6:if(dk(e,i),fk(i),o&4){if(i.stateNode===null)throw Error(p$1(162));a=i.stateNode,c=i.memoizedProps;try{a.nodeValue=c}catch(Ol){W$2(i,i.return,Ol)}}break;case 3:if(dk(e,i),fk(i),o&4&&s!==null&&s.memoizedState.isDehydrated)try{bd$1(e.containerInfo)}catch(Ol){W$2(i,i.return,Ol)}break;case 4:dk(e,i),fk(i);break;case 13:dk(e,i),fk(i),a=i.child,a.flags&8192&&(c=a.memoizedState!==null,a.stateNode.isHidden=c,!c||a.alternate!==null&&a.alternate.memoizedState!==null||(gk=B$2())),o&4&&bk(i);break;case 22:if(ft=s!==null&&s.memoizedState!==null,i.mode&1?(U$2=(_=U$2)||ft,dk(e,i),U$2=_):dk(e,i),fk(i),o&8192){if(_=i.memoizedState!==null,(i.stateNode.isHidden=_)&&!ft&&i.mode&1)for(V$2=i,ft=i.child;ft!==null;){for(_t=V$2=ft;V$2!==null;){switch($t=V$2,Mt=$t.child,$t.tag){case 0:case 11:case 14:case 15:Qj(4,$t,$t.return);break;case 1:Mj($t,$t.return);var Ft=$t.stateNode;if(typeof Ft.componentWillUnmount=="function"){o=$t,s=$t.return;try{e=o,Ft.props=e.memoizedProps,Ft.state=e.memoizedState,Ft.componentWillUnmount()}catch(Ol){W$2(o,s,Ol)}}break;case 5:Mj($t,$t.return);break;case 22:if($t.memoizedState!==null){hk(_t);continue}}Mt!==null?(Mt.return=$t,V$2=Mt):hk(_t)}ft=ft.sibling}e:for(ft=null,_t=i;;){if(_t.tag===5){if(ft===null){ft=_t;try{a=_t.stateNode,_?(c=a.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(h=_t.stateNode,g=_t.memoizedProps.style,d=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=rb$1("display",d))}catch(Ol){W$2(i,i.return,Ol)}}}else if(_t.tag===6){if(ft===null)try{_t.stateNode.nodeValue=_?"":_t.memoizedProps}catch(Ol){W$2(i,i.return,Ol)}}else if((_t.tag!==22&&_t.tag!==23||_t.memoizedState===null||_t===i)&&_t.child!==null){_t.child.return=_t,_t=_t.child;continue}if(_t===i)break e;for(;_t.sibling===null;){if(_t.return===null||_t.return===i)break e;ft===_t&&(ft=null),_t=_t.return}ft===_t&&(ft=null),_t.sibling.return=_t.return,_t=_t.sibling}}break;case 19:dk(e,i),fk(i),o&4&&bk(i);break;case 21:break;default:dk(e,i),fk(i)}}function fk(i){var e=i.flags;if(e&2){try{e:{for(var s=i.return;s!==null;){if(Uj(s)){var o=s;break e}s=s.return}throw Error(p$1(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(ob$1(a,""),o.flags&=-33);var c=Vj(i);Xj(i,c,a);break;case 3:case 4:var d=o.stateNode.containerInfo,h=Vj(i);Wj(i,h,d);break;default:throw Error(p$1(161))}}catch(g){W$2(i,i.return,g)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function ik(i,e,s){V$2=i,jk(i)}function jk(i,e,s){for(var o=(i.mode&1)!==0;V$2!==null;){var a=V$2,c=a.child;if(a.tag===22&&o){var d=a.memoizedState!==null||Kj;if(!d){var h=a.alternate,g=h!==null&&h.memoizedState!==null||U$2;h=Kj;var _=U$2;if(Kj=d,(U$2=g)&&!_)for(V$2=a;V$2!==null;)d=V$2,g=d.child,d.tag===22&&d.memoizedState!==null?kk(a):g!==null?(g.return=d,V$2=g):kk(a);for(;c!==null;)V$2=c,jk(c),c=c.sibling;V$2=a,Kj=h,U$2=_}lk(i)}else a.subtreeFlags&8772&&c!==null?(c.return=a,V$2=c):lk(i)}}function lk(i){for(;V$2!==null;){var e=V$2;if(e.flags&8772){var s=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U$2||Rj(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!U$2)if(s===null)o.componentDidMount();else{var a=e.elementType===e.type?s.memoizedProps:Lg(e.type,s.memoizedProps);o.componentDidUpdate(a,s.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&ih$1(e,c,o);break;case 3:var d=e.updateQueue;if(d!==null){if(s=null,e.child!==null)switch(e.child.tag){case 5:s=e.child.stateNode;break;case 1:s=e.child.stateNode}ih$1(e,d,s)}break;case 5:var h=e.stateNode;if(s===null&&e.flags&4){s=h;var g=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&s.focus();break;case"img":g.src&&(s.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var ft=_.memoizedState;if(ft!==null){var _t=ft.dehydrated;_t!==null&&bd$1(_t)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U$2||e.flags&512&&Sj(e)}catch($t){W$2(e,e.return,$t)}}if(e===i){V$2=null;break}if(s=e.sibling,s!==null){s.return=e.return,V$2=s;break}V$2=e.return}}function hk(i){for(;V$2!==null;){var e=V$2;if(e===i){V$2=null;break}var s=e.sibling;if(s!==null){s.return=e.return,V$2=s;break}V$2=e.return}}function kk(i){for(;V$2!==null;){var e=V$2;try{switch(e.tag){case 0:case 11:case 15:var s=e.return;try{Rj(4,e)}catch(g){W$2(e,s,g)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var a=e.return;try{o.componentDidMount()}catch(g){W$2(e,a,g)}}var c=e.return;try{Sj(e)}catch(g){W$2(e,c,g)}break;case 5:var d=e.return;try{Sj(e)}catch(g){W$2(e,d,g)}}}catch(g){W$2(e,e.return,g)}if(e===i){V$2=null;break}var h=e.sibling;if(h!==null){h.return=e.return,V$2=h;break}V$2=e.return}}var mk=Math.ceil,nk=ua$2.ReactCurrentDispatcher,ok=ua$2.ReactCurrentOwner,pk=ua$2.ReactCurrentBatchConfig,K$2=0,R$1=null,Y$2=null,Z$1=0,gj=0,fj=Uf(0),T$1=0,qk=null,hh$1=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi$1=!1,Qi$1=null,Si$1=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L$2(){return K$2&6?B$2():Bk!==-1?Bk:Bk=B$2()}function lh$1(i){return i.mode&1?K$2&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Ck===0&&(Ck=yc$2()),Ck):(i=C$2,i!==0||(i=window.event,i=i===void 0?16:jd$1(i.type)),i):1}function mh$1(i,e,s,o){if(50<zk)throw zk=0,Ak=null,Error(p$1(185));Ac$2(i,s,o),(!(K$2&2)||i!==R$1)&&(i===R$1&&(!(K$2&2)&&(rk|=s),T$1===4&&Dk(i,Z$1)),Ek(i,o),s===1&&K$2===0&&!(e.mode&1)&&(Hj=B$2()+500,fg&&jg()))}function Ek(i,e){var s=i.callbackNode;wc$2(i,e);var o=uc$2(i,i===R$1?Z$1:0);if(o===0)s!==null&&bc$2(s),i.callbackNode=null,i.callbackPriority=0;else if(e=o&-o,i.callbackPriority!==e){if(s!=null&&bc$2(s),e===1)i.tag===0?ig(Fk.bind(null,i)):hg(Fk.bind(null,i)),Jf(function(){!(K$2&6)&&jg()}),s=null;else{switch(Dc$2(o)){case 1:s=fc$2;break;case 4:s=gc$2;break;case 16:s=hc$2;break;case 536870912:s=jc$2;break;default:s=hc$2}s=Gk(s,Hk.bind(null,i))}i.callbackPriority=e,i.callbackNode=s}}function Hk(i,e){if(Bk=-1,Ck=0,K$2&6)throw Error(p$1(327));var s=i.callbackNode;if(Ik()&&i.callbackNode!==s)return null;var o=uc$2(i,i===R$1?Z$1:0);if(o===0)return null;if(o&30||o&i.expiredLanes||e)e=Jk(i,o);else{e=o;var a=K$2;K$2|=2;var c=Kk();(R$1!==i||Z$1!==e)&&(vk=null,Hj=B$2()+500,Lk(i,e));do try{Mk();break}catch(h){Nk(i,h)}while(1);Qg(),nk.current=c,K$2=a,Y$2!==null?e=0:(R$1=null,Z$1=0,e=T$1)}if(e!==0){if(e===2&&(a=xc$2(i),a!==0&&(o=a,e=Ok(i,a))),e===1)throw s=qk,Lk(i,0),Dk(i,o),Ek(i,B$2()),s;if(e===6)Dk(i,o);else{if(a=i.current.alternate,!(o&30)&&!Pk(a)&&(e=Jk(i,o),e===2&&(c=xc$2(i),c!==0&&(o=c,e=Ok(i,c))),e===1))throw s=qk,Lk(i,0),Dk(i,o),Ek(i,B$2()),s;switch(i.finishedWork=a,i.finishedLanes=o,e){case 0:case 1:throw Error(p$1(345));case 2:Qk(i,uk,vk);break;case 3:if(Dk(i,o),(o&130023424)===o&&(e=gk+500-B$2(),10<e)){if(uc$2(i,0)!==0)break;if(a=i.suspendedLanes,(a&o)!==o){L$2(),i.pingedLanes|=i.suspendedLanes&a;break}i.timeoutHandle=Ff(Qk.bind(null,i,uk,vk),e);break}Qk(i,uk,vk);break;case 4:if(Dk(i,o),(o&4194240)===o)break;for(e=i.eventTimes,a=-1;0<o;){var d=31-oc$2(o);c=1<<d,d=e[d],d>a&&(a=d),o&=~c}if(o=a,o=B$2()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*mk(o/1960))-o,10<o){i.timeoutHandle=Ff(Qk.bind(null,i,uk,vk),o);break}Qk(i,uk,vk);break;case 5:Qk(i,uk,vk);break;default:throw Error(p$1(329))}}}return Ek(i,B$2()),i.callbackNode===s?Hk.bind(null,i):null}function Ok(i,e){var s=tk;return i.current.memoizedState.isDehydrated&&(Lk(i,e).flags|=256),i=Jk(i,e),i!==2&&(e=uk,uk=s,e!==null&&Gj(e)),i}function Gj(i){uk===null?uk=i:uk.push.apply(uk,i)}function Pk(i){for(var e=i;;){if(e.flags&16384){var s=e.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var o=0;o<s.length;o++){var a=s[o],c=a.getSnapshot;a=a.value;try{if(!He$1(c(),a))return!1}catch{return!1}}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Dk(i,e){for(e&=~sk,e&=~rk,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var s=31-oc$2(e),o=1<<s;i[s]=-1,e&=~o}}function Fk(i){if(K$2&6)throw Error(p$1(327));Ik();var e=uc$2(i,0);if(!(e&1))return Ek(i,B$2()),null;var s=Jk(i,e);if(i.tag!==0&&s===2){var o=xc$2(i);o!==0&&(e=o,s=Ok(i,o))}if(s===1)throw s=qk,Lk(i,0),Dk(i,e),Ek(i,B$2()),s;if(s===6)throw Error(p$1(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Qk(i,uk,vk),Ek(i,B$2()),null}function Rk(i,e){var s=K$2;K$2|=1;try{return i(e)}finally{K$2=s,K$2===0&&(Hj=B$2()+500,fg&&jg())}}function Sk(i){xk!==null&&xk.tag===0&&!(K$2&6)&&Ik();var e=K$2;K$2|=1;var s=pk.transition,o=C$2;try{if(pk.transition=null,C$2=1,i)return i()}finally{C$2=o,pk.transition=s,K$2=e,!(K$2&6)&&jg()}}function Ij(){gj=fj.current,E$1(fj)}function Lk(i,e){i.finishedWork=null,i.finishedLanes=0;var s=i.timeoutHandle;if(s!==-1&&(i.timeoutHandle=-1,Gf(s)),Y$2!==null)for(s=Y$2.return;s!==null;){var o=s;switch(wg(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&$f();break;case 3:Jh$1(),E$1(Wf),E$1(H$2),Oh$1();break;case 5:Lh$1(o);break;case 4:Jh$1();break;case 13:E$1(M$2);break;case 19:E$1(M$2);break;case 10:Rg(o.type._context);break;case 22:case 23:Ij()}s=s.return}if(R$1=i,Y$2=i=wh$1(i.current,null),Z$1=gj=e,T$1=0,qk=null,sk=rk=hh$1=0,uk=tk=null,Wg!==null){for(e=0;e<Wg.length;e++)if(s=Wg[e],o=s.interleaved,o!==null){s.interleaved=null;var a=o.next,c=s.pending;if(c!==null){var d=c.next;c.next=a,o.next=d}s.pending=o}Wg=null}return i}function Nk(i,e){do{var s=Y$2;try{if(Qg(),Ph$1.current=ai$1,Sh$1){for(var o=N$2.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}Sh$1=!1}if(Rh$1=0,P$2=O$2=N$2=null,Th=!1,Uh$1=0,ok.current=null,s===null||s.return===null){T$1=1,qk=e,Y$2=null;break}e:{var c=i,d=s.return,h=s,g=e;if(e=Z$1,h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,ft=h,_t=ft.tag;if(!(ft.mode&1)&&(_t===0||_t===11||_t===15)){var $t=ft.alternate;$t?(ft.updateQueue=$t.updateQueue,ft.memoizedState=$t.memoizedState,ft.lanes=$t.lanes):(ft.updateQueue=null,ft.memoizedState=null)}var Mt=Vi$1(d);if(Mt!==null){Mt.flags&=-257,Wi$1(Mt,d,h,c,e),Mt.mode&1&&Ti$1(c,_,e),e=Mt,g=_;var Ft=e.updateQueue;if(Ft===null){var Ol=new Set;Ol.add(g),e.updateQueue=Ol}else Ft.add(g);break e}else{if(!(e&1)){Ti$1(c,_,e),uj();break e}g=Error(p$1(426))}}else if(I$1&&h.mode&1){var Vl=Vi$1(d);if(Vl!==null){!(Vl.flags&65536)&&(Vl.flags|=256),Wi$1(Vl,d,h,c,e),Jg(Ki$1(g,h));break e}}c=g=Ki$1(g,h),T$1!==4&&(T$1=2),tk===null?tk=[c]:tk.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var Nl=Oi$1(c,g,e);fh$1(c,Nl);break e;case 1:h=g;var xl=c.type,Ml=c.stateNode;if(!(c.flags&128)&&(typeof xl.getDerivedStateFromError=="function"||Ml!==null&&typeof Ml.componentDidCatch=="function"&&(Si$1===null||!Si$1.has(Ml)))){c.flags|=65536,e&=-e,c.lanes|=e;var Su=Ri$1(c,h,e);fh$1(c,Su);break e}}c=c.return}while(c!==null)}Tk(s)}catch(_d){e=_d,Y$2===s&&s!==null&&(Y$2=s=s.return);continue}break}while(1)}function Kk(){var i=nk.current;return nk.current=ai$1,i===null?ai$1:i}function uj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),R$1===null||!(hh$1&268435455)&&!(rk&268435455)||Dk(R$1,Z$1)}function Jk(i,e){var s=K$2;K$2|=2;var o=Kk();(R$1!==i||Z$1!==e)&&(vk=null,Lk(i,e));do try{Uk();break}catch(a){Nk(i,a)}while(1);if(Qg(),K$2=s,nk.current=o,Y$2!==null)throw Error(p$1(261));return R$1=null,Z$1=0,T$1}function Uk(){for(;Y$2!==null;)Vk(Y$2)}function Mk(){for(;Y$2!==null&&!cc$2();)Vk(Y$2)}function Vk(i){var e=Wk(i.alternate,i,gj);i.memoizedProps=i.pendingProps,e===null?Tk(i):Y$2=e,ok.current=null}function Tk(i){var e=i;do{var s=e.alternate;if(i=e.return,e.flags&32768){if(s=Jj(s,e),s!==null){s.flags&=32767,Y$2=s;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{T$1=6,Y$2=null;return}}else if(s=Fj(s,e,gj),s!==null){Y$2=s;return}if(e=e.sibling,e!==null){Y$2=e;return}Y$2=e=i}while(e!==null);T$1===0&&(T$1=5)}function Qk(i,e,s){var o=C$2,a=pk.transition;try{pk.transition=null,C$2=1,Xk(i,e,s,o)}finally{pk.transition=a,C$2=o}return null}function Xk(i,e,s,o){do Ik();while(xk!==null);if(K$2&6)throw Error(p$1(327));s=i.finishedWork;var a=i.finishedLanes;if(s===null)return null;if(i.finishedWork=null,i.finishedLanes=0,s===i.current)throw Error(p$1(177));i.callbackNode=null,i.callbackPriority=0;var c=s.lanes|s.childLanes;if(Bc$2(i,c),i===R$1&&(Y$2=R$1=null,Z$1=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||wk||(wk=!0,Gk(hc$2,function(){return Ik(),null})),c=(s.flags&15990)!==0,s.subtreeFlags&15990||c){c=pk.transition,pk.transition=null;var d=C$2;C$2=1;var h=K$2;K$2|=4,ok.current=null,Pj(i,s),ek(s,i),Oe$1(Df),dd$1=!!Cf,Df=Cf=null,i.current=s,ik(s),dc$2(),K$2=h,C$2=d,pk.transition=c}else i.current=s;if(wk&&(wk=!1,xk=i,yk=a),c=i.pendingLanes,c===0&&(Si$1=null),mc$2(s.stateNode),Ek(i,B$2()),e!==null)for(o=i.onRecoverableError,s=0;s<e.length;s++)a=e[s],o(a.value,{componentStack:a.stack,digest:a.digest});if(Pi$1)throw Pi$1=!1,i=Qi$1,Qi$1=null,i;return yk&1&&i.tag!==0&&Ik(),c=i.pendingLanes,c&1?i===Ak?zk++:(zk=0,Ak=i):zk=0,jg(),null}function Ik(){if(xk!==null){var i=Dc$2(yk),e=pk.transition,s=C$2;try{if(pk.transition=null,C$2=16>i?16:i,xk===null)var o=!1;else{if(i=xk,xk=null,yk=0,K$2&6)throw Error(p$1(331));var a=K$2;for(K$2|=4,V$2=i.current;V$2!==null;){var c=V$2,d=c.child;if(V$2.flags&16){var h=c.deletions;if(h!==null){for(var g=0;g<h.length;g++){var _=h[g];for(V$2=_;V$2!==null;){var ft=V$2;switch(ft.tag){case 0:case 11:case 15:Qj(8,ft,c)}var _t=ft.child;if(_t!==null)_t.return=ft,V$2=_t;else for(;V$2!==null;){ft=V$2;var $t=ft.sibling,Mt=ft.return;if(Tj(ft),ft===_){V$2=null;break}if($t!==null){$t.return=Mt,V$2=$t;break}V$2=Mt}}}var Ft=c.alternate;if(Ft!==null){var Ol=Ft.child;if(Ol!==null){Ft.child=null;do{var Vl=Ol.sibling;Ol.sibling=null,Ol=Vl}while(Ol!==null)}}V$2=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,V$2=d;else e:for(;V$2!==null;){if(c=V$2,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Qj(9,c,c.return)}var Nl=c.sibling;if(Nl!==null){Nl.return=c.return,V$2=Nl;break e}V$2=c.return}}var xl=i.current;for(V$2=xl;V$2!==null;){d=V$2;var Ml=d.child;if(d.subtreeFlags&2064&&Ml!==null)Ml.return=d,V$2=Ml;else e:for(d=xl;V$2!==null;){if(h=V$2,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Rj(9,h)}}catch(_d){W$2(h,h.return,_d)}if(h===d){V$2=null;break e}var Su=h.sibling;if(Su!==null){Su.return=h.return,V$2=Su;break e}V$2=h.return}}if(K$2=a,jg(),lc$2&&typeof lc$2.onPostCommitFiberRoot=="function")try{lc$2.onPostCommitFiberRoot(kc$2,i)}catch{}o=!0}return o}finally{C$2=s,pk.transition=e}}return!1}function Yk(i,e,s){e=Ki$1(s,e),e=Oi$1(i,e,1),i=dh$1(i,e,1),e=L$2(),i!==null&&(Ac$2(i,1,e),Ek(i,e))}function W$2(i,e,s){if(i.tag===3)Yk(i,i,s);else for(;e!==null;){if(e.tag===3){Yk(e,i,s);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Si$1===null||!Si$1.has(o))){i=Ki$1(s,i),i=Ri$1(e,i,1),e=dh$1(e,i,1),i=L$2(),e!==null&&(Ac$2(e,1,i),Ek(e,i));break}}e=e.return}}function Ui$1(i,e,s){var o=i.pingCache;o!==null&&o.delete(e),e=L$2(),i.pingedLanes|=i.suspendedLanes&s,R$1===i&&(Z$1&s)===s&&(T$1===4||T$1===3&&(Z$1&130023424)===Z$1&&500>B$2()-gk?Lk(i,0):sk|=s),Ek(i,e)}function Zk(i,e){e===0&&(i.mode&1?(e=sc$2,sc$2<<=1,!(sc$2&130023424)&&(sc$2=4194304)):e=1);var s=L$2();i=Zg(i,e),i!==null&&(Ac$2(i,e,s),Ek(i,s))}function vj(i){var e=i.memoizedState,s=0;e!==null&&(s=e.retryLane),Zk(i,s)}function ck(i,e){var s=0;switch(i.tag){case 13:var o=i.stateNode,a=i.memoizedState;a!==null&&(s=a.retryLane);break;case 19:o=i.stateNode;break;default:throw Error(p$1(314))}o!==null&&o.delete(e),Zk(i,s)}var Wk;Wk=function(i,e,s){if(i!==null)if(i.memoizedProps!==e.pendingProps||Wf.current)Ug=!0;else{if(!(i.lanes&s)&&!(e.flags&128))return Ug=!1,zj(i,e,s);Ug=!!(i.flags&131072)}else Ug=!1,I$1&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;jj(i,e),i=e.pendingProps;var a=Yf(e,H$2.current);Tg(e,s),a=Xh$1(null,e,o,i,a,s);var c=bi$1();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(o)?(c=!0,cg(e)):c=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ah$1(e),a.updater=nh$1,e.stateNode=a,a._reactInternals=e,rh$1(e,o,i,s),e=kj(null,e,o,!0,c,s)):(e.tag=0,I$1&&c&&vg(e),Yi$1(null,e,a,s),e=e.child),e;case 16:o=e.elementType;e:{switch(jj(i,e),i=e.pendingProps,a=o._init,o=a(o._payload),e.type=o,a=e.tag=$k(o),i=Lg(o,i),a){case 0:e=dj(null,e,o,i,s);break e;case 1:e=ij(null,e,o,i,s);break e;case 11:e=Zi$1(null,e,o,i,s);break e;case 14:e=aj(null,e,o,Lg(o.type,i),s);break e}throw Error(p$1(306,o,""))}return e;case 0:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Lg(o,a),dj(i,e,o,a,s);case 1:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Lg(o,a),ij(i,e,o,a,s);case 3:e:{if(lj(e),i===null)throw Error(p$1(387));o=e.pendingProps,c=e.memoizedState,a=c.element,bh(i,e),gh(e,o,null,s);var d=e.memoizedState;if(o=d.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){a=Ki$1(Error(p$1(423)),e),e=mj(i,e,o,s,a);break e}else if(o!==a){a=Ki$1(Error(p$1(424)),e),e=mj(i,e,o,s,a);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I$1=!0,zg=null,s=Ch$1(e,null,o,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),o===a){e=$i$1(i,e,s);break e}Yi$1(i,e,o,s)}e=e.child}return e;case 5:return Kh$1(e),i===null&&Eg(e),o=e.type,a=e.pendingProps,c=i!==null?i.memoizedProps:null,d=a.children,Ef(o,a)?d=null:c!==null&&Ef(o,c)&&(e.flags|=32),hj(i,e),Yi$1(i,e,d,s),e.child;case 6:return i===null&&Eg(e),null;case 13:return pj(i,e,s);case 4:return Ih$1(e,e.stateNode.containerInfo),o=e.pendingProps,i===null?e.child=Bh$1(e,null,o,s):Yi$1(i,e,o,s),e.child;case 11:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Lg(o,a),Zi$1(i,e,o,a,s);case 7:return Yi$1(i,e,e.pendingProps,s),e.child;case 8:return Yi$1(i,e,e.pendingProps.children,s),e.child;case 12:return Yi$1(i,e,e.pendingProps.children,s),e.child;case 10:e:{if(o=e.type._context,a=e.pendingProps,c=e.memoizedProps,d=a.value,G$2(Mg,o._currentValue),o._currentValue=d,c!==null)if(He$1(c.value,d)){if(c.children===a.children&&!Wf.current){e=$i$1(i,e,s);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){d=c.child;for(var g=h.firstContext;g!==null;){if(g.context===o){if(c.tag===1){g=ch$1(-1,s&-s),g.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var ft=_.pending;ft===null?g.next=g:(g.next=ft.next,ft.next=g),_.pending=g}}c.lanes|=s,g=c.alternate,g!==null&&(g.lanes|=s),Sg(c.return,s,e),h.lanes|=s;break}g=g.next}}else if(c.tag===10)d=c.type===e.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(p$1(341));d.lanes|=s,h=d.alternate,h!==null&&(h.lanes|=s),Sg(d,s,e),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===e){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Yi$1(i,e,a.children,s),e=e.child}return e;case 9:return a=e.type,o=e.pendingProps.children,Tg(e,s),a=Vg(a),o=o(a),e.flags|=1,Yi$1(i,e,o,s),e.child;case 14:return o=e.type,a=Lg(o,e.pendingProps),a=Lg(o.type,a),aj(i,e,o,a,s);case 15:return cj(i,e,e.type,e.pendingProps,s);case 17:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Lg(o,a),jj(i,e),e.tag=1,Zf(o)?(i=!0,cg(e)):i=!1,Tg(e,s),ph$1(e,o,a),rh$1(e,o,a,s),kj(null,e,o,!0,i,s);case 19:return yj(i,e,s);case 22:return ej(i,e,s)}throw Error(p$1(156,e.tag))};function Gk(i,e){return ac$2(i,e)}function al$1(i,e,s,o){this.tag=i,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(i,e,s,o){return new al$1(i,e,s,o)}function bj(i){return i=i.prototype,!(!i||!i.isReactComponent)}function $k(i){if(typeof i=="function")return bj(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Da$1)return 11;if(i===Ga$2)return 14}return 2}function wh$1(i,e){var s=i.alternate;return s===null?(s=Bg(i.tag,e,i.key,i.mode),s.elementType=i.elementType,s.type=i.type,s.stateNode=i.stateNode,s.alternate=i,i.alternate=s):(s.pendingProps=e,s.type=i.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=i.flags&14680064,s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=i.sibling,s.index=i.index,s.ref=i.ref,s}function yh$1(i,e,s,o,a,c){var d=2;if(o=i,typeof i=="function")bj(i)&&(d=1);else if(typeof i=="string")d=5;else e:switch(i){case ya$2:return Ah$1(s.children,a,c,e);case za$2:d=8,a|=8;break;case Aa$2:return i=Bg(12,s,e,a|2),i.elementType=Aa$2,i.lanes=c,i;case Ea$2:return i=Bg(13,s,e,a),i.elementType=Ea$2,i.lanes=c,i;case Fa$2:return i=Bg(19,s,e,a),i.elementType=Fa$2,i.lanes=c,i;case Ia$2:return qj(s,a,c,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ba$2:d=10;break e;case Ca$1:d=9;break e;case Da$1:d=11;break e;case Ga$2:d=14;break e;case Ha$2:d=16,o=null;break e}throw Error(p$1(130,i==null?i:typeof i,""))}return e=Bg(d,s,e,a),e.elementType=i,e.type=o,e.lanes=c,e}function Ah$1(i,e,s,o){return i=Bg(7,i,o,e),i.lanes=s,i}function qj(i,e,s,o){return i=Bg(22,i,o,e),i.elementType=Ia$2,i.lanes=s,i.stateNode={isHidden:!1},i}function xh$1(i,e,s){return i=Bg(6,i,null,e),i.lanes=s,i}function zh$1(i,e,s){return e=Bg(4,i.children!==null?i.children:[],i.key,e),e.lanes=s,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function bl$1(i,e,s,o,a){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc$2(0),this.expirationTimes=zc$2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc$2(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function cl$1(i,e,s,o,a,c,d,h,g){return i=new bl$1(i,e,s,h,g),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Bg(3,null,null,e),i.current=c,c.stateNode=i,c.memoizedState={element:o,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah$1(c),i}function dl$1(i,e,s){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$2,key:o==null?null:""+o,children:i,containerInfo:e,implementation:s}}function el$1(i){if(!i)return Vf;i=i._reactInternals;e:{if(Vb$1(i)!==i||i.tag!==1)throw Error(p$1(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p$1(171))}if(i.tag===1){var s=i.type;if(Zf(s))return bg(i,s,e)}return e}function fl$1(i,e,s,o,a,c,d,h,g){return i=cl$1(s,o,!0,i,a,c,d,h,g),i.context=el$1(null),s=i.current,o=L$2(),a=lh$1(s),c=ch$1(o,a),c.callback=e??null,dh$1(s,c,a),i.current.lanes=a,Ac$2(i,a,o),Ek(i,o),i}function gl$1(i,e,s,o){var a=e.current,c=L$2(),d=lh$1(a);return s=el$1(s),e.context===null?e.context=s:e.pendingContext=s,e=ch$1(c,d),e.payload={element:i},o=o===void 0?null:o,o!==null&&(e.callback=o),i=dh$1(a,e,d),i!==null&&(mh$1(i,a,d,c),eh$1(i,a,d)),d}function hl(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function il$1(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var s=i.retryLane;i.retryLane=s!==0&&s<e?s:e}}function jl$1(i,e){il$1(i,e),(i=i.alternate)&&il$1(i,e)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(i){console.error(i)};function ml$1(i){this._internalRoot=i}nl$1.prototype.render=ml$1.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(p$1(409));gl$1(i,e,null,null)};nl$1.prototype.unmount=ml$1.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Sk(function(){gl$1(null,i,null,null)}),e[uf$1]=null}};function nl$1(i){this._internalRoot=i}nl$1.prototype.unstable_scheduleHydration=function(i){if(i){var e=Hc$2();i={blockedOn:null,target:i,priority:e};for(var s=0;s<Qc$2.length&&e!==0&&e<Qc$2[s].priority;s++);Qc$2.splice(s,0,i),s===0&&Vc$2(i)}};function ol$1(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function pl$1(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function ql$1(){}function rl$1(i,e,s,o,a){if(a){if(typeof o=="function"){var c=o;o=function(){var _=hl(d);c.call(_)}}var d=fl$1(e,o,i,0,null,!1,!1,"",ql$1);return i._reactRootContainer=d,i[uf$1]=d.current,sf$1(i.nodeType===8?i.parentNode:i),Sk(),d}for(;a=i.lastChild;)i.removeChild(a);if(typeof o=="function"){var h=o;o=function(){var _=hl(g);h.call(_)}}var g=cl$1(i,0,!1,null,null,!1,!1,"",ql$1);return i._reactRootContainer=g,i[uf$1]=g.current,sf$1(i.nodeType===8?i.parentNode:i),Sk(function(){gl$1(e,g,s,o)}),g}function sl$1(i,e,s,o,a){var c=s._reactRootContainer;if(c){var d=c;if(typeof a=="function"){var h=a;a=function(){var g=hl(d);h.call(g)}}gl$1(e,d,i,a)}else d=rl$1(s,e,i,a,o);return hl(d)}Ec$2=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var s=tc$2(e.pendingLanes);s!==0&&(Cc$2(e,s|1),Ek(e,B$2()),!(K$2&6)&&(Hj=B$2()+500,jg()))}break;case 13:Sk(function(){var o=Zg(i,1);if(o!==null){var a=L$2();mh$1(o,i,1,a)}}),jl$1(i,1)}};Fc$2=function(i){if(i.tag===13){var e=Zg(i,134217728);if(e!==null){var s=L$2();mh$1(e,i,134217728,s)}jl$1(i,134217728)}};Gc$2=function(i){if(i.tag===13){var e=lh$1(i),s=Zg(i,e);if(s!==null){var o=L$2();mh$1(s,i,e,o)}jl$1(i,e)}};Hc$2=function(){return C$2};Ic$2=function(i,e){var s=C$2;try{return C$2=i,e()}finally{C$2=s}};yb$1=function(i,e,s){switch(e){case"input":if(bb$1(i,s),e=s.name,s.type==="radio"&&e!=null){for(s=i;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<s.length;e++){var o=s[e];if(o!==i&&o.form===i.form){var a=Db$1(o);if(!a)throw Error(p$1(90));Wa$2(o),bb$1(o,a)}}}break;case"textarea":ib$1(i,s);break;case"select":e=s.value,e!=null&&fb$1(i,!!s.multiple,e,!1)}};Gb$1=Rk;Hb$1=Sk;var tl$1={usingClientEntryPoint:!1,Events:[Cb$1,ue$1,Db$1,Eb$1,Fb$1,Rk]},ul$1={findFiberByHostInstance:Wc$2,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl$1={bundleType:ul$1.bundleType,version:ul$1.version,rendererPackageName:ul$1.rendererPackageName,rendererConfig:ul$1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$2.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Zb$1(i),i===null?null:i.stateNode},findFiberByHostInstance:ul$1.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl$1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl$1.isDisabled&&wl$1.supportsFiber)try{kc$2=wl$1.inject(vl$1),lc$2=wl$1}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl$1;reactDom_production_min.createPortal=function(i,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol$1(e))throw Error(p$1(200));return dl$1(i,e,null,s)};reactDom_production_min.createRoot=function(i,e){if(!ol$1(i))throw Error(p$1(299));var s=!1,o="",a=ll;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=cl$1(i,1,!1,null,null,s,!1,o,a),i[uf$1]=e.current,sf$1(i.nodeType===8?i.parentNode:i),new ml$1(e)};reactDom_production_min.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(p$1(188)):(i=Object.keys(i).join(","),Error(p$1(268,i)));return i=Zb$1(e),i=i===null?null:i.stateNode,i};reactDom_production_min.flushSync=function(i){return Sk(i)};reactDom_production_min.hydrate=function(i,e,s){if(!pl$1(e))throw Error(p$1(200));return sl$1(null,i,e,!0,s)};reactDom_production_min.hydrateRoot=function(i,e,s){if(!ol$1(i))throw Error(p$1(405));var o=s!=null&&s.hydratedSources||null,a=!1,c="",d=ll;if(s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onRecoverableError!==void 0&&(d=s.onRecoverableError)),e=fl$1(e,null,i,1,s??null,a,!1,c,d),i[uf$1]=e.current,sf$1(i),o)for(i=0;i<o.length;i++)s=o[i],a=s._getVersion,a=a(s._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[s,a]:e.mutableSourceEagerHydrationData.push(s,a);return new nl$1(e)};reactDom_production_min.render=function(i,e,s){if(!pl$1(e))throw Error(p$1(200));return sl$1(null,i,e,!1,s)};reactDom_production_min.unmountComponentAtNode=function(i){if(!pl$1(i))throw Error(p$1(40));return i._reactRootContainer?(Sk(function(){sl$1(null,null,i,!1,function(){i._reactRootContainer=null,i[uf$1]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(i,e,s,o){if(!pl$1(s))throw Error(p$1(200));if(i==null||i._reactInternals===void 0)throw Error(p$1(38));return sl$1(i,e,s,!1,o)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";(function(i){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(s){console.error(s)}}e(),i.exports=reactDom_production_min})(reactDom);const ReactDOM=getDefaultExportFromCjs(reactDomExports);var m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @remix-run/router v1.3.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i},_extends$4.apply(this,arguments)}var Action;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(i){i===void 0&&(i={});function e(o,a){let{pathname:c,search:d,hash:h}=o.location;return createLocation("",{pathname:c,search:d,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function s(o,a){return typeof a=="string"?a:createPath(a)}return getUrlBasedHistory(e,s,null,i)}function invariant(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(i,e){return{usr:i.state,key:i.key,idx:e}}function createLocation(i,e,s,o){return s===void 0&&(s=null),_extends$4({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:s,key:e&&e.key||o||createKey()})}function createPath(i){let{pathname:e="/",search:s="",hash:o=""}=i;return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function parsePath(i){let e={};if(i){let s=i.indexOf("#");s>=0&&(e.hash=i.substr(s),i=i.substr(0,s));let o=i.indexOf("?");o>=0&&(e.search=i.substr(o),i=i.substr(0,o)),i&&(e.pathname=i)}return e}function getUrlBasedHistory(i,e,s,o){o===void 0&&(o={});let{window:a=document.defaultView,v5Compat:c=!1}=o,d=a.history,h=Action.Pop,g=null,_=ft();_==null&&(_=0,d.replaceState(_extends$4({},d.state,{idx:_}),""));function ft(){return(d.state||{idx:null}).idx}function _t(){h=Action.Pop;let Vl=ft(),Nl=Vl==null?null:Vl-_;_=Vl,g&&g({action:h,location:Ol.location,delta:Nl})}function $t(Vl,Nl){h=Action.Push;let xl=createLocation(Ol.location,Vl,Nl);s&&s(xl,Vl),_=ft()+1;let Ml=getHistoryState(xl,_),Su=Ol.createHref(xl);try{d.pushState(Ml,"",Su)}catch{a.location.assign(Su)}c&&g&&g({action:h,location:Ol.location,delta:1})}function Mt(Vl,Nl){h=Action.Replace;let xl=createLocation(Ol.location,Vl,Nl);s&&s(xl,Vl),_=ft();let Ml=getHistoryState(xl,_),Su=Ol.createHref(xl);d.replaceState(Ml,"",Su),c&&g&&g({action:h,location:Ol.location,delta:0})}function Ft(Vl){let Nl=a.location.origin!=="null"?a.location.origin:a.location.href,xl=typeof Vl=="string"?Vl:createPath(Vl);return invariant(Nl,"No window.location.(origin|href) available to create URL for href: "+xl),new URL(xl,Nl)}let Ol={get action(){return h},get location(){return i(a,d)},listen(Vl){if(g)throw new Error("A history only accepts one active listener");return a.addEventListener(PopStateEventType,_t),g=Vl,()=>{a.removeEventListener(PopStateEventType,_t),g=null}},createHref(Vl){return e(a,Vl)},createURL:Ft,encodeLocation(Vl){let Nl=Ft(Vl);return{pathname:Nl.pathname,search:Nl.search,hash:Nl.hash}},push:$t,replace:Mt,go(Vl){return d.go(Vl)}};return Ol}var ResultType;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(ResultType||(ResultType={}));function matchRoutes(i,e,s){s===void 0&&(s="/");let o=typeof e=="string"?parsePath(e):e,a=stripBasename(o.pathname||"/",s);if(a==null)return null;let c=flattenRoutes(i);rankRouteBranches(c);let d=null;for(let h=0;d==null&&h<c.length;++h)d=matchRouteBranch(c[h],safelyDecodeURI(a));return d}function flattenRoutes(i,e,s,o){e===void 0&&(e=[]),s===void 0&&(s=[]),o===void 0&&(o="");let a=(c,d,h)=>{let g={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};g.relativePath.startsWith("/")&&(invariant(g.relativePath.startsWith(o),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(o.length));let _=joinPaths([o,g.relativePath]),ft=s.concat(g);c.children&&c.children.length>0&&(invariant(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),flattenRoutes(c.children,e,ft,_)),!(c.path==null&&!c.index)&&e.push({path:_,score:computeScore(_,c.index),routesMeta:ft})};return i.forEach((c,d)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))a(c,d);else for(let g of explodeOptionalSegments(c.path))a(c,d,g)}),e}function explodeOptionalSegments(i){let e=i.split("/");if(e.length===0)return[];let[s,...o]=e,a=s.endsWith("?"),c=s.replace(/\?$/,"");if(o.length===0)return a?[c,""]:[c];let d=explodeOptionalSegments(o.join("/")),h=[];return h.push(...d.map(g=>g===""?c:[c,g].join("/"))),a&&h.push(...d),h.map(g=>i.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(i){i.sort((e,s)=>e.score!==s.score?s.score-e.score:compareIndexes(e.routesMeta.map(o=>o.childrenIndex),s.routesMeta.map(o=>o.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=i=>i==="*";function computeScore(i,e){let s=i.split("/"),o=s.length;return s.some(isSplat)&&(o+=splatPenalty),e&&(o+=indexRouteValue),s.filter(a=>!isSplat(a)).reduce((a,c)=>a+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(i,e){return i.length===e.length&&i.slice(0,-1).every((o,a)=>o===e[a])?i[i.length-1]-e[e.length-1]:0}function matchRouteBranch(i,e){let{routesMeta:s}=i,o={},a="/",c=[];for(let d=0;d<s.length;++d){let h=s[d],g=d===s.length-1,_=a==="/"?e:e.slice(a.length)||"/",ft=matchPath({path:h.relativePath,caseSensitive:h.caseSensitive,end:g},_);if(!ft)return null;Object.assign(o,ft.params);let _t=h.route;c.push({params:o,pathname:joinPaths([a,ft.pathname]),pathnameBase:normalizePathname(joinPaths([a,ft.pathnameBase])),route:_t}),ft.pathnameBase!=="/"&&(a=joinPaths([a,ft.pathnameBase]))}return c}function matchPath(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[s,o]=compilePath(i.path,i.caseSensitive,i.end),a=e.match(s);if(!a)return null;let c=a[0],d=c.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:o.reduce((_,ft,_t)=>{if(ft==="*"){let $t=h[_t]||"";d=c.slice(0,c.length-$t.length).replace(/(.)\/+$/,"$1")}return _[ft]=safelyDecodeURIComponent(h[_t]||"",ft),_},{}),pathname:c,pathnameBase:d,pattern:i}}function compilePath(i,e,s){e===void 0&&(e=!1),s===void 0&&(s=!0),warning(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let o=[],a="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(d,h)=>(o.push(h),"/([^\\/]+)"));return i.endsWith("*")?(o.push("*"),a+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":i!==""&&i!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),o]}function safelyDecodeURI(i){try{return decodeURI(i)}catch(e){return warning(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function safelyDecodeURIComponent(i,e){try{return decodeURIComponent(i)}catch(s){return warning(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+i+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+s+").")),i}}function stripBasename(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,o=i.charAt(s);return o&&o!=="/"?null:i.slice(s)||"/"}function warning(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function resolvePath(i,e){e===void 0&&(e="/");let{pathname:s,search:o="",hash:a=""}=typeof i=="string"?parsePath(i):i;return{pathname:s?s.startsWith("/")?s:resolvePathname(s,e):e,search:normalizeSearch(o),hash:normalizeHash(a)}}function resolvePathname(i,e){let s=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(a=>{a===".."?s.length>1&&s.pop():a!=="."&&s.push(a)}),s.length>1?s.join("/"):"/"}function getInvalidPathError(i,e,s,o){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(i){return i.filter((e,s)=>s===0||e.route.path&&e.route.path.length>0)}function resolveTo(i,e,s,o){o===void 0&&(o=!1);let a;typeof i=="string"?a=parsePath(i):(a=_extends$4({},i),invariant(!a.pathname||!a.pathname.includes("?"),getInvalidPathError("?","pathname","search",a)),invariant(!a.pathname||!a.pathname.includes("#"),getInvalidPathError("#","pathname","hash",a)),invariant(!a.search||!a.search.includes("#"),getInvalidPathError("#","search","hash",a)));let c=i===""||a.pathname==="",d=c?"/":a.pathname,h;if(o||d==null)h=s;else{let _t=e.length-1;if(d.startsWith("..")){let $t=d.split("/");for(;$t[0]==="..";)$t.shift(),_t-=1;a.pathname=$t.join("/")}h=_t>=0?e[_t]:"/"}let g=resolvePath(a,h),_=d&&d!=="/"&&d.endsWith("/"),ft=(c||d===".")&&s.endsWith("/");return!g.pathname.endsWith("/")&&(_||ft)&&(g.pathname+="/"),g}const joinPaths=i=>i.join("/").replace(/\/\/+/g,"/"),normalizePathname=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,normalizeHash=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function isRouteErrorResponse(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const validMutationMethodsArr=["post","put","patch","delete"];[...validMutationMethodsArr];/**
 * React Router v6.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i},_extends$3.apply(this,arguments)}function isPolyfill(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}const is$1=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$1;function useSyncExternalStore$2(i,e,s){const o=e(),[{inst:a},c]=useState({inst:{value:o,getSnapshot:e}});return useLayoutEffect(()=>{a.value=o,a.getSnapshot=e,checkIfSnapshotChanged(a)&&c({inst:a})},[i,o,e]),useEffect(()=>(checkIfSnapshotChanged(a)&&c({inst:a}),i(()=>{checkIfSnapshotChanged(a)&&c({inst:a})})),[i]),useDebugValue(o),o}function checkIfSnapshotChanged(i){const e=i.getSnapshot,s=i.value;try{const o=e();return!is$1(s,o)}catch{return!0}}function useSyncExternalStore$1(i,e,s){return e()}const canUseDOM$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM$1,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2;"useSyncExternalStore"in React$1&&(i=>i.useSyncExternalStore)(React$1);const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[]}),RouteErrorContext=reactExports.createContext(null);function useHref(i,e){let{relative:s}=e===void 0?{}:e;useInRouterContext()||invariant(!1);let{basename:o,navigator:a}=reactExports.useContext(NavigationContext),{hash:c,pathname:d,search:h}=useResolvedPath(i,{relative:s}),g=d;return o!=="/"&&(g=d==="/"?o:joinPaths([o,d])),a.createHref({pathname:g,search:h,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant(!1);let{basename:i,navigator:e}=reactExports.useContext(NavigationContext),{matches:s}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),a=JSON.stringify(getPathContributingMatches(s).map(h=>h.pathnameBase)),c=reactExports.useRef(!1);return reactExports.useEffect(()=>{c.current=!0}),reactExports.useCallback(function(h,g){if(g===void 0&&(g={}),!c.current)return;if(typeof h=="number"){e.go(h);return}let _=resolveTo(h,JSON.parse(a),o,g.relative==="path");i!=="/"&&(_.pathname=_.pathname==="/"?i:joinPaths([i,_.pathname])),(g.replace?e.replace:e.push)(_,g.state,g)},[i,e,a,o])}function useResolvedPath(i,e){let{relative:s}=e===void 0?{}:e,{matches:o}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),c=JSON.stringify(getPathContributingMatches(o).map(d=>d.pathnameBase));return reactExports.useMemo(()=>resolveTo(i,JSON.parse(c),a,s==="path"),[i,c,a,s])}function useRoutes(i,e){useInRouterContext()||invariant(!1);let{navigator:s}=reactExports.useContext(NavigationContext),o=reactExports.useContext(DataRouterStateContext),{matches:a}=reactExports.useContext(RouteContext),c=a[a.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let g=useLocation(),_;if(e){var ft;let Ol=typeof e=="string"?parsePath(e):e;h==="/"||(ft=Ol.pathname)!=null&&ft.startsWith(h)||invariant(!1),_=Ol}else _=g;let _t=_.pathname||"/",$t=h==="/"?_t:_t.slice(h.length)||"/",Mt=matchRoutes(i,{pathname:$t}),Ft=_renderMatches(Mt&&Mt.map(Ol=>Object.assign({},Ol,{params:Object.assign({},d,Ol.params),pathname:joinPaths([h,s.encodeLocation?s.encodeLocation(Ol.pathname).pathname:Ol.pathname]),pathnameBase:Ol.pathnameBase==="/"?h:joinPaths([h,s.encodeLocation?s.encodeLocation(Ol.pathnameBase).pathname:Ol.pathnameBase])})),a,o||void 0);return e&&Ft?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$3({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:Action.Pop}},Ft):Ft}function DefaultErrorElement(){let i=useRouteError(),e=isRouteErrorResponse(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),s=i instanceof Error?i.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},c=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),s?reactExports.createElement("pre",{style:a},s):null,c)}class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location?{error:e.error,location:e.location}:{error:e.error||s.error,location:s.location}}componentDidCatch(e,s){console.error("React Router caught the following error during render",e,s)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(i){let{routeContext:e,match:s,children:o}=i,a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&s.route.errorElement&&(a.staticContext._deepestRenderedBoundaryId=s.route.id),reactExports.createElement(RouteContext.Provider,{value:e},o)}function _renderMatches(i,e,s){if(e===void 0&&(e=[]),i==null)if(s!=null&&s.errors)i=s.matches;else return null;let o=i,a=s==null?void 0:s.errors;if(a!=null){let c=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));c>=0||invariant(!1),o=o.slice(0,Math.min(o.length,c+1))}return o.reduceRight((c,d,h)=>{let g=d.route.id?a==null?void 0:a[d.route.id]:null,_=s?d.route.errorElement||reactExports.createElement(DefaultErrorElement,null):null,ft=e.concat(o.slice(0,h+1)),_t=()=>reactExports.createElement(RenderedRoute,{match:d,routeContext:{outlet:c,matches:ft}},g?_:d.route.element!==void 0?d.route.element:c);return s&&(d.route.errorElement||h===0)?reactExports.createElement(RenderErrorBoundary,{location:s.location,component:_,error:g,children:_t(),routeContext:{outlet:null,matches:ft}}):_t()},null)}var DataRouterHook$1;(function(i){i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(i){i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterState(i){let e=reactExports.useContext(DataRouterStateContext);return e||invariant(!1),e}function useRouteContext(i){let e=reactExports.useContext(RouteContext);return e||invariant(!1),e}function useCurrentRouteId(i){let e=useRouteContext(),s=e.matches[e.matches.length-1];return s.route.id||invariant(!1),s.route.id}function useRouteError(){var i;let e=reactExports.useContext(RouteErrorContext),s=useDataRouterState(DataRouterStateHook$1.UseRouteError),o=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return e||((i=s.errors)==null?void 0:i[o])}function Route(i){invariant(!1)}function Router(i){let{basename:e="/",children:s=null,location:o,navigationType:a=Action.Pop,navigator:c,static:d=!1}=i;useInRouterContext()&&invariant(!1);let h=e.replace(/^\/*/,"/"),g=reactExports.useMemo(()=>({basename:h,navigator:c,static:d}),[h,c,d]);typeof o=="string"&&(o=parsePath(o));let{pathname:_="/",search:ft="",hash:_t="",state:$t=null,key:Mt="default"}=o,Ft=reactExports.useMemo(()=>{let Ol=stripBasename(_,h);return Ol==null?null:{pathname:Ol,search:ft,hash:_t,state:$t,key:Mt}},[h,_,ft,_t,$t,Mt]);return Ft==null?null:reactExports.createElement(NavigationContext.Provider,{value:g},reactExports.createElement(LocationContext.Provider,{children:s,value:{location:Ft,navigationType:a}}))}function Routes(i){let{children:e,location:s}=i,o=reactExports.useContext(DataRouterContext),a=o&&!e?o.router.routes:createRoutesFromChildren(e);return useRoutes(a,s)}var AwaitRenderStatus;(function(i){i[i.pending=0]="pending",i[i.success=1]="success",i[i.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(i,e){e===void 0&&(e=[]);let s=[];return reactExports.Children.forEach(i,(o,a)=>{if(!reactExports.isValidElement(o))return;if(o.type===reactExports.Fragment){s.push.apply(s,createRoutesFromChildren(o.props.children,e));return}o.type!==Route&&invariant(!1),!o.props.index||!o.props.children||invariant(!1);let c=[...e,a],d={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,hasErrorBoundary:o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle};o.props.children&&(d.children=createRoutesFromChildren(o.props.children,c)),s.push(d)}),s}/**
 * React Router DOM v6.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i},_extends$2.apply(this,arguments)}function _objectWithoutPropertiesLoose$a(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function isModifiedEvent$1(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function shouldProcessLinkClick(i,e){return i.button===0&&(!e||e==="_self")&&!isModifiedEvent$1(i)}const _excluded$8=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function BrowserRouter(i){let{basename:e,children:s,window:o}=i,a=reactExports.useRef();a.current==null&&(a.current=createBrowserHistory({window:o,v5Compat:!0}));let c=a.current,[d,h]=reactExports.useState({action:c.action,location:c.location});return reactExports.useLayoutEffect(()=>c.listen(h),[c]),reactExports.createElement(Router,{basename:e,children:s,location:d.location,navigationType:d.action,navigator:c})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Link=reactExports.forwardRef(function(e,s){let{onClick:o,relative:a,reloadDocument:c,replace:d,state:h,target:g,to:_,preventScrollReset:ft}=e,_t=_objectWithoutPropertiesLoose$a(e,_excluded$8),$t,Mt=!1;if(isBrowser$1&&typeof _=="string"&&/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i.test(_)){$t=_;let Nl=new URL(window.location.href),xl=_.startsWith("//")?new URL(Nl.protocol+_):new URL(_);xl.origin===Nl.origin?_=xl.pathname+xl.search+xl.hash:Mt=!0}let Ft=useHref(_,{relative:a}),Ol=useLinkClickHandler(_,{replace:d,state:h,target:g,preventScrollReset:ft,relative:a});function Vl(Nl){o&&o(Nl),Nl.defaultPrevented||Ol(Nl)}return reactExports.createElement("a",_extends$2({},_t,{href:$t||Ft,onClick:Mt||c?o:Vl,ref:s,target:g}))});var DataRouterHook;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmitImpl="useSubmitImpl",i.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(i){i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(i,e){let{target:s,replace:o,state:a,preventScrollReset:c,relative:d}=e===void 0?{}:e,h=useNavigate(),g=useLocation(),_=useResolvedPath(i,{relative:d});return reactExports.useCallback(ft=>{if(shouldProcessLinkClick(ft,s)){ft.preventDefault();let _t=o!==void 0?o:createPath(g)===createPath(_);h(i,{replace:_t,state:a,preventScrollReset:c,relative:d})}},[g,h,_,o,a,s,i,c,d])}const Header$1="";var classnamesExports={},classnames={get exports(){return classnamesExports},set exports(i){classnamesExports=i}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(i){(function(){var e={}.hasOwnProperty;function s(){for(var o=[],a=0;a<arguments.length;a++){var c=arguments[a];if(c){var d=typeof c;if(d==="string"||d==="number")o.push(c);else if(Array.isArray(c)){if(c.length){var h=s.apply(null,c);h&&o.push(h)}}else if(d==="object"){if(c.toString!==Object.prototype.toString&&!c.toString.toString().includes("[native code]")){o.push(c.toString());continue}for(var g in c)e.call(c,g)&&c[g]&&o.push(g)}}}return o.join(" ")}i.exports?(s.default=s,i.exports=s):window.classNames=s})()})(classnames);const classNames=classnamesExports,_excluded$7=["as","disabled"];function _objectWithoutPropertiesLoose$9(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function isTrivialHref$1(i){return!i||i.trim()==="#"}function useButtonProps({tagName:i,disabled:e,href:s,target:o,rel:a,role:c,onClick:d,tabIndex:h=0,type:g}){i||(s!=null||o!=null||a!=null?i="a":i="button");const _={tagName:i};if(i==="button")return[{type:g||"button",disabled:e},_];const ft=$t=>{if((e||i==="a"&&isTrivialHref$1(s))&&$t.preventDefault(),e){$t.stopPropagation();return}d==null||d($t)},_t=$t=>{$t.key===" "&&($t.preventDefault(),ft($t))};return i==="a"&&(s||(s="#"),e&&(s=void 0)),[{role:c??"button",disabled:void 0,tabIndex:e?void 0:h,href:s,target:i==="a"?o:void 0,"aria-disabled":e||void 0,rel:i==="a"?a:void 0,onClick:ft,onKeyDown:_t},_]}const Button$1=reactExports.forwardRef((i,e)=>{let{as:s,disabled:o}=i,a=_objectWithoutPropertiesLoose$9(i,_excluded$7);const[c,{tagName:d}]=useButtonProps(Object.assign({tagName:s,disabled:o},a));return jsx(d,Object.assign({},a,c,{ref:e}))});Button$1.displayName="Button";const DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT});function useBootstrapPrefix(i,e){const{prefixes:s}=reactExports.useContext(ThemeContext);return i||s[e]||e}function useBootstrapBreakpoints(){const{breakpoints:i}=reactExports.useContext(ThemeContext);return i}function useBootstrapMinBreakpoint(){const{minBreakpoint:i}=reactExports.useContext(ThemeContext);return i}function useIsRTL(){const{dir:i}=reactExports.useContext(ThemeContext);return i==="rtl"}const defaultProps$g={variant:"primary",active:!1,disabled:!1},Button=reactExports.forwardRef(({as:i,bsPrefix:e,variant:s,size:o,active:a,className:c,...d},h)=>{const g=useBootstrapPrefix(e,"btn"),[_,{tagName:ft}]=useButtonProps({tagName:i,...d});return jsx(ft,{..._,...d,ref:h,className:classNames(c,g,a&&"active",s&&`${g}-${s}`,o&&`${g}-${o}`,d.href&&d.disabled&&"disabled")})});Button.displayName="Button";Button.defaultProps=defaultProps$g;const defaultProps$f={fluid:!1},Container=reactExports.forwardRef(({bsPrefix:i,fluid:e,as:s="div",className:o,...a},c)=>{const d=useBootstrapPrefix(i,"container"),h=typeof e=="string"?`-${e}`:"-fluid";return jsx(s,{ref:c,...a,className:classNames(o,e?`${d}${h}`:d)})});Container.displayName="Container";Container.defaultProps=defaultProps$f;var propTypesExports={},propTypes$3={get exports(){return propTypesExports},set exports(i){propTypesExports=i}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function i(o,a,c,d,h,g){if(g!==ReactPropTypesSecret){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}i.isRequired=i;function e(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return s.PropTypes=s,s};propTypes$3.exports=factoryWithThrowingShims();const propTypes$2={type:propTypesExports.string,tooltip:propTypesExports.bool,as:propTypesExports.elementType},Feedback=reactExports.forwardRef(({as:i="div",className:e,type:s="valid",tooltip:o=!1,...a},c)=>jsx(i,{...a,ref:c,className:classNames(e,`${s}-${o?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$2;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:i,bsPrefix:e,className:s,type:o="checkbox",isValid:a=!1,isInvalid:c=!1,as:d="input",...h},g)=>{const{controlId:_}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-check-input"),jsx(d,{...h,ref:g,type:o,id:i||_,className:classNames(s,e,a&&"is-valid",c&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:i,className:e,htmlFor:s,...o},a)=>{const{controlId:c}=reactExports.useContext(FormContext);return i=useBootstrapPrefix(i,"form-check-label"),jsx("label",{...o,ref:a,htmlFor:s||c,className:classNames(e,i)})});FormCheckLabel.displayName="FormCheckLabel";function hasChildOfType(i,e){return reactExports.Children.toArray(i).some(s=>reactExports.isValidElement(s)&&s.type===e)}const FormCheck=reactExports.forwardRef(({id:i,bsPrefix:e,bsSwitchPrefix:s,inline:o=!1,reverse:a=!1,disabled:c=!1,isValid:d=!1,isInvalid:h=!1,feedbackTooltip:g=!1,feedback:_,feedbackType:ft,className:_t,style:$t,title:Mt="",type:Ft="checkbox",label:Ol,children:Vl,as:Nl="input",...xl},Ml)=>{e=useBootstrapPrefix(e,"form-check"),s=useBootstrapPrefix(s,"form-switch");const{controlId:Su}=reactExports.useContext(FormContext),_d=reactExports.useMemo(()=>({controlId:i||Su}),[Su,i]),ep=!Vl&&Ol!=null&&Ol!==!1||hasChildOfType(Vl,FormCheckLabel),tp=jsx(FormCheckInput,{...xl,type:Ft==="switch"?"checkbox":Ft,ref:Ml,isValid:d,isInvalid:h,disabled:c,as:Nl});return jsx(FormContext.Provider,{value:_d,children:jsx("div",{style:$t,className:classNames(_t,ep&&e,o&&`${e}-inline`,a&&`${e}-reverse`,Ft==="switch"&&s),children:Vl||jsxs(Fragment,{children:[tp,ep&&jsx(FormCheckLabel,{title:Mt,children:Ol}),_&&jsx(Feedback,{type:ft,tooltip:g,children:_})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:i,type:e,size:s,htmlSize:o,id:a,className:c,isValid:d=!1,isInvalid:h=!1,plaintext:g,readOnly:_,as:ft="input",..._t},$t)=>{const{controlId:Mt}=reactExports.useContext(FormContext);i=useBootstrapPrefix(i,"form-control");let Ft;return g?Ft={[`${i}-plaintext`]:!0}:Ft={[i]:!0,[`${i}-${s}`]:s},jsx(ft,{..._t,type:e,size:o,ref:$t,readOnly:_,id:a||Mt,className:classNames(c,Ft,d&&"is-valid",h&&"is-invalid",e==="color"&&`${i}-color`)})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback});var rHyphen=/-(.)/g;function camelize(i){return i.replace(rHyphen,function(e,s){return s.toUpperCase()})}const pascalCase=i=>i[0].toUpperCase()+camelize(i).slice(1);function createWithBsPrefix(i,{displayName:e=pascalCase(i),Component:s,defaultProps:o}={}){const a=reactExports.forwardRef(({className:c,bsPrefix:d,as:h=s||"div",...g},_)=>{const ft=useBootstrapPrefix(d,i);return jsx(h,{ref:_,className:classNames(c,ft),...g})});return a.defaultProps=o,a.displayName=e,a}const FormFloating=createWithBsPrefix("form-floating"),FormGroup=reactExports.forwardRef(({controlId:i,as:e="div",...s},o)=>{const a=reactExports.useMemo(()=>({controlId:i}),[i]);return jsx(FormContext.Provider,{value:a,children:jsx(e,{...s,ref:o})})});FormGroup.displayName="FormGroup";function useCol({as:i,bsPrefix:e,className:s,...o}){e=useBootstrapPrefix(e,"col");const a=useBootstrapBreakpoints(),c=useBootstrapMinBreakpoint(),d=[],h=[];return a.forEach(g=>{const _=o[g];delete o[g];let ft,_t,$t;typeof _=="object"&&_!=null?{span:ft,offset:_t,order:$t}=_:ft=_;const Mt=g!==c?`-${g}`:"";ft&&d.push(ft===!0?`${e}${Mt}`:`${e}${Mt}-${ft}`),$t!=null&&h.push(`order${Mt}-${$t}`),_t!=null&&h.push(`offset${Mt}-${_t}`)}),[{...o,className:classNames(s,...d,...h)},{as:i,bsPrefix:e,spans:d}]}const Col=reactExports.forwardRef((i,e)=>{const[{className:s,...o},{as:a="div",bsPrefix:c,spans:d}]=useCol(i);return jsx(a,{...o,ref:e,className:classNames(s,!d.length&&c)})});Col.displayName="Col";const defaultProps$e={column:!1,visuallyHidden:!1},FormLabel=reactExports.forwardRef(({as:i="label",bsPrefix:e,column:s,visuallyHidden:o,className:a,htmlFor:c,...d},h)=>{const{controlId:g}=reactExports.useContext(FormContext);e=useBootstrapPrefix(e,"form-label");let _="col-form-label";typeof s=="string"&&(_=`${_} ${_}-${s}`);const ft=classNames(a,e,o&&"visually-hidden",s&&_);return c=c||g,s?jsx(Col,{ref:h,as:"label",className:ft,htmlFor:c,...d}):jsx(i,{ref:h,className:ft,htmlFor:c,...d})});FormLabel.displayName="FormLabel";FormLabel.defaultProps=defaultProps$e;const FormRange=reactExports.forwardRef(({bsPrefix:i,className:e,id:s,...o},a)=>{const{controlId:c}=reactExports.useContext(FormContext);return i=useBootstrapPrefix(i,"form-range"),jsx("input",{...o,type:"range",ref:a,className:classNames(e,i),id:s||c})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:i,size:e,htmlSize:s,className:o,isValid:a=!1,isInvalid:c=!1,id:d,...h},g)=>{const{controlId:_}=reactExports.useContext(FormContext);return i=useBootstrapPrefix(i,"form-select"),jsx("select",{...h,size:s,ref:g,className:classNames(o,i,e&&`${i}-${e}`,a&&"is-valid",c&&"is-invalid"),id:d||_})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:i,className:e,as:s="small",muted:o,...a},c)=>(i=useBootstrapPrefix(i,"form-text"),jsx(s,{...a,ref:c,className:classNames(e,i,o&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((i,e)=>jsx(FormCheck$1,{...i,ref:e,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:i,className:e,children:s,controlId:o,label:a,...c},d)=>(i=useBootstrapPrefix(i,"form-floating"),jsxs(FormGroup,{ref:d,className:classNames(e,i),controlId:o,...c,children:[s,jsx("label",{htmlFor:o,children:a})]})));FloatingLabel.displayName="FloatingLabel";const propTypes$1={_ref:propTypesExports.any,validated:propTypesExports.bool,as:propTypesExports.elementType},Form=reactExports.forwardRef(({className:i,validated:e,as:s="form",...o},a)=>jsx(s,{...o,ref:a,className:classNames(i,e&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes$1;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var allExports={},all={get exports(){return allExports},set exports(i){allExports=i}},createChainableTypeCheckerExports={},createChainableTypeChecker={get exports(){return createChainableTypeCheckerExports},set exports(i){createChainableTypeCheckerExports=i}};(function(i,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=s;function s(o){function a(d,h,g,_,ft,_t){var $t=_||"<<anonymous>>",Mt=_t||g;if(h[g]==null)return d?new Error("Required "+ft+" `"+Mt+"` was not specified "+("in `"+$t+"`.")):null;for(var Ft=arguments.length,Ol=Array(Ft>6?Ft-6:0),Vl=6;Vl<Ft;Vl++)Ol[Vl-6]=arguments[Vl];return o.apply(void 0,[h,g,$t,ft,Mt].concat(Ol))}var c=a.bind(null,!1);return c.isRequired=a.bind(null,!0),c}i.exports=e.default})(createChainableTypeChecker,createChainableTypeCheckerExports);(function(i,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var s=createChainableTypeCheckerExports,o=a(s);function a(d){return d&&d.__esModule?d:{default:d}}function c(){for(var d=arguments.length,h=Array(d),g=0;g<d;g++)h[g]=arguments[g];function _(){for(var ft=arguments.length,_t=Array(ft),$t=0;$t<ft;$t++)_t[$t]=arguments[$t];var Mt=null;return h.forEach(function(Ft){if(Mt==null){var Ol=Ft.apply(void 0,_t);Ol!=null&&(Mt=Ol)}}),Mt}return(0,o.default)(_)}i.exports=e.default})(all,allExports);function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i},_extends$1.apply(this,arguments)}function _objectWithoutPropertiesLoose$8(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function defaultKey(i){return"default"+i.charAt(0).toUpperCase()+i.substr(1)}function _toPropertyKey(i){var e=_toPrimitive(i,"string");return typeof e=="symbol"?e:String(e)}function _toPrimitive(i,e){if(typeof i!="object"||i===null)return i;var s=i[Symbol.toPrimitive];if(s!==void 0){var o=s.call(i,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function useUncontrolledProp(i,e,s){var o=reactExports.useRef(i!==void 0),a=reactExports.useState(e),c=a[0],d=a[1],h=i!==void 0,g=o.current;return o.current=h,!h&&g&&c!==e&&d(e),[h?i:c,reactExports.useCallback(function(_){for(var ft=arguments.length,_t=new Array(ft>1?ft-1:0),$t=1;$t<ft;$t++)_t[$t-1]=arguments[$t];s&&s.apply(void 0,[_].concat(_t)),d(_)},[s])]}function useUncontrolled(i,e){return Object.keys(e).reduce(function(s,o){var a,c=s,d=c[defaultKey(o)],h=c[o],g=_objectWithoutPropertiesLoose$8(c,[defaultKey(o),o].map(_toPropertyKey)),_=e[o],ft=useUncontrolledProp(h,d,i[_]),_t=ft[0],$t=ft[1];return _extends$1({},g,(a={},a[o]=_t,a[_]=$t,a))},i)}function _setPrototypeOf(i,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,a){return o.__proto__=a,o},_setPrototypeOf(i,e)}function _inheritsLoose(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,_setPrototypeOf(i,e)}var toArray=Function.prototype.bind.call(Function.prototype.call,[].slice);function qsa(i,e){return toArray(i.querySelectorAll(e))}function useForceUpdate(){var i=reactExports.useReducer(function(s){return!s},!1),e=i[1];return e}var toFnRef=function(e){return!e||typeof e=="function"?e:function(s){e.current=s}};function mergeRefs(i,e){var s=toFnRef(i),o=toFnRef(e);return function(a){s&&s(a),o&&o(a)}}function useMergedRefs(i,e){return reactExports.useMemo(function(){return mergeRefs(i,e)},[i,e])}const NavContext=reactExports.createContext(null);NavContext.displayName="NavContext";const SelectableContext=reactExports.createContext(null),makeEventKey=(i,e=null)=>i!=null?String(i):e||null,TabContext=reactExports.createContext(null),ATTRIBUTE_PREFIX="data-rr-ui-",PROPERTY_PREFIX="rrUi";function dataAttr(i){return`${ATTRIBUTE_PREFIX}${i}`}function dataProp(i){return`${PROPERTY_PREFIX}${i}`}function useCommittedRef(i){var e=reactExports.useRef(i);return reactExports.useEffect(function(){e.current=i},[i]),e}function useEventCallback(i){var e=useCommittedRef(i);return reactExports.useCallback(function(){return e.current&&e.current.apply(e,arguments)},[e])}const _excluded$6=["as","active","eventKey"];function _objectWithoutPropertiesLoose$7(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function useNavItem({key:i,onClick:e,active:s,id:o,role:a,disabled:c}){const d=reactExports.useContext(SelectableContext),h=reactExports.useContext(NavContext),g=reactExports.useContext(TabContext);let _=s;const ft={role:a};if(h){!a&&h.role==="tablist"&&(ft.role="tab");const _t=h.getControllerId(i??null),$t=h.getControlledId(i??null);ft[dataAttr("event-key")]=i,ft.id=_t||o,_=s==null&&i!=null?h.activeKey===i:s,(_||!(g!=null&&g.unmountOnExit)&&!(g!=null&&g.mountOnEnter))&&(ft["aria-controls"]=$t)}return ft.role==="tab"&&(ft["aria-selected"]=_,_||(ft.tabIndex=-1),c&&(ft.tabIndex=-1,ft["aria-disabled"]=!0)),ft.onClick=useEventCallback(_t=>{c||(e==null||e(_t),i!=null&&d&&!_t.isPropagationStopped()&&d(i,_t))}),[ft,{isActive:_}]}const NavItem$1=reactExports.forwardRef((i,e)=>{let{as:s=Button$1,active:o,eventKey:a}=i,c=_objectWithoutPropertiesLoose$7(i,_excluded$6);const[d,h]=useNavItem(Object.assign({key:makeEventKey(a,c.href),active:o},c));return d[dataAttr("active")]=h.isActive,jsx(s,Object.assign({},c,d,{ref:e}))});NavItem$1.displayName="NavItem";const _excluded$5=["as","onSelect","activeKey","role","onKeyDown"];function _objectWithoutPropertiesLoose$6(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}const noop$6=()=>{},EVENT_KEY_ATTR=dataAttr("event-key"),Nav$2=reactExports.forwardRef((i,e)=>{let{as:s="div",onSelect:o,activeKey:a,role:c,onKeyDown:d}=i,h=_objectWithoutPropertiesLoose$6(i,_excluded$5);const g=useForceUpdate(),_=reactExports.useRef(!1),ft=reactExports.useContext(SelectableContext),_t=reactExports.useContext(TabContext);let $t,Mt;_t&&(c=c||"tablist",a=_t.activeKey,$t=_t.getControlledId,Mt=_t.getControllerId);const Ft=reactExports.useRef(null),Ol=Ml=>{const Su=Ft.current;if(!Su)return null;const _d=qsa(Su,`[${EVENT_KEY_ATTR}]:not([aria-disabled=true])`),ep=Su.querySelector("[aria-selected=true]");if(!ep||ep!==document.activeElement)return null;const tp=_d.indexOf(ep);if(tp===-1)return null;let np=tp+Ml;return np>=_d.length&&(np=0),np<0&&(np=_d.length-1),_d[np]},Vl=(Ml,Su)=>{Ml!=null&&(o==null||o(Ml,Su),ft==null||ft(Ml,Su))},Nl=Ml=>{if(d==null||d(Ml),!_t)return;let Su;switch(Ml.key){case"ArrowLeft":case"ArrowUp":Su=Ol(-1);break;case"ArrowRight":case"ArrowDown":Su=Ol(1);break;default:return}Su&&(Ml.preventDefault(),Vl(Su.dataset[dataProp("EventKey")]||null,Ml),_.current=!0,g())};reactExports.useEffect(()=>{if(Ft.current&&_.current){const Ml=Ft.current.querySelector(`[${EVENT_KEY_ATTR}][aria-selected=true]`);Ml==null||Ml.focus()}_.current=!1});const xl=useMergedRefs(e,Ft);return jsx(SelectableContext.Provider,{value:Vl,children:jsx(NavContext.Provider,{value:{role:c,activeKey:makeEventKey(a),getControlledId:$t||noop$6,getControllerId:Mt||noop$6},children:jsx(s,Object.assign({},h,{onKeyDown:Nl,ref:xl,role:c}))})})});Nav$2.displayName="Nav";const BaseNav=Object.assign(Nav$2,{Item:NavItem$1}),context$2=reactExports.createContext(null);context$2.displayName="NavbarContext";const context$1=reactExports.createContext(null);context$1.displayName="CardHeaderContext";const NavItem=createWithBsPrefix("nav-item");function useCallbackRef(){return reactExports.useState(null)}function useEventListener(i,e,s,o){o===void 0&&(o=!1);var a=useEventCallback(s);reactExports.useEffect(function(){var c=typeof i=="function"?i():i;return c.addEventListener(e,a,o),function(){return c.removeEventListener(e,a,o)}},[i])}function useMounted(){var i=reactExports.useRef(!0),e=reactExports.useRef(function(){return i.current});return reactExports.useEffect(function(){return i.current=!0,function(){i.current=!1}},[]),e.current}function usePrevious$1(i){var e=reactExports.useRef(null);return reactExports.useEffect(function(){e.current=i}),e.current}var isReactNative$1=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",isDOM=typeof document<"u";const useIsomorphicEffect=isDOM||isReactNative$1?reactExports.useLayoutEffect:reactExports.useEffect,_excluded$4=["onKeyDown"];function _objectWithoutPropertiesLoose$5(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function isTrivialHref(i){return!i||i.trim()==="#"}const Anchor=reactExports.forwardRef((i,e)=>{let{onKeyDown:s}=i,o=_objectWithoutPropertiesLoose$5(i,_excluded$4);const[a]=useButtonProps(Object.assign({tagName:"a"},o)),c=useEventCallback(d=>{a.onKeyDown(d),s==null||s(d)});return isTrivialHref(o.href)||o.role==="button"?jsx("a",Object.assign({ref:e},o,a,{onKeyDown:c})):jsx("a",Object.assign({ref:e},o,{onKeyDown:s}))});Anchor.displayName="Anchor";const defaultProps$d={disabled:!1},NavLink=reactExports.forwardRef(({bsPrefix:i,className:e,as:s=Anchor,active:o,eventKey:a,...c},d)=>{i=useBootstrapPrefix(i,"nav-link");const[h,g]=useNavItem({key:makeEventKey(a,c.href),active:o,...c});return jsx(s,{...c,...h,ref:d,className:classNames(e,i,c.disabled&&"disabled",g.isActive&&"active")})});NavLink.displayName="NavLink";NavLink.defaultProps=defaultProps$d;const defaultProps$c={justify:!1,fill:!1},Nav=reactExports.forwardRef((i,e)=>{const{as:s="div",bsPrefix:o,variant:a,fill:c,justify:d,navbar:h,navbarScroll:g,className:_,activeKey:ft,..._t}=useUncontrolled(i,{activeKey:"onSelect"}),$t=useBootstrapPrefix(o,"nav");let Mt,Ft,Ol=!1;const Vl=reactExports.useContext(context$2),Nl=reactExports.useContext(context$1);return Vl?(Mt=Vl.bsPrefix,Ol=h??!0):Nl&&({cardHeaderBsPrefix:Ft}=Nl),jsx(BaseNav,{as:s,ref:e,activeKey:ft,className:classNames(_,{[$t]:!Ol,[`${Mt}-nav`]:Ol,[`${Mt}-nav-scroll`]:Ol&&g,[`${Ft}-${a}`]:!!Ft,[`${$t}-${a}`]:!!a,[`${$t}-fill`]:c,[`${$t}-justified`]:d}),..._t})});Nav.displayName="Nav";Nav.defaultProps=defaultProps$c;const Nav$1=Object.assign(Nav,{Item:NavItem,Link:NavLink}),NavbarBrand=reactExports.forwardRef(({bsPrefix:i,className:e,as:s,...o},a)=>{i=useBootstrapPrefix(i,"navbar-brand");const c=s||(o.href?"a":"span");return jsx(c,{...o,ref:a,className:classNames(e,i)})});NavbarBrand.displayName="NavbarBrand";function ownerDocument(i){return i&&i.ownerDocument||document}function ownerWindow(i){var e=ownerDocument(i);return e&&e.defaultView||window}function getComputedStyle$1(i,e){return ownerWindow(i).getComputedStyle(i,e)}var rUpper=/([A-Z])/g;function hyphenate(i){return i.replace(rUpper,"-$1").toLowerCase()}var msPattern=/^ms-/;function hyphenateStyleName(i){return hyphenate(i).replace(msPattern,"-ms-")}var supportedTransforms=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function isTransform(i){return!!(i&&supportedTransforms.test(i))}function style(i,e){var s="",o="";if(typeof e=="string")return i.style.getPropertyValue(hyphenateStyleName(e))||getComputedStyle$1(i).getPropertyValue(hyphenateStyleName(e));Object.keys(e).forEach(function(a){var c=e[a];!c&&c!==0?i.style.removeProperty(hyphenateStyleName(a)):isTransform(a)?o+=a+"("+c+") ":s+=hyphenateStyleName(a)+": "+c+";"}),o&&(s+="transform: "+o+";"),i.style.cssText+=";"+s}const config$2={disabled:!1},TransitionGroupContext=React.createContext(null);var forceReflow=function(e){return e.scrollTop},UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(i){_inheritsLoose(e,i);function e(o,a){var c;c=i.call(this,o,a)||this;var d=a,h=d&&!d.isMounting?o.enter:o.appear,g;return c.appearStatus=null,o.in?h?(g=EXITED,c.appearStatus=ENTERING):g=ENTERED:o.unmountOnExit||o.mountOnEnter?g=UNMOUNTED:g=EXITED,c.state={status:g},c.nextCallback=null,c}e.getDerivedStateFromProps=function(a,c){var d=a.in;return d&&c.status===UNMOUNTED?{status:EXITED}:null};var s=e.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(a){var c=null;if(a!==this.props){var d=this.state.status;this.props.in?d!==ENTERING&&d!==ENTERED&&(c=ENTERING):(d===ENTERING||d===ENTERED)&&(c=EXITING)}this.updateStatus(!1,c)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var a=this.props.timeout,c,d,h;return c=d=h=a,a!=null&&typeof a!="number"&&(c=a.exit,d=a.enter,h=a.appear!==void 0?a.appear:d),{exit:c,enter:d,appear:h}},s.updateStatus=function(a,c){if(a===void 0&&(a=!1),c!==null)if(this.cancelNextCallback(),c===ENTERING){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);d&&forceReflow(d)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},s.performEnter=function(a){var c=this,d=this.props.enter,h=this.context?this.context.isMounting:a,g=this.props.nodeRef?[h]:[ReactDOM.findDOMNode(this),h],_=g[0],ft=g[1],_t=this.getTimeouts(),$t=h?_t.appear:_t.enter;if(!a&&!d||config$2.disabled){this.safeSetState({status:ENTERED},function(){c.props.onEntered(_)});return}this.props.onEnter(_,ft),this.safeSetState({status:ENTERING},function(){c.props.onEntering(_,ft),c.onTransitionEnd($t,function(){c.safeSetState({status:ENTERED},function(){c.props.onEntered(_,ft)})})})},s.performExit=function(){var a=this,c=this.props.exit,d=this.getTimeouts(),h=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!c||config$2.disabled){this.safeSetState({status:EXITED},function(){a.props.onExited(h)});return}this.props.onExit(h),this.safeSetState({status:EXITING},function(){a.props.onExiting(h),a.onTransitionEnd(d.exit,function(){a.safeSetState({status:EXITED},function(){a.props.onExited(h)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(a,c){c=this.setNextCallback(c),this.setState(a,c)},s.setNextCallback=function(a){var c=this,d=!0;return this.nextCallback=function(h){d&&(d=!1,c.nextCallback=null,a(h))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},s.onTransitionEnd=function(a,c){this.setNextCallback(c);var d=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),h=a==null&&!this.props.addEndListener;if(!d||h){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var g=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],_=g[0],ft=g[1];this.props.addEndListener(_,ft)}a!=null&&setTimeout(this.nextCallback,a)},s.render=function(){var a=this.state.status;if(a===UNMOUNTED)return null;var c=this.props,d=c.children;c.in,c.mountOnEnter,c.unmountOnExit,c.appear,c.enter,c.exit,c.timeout,c.addEndListener,c.onEnter,c.onEntering,c.onEntered,c.onExit,c.onExiting,c.onExited,c.nodeRef;var h=_objectWithoutPropertiesLoose$8(c,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React.createElement(TransitionGroupContext.Provider,{value:null},typeof d=="function"?d(a,h):React.cloneElement(React.Children.only(d),h))},e}(React.Component);Transition.contextType=TransitionGroupContext;Transition.propTypes={};function noop$5(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop$5,onEntering:noop$5,onEntered:noop$5,onExit:noop$5,onExiting:noop$5,onExited:noop$5};Transition.UNMOUNTED=UNMOUNTED;Transition.EXITED=EXITED;Transition.ENTERING=ENTERING;Transition.ENTERED=ENTERED;Transition.EXITING=EXITING;const canUseDOM=!!(typeof window<"u"&&window.document&&window.document.createElement);var optionsSupported=!1,onceSupported=!1;try{var options={get passive(){return optionsSupported=!0},get once(){return onceSupported=optionsSupported=!0}};canUseDOM&&(window.addEventListener("test",options,options),window.removeEventListener("test",options,!0))}catch{}function addEventListener$1(i,e,s,o){if(o&&typeof o!="boolean"&&!onceSupported){var a=o.once,c=o.capture,d=s;!onceSupported&&a&&(d=s.__once||function h(g){this.removeEventListener(e,h,c),s.call(this,g)},s.__once=d),i.addEventListener(e,d,optionsSupported?o:c)}i.addEventListener(e,s,o)}function removeEventListener(i,e,s,o){var a=o&&typeof o!="boolean"?o.capture:o;i.removeEventListener(e,s,a),s.__once&&i.removeEventListener(e,s.__once,a)}function listen(i,e,s,o){return addEventListener$1(i,e,s,o),function(){removeEventListener(i,e,s,o)}}function triggerEvent(i,e,s,o){if(s===void 0&&(s=!1),o===void 0&&(o=!0),i){var a=document.createEvent("HTMLEvents");a.initEvent(e,s,o),i.dispatchEvent(a)}}function parseDuration$1(i){var e=style(i,"transitionDuration")||"",s=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*s}function emulateTransitionEnd(i,e,s){s===void 0&&(s=5);var o=!1,a=setTimeout(function(){o||triggerEvent(i,"transitionend",!0)},e+s),c=listen(i,"transitionend",function(){o=!0},{once:!0});return function(){clearTimeout(a),c()}}function transitionEnd(i,e,s,o){s==null&&(s=parseDuration$1(i)||0);var a=emulateTransitionEnd(i,s,o),c=listen(i,"transitionend",e);return function(){a(),c()}}function parseDuration(i,e){const s=style(i,e)||"",o=s.indexOf("ms")===-1?1e3:1;return parseFloat(s)*o}function transitionEndListener(i,e){const s=parseDuration(i,"transitionDuration"),o=parseDuration(i,"transitionDelay"),a=transitionEnd(i,c=>{c.target===i&&(a(),e(c))},s+o)}function createChainedFunction(...i){return i.filter(e=>e!=null).reduce((e,s)=>{if(typeof s!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return e===null?s:function(...a){e.apply(this,a),s.apply(this,a)}},null)}function triggerBrowserReflow(i){i.offsetHeight}function safeFindDOMNode(i){return i&&"setState"in i?ReactDOM.findDOMNode(i):i??null}const TransitionWrapper=React.forwardRef(({onEnter:i,onEntering:e,onEntered:s,onExit:o,onExiting:a,onExited:c,addEndListener:d,children:h,childRef:g,..._},ft)=>{const _t=reactExports.useRef(null),$t=useMergedRefs(_t,g),Mt=ep=>{$t(safeFindDOMNode(ep))},Ft=ep=>tp=>{ep&&_t.current&&ep(_t.current,tp)},Ol=reactExports.useCallback(Ft(i),[i]),Vl=reactExports.useCallback(Ft(e),[e]),Nl=reactExports.useCallback(Ft(s),[s]),xl=reactExports.useCallback(Ft(o),[o]),Ml=reactExports.useCallback(Ft(a),[a]),Su=reactExports.useCallback(Ft(c),[c]),_d=reactExports.useCallback(Ft(d),[d]);return jsx(Transition,{ref:ft,..._,onEnter:Ol,onEntered:Nl,onEntering:Vl,onExit:xl,onExited:Su,onExiting:Ml,addEndListener:_d,nodeRef:_t,children:typeof h=="function"?(ep,tp)=>h(ep,{...tp,ref:Mt}):React.cloneElement(h,{ref:Mt})})}),MARGINS={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function getDefaultDimensionValue(i,e){const s=`offset${i[0].toUpperCase()}${i.slice(1)}`,o=e[s],a=MARGINS[i];return o+parseInt(style(e,a[0]),10)+parseInt(style(e,a[1]),10)}const collapseStyles={[EXITED]:"collapse",[EXITING]:"collapsing",[ENTERING]:"collapsing",[ENTERED]:"collapse show"},defaultProps$b={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,getDimensionValue:getDefaultDimensionValue},Collapse=React.forwardRef(({onEnter:i,onEntering:e,onEntered:s,onExit:o,onExiting:a,className:c,children:d,dimension:h="height",getDimensionValue:g=getDefaultDimensionValue,..._},ft)=>{const _t=typeof h=="function"?h():h,$t=reactExports.useMemo(()=>createChainedFunction(Nl=>{Nl.style[_t]="0"},i),[_t,i]),Mt=reactExports.useMemo(()=>createChainedFunction(Nl=>{const xl=`scroll${_t[0].toUpperCase()}${_t.slice(1)}`;Nl.style[_t]=`${Nl[xl]}px`},e),[_t,e]),Ft=reactExports.useMemo(()=>createChainedFunction(Nl=>{Nl.style[_t]=null},s),[_t,s]),Ol=reactExports.useMemo(()=>createChainedFunction(Nl=>{Nl.style[_t]=`${g(_t,Nl)}px`,triggerBrowserReflow(Nl)},o),[o,g,_t]),Vl=reactExports.useMemo(()=>createChainedFunction(Nl=>{Nl.style[_t]=null},a),[_t,a]);return jsx(TransitionWrapper,{ref:ft,addEndListener:transitionEndListener,..._,"aria-expanded":_.role?_.in:null,onEnter:$t,onEntering:Mt,onEntered:Ft,onExit:Ol,onExiting:Vl,childRef:d.ref,children:(Nl,xl)=>React.cloneElement(d,{...xl,className:classNames(c,d.props.className,collapseStyles[Nl],_t==="width"&&"collapse-horizontal")})})});Collapse.defaultProps=defaultProps$b;const NavbarCollapse=reactExports.forwardRef(({children:i,bsPrefix:e,...s},o)=>{e=useBootstrapPrefix(e,"navbar-collapse");const a=reactExports.useContext(context$2);return jsx(Collapse,{in:!!(a&&a.expanded),...s,children:jsx("div",{ref:o,className:e,children:i})})});NavbarCollapse.displayName="NavbarCollapse";const defaultProps$a={label:"Toggle navigation"},NavbarToggle=reactExports.forwardRef(({bsPrefix:i,className:e,children:s,label:o,as:a="button",onClick:c,...d},h)=>{i=useBootstrapPrefix(i,"navbar-toggler");const{onToggle:g,expanded:_}=reactExports.useContext(context$2)||{},ft=useEventCallback(_t=>{c&&c(_t),g&&g()});return a==="button"&&(d.type="button"),jsx(a,{...d,ref:h,onClick:ft,"aria-label":o,className:classNames(e,i,!_&&"collapsed"),children:s||jsx("span",{className:`${i}-icon`})})});NavbarToggle.displayName="NavbarToggle";NavbarToggle.defaultProps=defaultProps$a;var matchersByWindow=new WeakMap,getMatcher=function(e,s){if(!(!e||!s)){var o=matchersByWindow.get(s)||new Map;matchersByWindow.set(s,o);var a=o.get(e);return a||(a=s.matchMedia(e),a.refCount=0,o.set(a.media,a)),a}};function useMediaQuery(i,e){e===void 0&&(e=typeof window>"u"?void 0:window);var s=getMatcher(i,e),o=reactExports.useState(function(){return s?s.matches:!1}),a=o[0],c=o[1];return useIsomorphicEffect(function(){var d=getMatcher(i,e);if(!d)return c(!1);var h=matchersByWindow.get(e),g=function(){c(d.matches)};return d.refCount++,d.addListener(g),g(),function(){d.removeListener(g),d.refCount--,d.refCount<=0&&(h==null||h.delete(d.media)),d=void 0}},[i]),a}function createBreakpointHook(i){var e=Object.keys(i);function s(h,g){return h===g?g:h?h+" and "+g:g}function o(h){return e[Math.min(e.indexOf(h)+1,e.length-1)]}function a(h){var g=o(h),_=i[g];return typeof _=="number"?_=_-.2+"px":_="calc("+_+" - 0.2px)","(max-width: "+_+")"}function c(h){var g=i[h];return typeof g=="number"&&(g=g+"px"),"(min-width: "+g+")"}function d(h,g,_){var ft;if(typeof h=="object")ft=h,_=g,g=!0;else{var _t;g=g||!0,ft=(_t={},_t[h]=g,_t)}var $t=reactExports.useMemo(function(){return Object.entries(ft).reduce(function(Mt,Ft){var Ol=Ft[0],Vl=Ft[1];return(Vl==="up"||Vl===!0)&&(Mt=s(Mt,c(Ol))),(Vl==="down"||Vl===!0)&&(Mt=s(Mt,a(Ol))),Mt},"")},[JSON.stringify(ft)]);return useMediaQuery($t,_)}return d}var useBreakpoint=createBreakpointHook({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400});function activeElement(i){i===void 0&&(i=ownerDocument());try{var e=i.activeElement;return!e||!e.nodeName?null:e}catch{return i.body}}function contains$2(i,e){if(i.contains)return i.contains(e);if(i.compareDocumentPosition)return i===e||!!(i.compareDocumentPosition(e)&16)}function useUpdatedRef(i){var e=reactExports.useRef(i);return e.current=i,e}function useWillUnmount(i){var e=useUpdatedRef(i);reactExports.useEffect(function(){return function(){return e.current()}},[])}function getBodyScrollbarWidth(i=document){const e=i.defaultView;return Math.abs(e.innerWidth-i.documentElement.clientWidth)}const OPEN_DATA_ATTRIBUTE=dataAttr("modal-open");class ModalManager{constructor({ownerDocument:e,handleContainerOverflow:s=!0,isRTL:o=!1}={}){this.handleContainerOverflow=s,this.isRTL=o,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return getBodyScrollbarWidth(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const s={overflow:"hidden"},o=this.isRTL?"paddingLeft":"paddingRight",a=this.getElement();e.style={overflow:a.style.overflow,[o]:a.style[o]},e.scrollBarWidth&&(s[o]=`${parseInt(style(a,o)||"0",10)+e.scrollBarWidth}px`),a.setAttribute(OPEN_DATA_ATTRIBUTE,""),style(a,s)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const s=this.getElement();s.removeAttribute(OPEN_DATA_ATTRIBUTE),Object.assign(s.style,e.style)}add(e){let s=this.modals.indexOf(e);return s!==-1||(s=this.modals.length,this.modals.push(e),this.setModalAttributes(e),s!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),s}remove(e){const s=this.modals.indexOf(e);s!==-1&&(this.modals.splice(s,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const Context=reactExports.createContext(canUseDOM?window:void 0);Context.Provider;function useWindow(){return reactExports.useContext(Context)}const resolveContainerRef=(i,e)=>canUseDOM?i==null?(e||ownerDocument()).body:(typeof i=="function"&&(i=i()),i&&"current"in i&&(i=i.current),i&&("nodeType"in i||i.getBoundingClientRect)?i:null):null;function useWaitForDOMRef(i,e){const s=useWindow(),[o,a]=reactExports.useState(()=>resolveContainerRef(i,s==null?void 0:s.document));if(!o){const c=resolveContainerRef(i);c&&a(c)}return reactExports.useEffect(()=>{e&&o&&e(o)},[e,o]),reactExports.useEffect(()=>{const c=resolveContainerRef(i);c!==o&&a(c)},[i,o]),o}function NoopTransition({children:i,in:e,onExited:s,mountOnEnter:o,unmountOnExit:a}){const c=reactExports.useRef(null),d=reactExports.useRef(e),h=useEventCallback(s);reactExports.useEffect(()=>{e?d.current=!0:h(c.current)},[e,h]);const g=useMergedRefs(c,i.ref),_=reactExports.cloneElement(i,{ref:g});return e?_:a||!d.current&&o?null:_}function useTransition({in:i,onTransition:e}){const s=reactExports.useRef(null),o=reactExports.useRef(!0),a=useEventCallback(e);return useIsomorphicEffect(()=>{if(!s.current)return;let c=!1;return a({in:i,element:s.current,initial:o.current,isStale:()=>c}),()=>{c=!0}},[i,a]),useIsomorphicEffect(()=>(o.current=!1,()=>{o.current=!0}),[]),s}function ImperativeTransition({children:i,in:e,onExited:s,onEntered:o,transition:a}){const[c,d]=reactExports.useState(!e);e&&c&&d(!1);const h=useTransition({in:!!e,onTransition:_=>{const ft=()=>{_.isStale()||(_.in?o==null||o(_.element,_.initial):(d(!0),s==null||s(_.element)))};Promise.resolve(a(_)).then(ft,_t=>{throw _.in||d(!0),_t})}}),g=useMergedRefs(h,i.ref);return c&&!e?null:reactExports.cloneElement(i,{ref:g})}function renderTransition(i,e,s){return i?jsx(i,Object.assign({},s)):e?jsx(ImperativeTransition,Object.assign({},s,{transition:e})):jsx(NoopTransition,Object.assign({},s))}const _excluded$3=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function _objectWithoutPropertiesLoose$4(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}let manager;function getManager(i){return manager||(manager=new ModalManager({ownerDocument:i==null?void 0:i.document})),manager}function useModalManager(i){const e=useWindow(),s=i||getManager(e),o=reactExports.useRef({dialog:null,backdrop:null});return Object.assign(o.current,{add:()=>s.add(o.current),remove:()=>s.remove(o.current),isTopModal:()=>s.isTopModal(o.current),setDialogRef:reactExports.useCallback(a=>{o.current.dialog=a},[]),setBackdropRef:reactExports.useCallback(a=>{o.current.backdrop=a},[])})}const Modal=reactExports.forwardRef((i,e)=>{let{show:s=!1,role:o="dialog",className:a,style:c,children:d,backdrop:h=!0,keyboard:g=!0,onBackdropClick:_,onEscapeKeyDown:ft,transition:_t,runTransition:$t,backdropTransition:Mt,runBackdropTransition:Ft,autoFocus:Ol=!0,enforceFocus:Vl=!0,restoreFocus:Nl=!0,restoreFocusOptions:xl,renderDialog:Ml,renderBackdrop:Su=yp=>jsx("div",Object.assign({},yp)),manager:_d,container:ep,onShow:tp,onHide:np=()=>{},onExit:op,onExited:rp,onExiting:ap,onEnter:up,onEntering:dp,onEntered:hp}=i,fp=_objectWithoutPropertiesLoose$4(i,_excluded$3);const gp=useWaitForDOMRef(ep),pp=useModalManager(_d),sp=useMounted(),lp=usePrevious$1(s),[ip,cp]=reactExports.useState(!s),mp=reactExports.useRef(null);reactExports.useImperativeHandle(e,()=>pp,[pp]),canUseDOM&&!lp&&s&&(mp.current=activeElement()),s&&ip&&cp(!1);const wp=useEventCallback(()=>{if(pp.add(),Ip.current=listen(document,"keydown",$p),Tp.current=listen(document,"focus",()=>setTimeout(vp),!0),tp&&tp(),Ol){const yp=activeElement(document);pp.dialog&&yp&&!contains$2(pp.dialog,yp)&&(mp.current=yp,pp.dialog.focus())}}),_p=useEventCallback(()=>{if(pp.remove(),Ip.current==null||Ip.current(),Tp.current==null||Tp.current(),Nl){var yp;(yp=mp.current)==null||yp.focus==null||yp.focus(xl),mp.current=null}});reactExports.useEffect(()=>{!s||!gp||wp()},[s,gp,wp]),reactExports.useEffect(()=>{ip&&_p()},[ip,_p]),useWillUnmount(()=>{_p()});const vp=useEventCallback(()=>{if(!Vl||!sp()||!pp.isTopModal())return;const yp=activeElement();pp.dialog&&yp&&!contains$2(pp.dialog,yp)&&pp.dialog.focus()}),Ep=useEventCallback(yp=>{yp.target===yp.currentTarget&&(_==null||_(yp),h===!0&&np())}),$p=useEventCallback(yp=>{g&&yp.keyCode===27&&pp.isTopModal()&&(ft==null||ft(yp),yp.defaultPrevented||np())}),Tp=reactExports.useRef(),Ip=reactExports.useRef(),Pp=(...yp)=>{cp(!0),rp==null||rp(...yp)};if(!gp)return null;const Rp=Object.assign({role:o,ref:pp.setDialogRef,"aria-modal":o==="dialog"?!0:void 0},fp,{style:c,className:a,tabIndex:-1});let Ap=Ml?Ml(Rp):jsx("div",Object.assign({},Rp,{children:reactExports.cloneElement(d,{role:"document"})}));Ap=renderTransition(_t,$t,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!s,onExit:op,onExiting:ap,onExited:Pp,onEnter:up,onEntering:dp,onEntered:hp,children:Ap});let Sp=null;return h&&(Sp=Su({ref:pp.setBackdropRef,onClick:Ep}),Sp=renderTransition(Mt,Ft,{in:!!s,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Sp})),jsx(Fragment,{children:ReactDOM.createPortal(jsxs(Fragment,{children:[Sp,Ap]}),gp)})});Modal.displayName="Modal";const BaseModal=Object.assign(Modal,{Manager:ModalManager}),defaultProps$9={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},fadeStyles={[ENTERING]:"show",[ENTERED]:"show"},Fade=reactExports.forwardRef(({className:i,children:e,transitionClasses:s={},...o},a)=>{const c=reactExports.useCallback((d,h)=>{triggerBrowserReflow(d),o.onEnter==null||o.onEnter(d,h)},[o]);return jsx(TransitionWrapper,{ref:a,addEndListener:transitionEndListener,...o,onEnter:c,childRef:e.ref,children:(d,h)=>reactExports.cloneElement(e,{...h,className:classNames("fade",i,e.props.className,fadeStyles[d],s[d])})})});Fade.defaultProps=defaultProps$9;Fade.displayName="Fade";const OffcanvasBody=createWithBsPrefix("offcanvas-body"),defaultProps$8={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1},transitionStyles={[ENTERING]:"show",[ENTERED]:"show"},OffcanvasToggling=reactExports.forwardRef(({bsPrefix:i,className:e,children:s,...o},a)=>(i=useBootstrapPrefix(i,"offcanvas"),jsx(TransitionWrapper,{ref:a,addEndListener:transitionEndListener,...o,childRef:s.ref,children:(c,d)=>reactExports.cloneElement(s,{...d,className:classNames(e,s.props.className,(c===ENTERING||c===EXITING)&&`${i}-toggling`,transitionStyles[c])})})));OffcanvasToggling.defaultProps=defaultProps$8;OffcanvasToggling.displayName="OffcanvasToggling";const ModalContext=reactExports.createContext({onHide(){}}),propTypes={"aria-label":propTypesExports.string,onClick:propTypesExports.func,variant:propTypesExports.oneOf(["white"])},defaultProps$7={"aria-label":"Close"},CloseButton=reactExports.forwardRef(({className:i,variant:e,...s},o)=>jsx("button",{ref:o,type:"button",className:classNames("btn-close",e&&`btn-close-${e}`,i),...s}));CloseButton.displayName="CloseButton";CloseButton.propTypes=propTypes;CloseButton.defaultProps=defaultProps$7;const defaultProps$6={closeLabel:"Close",closeButton:!1},AbstractModalHeader=reactExports.forwardRef(({closeLabel:i,closeVariant:e,closeButton:s,onHide:o,children:a,...c},d)=>{const h=reactExports.useContext(ModalContext),g=useEventCallback(()=>{h==null||h.onHide(),o==null||o()});return jsxs("div",{ref:d,...c,children:[a,s&&jsx(CloseButton,{"aria-label":i,variant:e,onClick:g})]})});AbstractModalHeader.defaultProps=defaultProps$6;const defaultProps$5={closeLabel:"Close",closeButton:!1},OffcanvasHeader=reactExports.forwardRef(({bsPrefix:i,className:e,...s},o)=>(i=useBootstrapPrefix(i,"offcanvas-header"),jsx(AbstractModalHeader,{ref:o,...s,className:classNames(e,i)})));OffcanvasHeader.displayName="OffcanvasHeader";OffcanvasHeader.defaultProps=defaultProps$5;const divWithClassName=i=>reactExports.forwardRef((e,s)=>jsx("div",{...e,ref:s,className:classNames(e.className,i)})),DivStyledAsH5=divWithClassName("h5"),OffcanvasTitle=createWithBsPrefix("offcanvas-title",{Component:DivStyledAsH5});function hasClass(i,e){return i.classList?!!e&&i.classList.contains(e):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+e+" ")!==-1}function addClass(i,e){i.classList?i.classList.add(e):hasClass(i,e)||(typeof i.className=="string"?i.className=i.className+" "+e:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+e))}function replaceClassName(i,e){return i.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function removeClass(i,e){i.classList?i.classList.remove(e):typeof i.className=="string"?i.className=replaceClassName(i.className,e):i.setAttribute("class",replaceClassName(i.className&&i.className.baseVal||"",e))}const Selector={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class BootstrapModalManager extends ModalManager{adjustAndStore(e,s,o){const a=s.style[e];s.dataset[e]=a,style(s,{[e]:`${parseFloat(style(s,e))+o}px`})}restore(e,s){const o=s.dataset[e];o!==void 0&&(delete s.dataset[e],style(s,{[e]:o}))}setContainerStyle(e){super.setContainerStyle(e);const s=this.getElement();if(addClass(s,"modal-open"),!e.scrollBarWidth)return;const o=this.isRTL?"paddingLeft":"paddingRight",a=this.isRTL?"marginLeft":"marginRight";qsa(s,Selector.FIXED_CONTENT).forEach(c=>this.adjustAndStore(o,c,e.scrollBarWidth)),qsa(s,Selector.STICKY_CONTENT).forEach(c=>this.adjustAndStore(a,c,-e.scrollBarWidth)),qsa(s,Selector.NAVBAR_TOGGLER).forEach(c=>this.adjustAndStore(a,c,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const s=this.getElement();removeClass(s,"modal-open");const o=this.isRTL?"paddingLeft":"paddingRight",a=this.isRTL?"marginLeft":"marginRight";qsa(s,Selector.FIXED_CONTENT).forEach(c=>this.restore(o,c)),qsa(s,Selector.STICKY_CONTENT).forEach(c=>this.restore(a,c)),qsa(s,Selector.NAVBAR_TOGGLER).forEach(c=>this.restore(a,c))}}let sharedManager;function getSharedManager(i){return sharedManager||(sharedManager=new BootstrapModalManager(i)),sharedManager}const defaultProps$4={show:!1,backdrop:!0,keyboard:!0,scroll:!1,autoFocus:!0,enforceFocus:!0,restoreFocus:!0,placement:"start",renderStaticNode:!1};function DialogTransition(i){return jsx(OffcanvasToggling,{...i})}function BackdropTransition(i){return jsx(Fade,{...i})}const Offcanvas=reactExports.forwardRef(({bsPrefix:i,className:e,children:s,"aria-labelledby":o,placement:a,responsive:c,show:d,backdrop:h,keyboard:g,scroll:_,onEscapeKeyDown:ft,onShow:_t,onHide:$t,container:Mt,autoFocus:Ft,enforceFocus:Ol,restoreFocus:Vl,restoreFocusOptions:Nl,onEntered:xl,onExit:Ml,onExiting:Su,onEnter:_d,onEntering:ep,onExited:tp,backdropClassName:np,manager:op,renderStaticNode:rp,...ap},up)=>{const dp=reactExports.useRef();i=useBootstrapPrefix(i,"offcanvas");const{onToggle:hp}=reactExports.useContext(context$2)||{},[fp,gp]=reactExports.useState(!1),pp=useBreakpoint(c||"xs","up");reactExports.useEffect(()=>{gp(c?d&&!pp:d)},[d,c,pp]);const sp=useEventCallback(()=>{hp==null||hp(),$t==null||$t()}),lp=reactExports.useMemo(()=>({onHide:sp}),[sp]);function ip(){return op||(_?(dp.current||(dp.current=new BootstrapModalManager({handleContainerOverflow:!1})),dp.current):getSharedManager())}const cp=(vp,...Ep)=>{vp&&(vp.style.visibility="visible"),_d==null||_d(vp,...Ep)},mp=(vp,...Ep)=>{vp&&(vp.style.visibility=""),tp==null||tp(...Ep)},wp=reactExports.useCallback(vp=>jsx("div",{...vp,className:classNames(`${i}-backdrop`,np)}),[np,i]),_p=vp=>jsx("div",{...vp,...ap,className:classNames(e,c?`${i}-${c}`:i,`${i}-${a}`),"aria-labelledby":o,children:s});return jsxs(Fragment,{children:[!fp&&(c||rp)&&_p({}),jsx(ModalContext.Provider,{value:lp,children:jsx(BaseModal,{show:fp,ref:up,backdrop:h,container:Mt,keyboard:g,autoFocus:Ft,enforceFocus:Ol&&!_,restoreFocus:Vl,restoreFocusOptions:Nl,onEscapeKeyDown:ft,onShow:_t,onHide:sp,onEnter:cp,onEntering:ep,onEntered:xl,onExit:Ml,onExiting:Su,onExited:mp,manager:ip(),transition:DialogTransition,backdropTransition:BackdropTransition,renderBackdrop:wp,renderDialog:_p})})]})});Offcanvas.displayName="Offcanvas";Offcanvas.defaultProps=defaultProps$4;const Offcanvas$1=Object.assign(Offcanvas,{Body:OffcanvasBody,Header:OffcanvasHeader,Title:OffcanvasTitle}),NavbarOffcanvas=reactExports.forwardRef((i,e)=>{const s=reactExports.useContext(context$2);return jsx(Offcanvas$1,{ref:e,show:!!(s!=null&&s.expanded),...i,renderStaticNode:!0})});NavbarOffcanvas.displayName="NavbarOffcanvas";const NavbarText=createWithBsPrefix("navbar-text",{Component:"span"}),defaultProps$3={expand:!0,variant:"light",collapseOnSelect:!1},Navbar=reactExports.forwardRef((i,e)=>{const{bsPrefix:s,expand:o,variant:a,bg:c,fixed:d,sticky:h,className:g,as:_="nav",expanded:ft,onToggle:_t,onSelect:$t,collapseOnSelect:Mt,...Ft}=useUncontrolled(i,{expanded:"onToggle"}),Ol=useBootstrapPrefix(s,"navbar"),Vl=reactExports.useCallback((...Ml)=>{$t==null||$t(...Ml),Mt&&ft&&(_t==null||_t(!1))},[$t,Mt,ft,_t]);Ft.role===void 0&&_!=="nav"&&(Ft.role="navigation");let Nl=`${Ol}-expand`;typeof o=="string"&&(Nl=`${Nl}-${o}`);const xl=reactExports.useMemo(()=>({onToggle:()=>_t==null?void 0:_t(!ft),bsPrefix:Ol,expanded:!!ft,expand:o}),[Ol,ft,o,_t]);return jsx(context$2.Provider,{value:xl,children:jsx(SelectableContext.Provider,{value:Vl,children:jsx(_,{ref:e,...Ft,className:classNames(g,Ol,o&&Nl,a&&`${Ol}-${a}`,c&&`bg-${c}`,h&&`sticky-${h}`,d&&`fixed-${d}`)})})})});Navbar.defaultProps=defaultProps$3;Navbar.displayName="Navbar";const Navbar$1=Object.assign(Navbar,{Brand:NavbarBrand,Collapse:NavbarCollapse,Offcanvas:NavbarOffcanvas,Text:NavbarText,Toggle:NavbarToggle}),DropdownContext$1=reactExports.createContext(null);var has=Object.prototype.hasOwnProperty;function find(i,e,s){for(s of i.keys())if(dequal(s,e))return s}function dequal(i,e){var s,o,a;if(i===e)return!0;if(i&&e&&(s=i.constructor)===e.constructor){if(s===Date)return i.getTime()===e.getTime();if(s===RegExp)return i.toString()===e.toString();if(s===Array){if((o=i.length)===e.length)for(;o--&&dequal(i[o],e[o]););return o===-1}if(s===Set){if(i.size!==e.size)return!1;for(o of i)if(a=o,a&&typeof a=="object"&&(a=find(e,a),!a)||!e.has(a))return!1;return!0}if(s===Map){if(i.size!==e.size)return!1;for(o of i)if(a=o[0],a&&typeof a=="object"&&(a=find(e,a),!a)||!dequal(o[1],e.get(a)))return!1;return!0}if(s===ArrayBuffer)i=new Uint8Array(i),e=new Uint8Array(e);else if(s===DataView){if((o=i.byteLength)===e.byteLength)for(;o--&&i.getInt8(o)===e.getInt8(o););return o===-1}if(ArrayBuffer.isView(i)){if((o=i.byteLength)===e.byteLength)for(;o--&&i[o]===e[o];);return o===-1}if(!s||typeof i=="object"){o=0;for(s in i)if(has.call(i,s)&&++o&&!has.call(e,s)||!(s in e)||!dequal(i[s],e[s]))return!1;return Object.keys(e).length===o}}return i!==i&&e!==e}function useSafeState(i){var e=useMounted();return[i[0],reactExports.useCallback(function(s){if(e())return i[1](s)},[e,i[1]])]}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start$1="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(i,e){return i.concat([e+"-"+start$1,e+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(i,e){return i.concat([e,e+"-"+start$1,e+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getBasePlacement(i){return i.split("-")[0]}function getWindow(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var e=i.ownerDocument;return e&&e.defaultView||window}return i}function isElement(i){var e=getWindow(i).Element;return i instanceof e||i instanceof Element}function isHTMLElement(i){var e=getWindow(i).HTMLElement;return i instanceof e||i instanceof HTMLElement}function isShadowRoot(i){if(typeof ShadowRoot>"u")return!1;var e=getWindow(i).ShadowRoot;return i instanceof e||i instanceof ShadowRoot}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var i=navigator.userAgentData;return i!=null&&i.brands?i.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(i,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=i.getBoundingClientRect(),a=1,c=1;e&&isHTMLElement(i)&&(a=i.offsetWidth>0&&round(o.width)/i.offsetWidth||1,c=i.offsetHeight>0&&round(o.height)/i.offsetHeight||1);var d=isElement(i)?getWindow(i):window,h=d.visualViewport,g=!isLayoutViewport()&&s,_=(o.left+(g&&h?h.offsetLeft:0))/a,ft=(o.top+(g&&h?h.offsetTop:0))/c,_t=o.width/a,$t=o.height/c;return{width:_t,height:$t,top:ft,right:_+_t,bottom:ft+$t,left:_,x:_,y:ft}}function getLayoutRect(i){var e=getBoundingClientRect(i),s=i.offsetWidth,o=i.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:i.offsetLeft,y:i.offsetTop,width:s,height:o}}function contains$1(i,e){var s=e.getRootNode&&e.getRootNode();if(i.contains(e))return!0;if(s&&isShadowRoot(s)){var o=e;do{if(o&&i.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function getNodeName(i){return i?(i.nodeName||"").toLowerCase():null}function getComputedStyle(i){return getWindow(i).getComputedStyle(i)}function isTableElement(i){return["table","td","th"].indexOf(getNodeName(i))>=0}function getDocumentElement(i){return((isElement(i)?i.ownerDocument:i.document)||window.document).documentElement}function getParentNode(i){return getNodeName(i)==="html"?i:i.assignedSlot||i.parentNode||(isShadowRoot(i)?i.host:null)||getDocumentElement(i)}function getTrueOffsetParent(i){return!isHTMLElement(i)||getComputedStyle(i).position==="fixed"?null:i.offsetParent}function getContainingBlock(i){var e=/firefox/i.test(getUAString()),s=/Trident/i.test(getUAString());if(s&&isHTMLElement(i)){var o=getComputedStyle(i);if(o.position==="fixed")return null}var a=getParentNode(i);for(isShadowRoot(a)&&(a=a.host);isHTMLElement(a)&&["html","body"].indexOf(getNodeName(a))<0;){var c=getComputedStyle(a);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return a;a=a.parentNode}return null}function getOffsetParent(i){for(var e=getWindow(i),s=getTrueOffsetParent(i);s&&isTableElement(s)&&getComputedStyle(s).position==="static";)s=getTrueOffsetParent(s);return s&&(getNodeName(s)==="html"||getNodeName(s)==="body"&&getComputedStyle(s).position==="static")?e:s||getContainingBlock(i)||e}function getMainAxisFromPlacement(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function within(i,e,s){return max(i,min(e,s))}function withinMaxClamp(i,e,s){var o=within(i,e,s);return o>s?s:o}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(i){return Object.assign({},getFreshSideObject(),i)}function expandToHashMap(i,e){return e.reduce(function(s,o){return s[o]=i,s},{})}var toPaddingObject=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,mergePaddingObject(typeof e!="number"?e:expandToHashMap(e,basePlacements))};function arrow(i){var e,s=i.state,o=i.name,a=i.options,c=s.elements.arrow,d=s.modifiersData.popperOffsets,h=getBasePlacement(s.placement),g=getMainAxisFromPlacement(h),_=[left,right].indexOf(h)>=0,ft=_?"height":"width";if(!(!c||!d)){var _t=toPaddingObject(a.padding,s),$t=getLayoutRect(c),Mt=g==="y"?top:left,Ft=g==="y"?bottom:right,Ol=s.rects.reference[ft]+s.rects.reference[g]-d[g]-s.rects.popper[ft],Vl=d[g]-s.rects.reference[g],Nl=getOffsetParent(c),xl=Nl?g==="y"?Nl.clientHeight||0:Nl.clientWidth||0:0,Ml=Ol/2-Vl/2,Su=_t[Mt],_d=xl-$t[ft]-_t[Ft],ep=xl/2-$t[ft]/2+Ml,tp=within(Su,ep,_d),np=g;s.modifiersData[o]=(e={},e[np]=tp,e.centerOffset=tp-ep,e)}}function effect$1(i){var e=i.state,s=i.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||contains$1(e.elements.popper,a)&&(e.elements.arrow=a))}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(i){return i.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(i){var e=i.x,s=i.y,o=window,a=o.devicePixelRatio||1;return{x:round(e*a)/a||0,y:round(s*a)/a||0}}function mapToStyles(i){var e,s=i.popper,o=i.popperRect,a=i.placement,c=i.variation,d=i.offsets,h=i.position,g=i.gpuAcceleration,_=i.adaptive,ft=i.roundOffsets,_t=i.isFixed,$t=d.x,Mt=$t===void 0?0:$t,Ft=d.y,Ol=Ft===void 0?0:Ft,Vl=typeof ft=="function"?ft({x:Mt,y:Ol}):{x:Mt,y:Ol};Mt=Vl.x,Ol=Vl.y;var Nl=d.hasOwnProperty("x"),xl=d.hasOwnProperty("y"),Ml=left,Su=top,_d=window;if(_){var ep=getOffsetParent(s),tp="clientHeight",np="clientWidth";if(ep===getWindow(s)&&(ep=getDocumentElement(s),getComputedStyle(ep).position!=="static"&&h==="absolute"&&(tp="scrollHeight",np="scrollWidth")),ep=ep,a===top||(a===left||a===right)&&c===end){Su=bottom;var op=_t&&ep===_d&&_d.visualViewport?_d.visualViewport.height:ep[tp];Ol-=op-o.height,Ol*=g?1:-1}if(a===left||(a===top||a===bottom)&&c===end){Ml=right;var rp=_t&&ep===_d&&_d.visualViewport?_d.visualViewport.width:ep[np];Mt-=rp-o.width,Mt*=g?1:-1}}var ap=Object.assign({position:h},_&&unsetSides),up=ft===!0?roundOffsetsByDPR({x:Mt,y:Ol}):{x:Mt,y:Ol};if(Mt=up.x,Ol=up.y,g){var dp;return Object.assign({},ap,(dp={},dp[Su]=xl?"0":"",dp[Ml]=Nl?"0":"",dp.transform=(_d.devicePixelRatio||1)<=1?"translate("+Mt+"px, "+Ol+"px)":"translate3d("+Mt+"px, "+Ol+"px, 0)",dp))}return Object.assign({},ap,(e={},e[Su]=xl?Ol+"px":"",e[Ml]=Nl?Mt+"px":"",e.transform="",e))}function computeStyles(i){var e=i.state,s=i.options,o=s.gpuAcceleration,a=o===void 0?!0:o,c=s.adaptive,d=c===void 0?!0:c,h=s.roundOffsets,g=h===void 0?!0:h,_={placement:getBasePlacement(e.placement),variation:getVariation(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,mapToStyles(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:g})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,mapToStyles(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(i){var e=i.state,s=i.instance,o=i.options,a=o.scroll,c=a===void 0?!0:a,d=o.resize,h=d===void 0?!0:d,g=getWindow(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&_.forEach(function(ft){ft.addEventListener("scroll",s.update,passive)}),h&&g.addEventListener("resize",s.update,passive),function(){c&&_.forEach(function(ft){ft.removeEventListener("scroll",s.update,passive)}),h&&g.removeEventListener("resize",s.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(i){return i.replace(/left|right|bottom|top/g,function(e){return hash$1[e]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(i){return i.replace(/start|end/g,function(e){return hash[e]})}function getWindowScroll(i){var e=getWindow(i),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function getWindowScrollBarX(i){return getBoundingClientRect(getDocumentElement(i)).left+getWindowScroll(i).scrollLeft}function getViewportRect(i,e){var s=getWindow(i),o=getDocumentElement(i),a=s.visualViewport,c=o.clientWidth,d=o.clientHeight,h=0,g=0;if(a){c=a.width,d=a.height;var _=isLayoutViewport();(_||!_&&e==="fixed")&&(h=a.offsetLeft,g=a.offsetTop)}return{width:c,height:d,x:h+getWindowScrollBarX(i),y:g}}function getDocumentRect(i){var e,s=getDocumentElement(i),o=getWindowScroll(i),a=(e=i.ownerDocument)==null?void 0:e.body,c=max(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),d=max(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),h=-o.scrollLeft+getWindowScrollBarX(i),g=-o.scrollTop;return getComputedStyle(a||s).direction==="rtl"&&(h+=max(s.clientWidth,a?a.clientWidth:0)-c),{width:c,height:d,x:h,y:g}}function isScrollParent(i){var e=getComputedStyle(i),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function getScrollParent(i){return["html","body","#document"].indexOf(getNodeName(i))>=0?i.ownerDocument.body:isHTMLElement(i)&&isScrollParent(i)?i:getScrollParent(getParentNode(i))}function listScrollParents(i,e){var s;e===void 0&&(e=[]);var o=getScrollParent(i),a=o===((s=i.ownerDocument)==null?void 0:s.body),c=getWindow(o),d=a?[c].concat(c.visualViewport||[],isScrollParent(o)?o:[]):o,h=e.concat(d);return a?h:h.concat(listScrollParents(getParentNode(d)))}function rectToClientRect(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function getInnerBoundingClientRect(i,e){var s=getBoundingClientRect(i,!1,e==="fixed");return s.top=s.top+i.clientTop,s.left=s.left+i.clientLeft,s.bottom=s.top+i.clientHeight,s.right=s.left+i.clientWidth,s.width=i.clientWidth,s.height=i.clientHeight,s.x=s.left,s.y=s.top,s}function getClientRectFromMixedType(i,e,s){return e===viewport?rectToClientRect(getViewportRect(i,s)):isElement(e)?getInnerBoundingClientRect(e,s):rectToClientRect(getDocumentRect(getDocumentElement(i)))}function getClippingParents(i){var e=listScrollParents(getParentNode(i)),s=["absolute","fixed"].indexOf(getComputedStyle(i).position)>=0,o=s&&isHTMLElement(i)?getOffsetParent(i):i;return isElement(o)?e.filter(function(a){return isElement(a)&&contains$1(a,o)&&getNodeName(a)!=="body"}):[]}function getClippingRect(i,e,s,o){var a=e==="clippingParents"?getClippingParents(i):[].concat(e),c=[].concat(a,[s]),d=c[0],h=c.reduce(function(g,_){var ft=getClientRectFromMixedType(i,_,o);return g.top=max(ft.top,g.top),g.right=min(ft.right,g.right),g.bottom=min(ft.bottom,g.bottom),g.left=max(ft.left,g.left),g},getClientRectFromMixedType(i,d,o));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function computeOffsets(i){var e=i.reference,s=i.element,o=i.placement,a=o?getBasePlacement(o):null,c=o?getVariation(o):null,d=e.x+e.width/2-s.width/2,h=e.y+e.height/2-s.height/2,g;switch(a){case top:g={x:d,y:e.y-s.height};break;case bottom:g={x:d,y:e.y+e.height};break;case right:g={x:e.x+e.width,y:h};break;case left:g={x:e.x-s.width,y:h};break;default:g={x:e.x,y:e.y}}var _=a?getMainAxisFromPlacement(a):null;if(_!=null){var ft=_==="y"?"height":"width";switch(c){case start$1:g[_]=g[_]-(e[ft]/2-s[ft]/2);break;case end:g[_]=g[_]+(e[ft]/2-s[ft]/2);break}}return g}function detectOverflow(i,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?i.placement:o,c=s.strategy,d=c===void 0?i.strategy:c,h=s.boundary,g=h===void 0?clippingParents:h,_=s.rootBoundary,ft=_===void 0?viewport:_,_t=s.elementContext,$t=_t===void 0?popper:_t,Mt=s.altBoundary,Ft=Mt===void 0?!1:Mt,Ol=s.padding,Vl=Ol===void 0?0:Ol,Nl=mergePaddingObject(typeof Vl!="number"?Vl:expandToHashMap(Vl,basePlacements)),xl=$t===popper?reference:popper,Ml=i.rects.popper,Su=i.elements[Ft?xl:$t],_d=getClippingRect(isElement(Su)?Su:Su.contextElement||getDocumentElement(i.elements.popper),g,ft,d),ep=getBoundingClientRect(i.elements.reference),tp=computeOffsets({reference:ep,element:Ml,strategy:"absolute",placement:a}),np=rectToClientRect(Object.assign({},Ml,tp)),op=$t===popper?np:ep,rp={top:_d.top-op.top+Nl.top,bottom:op.bottom-_d.bottom+Nl.bottom,left:_d.left-op.left+Nl.left,right:op.right-_d.right+Nl.right},ap=i.modifiersData.offset;if($t===popper&&ap){var up=ap[a];Object.keys(rp).forEach(function(dp){var hp=[right,bottom].indexOf(dp)>=0?1:-1,fp=[top,bottom].indexOf(dp)>=0?"y":"x";rp[dp]+=up[fp]*hp})}return rp}function computeAutoPlacement(i,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,c=s.rootBoundary,d=s.padding,h=s.flipVariations,g=s.allowedAutoPlacements,_=g===void 0?placements:g,ft=getVariation(o),_t=ft?h?variationPlacements:variationPlacements.filter(function(Ft){return getVariation(Ft)===ft}):basePlacements,$t=_t.filter(function(Ft){return _.indexOf(Ft)>=0});$t.length===0&&($t=_t);var Mt=$t.reduce(function(Ft,Ol){return Ft[Ol]=detectOverflow(i,{placement:Ol,boundary:a,rootBoundary:c,padding:d})[getBasePlacement(Ol)],Ft},{});return Object.keys(Mt).sort(function(Ft,Ol){return Mt[Ft]-Mt[Ol]})}function getExpandedFallbackPlacements(i){if(getBasePlacement(i)===auto)return[];var e=getOppositePlacement(i);return[getOppositeVariationPlacement(i),e,getOppositeVariationPlacement(e)]}function flip(i){var e=i.state,s=i.options,o=i.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,c=a===void 0?!0:a,d=s.altAxis,h=d===void 0?!0:d,g=s.fallbackPlacements,_=s.padding,ft=s.boundary,_t=s.rootBoundary,$t=s.altBoundary,Mt=s.flipVariations,Ft=Mt===void 0?!0:Mt,Ol=s.allowedAutoPlacements,Vl=e.options.placement,Nl=getBasePlacement(Vl),xl=Nl===Vl,Ml=g||(xl||!Ft?[getOppositePlacement(Vl)]:getExpandedFallbackPlacements(Vl)),Su=[Vl].concat(Ml).reduce(function(_p,vp){return _p.concat(getBasePlacement(vp)===auto?computeAutoPlacement(e,{placement:vp,boundary:ft,rootBoundary:_t,padding:_,flipVariations:Ft,allowedAutoPlacements:Ol}):vp)},[]),_d=e.rects.reference,ep=e.rects.popper,tp=new Map,np=!0,op=Su[0],rp=0;rp<Su.length;rp++){var ap=Su[rp],up=getBasePlacement(ap),dp=getVariation(ap)===start$1,hp=[top,bottom].indexOf(up)>=0,fp=hp?"width":"height",gp=detectOverflow(e,{placement:ap,boundary:ft,rootBoundary:_t,altBoundary:$t,padding:_}),pp=hp?dp?right:left:dp?bottom:top;_d[fp]>ep[fp]&&(pp=getOppositePlacement(pp));var sp=getOppositePlacement(pp),lp=[];if(c&&lp.push(gp[up]<=0),h&&lp.push(gp[pp]<=0,gp[sp]<=0),lp.every(function(_p){return _p})){op=ap,np=!1;break}tp.set(ap,lp)}if(np)for(var ip=Ft?3:1,cp=function(vp){var Ep=Su.find(function($p){var Tp=tp.get($p);if(Tp)return Tp.slice(0,vp).every(function(Ip){return Ip})});if(Ep)return op=Ep,"break"},mp=ip;mp>0;mp--){var wp=cp(mp);if(wp==="break")break}e.placement!==op&&(e.modifiersData[o]._skip=!0,e.placement=op,e.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(i,e,s){return s===void 0&&(s={x:0,y:0}),{top:i.top-e.height-s.y,right:i.right-e.width+s.x,bottom:i.bottom-e.height+s.y,left:i.left-e.width-s.x}}function isAnySideFullyClipped(i){return[top,right,bottom,left].some(function(e){return i[e]>=0})}function hide(i){var e=i.state,s=i.name,o=e.rects.reference,a=e.rects.popper,c=e.modifiersData.preventOverflow,d=detectOverflow(e,{elementContext:"reference"}),h=detectOverflow(e,{altBoundary:!0}),g=getSideOffsets(d,o),_=getSideOffsets(h,a,c),ft=isAnySideFullyClipped(g),_t=isAnySideFullyClipped(_);e.modifiersData[s]={referenceClippingOffsets:g,popperEscapeOffsets:_,isReferenceHidden:ft,hasPopperEscaped:_t},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":ft,"data-popper-escaped":_t})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(i,e,s){var o=getBasePlacement(i),a=[left,top].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:i})):s,d=c[0],h=c[1];return d=d||0,h=(h||0)*a,[left,right].indexOf(o)>=0?{x:h,y:d}:{x:d,y:h}}function offset(i){var e=i.state,s=i.options,o=i.name,a=s.offset,c=a===void 0?[0,0]:a,d=placements.reduce(function(ft,_t){return ft[_t]=distanceAndSkiddingToXY(_t,e.rects,c),ft},{}),h=d[e.placement],g=h.x,_=h.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=g,e.modifiersData.popperOffsets.y+=_),e.modifiersData[o]=d}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(i){var e=i.state,s=i.name;e.modifiersData[s]=computeOffsets({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(i){return i==="x"?"y":"x"}function preventOverflow(i){var e=i.state,s=i.options,o=i.name,a=s.mainAxis,c=a===void 0?!0:a,d=s.altAxis,h=d===void 0?!1:d,g=s.boundary,_=s.rootBoundary,ft=s.altBoundary,_t=s.padding,$t=s.tether,Mt=$t===void 0?!0:$t,Ft=s.tetherOffset,Ol=Ft===void 0?0:Ft,Vl=detectOverflow(e,{boundary:g,rootBoundary:_,padding:_t,altBoundary:ft}),Nl=getBasePlacement(e.placement),xl=getVariation(e.placement),Ml=!xl,Su=getMainAxisFromPlacement(Nl),_d=getAltAxis(Su),ep=e.modifiersData.popperOffsets,tp=e.rects.reference,np=e.rects.popper,op=typeof Ol=="function"?Ol(Object.assign({},e.rects,{placement:e.placement})):Ol,rp=typeof op=="number"?{mainAxis:op,altAxis:op}:Object.assign({mainAxis:0,altAxis:0},op),ap=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,up={x:0,y:0};if(ep){if(c){var dp,hp=Su==="y"?top:left,fp=Su==="y"?bottom:right,gp=Su==="y"?"height":"width",pp=ep[Su],sp=pp+Vl[hp],lp=pp-Vl[fp],ip=Mt?-np[gp]/2:0,cp=xl===start$1?tp[gp]:np[gp],mp=xl===start$1?-np[gp]:-tp[gp],wp=e.elements.arrow,_p=Mt&&wp?getLayoutRect(wp):{width:0,height:0},vp=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:getFreshSideObject(),Ep=vp[hp],$p=vp[fp],Tp=within(0,tp[gp],_p[gp]),Ip=Ml?tp[gp]/2-ip-Tp-Ep-rp.mainAxis:cp-Tp-Ep-rp.mainAxis,Pp=Ml?-tp[gp]/2+ip+Tp+$p+rp.mainAxis:mp+Tp+$p+rp.mainAxis,Rp=e.elements.arrow&&getOffsetParent(e.elements.arrow),Ap=Rp?Su==="y"?Rp.clientTop||0:Rp.clientLeft||0:0,Sp=(dp=ap==null?void 0:ap[Su])!=null?dp:0,yp=pp+Ip-Sp-Ap,Hp=pp+Pp-Sp,Lp=within(Mt?min(sp,yp):sp,pp,Mt?max(lp,Hp):lp);ep[Su]=Lp,up[Su]=Lp-pp}if(h){var Fp,qp=Su==="x"?top:left,zp=Su==="x"?bottom:right,bp=ep[_d],kp=_d==="y"?"height":"width",Up=bp+Vl[qp],Bp=bp-Vl[zp],Op=[top,left].indexOf(Nl)!==-1,jp=(Fp=ap==null?void 0:ap[_d])!=null?Fp:0,Vp=Op?Up:bp-tp[kp]-np[kp]-jp+rp.altAxis,Wp=Op?bp+tp[kp]+np[kp]-jp-rp.altAxis:Bp,Gp=Mt&&Op?withinMaxClamp(Vp,bp,Wp):within(Mt?Vp:Up,bp,Mt?Wp:Bp);ep[_d]=Gp,up[_d]=Gp-bp}e.modifiersData[o]=up}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function getNodeScroll(i){return i===getWindow(i)||!isHTMLElement(i)?getWindowScroll(i):getHTMLElementScroll(i)}function isElementScaled(i){var e=i.getBoundingClientRect(),s=round(e.width)/i.offsetWidth||1,o=round(e.height)/i.offsetHeight||1;return s!==1||o!==1}function getCompositeRect(i,e,s){s===void 0&&(s=!1);var o=isHTMLElement(e),a=isHTMLElement(e)&&isElementScaled(e),c=getDocumentElement(e),d=getBoundingClientRect(i,a,s),h={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(o||!o&&!s)&&((getNodeName(e)!=="body"||isScrollParent(c))&&(h=getNodeScroll(e)),isHTMLElement(e)?(g=getBoundingClientRect(e,!0),g.x+=e.clientLeft,g.y+=e.clientTop):c&&(g.x=getWindowScrollBarX(c))),{x:d.left+h.scrollLeft-g.x,y:d.top+h.scrollTop-g.y,width:d.width,height:d.height}}function order(i){var e=new Map,s=new Set,o=[];i.forEach(function(c){e.set(c.name,c)});function a(c){s.add(c.name);var d=[].concat(c.requires||[],c.requiresIfExists||[]);d.forEach(function(h){if(!s.has(h)){var g=e.get(h);g&&a(g)}}),o.push(c)}return i.forEach(function(c){s.has(c.name)||a(c)}),o}function orderModifiers(i){var e=order(i);return modifierPhases.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function debounce(i){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(i())})})),e}}function mergeByName(i){var e=i.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function popperGenerator(i){i===void 0&&(i={});var e=i,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,c=a===void 0?DEFAULT_OPTIONS:a;return function(h,g,_){_===void 0&&(_=c);var ft={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,c),modifiersData:{},elements:{reference:h,popper:g},attributes:{},styles:{}},_t=[],$t=!1,Mt={state:ft,setOptions:function(Nl){var xl=typeof Nl=="function"?Nl(ft.options):Nl;Ol(),ft.options=Object.assign({},c,ft.options,xl),ft.scrollParents={reference:isElement(h)?listScrollParents(h):h.contextElement?listScrollParents(h.contextElement):[],popper:listScrollParents(g)};var Ml=orderModifiers(mergeByName([].concat(o,ft.options.modifiers)));return ft.orderedModifiers=Ml.filter(function(Su){return Su.enabled}),Ft(),Mt.update()},forceUpdate:function(){if(!$t){var Nl=ft.elements,xl=Nl.reference,Ml=Nl.popper;if(areValidElements(xl,Ml)){ft.rects={reference:getCompositeRect(xl,getOffsetParent(Ml),ft.options.strategy==="fixed"),popper:getLayoutRect(Ml)},ft.reset=!1,ft.placement=ft.options.placement,ft.orderedModifiers.forEach(function(rp){return ft.modifiersData[rp.name]=Object.assign({},rp.data)});for(var Su=0;Su<ft.orderedModifiers.length;Su++){if(ft.reset===!0){ft.reset=!1,Su=-1;continue}var _d=ft.orderedModifiers[Su],ep=_d.fn,tp=_d.options,np=tp===void 0?{}:tp,op=_d.name;typeof ep=="function"&&(ft=ep({state:ft,options:np,name:op,instance:Mt})||ft)}}}},update:debounce(function(){return new Promise(function(Vl){Mt.forceUpdate(),Vl(ft)})}),destroy:function(){Ol(),$t=!0}};if(!areValidElements(h,g))return Mt;Mt.setOptions(_).then(function(Vl){!$t&&_.onFirstUpdate&&_.onFirstUpdate(Vl)});function Ft(){ft.orderedModifiers.forEach(function(Vl){var Nl=Vl.name,xl=Vl.options,Ml=xl===void 0?{}:xl,Su=Vl.effect;if(typeof Su=="function"){var _d=Su({state:ft,name:Nl,instance:Mt,options:Ml}),ep=function(){};_t.push(_d||ep)}})}function Ol(){_t.forEach(function(Vl){return Vl()}),_t=[]}return Mt}}const createPopper=popperGenerator({defaultModifiers:[hide$1,popperOffsets$1,computeStyles$1,eventListeners,offset$1,flip$1,preventOverflow$1,arrow$1]}),_excluded$2=["enabled","placement","strategy","modifiers"];function _objectWithoutPropertiesLoose$3(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}const disabledApplyStylesModifier={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},ariaDescribedByModifier={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:i})=>()=>{const{reference:e,popper:s}=i.elements;if("removeAttribute"in e){const o=(e.getAttribute("aria-describedby")||"").split(",").filter(a=>a.trim()!==s.id);o.length?e.setAttribute("aria-describedby",o.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:i})=>{var e;const{popper:s,reference:o}=i.elements,a=(e=s.getAttribute("role"))==null?void 0:e.toLowerCase();if(s.id&&a==="tooltip"&&"setAttribute"in o){const c=o.getAttribute("aria-describedby");if(c&&c.split(",").indexOf(s.id)!==-1)return;o.setAttribute("aria-describedby",c?`${c},${s.id}`:s.id)}}},EMPTY_MODIFIERS=[];function usePopper(i,e,s={}){let{enabled:o=!0,placement:a="bottom",strategy:c="absolute",modifiers:d=EMPTY_MODIFIERS}=s,h=_objectWithoutPropertiesLoose$3(s,_excluded$2);const g=reactExports.useRef(d),_=reactExports.useRef(),ft=reactExports.useCallback(()=>{var Vl;(Vl=_.current)==null||Vl.update()},[]),_t=reactExports.useCallback(()=>{var Vl;(Vl=_.current)==null||Vl.forceUpdate()},[]),[$t,Mt]=useSafeState(reactExports.useState({placement:a,update:ft,forceUpdate:_t,attributes:{},styles:{popper:{},arrow:{}}})),Ft=reactExports.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:Vl})=>{const Nl={},xl={};Object.keys(Vl.elements).forEach(Ml=>{Nl[Ml]=Vl.styles[Ml],xl[Ml]=Vl.attributes[Ml]}),Mt({state:Vl,styles:Nl,attributes:xl,update:ft,forceUpdate:_t,placement:Vl.placement})}}),[ft,_t,Mt]),Ol=reactExports.useMemo(()=>(dequal(g.current,d)||(g.current=d),g.current),[d]);return reactExports.useEffect(()=>{!_.current||!o||_.current.setOptions({placement:a,strategy:c,modifiers:[...Ol,Ft,disabledApplyStylesModifier]})},[c,a,Ft,o,Ol]),reactExports.useEffect(()=>{if(!(!o||i==null||e==null))return _.current=createPopper(i,e,Object.assign({},h,{placement:a,strategy:c,modifiers:[...Ol,ariaDescribedByModifier,Ft]})),()=>{_.current!=null&&(_.current.destroy(),_.current=void 0,Mt(Vl=>Object.assign({},Vl,{attributes:{},styles:{popper:{}}})))}},[o,i,e]),$t}const noop$4=()=>{};function isLeftClickEvent(i){return i.button===0}function isModifiedEvent(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}const getRefTarget=i=>i&&("current"in i?i.current:i),InitialTriggerEvents={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function useClickOutside(i,e=noop$4,{disabled:s,clickTrigger:o="click"}={}){const a=reactExports.useRef(!1),c=reactExports.useRef(!1),d=reactExports.useCallback(_=>{const ft=getRefTarget(i);a.current=!ft||isModifiedEvent(_)||!isLeftClickEvent(_)||!!contains$2(ft,_.target)||c.current,c.current=!1},[i]),h=useEventCallback(_=>{const ft=getRefTarget(i);ft&&contains$2(ft,_.target)&&(c.current=!0)}),g=useEventCallback(_=>{a.current||e(_)});reactExports.useEffect(()=>{if(s||i==null)return;const _=ownerDocument(getRefTarget(i));let ft=(_.defaultView||window).event,_t=null;InitialTriggerEvents[o]&&(_t=listen(_,InitialTriggerEvents[o],h,!0));const $t=listen(_,o,d,!0),Mt=listen(_,o,Ol=>{if(Ol===ft){ft=void 0;return}g(Ol)});let Ft=[];return"ontouchstart"in _.documentElement&&(Ft=[].slice.call(_.body.children).map(Ol=>listen(Ol,"mousemove",noop$4))),()=>{_t==null||_t(),$t(),Mt(),Ft.forEach(Ol=>Ol())}},[i,s,o,d,h,g])}function toModifierMap(i){const e={};return Array.isArray(i)?(i==null||i.forEach(s=>{e[s.name]=s}),e):i||e}function toModifierArray(i={}){return Array.isArray(i)?i:Object.keys(i).map(e=>(i[e].name=e,i[e]))}function mergeOptionsWithPopperConfig({enabled:i,enableEvents:e,placement:s,flip:o,offset:a,fixed:c,containerPadding:d,arrowElement:h,popperConfig:g={}}){var _,ft,_t,$t,Mt;const Ft=toModifierMap(g.modifiers);return Object.assign({},g,{placement:s,enabled:i,strategy:c?"fixed":g.strategy,modifiers:toModifierArray(Object.assign({},Ft,{eventListeners:{enabled:e,options:(_=Ft.eventListeners)==null?void 0:_.options},preventOverflow:Object.assign({},Ft.preventOverflow,{options:d?Object.assign({padding:d},(ft=Ft.preventOverflow)==null?void 0:ft.options):(_t=Ft.preventOverflow)==null?void 0:_t.options}),offset:{options:Object.assign({offset:a},($t=Ft.offset)==null?void 0:$t.options)},arrow:Object.assign({},Ft.arrow,{enabled:!!h,options:Object.assign({},(Mt=Ft.arrow)==null?void 0:Mt.options,{element:h})}),flip:Object.assign({enabled:!!o},Ft.flip)}))})}const _excluded$1=["children"];function _objectWithoutPropertiesLoose$2(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}const noop$3=()=>{};function useDropdownMenu(i={}){const e=reactExports.useContext(DropdownContext$1),[s,o]=useCallbackRef(),a=reactExports.useRef(!1),{flip:c,offset:d,rootCloseEvent:h,fixed:g=!1,placement:_,popperConfig:ft={},enableEventListeners:_t=!0,usePopper:$t=!!e}=i,Mt=(e==null?void 0:e.show)==null?!!i.show:e.show;Mt&&!a.current&&(a.current=!0);const Ft=ep=>{e==null||e.toggle(!1,ep)},{placement:Ol,setMenu:Vl,menuElement:Nl,toggleElement:xl}=e||{},Ml=usePopper(xl,Nl,mergeOptionsWithPopperConfig({placement:_||Ol||"bottom-start",enabled:$t,enableEvents:_t??Mt,offset:d,flip:c,fixed:g,arrowElement:s,popperConfig:ft})),Su=Object.assign({ref:Vl||noop$3,"aria-labelledby":xl==null?void 0:xl.id},Ml.attributes.popper,{style:Ml.styles.popper}),_d={show:Mt,placement:Ol,hasShown:a.current,toggle:e==null?void 0:e.toggle,popper:$t?Ml:null,arrowProps:$t?Object.assign({ref:o},Ml.attributes.arrow,{style:Ml.styles.arrow}):{}};return useClickOutside(Nl,Ft,{clickTrigger:h,disabled:!Mt}),[Su,_d]}const defaultProps$2={usePopper:!0};function DropdownMenu$1(i){let{children:e}=i,s=_objectWithoutPropertiesLoose$2(i,_excluded$1);const[o,a]=useDropdownMenu(s);return jsx(Fragment,{children:e(o,a)})}DropdownMenu$1.displayName="DropdownMenu";DropdownMenu$1.defaultProps=defaultProps$2;const $704cf1d3b684cc5c$var$defaultContext={prefix:String(Math.round(Math.random()*1e10)),current:0},$704cf1d3b684cc5c$var$SSRContext=React.createContext($704cf1d3b684cc5c$var$defaultContext);let $704cf1d3b684cc5c$var$canUseDOM=Boolean(typeof window<"u"&&window.document&&window.document.createElement);function $704cf1d3b684cc5c$export$619500959fc48b26(i){let e=reactExports.useContext($704cf1d3b684cc5c$var$SSRContext);return e===$704cf1d3b684cc5c$var$defaultContext&&!$704cf1d3b684cc5c$var$canUseDOM&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server."),reactExports.useMemo(()=>i||`react-aria${e.prefix}-${++e.current}`,[i])}const isRoleMenu=i=>{var e;return((e=i.getAttribute("role"))==null?void 0:e.toLowerCase())==="menu"},noop$2=()=>{};function useDropdownToggle(){const i=$704cf1d3b684cc5c$export$619500959fc48b26(),{show:e=!1,toggle:s=noop$2,setToggle:o,menuElement:a}=reactExports.useContext(DropdownContext$1)||{},c=reactExports.useCallback(h=>{s(!e,h)},[e,s]),d={id:i,ref:o||noop$2,onClick:c,"aria-expanded":!!e};return a&&isRoleMenu(a)&&(d["aria-haspopup"]=!0),[d,{show:e,toggle:s}]}function DropdownToggle$1({children:i}){const[e,s]=useDropdownToggle();return jsx(Fragment,{children:i(e,s)})}DropdownToggle$1.displayName="DropdownToggle";const _excluded=["eventKey","disabled","onClick","active","as"];function _objectWithoutPropertiesLoose$1(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function useDropdownItem({key:i,href:e,active:s,disabled:o,onClick:a}){const c=reactExports.useContext(SelectableContext),d=reactExports.useContext(NavContext),{activeKey:h}=d||{},g=makeEventKey(i,e),_=s==null&&i!=null?makeEventKey(h)===g:s;return[{onClick:useEventCallback(_t=>{o||(a==null||a(_t),c&&!_t.isPropagationStopped()&&c(g,_t))}),"aria-disabled":o||void 0,"aria-selected":_,[dataAttr("dropdown-item")]:""},{isActive:_}]}const DropdownItem$1=reactExports.forwardRef((i,e)=>{let{eventKey:s,disabled:o,onClick:a,active:c,as:d=Button$1}=i,h=_objectWithoutPropertiesLoose$1(i,_excluded);const[g]=useDropdownItem({key:s,href:h.href,disabled:o,onClick:a,active:c});return jsx(d,Object.assign({},h,{ref:e},g))});DropdownItem$1.displayName="DropdownItem";function useRefWithUpdate(){const i=useForceUpdate(),e=reactExports.useRef(null),s=reactExports.useCallback(o=>{e.current=o,i()},[i]);return[e,s]}function Dropdown$2({defaultShow:i,show:e,onSelect:s,onToggle:o,itemSelector:a=`* [${dataAttr("dropdown-item")}]`,focusFirstItemOnShow:c,placement:d="bottom-start",children:h}){const g=useWindow(),[_,ft]=useUncontrolledProp(e,i,o),[_t,$t]=useRefWithUpdate(),Mt=_t.current,[Ft,Ol]=useRefWithUpdate(),Vl=Ft.current,Nl=usePrevious$1(_),xl=reactExports.useRef(null),Ml=reactExports.useRef(!1),Su=reactExports.useContext(SelectableContext),_d=reactExports.useCallback((ap,up,dp=up==null?void 0:up.type)=>{ft(ap,{originalEvent:up,source:dp})},[ft]),ep=useEventCallback((ap,up)=>{s==null||s(ap,up),_d(!1,up,"select"),up.isPropagationStopped()||Su==null||Su(ap,up)}),tp=reactExports.useMemo(()=>({toggle:_d,placement:d,show:_,menuElement:Mt,toggleElement:Vl,setMenu:$t,setToggle:Ol}),[_d,d,_,Mt,Vl,$t,Ol]);Mt&&Nl&&!_&&(Ml.current=Mt.contains(Mt.ownerDocument.activeElement));const np=useEventCallback(()=>{Vl&&Vl.focus&&Vl.focus()}),op=useEventCallback(()=>{const ap=xl.current;let up=c;if(up==null&&(up=_t.current&&isRoleMenu(_t.current)?"keyboard":!1),up===!1||up==="keyboard"&&!/^key.+$/.test(ap))return;const dp=qsa(_t.current,a)[0];dp&&dp.focus&&dp.focus()});reactExports.useEffect(()=>{_?op():Ml.current&&(Ml.current=!1,np())},[_,Ml,np,op]),reactExports.useEffect(()=>{xl.current=null});const rp=(ap,up)=>{if(!_t.current)return null;const dp=qsa(_t.current,a);let hp=dp.indexOf(ap)+up;return hp=Math.max(0,Math.min(hp,dp.length)),dp[hp]};return useEventListener(reactExports.useCallback(()=>g.document,[g]),"keydown",ap=>{var up,dp;const{key:hp}=ap,fp=ap.target,gp=(up=_t.current)==null?void 0:up.contains(fp),pp=(dp=Ft.current)==null?void 0:dp.contains(fp);if(/input|textarea/i.test(fp.tagName)&&(hp===" "||hp!=="Escape"&&gp||hp==="Escape"&&fp.type==="search")||!gp&&!pp||hp==="Tab"&&(!_t.current||!_))return;xl.current=ap.type;const lp={originalEvent:ap,source:ap.type};switch(hp){case"ArrowUp":{const ip=rp(fp,-1);ip&&ip.focus&&ip.focus(),ap.preventDefault();return}case"ArrowDown":if(ap.preventDefault(),!_)ft(!0,lp);else{const ip=rp(fp,1);ip&&ip.focus&&ip.focus()}return;case"Tab":addEventListener$1(fp.ownerDocument,"keyup",ip=>{var cp;(ip.key==="Tab"&&!ip.target||!((cp=_t.current)!=null&&cp.contains(ip.target)))&&ft(!1,lp)},{once:!0});break;case"Escape":hp==="Escape"&&(ap.preventDefault(),ap.stopPropagation()),ft(!1,lp);break}}),jsx(SelectableContext.Provider,{value:ep,children:jsx(DropdownContext$1.Provider,{value:tp,children:h})})}Dropdown$2.displayName="Dropdown";Dropdown$2.Menu=DropdownMenu$1;Dropdown$2.Toggle=DropdownToggle$1;Dropdown$2.Item=DropdownItem$1;const DropdownContext=reactExports.createContext({});DropdownContext.displayName="DropdownContext";const DropdownItem=reactExports.forwardRef(({bsPrefix:i,className:e,eventKey:s,disabled:o=!1,onClick:a,active:c,as:d=Anchor,...h},g)=>{const _=useBootstrapPrefix(i,"dropdown-item"),[ft,_t]=useDropdownItem({key:s,href:h.href,disabled:o,onClick:a,active:c});return jsx(d,{...h,...ft,ref:g,className:classNames(e,_,_t.isActive&&"active",o&&"disabled")})});DropdownItem.displayName="DropdownItem";const context=reactExports.createContext(null);context.displayName="InputGroupContext";function useWrappedRefWithWarning(i,e){return i}const alignDirection=propTypesExports.oneOf(["start","end"]);propTypesExports.oneOfType([alignDirection,propTypesExports.shape({sm:alignDirection}),propTypesExports.shape({md:alignDirection}),propTypesExports.shape({lg:alignDirection}),propTypesExports.shape({xl:alignDirection}),propTypesExports.shape({xxl:alignDirection}),propTypesExports.object]);const defaultProps$1={flip:!0};function getDropdownMenuPlacement(i,e,s){const o=s?"top-end":"top-start",a=s?"top-start":"top-end",c=s?"bottom-end":"bottom-start",d=s?"bottom-start":"bottom-end",h=s?"right-start":"left-start",g=s?"right-end":"left-end",_=s?"left-start":"right-start",ft=s?"left-end":"right-end";let _t=i?d:c;return e==="up"?_t=i?a:o:e==="end"?_t=i?ft:_:e==="start"?_t=i?g:h:e==="down-centered"?_t="bottom":e==="up-centered"&&(_t="top"),_t}const DropdownMenu=reactExports.forwardRef(({bsPrefix:i,className:e,align:s,rootCloseEvent:o,flip:a,show:c,renderOnMount:d,as:h="div",popperConfig:g,variant:_,...ft},_t)=>{let $t=!1;const Mt=reactExports.useContext(context$2),Ft=useBootstrapPrefix(i,"dropdown-menu"),{align:Ol,drop:Vl,isRTL:Nl}=reactExports.useContext(DropdownContext);s=s||Ol;const xl=reactExports.useContext(context),Ml=[];if(s)if(typeof s=="object"){const ap=Object.keys(s);if(ap.length){const up=ap[0],dp=s[up];$t=dp==="start",Ml.push(`${Ft}-${up}-${dp}`)}}else s==="end"&&($t=!0);const Su=getDropdownMenuPlacement($t,Vl,Nl),[_d,{hasShown:ep,popper:tp,show:np,toggle:op}]=useDropdownMenu({flip:a,rootCloseEvent:o,show:c,usePopper:!Mt&&Ml.length===0,offset:[0,2],popperConfig:g,placement:Su});if(_d.ref=useMergedRefs(useWrappedRefWithWarning(_t),_d.ref),useIsomorphicEffect(()=>{np&&(tp==null||tp.update())},[np]),!ep&&!d&&!xl)return null;typeof h!="string"&&(_d.show=np,_d.close=()=>op==null?void 0:op(!1),_d.align=s);let rp=ft.style;return tp!=null&&tp.placement&&(rp={...ft.style,..._d.style},ft["x-placement"]=tp.placement),jsx(h,{...ft,..._d,style:rp,...(Ml.length||Mt)&&{"data-bs-popper":"static"},className:classNames(e,Ft,np&&"show",$t&&`${Ft}-end`,_&&`${Ft}-${_}`,...Ml)})});DropdownMenu.displayName="DropdownMenu";DropdownMenu.defaultProps=defaultProps$1;const DropdownToggle=reactExports.forwardRef(({bsPrefix:i,split:e,className:s,childBsPrefix:o,as:a=Button,...c},d)=>{const h=useBootstrapPrefix(i,"dropdown-toggle"),g=reactExports.useContext(DropdownContext$1);o!==void 0&&(c.bsPrefix=o);const[_]=useDropdownToggle();return _.ref=useMergedRefs(_.ref,useWrappedRefWithWarning(d)),jsx(a,{className:classNames(s,h,e&&`${h}-split`,(g==null?void 0:g.show)&&"show"),..._,...c})});DropdownToggle.displayName="DropdownToggle";const DropdownHeader=createWithBsPrefix("dropdown-header",{defaultProps:{role:"heading"}}),DropdownDivider=createWithBsPrefix("dropdown-divider",{Component:"hr",defaultProps:{role:"separator"}}),DropdownItemText=createWithBsPrefix("dropdown-item-text",{Component:"span"}),defaultProps={navbar:!1,align:"start",autoClose:!0,drop:"down"},Dropdown=reactExports.forwardRef((i,e)=>{const{bsPrefix:s,drop:o,show:a,className:c,align:d,onSelect:h,onToggle:g,focusFirstItemOnShow:_,as:ft="div",navbar:_t,autoClose:$t,...Mt}=useUncontrolled(i,{show:"onToggle"}),Ft=reactExports.useContext(context),Ol=useBootstrapPrefix(s,"dropdown"),Vl=useIsRTL(),Nl=tp=>$t===!1?tp==="click":$t==="inside"?tp!=="rootClose":$t==="outside"?tp!=="select":!0,xl=useEventCallback((tp,np)=>{np.originalEvent.currentTarget===document&&(np.source!=="keydown"||np.originalEvent.key==="Escape")&&(np.source="rootClose"),Nl(np.source)&&(g==null||g(tp,np))}),Su=getDropdownMenuPlacement(d==="end",o,Vl),_d=reactExports.useMemo(()=>({align:d,drop:o,isRTL:Vl}),[d,o,Vl]),ep={down:Ol,"down-centered":`${Ol}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return jsx(DropdownContext.Provider,{value:_d,children:jsx(Dropdown$2,{placement:Su,show:a,onSelect:h,onToggle:xl,focusFirstItemOnShow:_,itemSelector:`.${Ol}-item:not(.disabled):not(:disabled)`,children:Ft?Mt.children:jsx(ft,{...Mt,ref:e,className:classNames(c,a&&"show",ep[o])})})})});Dropdown.displayName="Dropdown";Dropdown.defaultProps=defaultProps;const Dropdown$1=Object.assign(Dropdown,{Toggle:DropdownToggle,Menu:DropdownMenu,Item:DropdownItem,ItemText:DropdownItemText,Divider:DropdownDivider,Header:DropdownHeader}),NavDropdown=reactExports.forwardRef(({id:i,title:e,children:s,bsPrefix:o,className:a,rootCloseEvent:c,menuRole:d,disabled:h,active:g,renderMenuOnMount:_,menuVariant:ft,..._t},$t)=>{const Mt=useBootstrapPrefix(void 0,"nav-item");return jsxs(Dropdown$1,{ref:$t,..._t,className:classNames(a,Mt),children:[jsx(Dropdown$1.Toggle,{id:i,eventKey:null,active:g,disabled:h,childBsPrefix:o,as:NavLink,children:e}),jsx(Dropdown$1.Menu,{role:d,renderOnMount:_,rootCloseEvent:c,variant:ft,children:s})]})});NavDropdown.displayName="NavDropdown";Object.assign(NavDropdown,{Item:Dropdown$1.Item,ItemText:Dropdown$1.ItemText,Divider:Dropdown$1.Divider,Header:Dropdown$1.Header});const logo="/assets/logo-5db259d6.png",Header=()=>jsx(Navbar$1,{expand:"lg",children:jsxs(Container,{fluid:!0,children:[jsx("img",{src:logo,alt:"Logo",width:"60px"}),jsx(Navbar$1.Brand,{href:"#",style:{color:"#bcb9b9"},className:"logoName",children:"Deep Challenge"}),jsx(Navbar$1.Toggle,{"aria-controls":"navbarScroll"}),jsxs(Navbar$1.Collapse,{id:"navbarScroll",children:[jsxs(Nav$1,{className:"me-auto my-2 my-lg-0 navItems",style:{maxHeight:"100px"},navbarScroll:!0,children:[jsx(Nav$1.Link,{href:"/Home",style:{color:"#bcb9b9"},children:"Home"}),jsx(Nav$1.Link,{href:"/Register",style:{color:"#bcb9b9"},children:"Register"}),jsx(Nav$1.Link,{href:"/Tracks",style:{color:"#bcb9b9"},children:"Tracks"}),jsx(Nav$1.Link,{href:"/Challenges",style:{color:"#bcb9b9"},children:"Challenges"})]}),jsxs(Form$1,{className:"d-flex",children:[jsx(Form$1.Control,{type:"search",placeholder:"Looking for something?",className:"me-2","aria-label":"Search"}),jsx(Button,{variant:"outline-secondary",style:{color:"#bcb9b9"},children:"Search"})]})]})]})}),Home$1="",Home=()=>jsxs("div",{className:"homeContainer",children:[jsx("h1",{className:"homeTitle",children:"Welcome to Web Development Interactive Learning"}),jsx("p",{className:"homeDescription",children:"Our website is designed to help you learn web development in an interactive and engaging way. With a focus on hands-on coding exercises, you'll be able to put your knowledge into practice and build real projects."}),jsx("h2",{className:"homeSubtitle",children:"What You'll Learn"}),jsxs("ul",{className:"homeList",children:[jsx("li",{children:"HTML, CSS, and JavaScript basics"}),jsx("li",{children:"Responsive design and layout"}),jsx("li",{children:"React and other front-end frameworks"}),jsx("li",{children:"Backend development with Node.js and Express"}),jsx("li",{children:"Database management with MongoDB"})]}),jsx("p",{className:"homeDescription",children:"Whether you're a beginner just starting out, or an experienced developer looking to expand your skills, our comprehensive curriculum has you covered. Our interactive lessons and projects are designed to challenge you and keep you engaged as you progress through the course material."}),jsx("h2",{className:"homeSubtitle",children:"Get Started Today"}),jsx("p",{className:"homeDescription",children:"Sign up now and start learning web development with us. With new lessons and projects added regularly, you'll never run out of new things to learn and build. Join the thousands of students who have already transformed their careers and built the websites of their dreams."}),jsx(Link,{to:"/register",children:jsx("button",{className:"homeButton",children:"Sign Up"})})]}),Html="",HTMLContent=[{id:1,title:"HTML Lesson 1: Introduction to HTML",content:"HTML stands for HyperText Markup Language and is used to create the structure and content of a web page. HTML uses tags to define the different elements on a page, such as headings, paragraphs, and lists."},{id:2,title:"HTML Lesson 2: Creating a Simple HTML Page",content:"To create a simple HTML page, you need to start with a basic structure that includes the following tags: <html>, <head>, and <body>. The <html> tag is the root element of the page and contains all the other elements. The <head> section is used for metadata, such as the title of the page, and the <body> section is where you put the actual content of the page."},{id:3,title:"HTML Lesson 3: HTML Headings",content:"HTML headings are used to create different levels of headings for your content. The headings are defined using the <h1> to <h6> tags, with <h1> being the highest level heading and <h6> being the lowest. It is recommended to use headings in a hierarchical manner to create a proper structure for your content."}],Page=({currentPage:i})=>jsxs("div",{className:"html-content",children:[jsx("h2",{children:HTMLContent[i].title}),jsx("p",{children:HTMLContent[i].content})]}),HTMLSlider=()=>{const[i,e]=reactExports.useState(0);return jsxs("div",{className:"html-slider",children:[jsx(Page,{currentPage:i}),jsx("button",{onClick:()=>{i>0&&e(i-1)},disabled:i===0,children:"Prev"}),jsx("button",{onClick:()=>{i<HTMLContent.length-1&&e(i+1)},disabled:i===HTMLContent.length-1,children:"Next"})]})};function _defineProperty$1(i,e,s){return e in i?Object.defineProperty(i,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[e]=s,i}function ownKeys$1(i,e){var s=Object.keys(i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),s.push.apply(s,o)}return s}function _objectSpread2$1(i){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$1(Object(s),!0).forEach(function(o){_defineProperty$1(i,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):ownKeys$1(Object(s)).forEach(function(o){Object.defineProperty(i,o,Object.getOwnPropertyDescriptor(s,o))})}return i}function _objectWithoutPropertiesLoose(i,e){if(i==null)return{};var s={},o=Object.keys(i),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(s[a]=i[a]);return s}function _objectWithoutProperties(i,e){if(i==null)return{};var s=_objectWithoutPropertiesLoose(i,e),o,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(i);for(a=0;a<c.length;a++)o=c[a],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(i,o)&&(s[o]=i[o])}return s}function _slicedToArray(i,e){return _arrayWithHoles(i)||_iterableToArrayLimit(i,e)||_unsupportedIterableToArray(i,e)||_nonIterableRest()}function _arrayWithHoles(i){if(Array.isArray(i))return i}function _iterableToArrayLimit(i,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var s=[],o=!0,a=!1,c=void 0;try{for(var d=i[Symbol.iterator](),h;!(o=(h=d.next()).done)&&(s.push(h.value),!(e&&s.length===e));o=!0);}catch(g){a=!0,c=g}finally{try{!o&&d.return!=null&&d.return()}finally{if(a)throw c}}return s}}function _unsupportedIterableToArray(i,e){if(i){if(typeof i=="string")return _arrayLikeToArray(i,e);var s=Object.prototype.toString.call(i).slice(8,-1);if(s==="Object"&&i.constructor&&(s=i.constructor.name),s==="Map"||s==="Set")return Array.from(i);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _arrayLikeToArray(i,e)}}function _arrayLikeToArray(i,e){(e==null||e>i.length)&&(e=i.length);for(var s=0,o=new Array(e);s<e;s++)o[s]=i[s];return o}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _defineProperty(i,e,s){return e in i?Object.defineProperty(i,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[e]=s,i}function ownKeys(i,e){var s=Object.keys(i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),s.push.apply(s,o)}return s}function _objectSpread2(i){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(s),!0).forEach(function(o){_defineProperty(i,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(o){Object.defineProperty(i,o,Object.getOwnPropertyDescriptor(s,o))})}return i}function compose$1(){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];return function(o){return e.reduceRight(function(a,c){return c(a)},o)}}function curry$1(i){return function e(){for(var s=this,o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return a.length>=i.length?i.apply(this,a):function(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];return e.apply(s,[].concat(a,h))}}}function isObject$2(i){return{}.toString.call(i).includes("Object")}function isEmpty$1(i){return!Object.keys(i).length}function isFunction$1(i){return typeof i=="function"}function hasOwnProperty(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function validateChanges(i,e){return isObject$2(e)||errorHandler$1("changeType"),Object.keys(e).some(function(s){return!hasOwnProperty(i,s)})&&errorHandler$1("changeField"),e}function validateSelector(i){isFunction$1(i)||errorHandler$1("selectorType")}function validateHandler(i){isFunction$1(i)||isObject$2(i)||errorHandler$1("handlerType"),isObject$2(i)&&Object.values(i).some(function(e){return!isFunction$1(e)})&&errorHandler$1("handlersType")}function validateInitial(i){i||errorHandler$1("initialIsRequired"),isObject$2(i)||errorHandler$1("initialType"),isEmpty$1(i)&&errorHandler$1("initialContent")}function throwError$1(i,e){throw new Error(i[e]||i.default)}var errorMessages$1={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},errorHandler$1=curry$1(throwError$1)(errorMessages$1),validators$1={changes:validateChanges,selector:validateSelector,handler:validateHandler,initial:validateInitial};function create(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};validators$1.initial(i),validators$1.handler(e);var s={current:i},o=curry$1(didStateUpdate)(s,e),a=curry$1(updateState)(s),c=curry$1(validators$1.changes)(i),d=curry$1(extractChanges)(s);function h(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(ft){return ft};return validators$1.selector(_),_(s.current)}function g(_){compose$1(o,a,c,d)(_)}return[h,g]}function extractChanges(i,e){return isFunction$1(e)?e(i.current):e}function updateState(i,e){return i.current=_objectSpread2(_objectSpread2({},i.current),e),e}function didStateUpdate(i,e,s){return isFunction$1(e)?e(i.current):Object.keys(s).forEach(function(o){var a;return(a=e[o])===null||a===void 0?void 0:a.call(e,i.current[o])}),s}var index$1={create},config$1={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.33.0/min/vs"}};function curry(i){return function e(){for(var s=this,o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return a.length>=i.length?i.apply(this,a):function(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];return e.apply(s,[].concat(a,h))}}}function isObject$1(i){return{}.toString.call(i).includes("Object")}function validateConfig(i){return i||errorHandler("configIsRequired"),isObject$1(i)||errorHandler("configType"),i.urls?(informAboutDeprecation(),{paths:{vs:i.urls.monacoBase}}):i}function informAboutDeprecation(){console.warn(errorMessages.deprecation)}function throwError(i,e){throw new Error(i[e]||i.default)}var errorMessages={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},errorHandler=curry(throwError)(errorMessages),validators={config:validateConfig},compose=function(){for(var e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];return function(a){return s.reduceRight(function(c,d){return d(c)},a)}};function merge(i,e){return Object.keys(e).forEach(function(s){e[s]instanceof Object&&i[s]&&Object.assign(e[s],merge(i[s],e[s]))}),_objectSpread2$1(_objectSpread2$1({},i),e)}var CANCELATION_MESSAGE={type:"cancelation",msg:"operation is manually canceled"};function makeCancelable(i){var e=!1,s=new Promise(function(o,a){i.then(function(c){return e?a(CANCELATION_MESSAGE):o(c)}),i.catch(a)});return s.cancel=function(){return e=!0},s}var _state$create=index$1.create({config:config$1,isInitialized:!1,resolve:null,reject:null,monaco:null}),_state$create2=_slicedToArray(_state$create,2),getState=_state$create2[0],setState=_state$create2[1];function config(i){var e=validators.config(i),s=e.monaco,o=_objectWithoutProperties(e,["monaco"]);setState(function(a){return{config:merge(a.config,o),monaco:s}})}function init(){var i=getState(function(e){var s=e.monaco,o=e.isInitialized,a=e.resolve;return{monaco:s,isInitialized:o,resolve:a}});if(!i.isInitialized){if(setState({isInitialized:!0}),i.monaco)return i.resolve(i.monaco),makeCancelable(wrapperPromise);if(window.monaco&&window.monaco.editor)return storeMonacoInstance(window.monaco),i.resolve(window.monaco),makeCancelable(wrapperPromise);compose(injectScripts,getMonacoLoaderScript)(configureLoader)}return makeCancelable(wrapperPromise)}function injectScripts(i){return document.body.appendChild(i)}function createScript(i){var e=document.createElement("script");return i&&(e.src=i),e}function getMonacoLoaderScript(i){var e=getState(function(o){var a=o.config,c=o.reject;return{config:a,reject:c}}),s=createScript("".concat(e.config.paths.vs,"/loader.js"));return s.onload=function(){return i()},s.onerror=e.reject,s}function configureLoader(){var i=getState(function(s){var o=s.config,a=s.resolve,c=s.reject;return{config:o,resolve:a,reject:c}}),e=window.require;e.config(i.config),e(["vs/editor/editor.main"],function(s){storeMonacoInstance(s),i.resolve(s)},function(s){i.reject(s)})}function storeMonacoInstance(i){getState().monaco||setState({monaco:i})}function __getMonacoInstance(){return getState(function(i){var e=i.monaco;return e})}var wrapperPromise=new Promise(function(i,e){return setState({resolve:i,reject:e})}),loader={config,init,__getMonacoInstance};function _extends(){return _extends=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i},_extends.apply(this,arguments)}const loadingStyles={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};function Loading({content:i}){return React.createElement("div",{style:loadingStyles},i)}const styles={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function MonacoContainer$1({width:i,height:e,isEditorReady:s,loading:o,_ref:a,className:c,wrapperProps:d}){return React.createElement("section",_extends({style:{...styles.wrapper,width:i,height:e}},d),!s&&React.createElement(Loading,{content:o}),React.createElement("div",{ref:a,style:{...styles.fullWidth,...!s&&styles.hide},className:c}))}MonacoContainer$1.propTypes={width:propTypesExports.oneOfType([propTypesExports.number,propTypesExports.string]).isRequired,height:propTypesExports.oneOfType([propTypesExports.number,propTypesExports.string]).isRequired,loading:propTypesExports.oneOfType([propTypesExports.element,propTypesExports.string]).isRequired,isEditorReady:propTypesExports.bool.isRequired,className:propTypesExports.string,wrapperProps:propTypesExports.object};var MonacoContainer=reactExports.memo(MonacoContainer$1);function useMount(i){reactExports.useEffect(i,[])}function useUpdate(i,e,s=!0){const o=reactExports.useRef(!0);reactExports.useEffect(o.current||!s?()=>{o.current=!1}:i,e)}function noop$1(){}function getOrCreateModel(i,e,s,o){return getModel(i,o)||createModel(i,e,s,o)}function getModel(i,e){return i.editor.getModel(createModelUri(i,e))}function createModel(i,e,s,o){return i.editor.createModel(e,s,o&&createModelUri(i,o))}function createModelUri(i,e){return i.Uri.parse(e)}function isUndefined(i){return i===void 0}function DiffEditor({original:i,modified:e,language:s,originalLanguage:o,modifiedLanguage:a,originalModelPath:c,modifiedModelPath:d,keepCurrentOriginalModel:h,keepCurrentModifiedModel:g,theme:_,loading:ft,options:_t,height:$t,width:Mt,className:Ft,wrapperProps:Ol,beforeMount:Vl,onMount:Nl}){const[xl,Ml]=reactExports.useState(!1),[Su,_d]=reactExports.useState(!0),ep=reactExports.useRef(null),tp=reactExports.useRef(null),np=reactExports.useRef(null),op=reactExports.useRef(Nl),rp=reactExports.useRef(Vl);useMount(()=>{const hp=loader.init();return hp.then(fp=>(tp.current=fp)&&_d(!1)).catch(fp=>(fp==null?void 0:fp.type)!=="cancelation"&&console.error("Monaco initialization: error:",fp)),()=>ep.current?dp():hp.cancel()}),useUpdate(()=>{const hp=ep.current.getModifiedEditor();hp.getOption(tp.current.editor.EditorOption.readOnly)?hp.setValue(e):e!==hp.getValue()&&(hp.executeEdits("",[{range:hp.getModel().getFullModelRange(),text:e,forceMoveMarkers:!0}]),hp.pushUndoStop())},[e],xl),useUpdate(()=>{ep.current.getModel().original.setValue(i)},[i],xl),useUpdate(()=>{const{original:hp,modified:fp}=ep.current.getModel();tp.current.editor.setModelLanguage(hp,o||s),tp.current.editor.setModelLanguage(fp,a||s)},[s,o,a],xl),useUpdate(()=>{tp.current.editor.setTheme(_)},[_],xl),useUpdate(()=>{ep.current.updateOptions(_t)},[_t],xl);const ap=reactExports.useCallback(()=>{rp.current(tp.current);const hp=getOrCreateModel(tp.current,i,o||s,c),fp=getOrCreateModel(tp.current,e,a||s,d);ep.current.setModel({original:hp,modified:fp})},[s,e,a,i,o,c,d]),up=reactExports.useCallback(()=>{ep.current=tp.current.editor.createDiffEditor(np.current,{automaticLayout:!0,..._t}),ap(),tp.current.editor.setTheme(_),Ml(!0)},[_t,_,ap]);reactExports.useEffect(()=>{xl&&op.current(ep.current,tp.current)},[xl]),reactExports.useEffect(()=>{!Su&&!xl&&up()},[Su,xl,up]);function dp(){const hp=ep.current.getModel();if(!h){var fp;(fp=hp.original)===null||fp===void 0||fp.dispose()}if(!g){var gp;(gp=hp.modified)===null||gp===void 0||gp.dispose()}ep.current.dispose()}return React.createElement(MonacoContainer,{width:Mt,height:$t,isEditorReady:xl,loading:ft,_ref:np,className:Ft,wrapperProps:Ol})}DiffEditor.propTypes={original:propTypesExports.string,modified:propTypesExports.string,language:propTypesExports.string,originalLanguage:propTypesExports.string,modifiedLanguage:propTypesExports.string,originalModelPath:propTypesExports.string,modifiedModelPath:propTypesExports.string,keepCurrentOriginalModel:propTypesExports.bool,keepCurrentModifiedModel:propTypesExports.bool,theme:propTypesExports.string,loading:propTypesExports.oneOfType([propTypesExports.element,propTypesExports.string]),options:propTypesExports.object,width:propTypesExports.oneOfType([propTypesExports.number,propTypesExports.string]),height:propTypesExports.oneOfType([propTypesExports.number,propTypesExports.string]),className:propTypesExports.string,wrapperProps:propTypesExports.object,beforeMount:propTypesExports.func,onMount:propTypesExports.func};DiffEditor.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:noop$1,onMount:noop$1};function usePrevious(i){const e=reactExports.useRef();return reactExports.useEffect(()=>{e.current=i},[i]),e.current}const viewStates=new Map;function Editor({defaultValue:i,defaultLanguage:e,defaultPath:s,value:o,language:a,path:c,theme:d,line:h,loading:g,options:_,overrideServices:ft,saveViewState:_t,keepCurrentModel:$t,width:Mt,height:Ft,className:Ol,wrapperProps:Vl,beforeMount:Nl,onMount:xl,onChange:Ml,onValidate:Su}){const[_d,ep]=reactExports.useState(!1),[tp,np]=reactExports.useState(!0),op=reactExports.useRef(null),rp=reactExports.useRef(null),ap=reactExports.useRef(null),up=reactExports.useRef(xl),dp=reactExports.useRef(Nl),hp=reactExports.useRef(null),fp=reactExports.useRef(o),gp=usePrevious(c),pp=reactExports.useRef(!1);useMount(()=>{const ip=loader.init();return ip.then(cp=>(op.current=cp)&&np(!1)).catch(cp=>(cp==null?void 0:cp.type)!=="cancelation"&&console.error("Monaco initialization: error:",cp)),()=>rp.current?lp():ip.cancel()}),useUpdate(()=>{const ip=getOrCreateModel(op.current,i||o,e||a,c);ip!==rp.current.getModel()&&(_t&&viewStates.set(gp,rp.current.saveViewState()),rp.current.setModel(ip),_t&&rp.current.restoreViewState(viewStates.get(c)))},[c],_d),useUpdate(()=>{rp.current.updateOptions(_)},[_],_d),useUpdate(()=>{rp.current.getOption(op.current.editor.EditorOption.readOnly)?rp.current.setValue(o):o!==rp.current.getValue()&&(rp.current.executeEdits("",[{range:rp.current.getModel().getFullModelRange(),text:o,forceMoveMarkers:!0}]),rp.current.pushUndoStop())},[o],_d),useUpdate(()=>{op.current.editor.setModelLanguage(rp.current.getModel(),a)},[a],_d),useUpdate(()=>{isUndefined(h)||rp.current.revealLine(h)},[h],_d),useUpdate(()=>{op.current.editor.setTheme(d)},[d],_d);const sp=reactExports.useCallback(()=>{if(!pp.current){dp.current(op.current);const ip=c||s,cp=getOrCreateModel(op.current,o||i,e||a,ip);rp.current=op.current.editor.create(ap.current,{model:cp,automaticLayout:!0,..._},ft),_t&&rp.current.restoreViewState(viewStates.get(ip)),op.current.editor.setTheme(d),ep(!0),pp.current=!0}},[i,e,s,o,a,c,_,ft,_t,d]);reactExports.useEffect(()=>{_d&&up.current(rp.current,op.current)},[_d]),reactExports.useEffect(()=>{!tp&&!_d&&sp()},[tp,_d,sp]),fp.current=o,reactExports.useEffect(()=>{if(_d&&Ml){var ip,cp;(ip=hp.current)===null||ip===void 0||ip.dispose(),hp.current=(cp=rp.current)===null||cp===void 0?void 0:cp.onDidChangeModelContent(mp=>{Ml(rp.current.getValue(),mp)})}},[_d,Ml]),reactExports.useEffect(()=>{if(_d){const ip=op.current.editor.onDidChangeMarkers(cp=>{var mp;const wp=(mp=rp.current.getModel())===null||mp===void 0?void 0:mp.uri;if(wp&&cp.find(vp=>vp.path===wp.path)){const vp=op.current.editor.getModelMarkers({resource:wp});Su==null||Su(vp)}});return()=>{ip==null||ip.dispose()}}},[_d,Su]);function lp(){var ip;if((ip=hp.current)===null||ip===void 0||ip.dispose(),$t)_t&&viewStates.set(c,rp.current.saveViewState());else{var cp;(cp=rp.current.getModel())===null||cp===void 0||cp.dispose()}rp.current.dispose()}return React.createElement(MonacoContainer,{width:Mt,height:Ft,isEditorReady:_d,loading:g,_ref:ap,className:Ol,wrapperProps:Vl})}Editor.propTypes={defaultValue:propTypesExports.string,defaultPath:propTypesExports.string,defaultLanguage:propTypesExports.string,value:propTypesExports.string,language:propTypesExports.string,path:propTypesExports.string,theme:propTypesExports.string,line:propTypesExports.number,loading:propTypesExports.oneOfType([propTypesExports.element,propTypesExports.string]),options:propTypesExports.object,overrideServices:propTypesExports.object,saveViewState:propTypesExports.bool,keepCurrentModel:propTypesExports.bool,width:propTypesExports.oneOfType([propTypesExports.number,propTypesExports.string]),height:propTypesExports.oneOfType([propTypesExports.number,propTypesExports.string]),className:propTypesExports.string,wrapperProps:propTypesExports.object,beforeMount:propTypesExports.func,onMount:propTypesExports.func,onChange:propTypesExports.func,onValidate:propTypesExports.func};Editor.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:noop$1,onMount:noop$1,onValidate:noop$1};var index=reactExports.memo(Editor);const OnlineIDE=()=>{reactExports.useState([]);const[code,setCode]=reactExports.useState("const test;"),[output,setOutput]=reactExports.useState(""),handleCodeChange=i=>{setCode(i)},handleRunClick=()=>{try{const result=eval(code);setOutput(JSON.stringify(result,null,2))}catch(i){setOutput(i.message)}};return jsxs("div",{style:{display:"flex"},children:[jsxs("div",{style:{width:"33%",height:""},children:[jsx("h2",{children:"Courses"}),jsx(HTMLSlider,{})]}),jsxs("div",{style:{width:"33%"},children:[jsx("h2",{children:"Editor"}),jsx(index,{width:"100%",height:"100vh",defaultLanguage:"javascript",value:code,onChange:handleCodeChange,theme:"vs-dark"}),jsx("button",{onClick:handleRunClick,children:"Run"})]}),jsxs("div",{style:{width:"33%"},children:[jsx("h2",{children:"Output"}),jsx("pre",{children:output})]})]})},RoomForm=({roomName:i,setRoomName:e,onSubmit:s})=>jsxs("form",{className:"RoomForm",onSubmit:a=>{a.preventDefault(),s(i)},children:[jsx("input",{className:"RoomForm__input",type:"text",value:i,onChange:a=>e(a.target.value),placeholder:"Room name"}),jsx("button",{type:"submit",children:"Create room"})]}),Room=({room:i,joinRoom:e,startChallenge:s})=>jsxs("div",{className:"Room",children:[jsx("h2",{children:`${i.participant1.name}'s Room`}),i.participant2?jsx("h3",{children:`Participant 2: ${i.participant2.name}`}):jsx("button",{onClick:e,children:"Join Room"}),i.participant2&&jsx("button",{onClick:s,children:"Start Challenge"})]}),Challenge=({room:i,endChallenge:e})=>{const[s,o]=reactExports.useState(null),a=()=>{o(i.participant1.name),e()};return jsxs("div",{className:"Challenge",children:[jsx("h2",{children:"Challenge in Progress"}),jsx("p",{children:`${i.participant1.name} vs. ${i.participant2.name}`}),jsx("button",{onClick:a,children:"End Challenge"}),s&&jsx("h3",{children:`The winner is: ${s}`})]})},Challenges="",RoomChallengeApp=()=>{const[i,e]=reactExports.useState(null),[s,o]=reactExports.useState(!1),[a,c]=reactExports.useState(null),[d,h]=reactExports.useState(null),[g,_]=reactExports.useState(""),ft=Ft=>{e({name:Ft,participants:[],problem:`function add(a, b) {
        return a + b;
      }`})};return jsxs("div",{className:"RoomChallengeApp",children:[jsx(RoomForm,{roomName:g,setRoomName:_,onSubmit:ft}),i===null&&!s&&jsx(RoomForm,{onSubmit:ft}),i!==null&&!s&&jsx(Room,{room:i,joinRoom:Ft=>{c(Ft)},startChallenge:()=>{o(!0)}}),s&&jsx(Challenge,{room:i,endChallenge:Ft=>{o(!1),h(Ft)},setWinner:h}),d&&jsx("div",{className:"Winner",children:jsxs("h2",{children:["The winner is: ",d.name]})})]})},Register="";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const assert=function(i,e){if(!i)throw assertionError(e)},assertionError=function(i){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+i)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(i){const e=[];let s=0;for(let o=0;o<i.length;o++){let a=i.charCodeAt(o);a<128?e[s++]=a:a<2048?(e[s++]=a>>6|192,e[s++]=a&63|128):(a&64512)===55296&&o+1<i.length&&(i.charCodeAt(o+1)&64512)===56320?(a=65536+((a&1023)<<10)+(i.charCodeAt(++o)&1023),e[s++]=a>>18|240,e[s++]=a>>12&63|128,e[s++]=a>>6&63|128,e[s++]=a&63|128):(e[s++]=a>>12|224,e[s++]=a>>6&63|128,e[s++]=a&63|128)}return e},byteArrayToString=function(i){const e=[];let s=0,o=0;for(;s<i.length;){const a=i[s++];if(a<128)e[o++]=String.fromCharCode(a);else if(a>191&&a<224){const c=i[s++];e[o++]=String.fromCharCode((a&31)<<6|c&63)}else if(a>239&&a<365){const c=i[s++],d=i[s++],h=i[s++],g=((a&7)<<18|(c&63)<<12|(d&63)<<6|h&63)-65536;e[o++]=String.fromCharCode(55296+(g>>10)),e[o++]=String.fromCharCode(56320+(g&1023))}else{const c=i[s++],d=i[s++];e[o++]=String.fromCharCode((a&15)<<12|(c&63)<<6|d&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let a=0;a<i.length;a+=3){const c=i[a],d=a+1<i.length,h=d?i[a+1]:0,g=a+2<i.length,_=g?i[a+2]:0,ft=c>>2,_t=(c&3)<<4|h>>4;let $t=(h&15)<<2|_>>6,Mt=_&63;g||(Mt=64,d||($t=64)),o.push(s[ft],s[_t],s[$t],s[Mt])}return o.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(stringToByteArray$1(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):byteArrayToString(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let a=0;a<i.length;){const c=s[i.charAt(a++)],h=a<i.length?s[i.charAt(a)]:0;++a;const _=a<i.length?s[i.charAt(a)]:64;++a;const _t=a<i.length?s[i.charAt(a)]:64;if(++a,c==null||h==null||_==null||_t==null)throw new DecodeBase64StringError;const $t=c<<2|h>>4;if(o.push($t),_!==64){const Mt=h<<4&240|_>>2;if(o.push(Mt),_t!==64){const Ft=_<<6&192|_t;o.push(Ft)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(i){const e=stringToByteArray$1(i);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(i){return base64Encode(i).replace(/\./g,"")},base64Decode=function(i){try{return base64.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function deepCopy(i){return deepExtend(void 0,i)}function deepExtend(i,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const s=e;return new Date(s.getTime());case Object:i===void 0&&(i={});break;case Array:i=[];break;default:return e}for(const s in e)!e.hasOwnProperty(s)||!isValidKey$1(s)||(i[s]=deepExtend(i[s],e[s]));return i}function isValidKey$1(i){return i!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof process.env>"u")return;const i={}.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&base64Decode(i[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},getDefaultAppConfig=()=>{var i;return(i=getDefaults())===null||i===void 0?void 0:i.config},getExperimentalSetting=i=>{var e;return(e=getDefaults())===null||e===void 0?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,o)=>{s?this.reject(s):this.resolve(o),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,o))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},o=e||"demo-project",a=i.iat||0,c=i.sub||i.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${o}`,aud:o,iat:a,exp:a+3600,auth_time:a,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},i),h="";return[base64urlEncodeWithoutPadding(JSON.stringify(s)),base64urlEncodeWithoutPadding(JSON.stringify(d)),h].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){var i;const e=(i=getDefaults())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isBrowser(){return typeof self=="object"&&self.self===self}function isBrowserExtension(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const i=getUA();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function isNodeSdk(){return CONSTANTS.NODE_ADMIN===!0}function isSafari(){return!isNode()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((i,e)=>{try{let s=!0;const o="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(o);a.onsuccess=()=>{a.result.close(),s||self.indexedDB.deleteDatabase(o),i(!0)},a.onupgradeneeded=()=>{s=!1},a.onerror=()=>{var c;e(((c=a.error)===null||c===void 0?void 0:c.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,s,o){super(s),this.code=e,this.customData=o,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,s,o){this.service=e,this.serviceName=s,this.errors=o}create(e,...s){const o=s[0]||{},a=`${this.service}/${e}`,c=this.errors[e],d=c?replaceTemplate(c,o):"Error",h=`${this.serviceName}: ${d} (${a}).`;return new FirebaseError(a,h,o)}}function replaceTemplate(i,e){return i.replace(PATTERN,(s,o)=>{const a=e[o];return a!=null?String(a):`<${o}?>`})}const PATTERN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonEval(i){return JSON.parse(i)}function stringify(i){return JSON.stringify(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const decode=function(i){let e={},s={},o={},a="";try{const c=i.split(".");e=jsonEval(base64Decode(c[0])||""),s=jsonEval(base64Decode(c[1])||""),a=c[2],o=s.d||{},delete s.d}catch{}return{header:e,claims:s,data:o,signature:a}},isValidFormat=function(i){const e=decode(i),s=e.claims;return!!s&&typeof s=="object"&&s.hasOwnProperty("iat")},isAdmin=function(i){const e=decode(i).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function contains(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function safeGet(i,e){if(Object.prototype.hasOwnProperty.call(i,e))return i[e]}function isEmpty(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function map(i,e,s){const o={};for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(o[a]=e.call(s,i[a],a,i));return o}function deepEqual(i,e){if(i===e)return!0;const s=Object.keys(i),o=Object.keys(e);for(const a of s){if(!o.includes(a))return!1;const c=i[a],d=e[a];if(isObject(c)&&isObject(d)){if(!deepEqual(c,d))return!1}else if(c!==d)return!1}for(const a of o)if(!s.includes(a))return!1;return!0}function isObject(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(i){const e=[];for(const[s,o]of Object.entries(i))Array.isArray(o)?o.forEach(a=>{e.push(encodeURIComponent(s)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(s)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function querystringDecode(i){const e={};return i.replace(/^\?/,"").split("&").forEach(o=>{if(o){const[a,c]=o.split("=");e[decodeURIComponent(a)]=decodeURIComponent(c)}}),e}function extractQuerystring(i){const e=i.indexOf("?");if(!e)return"";const s=i.indexOf("#",e);return i.substring(e,s>0?s:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sha1{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,s){s||(s=0);const o=this.W_;if(typeof e=="string")for(let _t=0;_t<16;_t++)o[_t]=e.charCodeAt(s)<<24|e.charCodeAt(s+1)<<16|e.charCodeAt(s+2)<<8|e.charCodeAt(s+3),s+=4;else for(let _t=0;_t<16;_t++)o[_t]=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],s+=4;for(let _t=16;_t<80;_t++){const $t=o[_t-3]^o[_t-8]^o[_t-14]^o[_t-16];o[_t]=($t<<1|$t>>>31)&4294967295}let a=this.chain_[0],c=this.chain_[1],d=this.chain_[2],h=this.chain_[3],g=this.chain_[4],_,ft;for(let _t=0;_t<80;_t++){_t<40?_t<20?(_=h^c&(d^h),ft=1518500249):(_=c^d^h,ft=1859775393):_t<60?(_=c&d|h&(c|d),ft=2400959708):(_=c^d^h,ft=3395469782);const $t=(a<<5|a>>>27)+_+g+ft+o[_t]&4294967295;g=h,h=d,d=(c<<30|c>>>2)&4294967295,c=a,a=$t}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+d&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+g&4294967295}update(e,s){if(e==null)return;s===void 0&&(s=e.length);const o=s-this.blockSize;let a=0;const c=this.buf_;let d=this.inbuf_;for(;a<s;){if(d===0)for(;a<=o;)this.compress_(e,a),a+=this.blockSize;if(typeof e=="string"){for(;a<s;)if(c[d]=e.charCodeAt(a),++d,++a,d===this.blockSize){this.compress_(c),d=0;break}}else for(;a<s;)if(c[d]=e[a],++d,++a,d===this.blockSize){this.compress_(c),d=0;break}}this.inbuf_=d,this.total_+=s}digest(){const e=[];let s=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=s&255,s/=256;this.compress_(this.buf_);let o=0;for(let a=0;a<5;a++)for(let c=24;c>=0;c-=8)e[o]=this.chain_[a]>>c&255,++o;return e}}function createSubscribe(i,e){const s=new ObserverProxy(i,e);return s.subscribe.bind(s)}class ObserverProxy{constructor(e,s){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=s,this.task.then(()=>{e(this)}).catch(o=>{this.error(o)})}next(e){this.forEachObserver(s=>{s.next(e)})}error(e){this.forEachObserver(s=>{s.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,s,o){let a;if(e===void 0&&s===void 0&&o===void 0)throw new Error("Missing Observer.");implementsAnyMethods$1(e,["next","error","complete"])?a=e:a={next:e,error:s,complete:o},a.next===void 0&&(a.next=noop),a.error===void 0&&(a.error=noop),a.complete===void 0&&(a.complete=noop);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let s=0;s<this.observers.length;s++)this.sendOne(s,e)}sendOne(e,s){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{s(this.observers[e])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods$1(i,e){if(typeof i!="object"||i===null)return!1;for(const s of e)if(s in i&&typeof i[s]=="function")return!0;return!1}function noop(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const validateArgCount=function(i,e,s,o){let a;if(o<e?a="at least "+e:o>s&&(a=s===0?"none":"no more than "+s),a){const c=i+" failed: Was called with "+o+(o===1?" argument.":" arguments.")+" Expects "+a+".";throw new Error(c)}};function errorPrefix(i,e){return`${i} failed: ${e} argument `}function validateCallback(i,e,s,o){if(!(o&&!s)&&typeof s!="function")throw new Error(errorPrefix(i,e)+"must be a valid function.")}function validateContextObject(i,e,s,o){if(!(o&&!s)&&(typeof s!="object"||s===null))throw new Error(errorPrefix(i,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray=function(i){const e=[];let s=0;for(let o=0;o<i.length;o++){let a=i.charCodeAt(o);if(a>=55296&&a<=56319){const c=a-55296;o++,assert(o<i.length,"Surrogate pair missing trail surrogate.");const d=i.charCodeAt(o)-56320;a=65536+(c<<10)+d}a<128?e[s++]=a:a<2048?(e[s++]=a>>6|192,e[s++]=a&63|128):a<65536?(e[s++]=a>>12|224,e[s++]=a>>6&63|128,e[s++]=a&63|128):(e[s++]=a>>18|240,e[s++]=a>>12&63|128,e[s++]=a>>6&63|128,e[s++]=a&63|128)}return e},stringLength=function(i){let e=0;for(let s=0;s<i.length;s++){const o=i.charCodeAt(s);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,s++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(i){return i&&i._delegate?i._delegate:i}class Component{constructor(e,s,o){this.name=e,this.instanceFactory=s,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const o=new Deferred;if(this.instancesDeferred.set(s,o),this.isInitialized(s)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:s});a&&o.resolve(a)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){var s;const o=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(s=e==null?void 0:e.optional)!==null&&s!==void 0?s:!1;if(this.isInitialized(o)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:o})}catch(c){if(a)return null;throw c}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);try{const c=this.getOrInitializeService({instanceIdentifier:a});o.resolve(c)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:o,options:s});for(const[c,d]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(c);o===h&&d.resolve(a)}return a}onInit(e,s){var o;const a=this.normalizeInstanceIdentifier(s),c=(o=this.onInitCallbacks.get(a))!==null&&o!==void 0?o:new Set;c.add(e),this.onInitCallbacks.set(a,c);const d=this.instances.get(a);return d&&e(d,a),()=>{c.delete(e)}}invokeOnInitCallbacks(e,s){const o=this.onInitCallbacks.get(s);if(o)for(const a of o)try{a(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let o=this.instances.get(e);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:s}),this.instances.set(e,o),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(o,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,o)}catch{}return o||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(i){return i===DEFAULT_ENTRY_NAME$1?void 0:i}function isComponentEager(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new Provider(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instances=[];var LogLevel;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(i,e,...s)=>{if(e<i.logLevel)return;const o=new Date().toISOString(),a=ConsoleMethod[e];if(a)console[a](`[${o}]  ${i.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}function setLogLevel$2(i){instances.forEach(e=>{e.setLogLevel(i)})}function setUserLogHandler(i,e){for(const s of instances){let o=null;e&&e.level&&(o=levelStringToEnum[e.level]),i===null?s.userLogHandler=null:s.userLogHandler=(a,c,...d)=>{const h=d.map(g=>{if(g==null)return null;if(typeof g=="string")return g;if(typeof g=="number"||typeof g=="boolean")return g.toString();if(g instanceof Error)return g.message;try{return JSON.stringify(g)}catch{return null}}).filter(g=>g).join(" ");c>=(o??a.logLevel)&&i({level:LogLevel[c].toLowerCase(),message:h,args:d,type:a.name})}}}const instanceOfAny=(i,e)=>e.some(s=>i instanceof s);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(i){const e=new Promise((s,o)=>{const a=()=>{i.removeEventListener("success",c),i.removeEventListener("error",d)},c=()=>{s(wrap(i.result)),a()},d=()=>{o(i.error),a()};i.addEventListener("success",c),i.addEventListener("error",d)});return e.then(s=>{s instanceof IDBCursor&&cursorRequestMap.set(s,i)}).catch(()=>{}),reverseTransformCache.set(e,i),e}function cacheDonePromiseForTransaction(i){if(transactionDoneMap.has(i))return;const e=new Promise((s,o)=>{const a=()=>{i.removeEventListener("complete",c),i.removeEventListener("error",d),i.removeEventListener("abort",d)},c=()=>{s(),a()},d=()=>{o(i.error||new DOMException("AbortError","AbortError")),a()};i.addEventListener("complete",c),i.addEventListener("error",d),i.addEventListener("abort",d)});transactionDoneMap.set(i,e)}let idbProxyTraps={get(i,e,s){if(i instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(i);if(e==="objectStoreNames")return i.objectStoreNames||transactionStoreNamesMap.get(i);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return wrap(i[e])},set(i,e,s){return i[e]=s,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function replaceTraps(i){idbProxyTraps=i(idbProxyTraps)}function wrapFunction(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const o=i.call(unwrap$1(this),e,...s);return transactionStoreNamesMap.set(o,e.sort?e.sort():[e]),wrap(o)}:getCursorAdvanceMethods().includes(i)?function(...e){return i.apply(unwrap$1(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(i.apply(unwrap$1(this),e))}}function transformCachableValue(i){return typeof i=="function"?wrapFunction(i):(i instanceof IDBTransaction&&cacheDonePromiseForTransaction(i),instanceOfAny(i,getIdbProxyableTypes())?new Proxy(i,idbProxyTraps):i)}function wrap(i){if(i instanceof IDBRequest)return promisifyRequest(i);if(transformCache.has(i))return transformCache.get(i);const e=transformCachableValue(i);return e!==i&&(transformCache.set(i,e),reverseTransformCache.set(e,i)),e}const unwrap$1=i=>reverseTransformCache.get(i);function openDB(i,e,{blocked:s,upgrade:o,blocking:a,terminated:c}={}){const d=indexedDB.open(i,e),h=wrap(d);return o&&d.addEventListener("upgradeneeded",g=>{o(wrap(d.result),g.oldVersion,g.newVersion,wrap(d.transaction))}),s&&d.addEventListener("blocked",()=>s()),h.then(g=>{c&&g.addEventListener("close",()=>c()),a&&g.addEventListener("versionchange",()=>a())}).catch(()=>{}),h}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const s=e.replace(/FromIndex$/,""),o=e!==s,a=writeMethods.includes(s);if(!(s in(o?IDBIndex:IDBObjectStore).prototype)||!(a||readMethods.includes(s)))return;const c=async function(d,...h){const g=this.transaction(d,a?"readwrite":"readonly");let _=g.store;return o&&(_=_.index(h.shift())),(await Promise.all([_[s](...h),a&&g.done]))[0]};return cachedMethods.set(e,c),c}replaceTraps(i=>({...i,get:(e,s,o)=>getMethod(e,s)||i.get(e,s,o),has:(e,s)=>!!getMethod(e,s)||i.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(isVersionServiceProvider(s)){const o=s.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(s=>s).join(" ")}}function isVersionServiceProvider(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$o="@firebase/app",version$1$1="0.9.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$2=new Logger("@firebase/app"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8$1="@firebase/performance",name$7$1="@firebase/performance-compat",name$6$1="@firebase/remote-config",name$5$1="@firebase/remote-config-compat",name$4$1="@firebase/storage",name$3$1="@firebase/storage-compat",name$2$1="@firebase/firestore",name$1$1="@firebase/firestore-compat",name$p="firebase",version$9="9.17.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8$1]:"fire-perf",[name$7$1]:"fire-perf-compat",[name$6$1]:"fire-rc",[name$5$1]:"fire-rc-compat",[name$4$1]:"fire-gcs",[name$3$1]:"fire-gcs-compat",[name$2$1]:"fire-fst",[name$1$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_components=new Map;function _addComponent(i,e){try{i.container.addComponent(e)}catch(s){logger$2.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,s)}}function _addOrOverwriteComponent(i,e){i.container.addOrOverwriteComponent(e)}function _registerComponent(i){const e=i.name;if(_components.has(e))return logger$2.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,i);for(const s of _apps.values())_addComponent(s,i);return!0}function _getProvider(i,e){const s=i.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),i.container.getProvider(e)}function _removeServiceInstance(i,e,s=DEFAULT_ENTRY_NAME){_getProvider(i,e).clearInstance(s)}function _clearComponents(){_components.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS$1={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY$1=new ErrorFactory("app","Firebase",ERRORS$1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FirebaseAppImpl$1=class{constructor(e,s,o){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY$1.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION$1=version$9;function initializeApp(i,e={}){let s=i;typeof e!="object"&&(e={name:e});const o=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},e),a=o.name;if(typeof a!="string"||!a)throw ERROR_FACTORY$1.create("bad-app-name",{appName:String(a)});if(s||(s=getDefaultAppConfig()),!s)throw ERROR_FACTORY$1.create("no-options");const c=_apps.get(a);if(c){if(deepEqual(s,c.options)&&deepEqual(o,c.config))return c;throw ERROR_FACTORY$1.create("duplicate-app",{appName:a})}const d=new ComponentContainer(a);for(const g of _components.values())d.addComponent(g);const h=new FirebaseAppImpl$1(s,o,d);return _apps.set(a,h),h}function getApp(i=DEFAULT_ENTRY_NAME){const e=_apps.get(i);if(!e&&i===DEFAULT_ENTRY_NAME)return initializeApp();if(!e)throw ERROR_FACTORY$1.create("no-app",{appName:i});return e}function getApps(){return Array.from(_apps.values())}async function deleteApp(i){const e=i.name;_apps.has(e)&&(_apps.delete(e),await Promise.all(i.container.getProviders().map(s=>s.delete())),i.isDeleted=!0)}function registerVersion(i,e,s){var o;let a=(o=PLATFORM_LOG_STRING[i])!==null&&o!==void 0?o:i;s&&(a+=`-${s}`);const c=a.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const h=[`Unable to register library "${a}" with version "${e}":`];c&&h.push(`library name "${a}" contains illegal characters (whitespace or "/")`),c&&d&&h.push("and"),d&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger$2.warn(h.join(" "));return}_registerComponent(new Component(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}function onLog(i,e){if(i!==null&&typeof i!="function")throw ERROR_FACTORY$1.create("invalid-log-argument");setUserLogHandler(i,e)}function setLogLevel$1(i){setLogLevel$2(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(STORE_NAME)}}}).catch(i=>{throw ERROR_FACTORY$1.create("idb-open",{originalErrorMessage:i.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(i){try{return(await getDbPromise()).transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(i))}catch(e){if(e instanceof FirebaseError)logger$2.warn(e.message);else{const s=ERROR_FACTORY$1.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger$2.warn(s.message)}}}async function writeHeartbeatsToIndexedDB(i,e){try{const o=(await getDbPromise()).transaction(STORE_NAME,"readwrite");return await o.objectStore(STORE_NAME).put(e,computeKey(i)),o.done}catch(s){if(s instanceof FirebaseError)logger$2.warn(s.message);else{const o=ERROR_FACTORY$1.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});logger$2.warn(o.message)}}}function computeKey(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(s),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=getUTCDateString();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)))return this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=getUTCDateString(),{heartbeatsToSend:s,unsentEntries:o}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),a=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=e,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(i,e=MAX_HEADER_BYTES){const s=[];let o=i.slice();for(const a of i){const c=s.find(d=>d.agent===a.agent);if(c){if(c.dates.push(a.date),countBytes(s)>e){c.dates.pop();break}}else if(s.push({agent:a.agent,dates:[a.date]}),countBytes(s)>e){s.pop();break}o=o.slice(1)}return{heartbeatsToSend:s,unsentEntries:o}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var s;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(s=e.lastSentHeartbeatDate)!==null&&s!==void 0?s:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var s;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(s=e.lastSentHeartbeatDate)!==null&&s!==void 0?s:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function countBytes(i){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:i})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents$1(i){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$o,version$1$1,i),registerVersion(name$o,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents$1("");const modularAPIs=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError,SDK_VERSION:SDK_VERSION$1,_DEFAULT_ENTRY_NAME:DEFAULT_ENTRY_NAME,_addComponent,_addOrOverwriteComponent,_apps,_clearComponents,_components,_getProvider,_registerComponent,_removeServiceInstance,deleteApp,getApp,getApps,initializeApp,onLog,registerVersion,setLogLevel:setLogLevel$1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,s){this._delegate=e,this.firebase=s,_addComponent(e,new Component("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),deleteApp(this._delegate)))}_getService(e,s=DEFAULT_ENTRY_NAME){var o;this._delegate.checkDestroyed();const a=this._delegate.container.getProvider(e);return!a.isInitialized()&&((o=a.getComponent())===null||o===void 0?void 0:o.instantiationMode)==="EXPLICIT"&&a.initialize(),a.getImmediate({identifier:s})}_removeServiceInstance(e,s=DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(s)}_addComponent(e){_addComponent(this._delegate,e)}_addOrOverwriteComponent(e){_addOrOverwriteComponent(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},ERROR_FACTORY=new ErrorFactory("app-compat","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createFirebaseNamespaceCore(i){const e={},s={__esModule:!0,initializeApp:c,app:a,registerVersion,setLogLevel:setLogLevel$1,onLog,apps:null,SDK_VERSION:SDK_VERSION$1,INTERNAL:{registerComponent:h,removeApp:o,useAsService:g,modularAPIs}};s.default=s,Object.defineProperty(s,"apps",{get:d});function o(_){delete e[_]}function a(_){if(_=_||DEFAULT_ENTRY_NAME,!contains(e,_))throw ERROR_FACTORY.create("no-app",{appName:_});return e[_]}a.App=i;function c(_,ft={}){const _t=initializeApp(_,ft);if(contains(e,_t.name))return e[_t.name];const $t=new i(_t,s);return e[_t.name]=$t,$t}function d(){return Object.keys(e).map(_=>e[_])}function h(_){const ft=_.name,_t=ft.replace("-compat","");if(_registerComponent(_)&&_.type==="PUBLIC"){const $t=(Mt=a())=>{if(typeof Mt[_t]!="function")throw ERROR_FACTORY.create("invalid-app-argument",{appName:ft});return Mt[_t]()};_.serviceProps!==void 0&&deepExtend($t,_.serviceProps),s[_t]=$t,i.prototype[_t]=function(...Mt){return this._getService.bind(this,ft).apply(this,_.multipleInstances?Mt:[])}}return _.type==="PUBLIC"?s[_t]:null}function g(_,ft){return ft==="serverAuth"?null:ft}return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createFirebaseNamespace(){const i=createFirebaseNamespaceCore(FirebaseAppImpl);i.INTERNAL=Object.assign(Object.assign({},i.INTERNAL),{createFirebaseNamespace,extendNamespace:e,createSubscribe,ErrorFactory,deepExtend});function e(s){deepExtend(i,s)}return i}const firebase$1=createFirebaseNamespace();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$1=new Logger("@firebase/app-compat"),name$8="@firebase/app-compat",version$8="0.2.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(i){registerVersion(name$8,version$8,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(isBrowser()&&self.firebase!==void 0){logger$1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const i=self.firebase.SDK_VERSION;i&&i.indexOf("LITE")>=0&&logger$1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const firebase=firebase$1;registerCoreComponents();var name$7="firebase",version$7="9.17.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */firebase.registerVersion(name$7,version$7,"app-compat");function __rest(i,e){var s={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&e.indexOf(o)<0&&(s[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(i);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(i,o[a])&&(s[o[a]]=i[o[a]]);return s}const ProviderId={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ActionCodeOperation={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _debugErrorMap(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function _prodErrorMap(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const debugErrorMap=_debugErrorMap,prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$2=new Logger("@firebase/auth");function _logError(i,...e){logClient$2.logLevel<=LogLevel.ERROR&&logClient$2.error(`Auth (${SDK_VERSION$1}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(i,...e){throw createErrorInternal(i,...e)}function _createError(i,...e){return createErrorInternal(i,...e)}function _errorWithCustomMessage(i,e,s){const o=Object.assign(Object.assign({},prodErrorMap()),{[e]:s});return new ErrorFactory("auth","Firebase",o).create(e,{appName:i.name})}function _assertInstanceOf(i,e,s){const o=s;if(!(e instanceof o))throw o.name!==e.constructor.name&&_fail(i,"argument-error"),_errorWithCustomMessage(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function createErrorInternal(i,...e){if(typeof i!="string"){const s=e[0],o=[...e.slice(1)];return o[0]&&(o[0].appName=i.name),i._errorFactory.create(s,...o)}return _DEFAULT_AUTH_ERROR_FACTORY.create(i,...e)}function _assert$4(i,e,...s){if(!i)throw createErrorInternal(e,...s)}function debugFail(i){const e="INTERNAL ASSERTION FAILED: "+i;throw _logError(e),new Error(e)}function debugAssert(i,e){i||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(i){debugAssert(i instanceof Function,"Expected a class definition");let e=instanceCache.get(i);return e?(debugAssert(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,instanceCache.set(i,e),e)}function _initializeAuthInstance(i,e){const s=(e==null?void 0:e.persistence)||[],o=(Array.isArray(s)?s:[s]).map(_getInstance);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(o,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.href)||""}function _isHttpOrHttps$1(){return _getCurrentScheme$1()==="http:"||_getCurrentScheme$1()==="https:"}function _getCurrentScheme$1(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps$1()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,s){this.shortDelay=e,this.longDelay=s,debugAssert(s>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(i,e){debugAssert(i.emulator,"Emulator should always be set here");const{url:s}=i.emulator;return e?`${s}${e.startsWith("/")?e.slice(1):e}`:s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,s,o){this.fetchImpl=e,s&&(this.headersImpl=s),o&&(this.responseImpl=o)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(i,e){return i.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:i.tenantId}):e}async function _performApiRequest(i,e,s,o,a={}){return _performFetchWithErrorHandling(i,a,async()=>{let c={},d={};o&&(e==="GET"?d=o:c={body:JSON.stringify(o)});const h=querystring(Object.assign({key:i.config.apiKey},d)).slice(1),g=await i._getAdditionalHeaders();return g["Content-Type"]="application/json",i.languageCode&&(g["X-Firebase-Locale"]=i.languageCode),FetchProvider.fetch()(_getFinalTarget(i,i.config.apiHost,s,h),Object.assign({method:e,headers:g,referrerPolicy:"no-referrer"},c))})}async function _performFetchWithErrorHandling(i,e,s){i._canInitEmulator=!1;const o=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const a=new NetworkTimeout(i),c=await Promise.race([s(),a.promise]);a.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw _makeTaggedError(i,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const h=c.ok?d.errorMessage:d.error.message,[g,_]=h.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(i,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw _makeTaggedError(i,"email-already-in-use",d);if(g==="USER_DISABLED")throw _makeTaggedError(i,"user-disabled",d);const ft=o[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw _errorWithCustomMessage(i,ft,_);_fail(i,ft)}}catch(a){if(a instanceof FirebaseError)throw a;_fail(i,"internal-error",{message:String(a)})}}async function _performSignInRequest(i,e,s,o,a={}){const c=await _performApiRequest(i,e,s,o,a);return"mfaPendingCredential"in c&&_fail(i,"multi-factor-auth-required",{_serverResponse:c}),c}function _getFinalTarget(i,e,s,o){const a=`${e}${s}?${o}`;return i.config.emulator?_emulatorUrl(i.config,a):`${i.config.apiScheme}://${a}`}class NetworkTimeout{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((s,o)=>{this.timer=setTimeout(()=>o(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _makeTaggedError(i,e,s){const o={appName:i.name};s.email&&(o.email=s.email),s.phoneNumber&&(o.phoneNumber=s.phoneNumber);const a=_createError(i,e,o);return a.customData._tokenResponse=s,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(i,e){return _performApiRequest(i,"POST","/v1/accounts:delete",e)}async function deleteLinkedAccounts(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",e)}async function getAccountInfo(i,e){return _performApiRequest(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(i,e=!1){const s=getModularInstance(i),o=await s.getIdToken(e),a=_parseToken(o);_assert$4(a&&a.exp&&a.auth_time&&a.iat,s.auth,"internal-error");const c=typeof a.firebase=="object"?a.firebase:void 0,d=c==null?void 0:c.sign_in_provider;return{claims:a,token:o,authTime:utcTimestampToDateString(secondsStringToMilliseconds(a.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(a.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(a.exp)),signInProvider:d||null,signInSecondFactor:(c==null?void 0:c.sign_in_second_factor)||null}}function secondsStringToMilliseconds(i){return Number(i)*1e3}function _parseToken(i){const[e,s,o]=i.split(".");if(e===void 0||s===void 0||o===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const a=base64Decode(s);return a?JSON.parse(a):(_logError("Failed to decode base64 JWT payload"),null)}catch(a){return _logError("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function _tokenExpiresIn(i){const e=_parseToken(i);return _assert$4(e,"internal-error"),_assert$4(typeof e.exp<"u","internal-error"),_assert$4(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(i,e,s=!1){if(s)return e;try{return await e}catch(o){throw o instanceof FirebaseError&&isUserInvalidated(o)&&i.auth.currentUser===i&&await i.auth.signOut(),o}}function isUserInvalidated({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var s;if(e){const o=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),o}else{this.errorBackoff=3e4;const a=((s=this.user.stsTokenManager.expirationTime)!==null&&s!==void 0?s:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const s=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},s)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,s){this.createdAt=e,this.lastLoginAt=s,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(i){var e;const s=i.auth,o=await i.getIdToken(),a=await _logoutIfInvalidated(i,getAccountInfo(s,{idToken:o}));_assert$4(a==null?void 0:a.users.length,s,"internal-error");const c=a.users[0];i._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(c.providerUserInfo):[],h=mergeProviderData(i.providerData,d),g=i.isAnonymous,_=!(i.email&&c.passwordHash)&&!(h!=null&&h.length),ft=g?_:!1,_t={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:h,metadata:new UserMetadata(c.createdAt,c.lastLoginAt),isAnonymous:ft};Object.assign(i,_t)}async function reload(i){const e=getModularInstance(i);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(i,e){return[...i.filter(o=>!e.some(a=>a.providerId===o.providerId)),...e]}function extractProviderData(i){return i.map(e=>{var{providerId:s}=e,o=__rest(e,["providerId"]);return{providerId:s,uid:o.rawId||"",displayName:o.displayName||null,email:o.email||null,phoneNumber:o.phoneNumber||null,photoURL:o.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(i,e){const s=await _performFetchWithErrorHandling(i,{},async()=>{const o=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:c}=i.config,d=_getFinalTarget(i,a,"/v1/token",`key=${c}`),h=await i._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",FetchProvider.fetch()(d,{method:"POST",headers:h,body:o})});return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert$4(e.idToken,"internal-error"),_assert$4(typeof e.idToken<"u","internal-error"),_assert$4(typeof e.refreshToken<"u","internal-error");const s="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,s)}async getToken(e,s=!1){return _assert$4(!this.accessToken||this.refreshToken,e,"user-token-expired"),!s&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,s){const{accessToken:o,refreshToken:a,expiresIn:c}=await requestStsToken(e,s);this.updateTokensAndExpiration(o,a,Number(c))}updateTokensAndExpiration(e,s,o){this.refreshToken=s||null,this.accessToken=e||null,this.expirationTime=Date.now()+o*1e3}static fromJSON(e,s){const{refreshToken:o,accessToken:a,expirationTime:c}=s,d=new StsTokenManager;return o&&(_assert$4(typeof o=="string","internal-error",{appName:e}),d.refreshToken=o),a&&(_assert$4(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),c&&(_assert$4(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(i,e){_assert$4(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:s,auth:o,stsTokenManager:a}=e,c=__rest(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=s,this.auth=o,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new UserMetadata(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const s=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert$4(s,this.auth,"internal-error"),this.accessToken!==s&&(this.accessToken=s,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),s}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert$4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(s=>Object.assign({},s)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){_assert$4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,s=!1){let o=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),o=!0),s&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),o&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,s){var o,a,c,d,h,g,_,ft;const _t=(o=s.displayName)!==null&&o!==void 0?o:void 0,$t=(a=s.email)!==null&&a!==void 0?a:void 0,Mt=(c=s.phoneNumber)!==null&&c!==void 0?c:void 0,Ft=(d=s.photoURL)!==null&&d!==void 0?d:void 0,Ol=(h=s.tenantId)!==null&&h!==void 0?h:void 0,Vl=(g=s._redirectEventId)!==null&&g!==void 0?g:void 0,Nl=(_=s.createdAt)!==null&&_!==void 0?_:void 0,xl=(ft=s.lastLoginAt)!==null&&ft!==void 0?ft:void 0,{uid:Ml,emailVerified:Su,isAnonymous:_d,providerData:ep,stsTokenManager:tp}=s;_assert$4(Ml&&tp,e,"internal-error");const np=StsTokenManager.fromJSON(this.name,tp);_assert$4(typeof Ml=="string",e,"internal-error"),assertStringOrUndefined(_t,e.name),assertStringOrUndefined($t,e.name),_assert$4(typeof Su=="boolean",e,"internal-error"),_assert$4(typeof _d=="boolean",e,"internal-error"),assertStringOrUndefined(Mt,e.name),assertStringOrUndefined(Ft,e.name),assertStringOrUndefined(Ol,e.name),assertStringOrUndefined(Vl,e.name),assertStringOrUndefined(Nl,e.name),assertStringOrUndefined(xl,e.name);const op=new UserImpl({uid:Ml,auth:e,email:$t,emailVerified:Su,displayName:_t,isAnonymous:_d,photoURL:Ft,phoneNumber:Mt,tenantId:Ol,stsTokenManager:np,createdAt:Nl,lastLoginAt:xl});return ep&&Array.isArray(ep)&&(op.providerData=ep.map(rp=>Object.assign({},rp))),Vl&&(op._redirectEventId=Vl),op}static async _fromIdTokenResponse(e,s,o=!1){const a=new StsTokenManager;a.updateFromServerResponse(s);const c=new UserImpl({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o});return await _reloadWithoutSaving(c),c}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,s){this.storage[e]=s}async _get(e){const s=this.storage[e];return s===void 0?null:s}async _remove(e){delete this.storage[e]}_addListener(e,s){}_removeListener(e,s){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(i,e,s){return`firebase:${i}:${e}:${s}`}class PersistenceUserManager{constructor(e,s,o){this.persistence=e,this.auth=s,this.userKey=o;const{config:a,name:c}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,a.apiKey,c),this.fullPersistenceKey=_persistenceKeyName("persistence",a.apiKey,c),this.boundEventHandler=s._onStorageEvent.bind(s),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?UserImpl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const s=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,s)return this.setCurrentUser(s)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,s,o="authUser"){if(!s.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,o);const a=(await Promise.all(s.map(async _=>{if(await _._isAvailable())return _}))).filter(_=>_);let c=a[0]||_getInstance(inMemoryPersistence);const d=_persistenceKeyName(o,e.config.apiKey,e.name);let h=null;for(const _ of s)try{const ft=await _._get(d);if(ft){const _t=UserImpl._fromJSON(e,ft);_!==c&&(h=_t),c=_;break}}catch{}const g=a.filter(_=>_._shouldAllowMigration);return!c._shouldAllowMigration||!g.length?new PersistenceUserManager(c,e,o):(c=g[0],h&&await c._set(d,h.toJSON()),await Promise.all(s.map(async _=>{if(_!==c)try{await _._remove(d)}catch{}})),new PersistenceUserManager(c,e,o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const s=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,o=i.match(s);if((o==null?void 0:o.length)===2)return o[1]}return"Other"}function _isFirefox(i=getUA()){return/firefox\//i.test(i)}function _isSafari(i=getUA()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(i=getUA()){return/crios\//i.test(i)}function _isIEMobile(i=getUA()){return/iemobile/i.test(i)}function _isAndroid(i=getUA()){return/android/i.test(i)}function _isBlackBerry(i=getUA()){return/blackberry/i.test(i)}function _isWebOS(i=getUA()){return/webos/i.test(i)}function _isIOS(i=getUA()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function _isIOS7Or8(i=getUA()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(i)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(i)}function _isIOSStandalone(i=getUA()){var e;return _isIOS(i)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(i=getUA()){return _isIOS(i)||_isAndroid(i)||_isWebOS(i)||_isBlackBerry(i)||/windows phone/i.test(i)||_isIEMobile(i)}function _isIframe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(i,e=[]){let s;switch(i){case"Browser":s=_getBrowserName(getUA());break;case"Worker":s=`${_getBrowserName(getUA())}-${i}`;break;default:s=i}const o=e.length?e.join(","):"FirebaseCore-web";return`${s}/JsCore/${SDK_VERSION$1}/${o}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,s){const o=c=>new Promise((d,h)=>{try{const g=e(c);d(g)}catch(g){h(g)}});o.onAbort=s,this.queue.push(o);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const s=[];try{for(const o of this.queue)await o(e),o.onAbort&&s.push(o.onAbort)}catch(o){s.reverse();for(const a of s)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:o==null?void 0:o.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,s,o){this.app=e,this.heartbeatServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion}_initializeWithPersistence(e,s){return s&&(this._popupRedirectResolver=_getInstance(s)),this._initializationPromise=this.queue(async()=>{var o,a;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(s),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var s;const o=await this.assertedPersistence.getCurrentUser();let a=o,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId,h=a==null?void 0:a._redirectEventId,g=await this.tryRedirectSignIn(e);(!d||d===h)&&(g!=null&&g.user)&&(a=g.user,c=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=o,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return _assert$4(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let s=null;try{s=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return s}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(s){if((s==null?void 0:s.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const s=e?getModularInstance(e):null;return s&&_assert$4(s.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(s&&s._clone(this))}async _updateCurrentUser(e,s=!1){if(!this._deleted)return e&&_assert$4(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),s||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,s,o){return this.registerStateListener(this.authStateSubscription,e,s,o)}beforeAuthStateChanged(e,s){return this.beforeStateQueue.pushCallback(e,s)}onIdTokenChanged(e,s,o){return this.registerStateListener(this.idTokenSubscription,e,s,o)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,s){const o=await this.getOrInitRedirectPersistenceManager(s);return e===null?o.removeCurrentUser():o.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const s=e&&_getInstance(e)||this._popupRedirectResolver;_assert$4(s,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(s._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var s,o;return this._isInitialized&&await this.queue(async()=>{}),((s=this._currentUser)===null||s===void 0?void 0:s._redirectEventId)===e?this._currentUser:((o=this.redirectUser)===null||o===void 0?void 0:o._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,s;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const o=(s=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&s!==void 0?s:null;this.lastNotifiedUid!==o&&(this.lastNotifiedUid=o,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,s,o,a){if(this._deleted)return()=>{};const c=typeof s=="function"?s:s.next.bind(s),d=this._isInitialized?Promise.resolve():this._initializationPromise;return _assert$4(d,this,"internal-error"),d.then(()=>c(this.currentUser)),typeof s=="function"?e.addObserver(s,o,a):e.addObserver(s)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert$4(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const s={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(s["X-Firebase-gmpid"]=this.app.options.appId);const o=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return o&&(s["X-Firebase-Client"]=o),s}}function _castAuth(i){return getModularInstance(i)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(s=>this.observer=s)}get next(){return _assert$4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function connectAuthEmulator(i,e,s){const o=_castAuth(i);_assert$4(o._canInitEmulator,o,"emulator-config-failed"),_assert$4(/^https?:\/\//.test(e),o,"invalid-emulator-scheme");const a=!!(s!=null&&s.disableWarnings),c=extractProtocol(e),{host:d,port:h}=extractHostAndPort(e),g=h===null?"":`:${h}`;o.config.emulator={url:`${c}//${d}${g}/`},o.settings.appVerificationDisabledForTesting=!0,o.emulatorConfig=Object.freeze({host:d,port:h,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||emitEmulatorWarning()}function extractProtocol(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function extractHostAndPort(i){const e=extractProtocol(i),s=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!s)return{host:"",port:null};const o=s[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(o);if(a){const c=a[1];return{host:c,port:parsePort(o.substr(c.length+1))}}else{const[c,d]=o.split(":");return{host:c,port:parsePort(d)}}}function parsePort(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function emitEmulatorWarning(){function i(){const e=document.createElement("p"),s=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",s.position="fixed",s.width="100%",s.backgroundColor="#ffffff",s.border=".1em solid #000000",s.color="#b50000",s.bottom="0px",s.left="0px",s.margin="0px",s.zIndex="10000",s.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,s){this.providerId=e,this.signInMethod=s}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,s){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function resetPassword(i,e){return _performApiRequest(i,"POST","/v1/accounts:resetPassword",_addTidIfNecessary(i,e))}async function updateEmailPassword(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",e)}async function applyActionCode$1(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(i,e))}async function sendOobCode(i,e){return _performApiRequest(i,"POST","/v1/accounts:sendOobCode",_addTidIfNecessary(i,e))}async function sendEmailVerification$1(i,e){return sendOobCode(i,e)}async function sendPasswordResetEmail$1(i,e){return sendOobCode(i,e)}async function sendSignInLinkToEmail$1(i,e){return sendOobCode(i,e)}async function verifyAndChangeEmail(i,e){return sendOobCode(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(i,e))}async function signInWithEmailLinkForLinking(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthCredential extends AuthCredential{constructor(e,s,o,a=null){super("password",o),this._email=e,this._password=s,this._tenantId=a}static _fromEmailAndPassword(e,s){return new EmailAuthCredential(e,s,"password")}static _fromEmailAndCode(e,s,o=null){return new EmailAuthCredential(e,s,"emailLink",o)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e;if(s!=null&&s.email&&(s!=null&&s.password)){if(s.signInMethod==="password")return this._fromEmailAndPassword(s.email,s.password);if(s.signInMethod==="emailLink")return this._fromEmailAndCode(s.email,s.password,s.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return signInWithPassword(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,s){switch(this.signInMethod){case"password":return updateEmailPassword(e,{idToken:s,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:s,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const s=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(s.idToken=e.idToken),e.accessToken&&(s.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(s.nonce=e.nonce),e.pendingToken&&(s.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(s.accessToken=e.oauthToken,s.secret=e.oauthTokenSecret):_fail("argument-error"),s}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e,{providerId:o,signInMethod:a}=s,c=__rest(s,["providerId","signInMethod"]);if(!o||!a)return null;const d=new OAuthCredential(o,a);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const s=this.buildRequest();return signInWithIdp(e,s)}_linkToIdToken(e,s){const o=this.buildRequest();return o.idToken=s,signInWithIdp(e,o)}_getReauthenticationResolver(e){const s=this.buildRequest();return s.autoCreate=!1,signInWithIdp(e,s)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const s={};this.idToken&&(s.id_token=this.idToken),this.accessToken&&(s.access_token=this.accessToken),this.secret&&(s.oauth_token_secret=this.secret),s.providerId=this.providerId,this.nonce&&!this.pendingToken&&(s.nonce=this.nonce),e.postBody=querystring(s)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendPhoneVerificationCode(i,e){return _performApiRequest(i,"POST","/v1/accounts:sendVerificationCode",_addTidIfNecessary(i,e))}async function signInWithPhoneNumber$1(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(i,e))}async function linkWithPhoneNumber$1(i,e){const s=await _performSignInRequest(i,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(i,e));if(s.temporaryProof)throw _makeTaggedError(i,"account-exists-with-different-credential",s);return s}const VERIFY_PHONE_NUMBER_FOR_EXISTING_ERROR_MAP_={USER_NOT_FOUND:"user-not-found"};async function verifyPhoneNumberForExisting(i,e){const s=Object.assign(Object.assign({},e),{operation:"REAUTH"});return _performSignInRequest(i,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(i,s),VERIFY_PHONE_NUMBER_FOR_EXISTING_ERROR_MAP_)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PhoneAuthCredential extends AuthCredential{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,s){return new PhoneAuthCredential({verificationId:e,verificationCode:s})}static _fromTokenResponse(e,s){return new PhoneAuthCredential({phoneNumber:e,temporaryProof:s})}_getIdTokenResponse(e){return signInWithPhoneNumber$1(e,this._makeVerificationRequest())}_linkToIdToken(e,s){return linkWithPhoneNumber$1(e,Object.assign({idToken:s},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return verifyPhoneNumberForExisting(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:s,verificationId:o,verificationCode:a}=this.params;return e&&s?{temporaryProof:e,phoneNumber:s}:{sessionInfo:o,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:s,verificationCode:o,phoneNumber:a,temporaryProof:c}=e;return!o&&!s&&!a&&!c?null:new PhoneAuthCredential({verificationId:s,verificationCode:o,phoneNumber:a,temporaryProof:c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parseMode(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function parseDeepLink(i){const e=querystringDecode(extractQuerystring(i)).link,s=e?querystringDecode(extractQuerystring(e)).deep_link_id:null,o=querystringDecode(extractQuerystring(i)).deep_link_id;return(o?querystringDecode(extractQuerystring(o)).link:null)||o||s||e||i}class ActionCodeURL{constructor(e){var s,o,a,c,d,h;const g=querystringDecode(extractQuerystring(e)),_=(s=g.apiKey)!==null&&s!==void 0?s:null,ft=(o=g.oobCode)!==null&&o!==void 0?o:null,_t=parseMode((a=g.mode)!==null&&a!==void 0?a:null);_assert$4(_&&ft&&_t,"argument-error"),this.apiKey=_,this.operation=_t,this.code=ft,this.continueUrl=(c=g.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=g.languageCode)!==null&&d!==void 0?d:null,this.tenantId=(h=g.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const s=parseDeepLink(e);try{return new ActionCodeURL(s)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,s){return EmailAuthCredential._fromEmailAndPassword(e,s)}static credentialWithLink(e,s){const o=ActionCodeURL.parseLink(s);return _assert$4(o,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,o.code,o.tenantId)}}EmailAuthProvider.PROVIDER_ID="password";EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password";EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class OAuthProvider extends BaseOAuthProvider{static credentialFromJSON(e){const s=typeof e=="string"?JSON.parse(e):e;return _assert$4("providerId"in s&&"signInMethod"in s,"argument-error"),OAuthCredential._fromParams(s)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return _assert$4(e.idToken||e.accessToken,"argument-error"),OAuthCredential._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return OAuthProvider.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return OAuthProvider.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:s,oauthAccessToken:o,oauthTokenSecret:a,pendingToken:c,nonce:d,providerId:h}=e;if(!o&&!a&&!s&&!c||!h)return null;try{return new OAuthProvider(h)._credential({idToken:s,accessToken:o,nonce:d,pendingToken:c})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,s){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:s})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:s,oauthAccessToken:o}=e;if(!s&&!o)return null;try{return GoogleAuthProvider.credential(s,o)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI="http://localhost";class SAMLAuthCredential extends AuthCredential{constructor(e,s){super(e,e),this.pendingToken=s}_getIdTokenResponse(e){const s=this.buildRequest();return signInWithIdp(e,s)}_linkToIdToken(e,s){const o=this.buildRequest();return o.idToken=s,signInWithIdp(e,o)}_getReauthenticationResolver(e){const s=this.buildRequest();return s.autoCreate=!1,signInWithIdp(e,s)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e,{providerId:o,signInMethod:a,pendingToken:c}=s;return!o||!a||!c||o!==a?null:new SAMLAuthCredential(o,c)}static _create(e,s){return new SAMLAuthCredential(e,s)}buildRequest(){return{requestUri:IDP_REQUEST_URI,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SAML_PROVIDER_PREFIX="saml.";class SAMLAuthProvider extends FederatedAuthProvider{constructor(e){_assert$4(e.startsWith(SAML_PROVIDER_PREFIX),"argument-error"),super(e)}static credentialFromResult(e){return SAMLAuthProvider.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return SAMLAuthProvider.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const s=SAMLAuthCredential.fromJSON(e);return _assert$4(s,"argument-error"),s}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:s,providerId:o}=e;if(!s||!o)return null;try{return SAMLAuthCredential._create(o,s)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,s){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:s})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:s,oauthTokenSecret:o}=e;if(!s||!o)return null;try{return TwitterAuthProvider.credential(s,o)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signUp(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signUp",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,s,o,a=!1){const c=await UserImpl._fromIdTokenResponse(e,o,a),d=providerIdForResponse(o);return new UserCredentialImpl({user:c,providerId:d,_tokenResponse:o,operationType:s})}static async _forOperation(e,s,o){await e._updateTokensIfNecessary(o,!0);const a=providerIdForResponse(o);return new UserCredentialImpl({user:e,providerId:a,_tokenResponse:o,operationType:s})}}function providerIdForResponse(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInAnonymously(i){var e;const s=_castAuth(i);if(await s._initializationPromise,!((e=s.currentUser)===null||e===void 0)&&e.isAnonymous)return new UserCredentialImpl({user:s.currentUser,providerId:null,operationType:"signIn"});const o=await signUp(s,{returnSecureToken:!0}),a=await UserCredentialImpl._fromIdTokenResponse(s,"signIn",o,!0);return await s._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,s,o,a){var c;super(s.code,s.message),this.operationType=o,this.user=a,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:s.customData._serverResponse,operationType:o}}static _fromErrorAndOperation(e,s,o,a){return new MultiFactorError(e,s,o,a)}}function _processCredentialSavingMfaContextIfNecessary(i,e,s,o){return(e==="reauthenticate"?s._getReauthenticationResolver(i):s._getIdTokenResponse(i)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(i,c,e,o):c})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function providerDataAsNames(i){return new Set(i.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function unlink(i,e){const s=getModularInstance(i);await _assertLinkedStatus(!0,s,e);const{providerUserInfo:o}=await deleteLinkedAccounts(s.auth,{idToken:await s.getIdToken(),deleteProvider:[e]}),a=providerDataAsNames(o||[]);return s.providerData=s.providerData.filter(c=>a.has(c.providerId)),a.has("phone")||(s.phoneNumber=null),await s.auth._persistUserIfCurrent(s),s}async function _link$1(i,e,s=!1){const o=await _logoutIfInvalidated(i,e._linkToIdToken(i.auth,await i.getIdToken()),s);return UserCredentialImpl._forOperation(i,"link",o)}async function _assertLinkedStatus(i,e,s){await _reloadWithoutSaving(e);const o=providerDataAsNames(e.providerData),a=i===!1?"provider-already-linked":"no-such-provider";_assert$4(o.has(s)===i,e.auth,a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(i,e,s=!1){const{auth:o}=i,a="reauthenticate";try{const c=await _logoutIfInvalidated(i,_processCredentialSavingMfaContextIfNecessary(o,a,e,i),s);_assert$4(c.idToken,o,"internal-error");const d=_parseToken(c.idToken);_assert$4(d,o,"internal-error");const{sub:h}=d;return _assert$4(i.uid===h,o,"user-mismatch"),UserCredentialImpl._forOperation(i,a,c)}catch(c){throw(c==null?void 0:c.code)==="auth/user-not-found"&&_fail(o,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(i,e,s=!1){const o="signIn",a=await _processCredentialSavingMfaContextIfNecessary(i,o,e),c=await UserCredentialImpl._fromIdTokenResponse(i,o,a);return s||await i._updateCurrentUser(c.user),c}async function signInWithCredential(i,e){return _signInWithCredential(_castAuth(i),e)}async function linkWithCredential(i,e){const s=getModularInstance(i);return await _assertLinkedStatus(!1,s,e.providerId),_link$1(s,e)}async function reauthenticateWithCredential(i,e){return _reauthenticate(getModularInstance(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithCustomToken$1(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithCustomToken",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithCustomToken(i,e){const s=_castAuth(i),o=await signInWithCustomToken$1(s,{token:e,returnSecureToken:!0}),a=await UserCredentialImpl._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorInfoImpl{constructor(e,s){this.factorId=e,this.uid=s.mfaEnrollmentId,this.enrollmentTime=new Date(s.enrolledAt).toUTCString(),this.displayName=s.displayName}static _fromServerResponse(e,s){return"phoneInfo"in s?PhoneMultiFactorInfoImpl._fromServerResponse(e,s):_fail(e,"internal-error")}}class PhoneMultiFactorInfoImpl extends MultiFactorInfoImpl{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,s){return new PhoneMultiFactorInfoImpl(s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _setActionCodeSettingsOnRequest(i,e,s){var o;_assert$4(((o=s.url)===null||o===void 0?void 0:o.length)>0,i,"invalid-continue-uri"),_assert$4(typeof s.dynamicLinkDomain>"u"||s.dynamicLinkDomain.length>0,i,"invalid-dynamic-link-domain"),e.continueUrl=s.url,e.dynamicLinkDomain=s.dynamicLinkDomain,e.canHandleCodeInApp=s.handleCodeInApp,s.iOS&&(_assert$4(s.iOS.bundleId.length>0,i,"missing-ios-bundle-id"),e.iOSBundleId=s.iOS.bundleId),s.android&&(_assert$4(s.android.packageName.length>0,i,"missing-android-pkg-name"),e.androidInstallApp=s.android.installApp,e.androidMinimumVersionCode=s.android.minimumVersion,e.androidPackageName=s.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendPasswordResetEmail(i,e,s){const o=getModularInstance(i),a={requestType:"PASSWORD_RESET",email:e};s&&_setActionCodeSettingsOnRequest(o,a,s),await sendPasswordResetEmail$1(o,a)}async function confirmPasswordReset(i,e,s){await resetPassword(getModularInstance(i),{oobCode:e,newPassword:s})}async function applyActionCode(i,e){await applyActionCode$1(getModularInstance(i),{oobCode:e})}async function checkActionCode(i,e){const s=getModularInstance(i),o=await resetPassword(s,{oobCode:e}),a=o.requestType;switch(_assert$4(a,s,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":_assert$4(o.newEmail,s,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":_assert$4(o.mfaInfo,s,"internal-error");default:_assert$4(o.email,s,"internal-error")}let c=null;return o.mfaInfo&&(c=MultiFactorInfoImpl._fromServerResponse(_castAuth(s),o.mfaInfo)),{data:{email:(o.requestType==="VERIFY_AND_CHANGE_EMAIL"?o.newEmail:o.email)||null,previousEmail:(o.requestType==="VERIFY_AND_CHANGE_EMAIL"?o.email:o.newEmail)||null,multiFactorInfo:c},operation:a}}async function verifyPasswordResetCode(i,e){const{data:s}=await checkActionCode(getModularInstance(i),e);return s.email}async function createUserWithEmailAndPassword(i,e,s){const o=_castAuth(i),a=await signUp(o,{returnSecureToken:!0,email:e,password:s}),c=await UserCredentialImpl._fromIdTokenResponse(o,"signIn",a);return await o._updateCurrentUser(c.user),c}function signInWithEmailAndPassword(i,e,s){return signInWithCredential(getModularInstance(i),EmailAuthProvider.credential(e,s))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendSignInLinkToEmail(i,e,s){const o=getModularInstance(i),a={requestType:"EMAIL_SIGNIN",email:e};_assert$4(s.handleCodeInApp,o,"argument-error"),s&&_setActionCodeSettingsOnRequest(o,a,s),await sendSignInLinkToEmail$1(o,a)}function isSignInWithEmailLink(i,e){const s=ActionCodeURL.parseLink(e);return(s==null?void 0:s.operation)==="EMAIL_SIGNIN"}async function signInWithEmailLink(i,e,s){const o=getModularInstance(i),a=EmailAuthProvider.credentialWithLink(e,s||_getCurrentUrl());return _assert$4(a._tenantId===(o.tenantId||null),o,"tenant-id-mismatch"),signInWithCredential(o,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function createAuthUri(i,e){return _performApiRequest(i,"POST","/v1/accounts:createAuthUri",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fetchSignInMethodsForEmail(i,e){const s=_isHttpOrHttps$1()?_getCurrentUrl():"http://localhost",o={identifier:e,continueUri:s},{signinMethods:a}=await createAuthUri(getModularInstance(i),o);return a||[]}async function sendEmailVerification(i,e){const s=getModularInstance(i),a={requestType:"VERIFY_EMAIL",idToken:await i.getIdToken()};e&&_setActionCodeSettingsOnRequest(s.auth,a,e);const{email:c}=await sendEmailVerification$1(s.auth,a);c!==i.email&&await i.reload()}async function verifyBeforeUpdateEmail(i,e,s){const o=getModularInstance(i),c={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await i.getIdToken(),newEmail:e};s&&_setActionCodeSettingsOnRequest(o.auth,c,s);const{email:d}=await verifyAndChangeEmail(o.auth,c);d!==i.email&&await i.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function updateProfile$1(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function updateProfile(i,{displayName:e,photoURL:s}){if(e===void 0&&s===void 0)return;const o=getModularInstance(i),c={idToken:await o.getIdToken(),displayName:e,photoUrl:s,returnSecureToken:!0},d=await _logoutIfInvalidated(o,updateProfile$1(o.auth,c));o.displayName=d.displayName||null,o.photoURL=d.photoUrl||null;const h=o.providerData.find(({providerId:g})=>g==="password");h&&(h.displayName=o.displayName,h.photoURL=o.photoURL),await o._updateTokensIfNecessary(d)}function updateEmail(i,e){return updateEmailOrPassword(getModularInstance(i),e,null)}function updatePassword(i,e){return updateEmailOrPassword(getModularInstance(i),null,e)}async function updateEmailOrPassword(i,e,s){const{auth:o}=i,c={idToken:await i.getIdToken(),returnSecureToken:!0};e&&(c.email=e),s&&(c.password=s);const d=await _logoutIfInvalidated(i,updateEmailPassword(o,c));await i._updateTokensIfNecessary(d,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fromIdTokenResponse(i){var e,s;if(!i)return null;const{providerId:o}=i,a=i.rawUserInfo?JSON.parse(i.rawUserInfo):{},c=i.isNewUser||i.kind==="identitytoolkit#SignupNewUserResponse";if(!o&&(i!=null&&i.idToken)){const d=(s=(e=_parseToken(i.idToken))===null||e===void 0?void 0:e.firebase)===null||s===void 0?void 0:s.sign_in_provider;if(d){const h=d!=="anonymous"&&d!=="custom"?d:null;return new GenericAdditionalUserInfo(c,h)}}if(!o)return null;switch(o){case"facebook.com":return new FacebookAdditionalUserInfo(c,a);case"github.com":return new GithubAdditionalUserInfo(c,a);case"google.com":return new GoogleAdditionalUserInfo(c,a);case"twitter.com":return new TwitterAdditionalUserInfo(c,a,i.screenName||null);case"custom":case"anonymous":return new GenericAdditionalUserInfo(c,null);default:return new GenericAdditionalUserInfo(c,o,a)}}class GenericAdditionalUserInfo{constructor(e,s,o={}){this.isNewUser=e,this.providerId=s,this.profile=o}}class FederatedAdditionalUserInfoWithUsername extends GenericAdditionalUserInfo{constructor(e,s,o,a){super(e,s,o),this.username=a}}class FacebookAdditionalUserInfo extends GenericAdditionalUserInfo{constructor(e,s){super(e,"facebook.com",s)}}class GithubAdditionalUserInfo extends FederatedAdditionalUserInfoWithUsername{constructor(e,s){super(e,"github.com",s,typeof(s==null?void 0:s.login)=="string"?s==null?void 0:s.login:null)}}class GoogleAdditionalUserInfo extends GenericAdditionalUserInfo{constructor(e,s){super(e,"google.com",s)}}class TwitterAdditionalUserInfo extends FederatedAdditionalUserInfoWithUsername{constructor(e,s,o){super(e,"twitter.com",s,o)}}function getAdditionalUserInfo(i){const{user:e,_tokenResponse:s}=i;return e.isAnonymous&&!s?{providerId:null,isNewUser:!1,profile:null}:_fromIdTokenResponse(s)}class MultiFactorSessionImpl{constructor(e,s,o){this.type=e,this.credential=s,this.auth=o}static _fromIdtoken(e,s){return new MultiFactorSessionImpl("enroll",e,s)}static _fromMfaPendingCredential(e){return new MultiFactorSessionImpl("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var s,o;if(e!=null&&e.multiFactorSession){if(!((s=e.multiFactorSession)===null||s===void 0)&&s.pendingCredential)return MultiFactorSessionImpl._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((o=e.multiFactorSession)===null||o===void 0)&&o.idToken)return MultiFactorSessionImpl._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorResolverImpl{constructor(e,s,o){this.session=e,this.hints=s,this.signInResolver=o}static _fromError(e,s){const o=_castAuth(e),a=s.customData._serverResponse,c=(a.mfaInfo||[]).map(h=>MultiFactorInfoImpl._fromServerResponse(o,h));_assert$4(a.mfaPendingCredential,o,"internal-error");const d=MultiFactorSessionImpl._fromMfaPendingCredential(a.mfaPendingCredential);return new MultiFactorResolverImpl(d,c,async h=>{const g=await h._process(o,d);delete a.mfaInfo,delete a.mfaPendingCredential;const _=Object.assign(Object.assign({},a),{idToken:g.idToken,refreshToken:g.refreshToken});switch(s.operationType){case"signIn":const ft=await UserCredentialImpl._fromIdTokenResponse(o,s.operationType,_);return await o._updateCurrentUser(ft.user),ft;case"reauthenticate":return _assert$4(s.user,o,"internal-error"),UserCredentialImpl._forOperation(s.user,s.operationType,_);default:_fail(o,"internal-error")}})}async resolveSignIn(e){const s=e;return this.signInResolver(s)}}function getMultiFactorResolver(i,e){var s;const o=getModularInstance(i),a=e;return _assert$4(e.customData.operationType,o,"argument-error"),_assert$4((s=a.customData._serverResponse)===null||s===void 0?void 0:s.mfaPendingCredential,o,"argument-error"),MultiFactorResolverImpl._fromError(o,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startEnrollPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaEnrollment:start",_addTidIfNecessary(i,e))}function finalizeEnrollPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaEnrollment:finalize",_addTidIfNecessary(i,e))}function withdrawMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaEnrollment:withdraw",_addTidIfNecessary(i,e))}class MultiFactorUserImpl{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(s=>{s.mfaInfo&&(this.enrolledFactors=s.mfaInfo.map(o=>MultiFactorInfoImpl._fromServerResponse(e.auth,o)))})}static _fromUser(e){return new MultiFactorUserImpl(e)}async getSession(){return MultiFactorSessionImpl._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,s){const o=e,a=await this.getSession(),c=await _logoutIfInvalidated(this.user,o._process(this.user.auth,a,s));return await this.user._updateTokensIfNecessary(c),this.user.reload()}async unenroll(e){const s=typeof e=="string"?e:e.uid,o=await this.user.getIdToken();try{const a=await _logoutIfInvalidated(this.user,withdrawMfa(this.user.auth,{idToken:o,mfaEnrollmentId:s}));this.enrolledFactors=this.enrolledFactors.filter(({uid:c})=>c!==s),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const multiFactorUserCache=new WeakMap;function multiFactor(i){const e=getModularInstance(i);return multiFactorUserCache.has(e)||multiFactorUserCache.set(e,MultiFactorUserImpl._fromUser(e)),multiFactorUserCache.get(e)}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,s){this.storageRetriever=e,this.type=s}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,s){return this.storage.setItem(e,JSON.stringify(s)),Promise.resolve()}_get(e){const s=this.storage.getItem(e);return Promise.resolve(s?JSON.parse(s):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _iframeCannotSyncWebStorage(){const i=getUA();return _isSafari(i)||_isIOS(i)}const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,s)=>this.onStorageEvent(e,s),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=_iframeCannotSyncWebStorage()&&_isIframe(),this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const s of Object.keys(this.listeners)){const o=this.storage.getItem(s),a=this.localCache[s];o!==a&&e(s,a,o)}}onStorageEvent(e,s=!1){if(!e.key){this.forAllChangedKeys((d,h,g)=>{this.notifyListeners(d,g)});return}const o=e.key;if(s?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const d=this.storage.getItem(o);if(e.newValue!==d)e.newValue!==null?this.storage.setItem(o,e.newValue):this.storage.removeItem(o);else if(this.localCache[o]===e.newValue&&!s)return}const a=()=>{const d=this.storage.getItem(o);!s&&this.localCache[o]===d||this.notifyListeners(o,d)},c=this.storage.getItem(o);_isIE10()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,IE10_LOCAL_STORAGE_SYNC_DELAY):a()}notifyListeners(e,s){this.localCache[e]=s;const o=this.listeners[e];if(o)for(const a of Array.from(o))a(s&&JSON.parse(s))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,s,o)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:s,newValue:o}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,s){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,s){await super._set(e,s),this.localCache[e]=JSON.stringify(s)}async _get(e){const s=await super._get(e);return this.localCache[e]=JSON.stringify(s),s}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,s){}_removeListener(e,s){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(s){return{fulfilled:!1,reason:s}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const s=this.receivers.find(a=>a.isListeningto(e));if(s)return s;const o=new Receiver(e);return this.receivers.push(o),o}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const s=e,{eventId:o,eventType:a,data:c}=s.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;s.ports[0].postMessage({status:"ack",eventId:o,eventType:a});const h=Array.from(d).map(async _=>_(s.origin,c)),g=await _allSettled(h);s.ports[0].postMessage({status:"done",eventId:o,eventType:a,response:g})}_subscribe(e,s){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(s)}_unsubscribe(e,s){this.handlersMap[e]&&s&&this.handlersMap[e].delete(s),(!s||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(i="",e=10){let s="";for(let o=0;o<e;o++)s+=Math.floor(Math.random()*10);return i+s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,s,o=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let c,d;return new Promise((h,g)=>{const _=_generateEventId("",20);a.port1.start();const ft=setTimeout(()=>{g(new Error("unsupported_event"))},o);d={messageChannel:a,onMessage(_t){const $t=_t;if($t.data.eventId===_)switch($t.data.status){case"ack":clearTimeout(ft),c=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),h($t.data.response);break;default:clearTimeout(ft),clearTimeout(c),g(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:_,data:s},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(i){_window().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker$1(){return typeof _window().WorkerGlobalScope<"u"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)===null||i===void 0?void 0:i.controller)||null}function _getWorkerGlobalScope(){return _isWorker$1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,s)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{s(this.request.error)})})}}function getObjectStore(i,e){return i.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const i=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(i).toPromise()}function _openDatabase(){const i=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,s)=>{i.addEventListener("error",()=>{s(i.error)}),i.addEventListener("upgradeneeded",()=>{const o=i.result;try{o.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(a){s(a)}}),i.addEventListener("success",async()=>{const o=i.result;o.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(o):(o.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(i,e,s){const o=getObjectStore(i,!0).put({[DB_DATA_KEYPATH]:e,value:s});return new DBPromise(o).toPromise()}async function getObject(i,e){const s=getObjectStore(i,!1).get(e),o=await new DBPromise(s).toPromise();return o===void 0?null:o.value}function _deleteObject(i,e){const s=getObjectStore(i,!0).delete(e);return new DBPromise(s).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let s=0;for(;;)try{const o=await this._openDb();return await e(o)}catch(o){if(s++>_TRANSACTION_RETRY_COUNT)throw o;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker$1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,s)=>({keyProcessed:(await this._poll()).includes(s.key)})),this.receiver._subscribe("ping",async(e,s)=>["keyChanged"])}async initializeSender(){var e,s;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const o=await this.sender._send("ping",{},800);o&&!((e=o[0])===null||e===void 0)&&e.fulfilled&&!((s=o[0])===null||s===void 0)&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,s){return this._withPendingWrite(async()=>(await this._withRetries(o=>_putObject(o,e,s)),this.localCache[e]=s,this.notifyServiceWorker(e)))}async _get(e){const s=await this._withRetries(o=>getObject(o,e));return this.localCache[e]=s,s}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(s=>_deleteObject(s,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const c=getObjectStore(a,!1).getAll();return new DBPromise(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const s=[],o=new Set;for(const{fbase_key:a,value:c}of e)o.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(c)&&(this.notifyListeners(a,c),s.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!o.has(a)&&(this.notifyListeners(a,null),s.push(a));return s}notifyListeners(e,s){this.localCache[e]=s;const o=this.listeners[e];if(o)for(const a of Array.from(o))a(s)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,s){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startSignInPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaSignIn:start",_addTidIfNecessary(i,e))}function finalizeSignInPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaSignIn:finalize",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function getRecaptchaParams(i){return(await _performApiRequest(i,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getScriptParentElement(){var i,e;return(e=(i=document.getElementsByTagName("head"))===null||i===void 0?void 0:i[0])!==null&&e!==void 0?e:document}function _loadJS(i){return new Promise((e,s)=>{const o=document.createElement("script");o.setAttribute("src",i),o.onload=e,o.onerror=a=>{const c=_createError("internal-error");c.customData=a,s(c)},o.type="text/javascript",o.charset="UTF-8",getScriptParentElement().appendChild(o)})}function _generateCallbackName(i){return`__${i}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _SOLVE_TIME_MS=500,_EXPIRATION_TIME_MS=6e4,_WIDGET_ID_START=1e12;class MockReCaptcha{constructor(e){this.auth=e,this.counter=_WIDGET_ID_START,this._widgets=new Map}render(e,s){const o=this.counter;return this._widgets.set(o,new MockWidget(e,this.auth.name,s||{})),this.counter++,o}reset(e){var s;const o=e||_WIDGET_ID_START;(s=this._widgets.get(o))===null||s===void 0||s.delete(),this._widgets.delete(o)}getResponse(e){var s;const o=e||_WIDGET_ID_START;return((s=this._widgets.get(o))===null||s===void 0?void 0:s.getResponse())||""}async execute(e){var s;const o=e||_WIDGET_ID_START;return(s=this._widgets.get(o))===null||s===void 0||s.execute(),""}}class MockWidget{constructor(e,s,o){this.params=o,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;_assert$4(a,"argument-error",{appName:s}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=generateRandomAlphaNumericString(50);const{callback:e,"expired-callback":s}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,s)try{s()}catch{}this.isVisible&&this.execute()},_EXPIRATION_TIME_MS)},_SOLVE_TIME_MS))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function generateRandomAlphaNumericString(i){const e=[],s="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let o=0;o<i;o++)e.push(s.charAt(Math.floor(Math.random()*s.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _JSLOAD_CALLBACK=_generateCallbackName("rcb"),NETWORK_TIMEOUT_DELAY=new Delay(3e4,6e4),RECAPTCHA_BASE="https://www.google.com/recaptcha/api.js?";class ReCaptchaLoaderImpl{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=_window().grecaptcha)===null||e===void 0)&&e.render)}load(e,s=""){return _assert$4(isHostLanguageValid(s),e,"argument-error"),this.shouldResolveImmediately(s)?Promise.resolve(_window().grecaptcha):new Promise((o,a)=>{const c=_window().setTimeout(()=>{a(_createError(e,"network-request-failed"))},NETWORK_TIMEOUT_DELAY.get());_window()[_JSLOAD_CALLBACK]=()=>{_window().clearTimeout(c),delete _window()[_JSLOAD_CALLBACK];const h=_window().grecaptcha;if(!h){a(_createError(e,"internal-error"));return}const g=h.render;h.render=(_,ft)=>{const _t=g(_,ft);return this.counter++,_t},this.hostLanguage=s,o(h)};const d=`${RECAPTCHA_BASE}?${querystring({onload:_JSLOAD_CALLBACK,render:"explicit",hl:s})}`;_loadJS(d).catch(()=>{clearTimeout(c),a(_createError(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var s;return!!(!((s=_window().grecaptcha)===null||s===void 0)&&s.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function isHostLanguageValid(i){return i.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(i)}class MockReCaptchaLoaderImpl{async load(e){return new MockReCaptcha(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECAPTCHA_VERIFIER_TYPE="recaptcha",DEFAULT_PARAMS={theme:"light",type:"image"};let RecaptchaVerifier$1=class{constructor(e,s=Object.assign({},DEFAULT_PARAMS),o){this.parameters=s,this.type=RECAPTCHA_VERIFIER_TYPE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=_castAuth(o),this.isInvisible=this.parameters.size==="invisible",_assert$4(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof e=="string"?document.getElementById(e):e;_assert$4(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new MockReCaptchaLoaderImpl:new ReCaptchaLoaderImpl,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),s=this.getAssertedRecaptcha(),o=s.getResponse(e);return o||new Promise(a=>{const c=d=>{d&&(this.tokenChangeListeners.delete(c),a(d))};this.tokenChangeListeners.add(c),this.isInvisible&&s.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){_assert$4(!this.parameters.sitekey,this.auth,"argument-error"),_assert$4(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),_assert$4(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return s=>{if(this.tokenChangeListeners.forEach(o=>o(s)),typeof e=="function")e(s);else if(typeof e=="string"){const o=_window()[e];typeof o=="function"&&o(s)}}}assertNotDestroyed(){_assert$4(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const s=document.createElement("div");e.appendChild(s),e=s}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){_assert$4(_isHttpOrHttps$1()&&!_isWorker$1(),this.auth,"internal-error"),await domReady(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await getRecaptchaParams(this.auth);_assert$4(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return _assert$4(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function domReady(){let i=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}i=()=>e(),window.addEventListener("load",i)}).catch(e=>{throw i&&window.removeEventListener("load",i),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ConfirmationResultImpl{constructor(e,s){this.verificationId=e,this.onConfirmation=s}confirm(e){const s=PhoneAuthCredential._fromVerification(this.verificationId,e);return this.onConfirmation(s)}}async function signInWithPhoneNumber(i,e,s){const o=_castAuth(i),a=await _verifyPhoneNumber(o,e,getModularInstance(s));return new ConfirmationResultImpl(a,c=>signInWithCredential(o,c))}async function linkWithPhoneNumber(i,e,s){const o=getModularInstance(i);await _assertLinkedStatus(!1,o,"phone");const a=await _verifyPhoneNumber(o.auth,e,getModularInstance(s));return new ConfirmationResultImpl(a,c=>linkWithCredential(o,c))}async function reauthenticateWithPhoneNumber(i,e,s){const o=getModularInstance(i),a=await _verifyPhoneNumber(o.auth,e,getModularInstance(s));return new ConfirmationResultImpl(a,c=>reauthenticateWithCredential(o,c))}async function _verifyPhoneNumber(i,e,s){var o;const a=await s.verify();try{_assert$4(typeof a=="string",i,"argument-error"),_assert$4(s.type===RECAPTCHA_VERIFIER_TYPE,i,"argument-error");let c;if(typeof e=="string"?c={phoneNumber:e}:c=e,"session"in c){const d=c.session;if("phoneNumber"in c)return _assert$4(d.type==="enroll",i,"internal-error"),(await startEnrollPhoneMfa(i,{idToken:d.credential,phoneEnrollmentInfo:{phoneNumber:c.phoneNumber,recaptchaToken:a}})).phoneSessionInfo.sessionInfo;{_assert$4(d.type==="signin",i,"internal-error");const h=((o=c.multiFactorHint)===null||o===void 0?void 0:o.uid)||c.multiFactorUid;return _assert$4(h,i,"missing-multi-factor-info"),(await startSignInPhoneMfa(i,{mfaPendingCredential:d.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:a}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:d}=await sendPhoneVerificationCode(i,{phoneNumber:c.phoneNumber,recaptchaToken:a});return d}}finally{s._reset()}}async function updatePhoneNumber(i,e){await _link$1(getModularInstance(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PhoneAuthProvider$1=class Np{constructor(e){this.providerId=Np.PROVIDER_ID,this.auth=_castAuth(e)}verifyPhoneNumber(e,s){return _verifyPhoneNumber(this.auth,e,getModularInstance(s))}static credential(e,s){return PhoneAuthCredential._fromVerification(e,s)}static credentialFromResult(e){const s=e;return Np.credentialFromTaggedObject(s)}static credentialFromError(e){return Np.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:s,temporaryProof:o}=e;return s&&o?PhoneAuthCredential._fromTokenResponse(s,o):null}};PhoneAuthProvider$1.PROVIDER_ID="phone";PhoneAuthProvider$1.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(i,e){return e?_getInstance(e):(_assert$4(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,s){return signInWithIdp(e,this._buildIdpRequest(s))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const s={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(s.idToken=e),s}}function _signIn(i){return _signInWithCredential(i.auth,new IdpCredential(i),i.bypassAuthState)}function _reauth(i){const{auth:e,user:s}=i;return _assert$4(s,e,"internal-error"),_reauthenticate(s,new IdpCredential(i),i.bypassAuthState)}async function _link(i){const{auth:e,user:s}=i;return _assert$4(s,e,"internal-error"),_link$1(s,new IdpCredential(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,s,o,a,c=!1){this.auth=e,this.resolver=o,this.user=a,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(s)?s:[s]}execute(){return new Promise(async(e,s)=>{this.pendingPromise={resolve:e,reject:s};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(o){this.reject(o)}})}async onAuthEvent(e){const{urlResponse:s,sessionId:o,postBody:a,tenantId:c,error:d,type:h}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:s,sessionId:o,tenantId:c||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(g))}catch(_){this.reject(_)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);async function signInWithPopup(i,e,s){const o=_castAuth(i);_assertInstanceOf(i,e,FederatedAuthProvider);const a=_withDefaultResolver(o,s);return new PopupOperation(o,"signInViaPopup",e,a).executeNotNull()}async function reauthenticateWithPopup(i,e,s){const o=getModularInstance(i);_assertInstanceOf(o.auth,e,FederatedAuthProvider);const a=_withDefaultResolver(o.auth,s);return new PopupOperation(o.auth,"reauthViaPopup",e,a,o).executeNotNull()}async function linkWithPopup(i,e,s){const o=getModularInstance(i);_assertInstanceOf(o.auth,e,FederatedAuthProvider);const a=_withDefaultResolver(o.auth,s);return new PopupOperation(o.auth,"linkViaPopup",e,a,o).executeNotNull()}class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,s,o,a,c){super(e,s,a,c),this.provider=o,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert$4(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(s=>{this.reject(s)}),this.resolver._isIframeWebStorageSupported(this.auth,s=>{s||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var s,o;if(!((o=(s=this.authWindow)===null||s===void 0?void 0:s.window)===null||o===void 0)&&o.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,s,o=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],s,void 0,o),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const o=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(o)}catch(s){e=()=>Promise.reject(s)}redirectOutcomeMap.set(this.auth._key(),e)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const s=await this.auth._redirectUserForId(e.eventId);if(s)return this.user=s,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(i,e){const s=pendingRedirectKey(e),o=resolverPersistence(i);if(!await o._isAvailable())return!1;const a=await o._get(s)==="true";return await o._remove(s),a}async function _setPendingRedirectStatus(i,e){return resolverPersistence(i)._set(pendingRedirectKey(e),"true")}function _clearRedirectOutcomes(){redirectOutcomeMap.clear()}function _overrideRedirectResult(i,e){redirectOutcomeMap.set(i._key(),e)}function resolverPersistence(i){return _getInstance(i._redirectPersistence)}function pendingRedirectKey(i){return _persistenceKeyName(PENDING_REDIRECT_KEY,i.config.apiKey,i.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function signInWithRedirect(i,e,s){return _signInWithRedirect(i,e,s)}async function _signInWithRedirect(i,e,s){const o=_castAuth(i);_assertInstanceOf(i,e,FederatedAuthProvider),await o._initializationPromise;const a=_withDefaultResolver(o,s);return await _setPendingRedirectStatus(a,o),a._openRedirect(o,e,"signInViaRedirect")}function reauthenticateWithRedirect(i,e,s){return _reauthenticateWithRedirect(i,e,s)}async function _reauthenticateWithRedirect(i,e,s){const o=getModularInstance(i);_assertInstanceOf(o.auth,e,FederatedAuthProvider),await o.auth._initializationPromise;const a=_withDefaultResolver(o.auth,s);await _setPendingRedirectStatus(a,o.auth);const c=await prepareUserForRedirect(o);return a._openRedirect(o.auth,e,"reauthViaRedirect",c)}function linkWithRedirect(i,e,s){return _linkWithRedirect(i,e,s)}async function _linkWithRedirect(i,e,s){const o=getModularInstance(i);_assertInstanceOf(o.auth,e,FederatedAuthProvider),await o.auth._initializationPromise;const a=_withDefaultResolver(o.auth,s);await _assertLinkedStatus(!1,o,e.providerId),await _setPendingRedirectStatus(a,o.auth);const c=await prepareUserForRedirect(o);return a._openRedirect(o.auth,e,"linkViaRedirect",c)}async function getRedirectResult(i,e){return await _castAuth(i)._initializationPromise,_getRedirectResult(i,e,!1)}async function _getRedirectResult(i,e,s=!1){const o=_castAuth(i),a=_withDefaultResolver(o,e),d=await new RedirectAction(o,a,s).execute();return d&&!s&&(delete d.user._redirectEventId,await o._persistUserIfCurrent(d.user),await o._setRedirectUser(null,e)),d}async function prepareUserForRedirect(i){const e=_generateEventId(`${i.uid}:::`);return i._redirectEventId=e,await i.auth._setRedirectUser(i),await i.auth._persistUserIfCurrent(i),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let s=!1;return this.consumers.forEach(o=>{this.isEventForConsumer(e,o)&&(s=!0,this.sendToConsumer(e,o),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,s||(this.queuedRedirectEvent=e,s=!0)),s}sendToConsumer(e,s){var o;if(e.error&&!isNullRedirectEvent(e)){const a=((o=e.error.code)===null||o===void 0?void 0:o.split("auth/")[1])||"internal-error";s.onError(_createError(this.auth,a))}else s.onAuthEvent(e)}isEventForConsumer(e,s){const o=s.eventId===null||!!e.eventId&&e.eventId===s.eventId;return s.filter.includes(e.type)&&o}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(i,e={}){return _performApiRequest(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin$1(i){if(i.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(i);for(const s of e)try{if(matchDomain(s))return}catch{}_fail(i,"unauthorized-domain")}function matchDomain(i){const e=_getCurrentUrl(),{protocol:s,hostname:o}=new URL(e);if(i.startsWith("chrome-extension://")){const d=new URL(i);return d.hostname===""&&o===""?s==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):s==="chrome-extension:"&&d.hostname===o}if(!HTTP_REGEX.test(s))return!1;if(IP_ADDRESS_REGEX.test(i))return o===i;const a=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(o)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const i=_window().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let s=0;s<i.CP.length;s++)i.CP[s]=null}}function loadGapi(i){return new Promise((e,s)=>{var o,a,c;function d(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),s(_createError(i,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((a=(o=_window().gapi)===null||o===void 0?void 0:o.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((c=_window().gapi)===null||c===void 0)&&c.load)d();else{const h=_generateCallbackName("iframefcb");return _window()[h]=()=>{gapi.load?d():s(_createError(i,"network-request-failed"))},_loadJS(`https://apis.google.com/js/api.js?onload=${h}`).catch(g=>s(g))}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(i){return cachedGApiLoader=cachedGApiLoader||loadGapi(i),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(i){const e=i.config;_assert$4(e.authDomain,i,"auth-domain-config-required");const s=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${i.config.authDomain}/${IFRAME_PATH}`,o={apiKey:e.apiKey,appName:i.name,v:SDK_VERSION$1},a=EID_FROM_APIHOST.get(i.config.apiHost);a&&(o.eid=a);const c=i._getFrameworks();return c.length&&(o.fw=c.join(",")),`${s}?${querystring(o).slice(1)}`}async function _openIframe(i){const e=await _loadGapi(i),s=_window().gapi;return _assert$4(s,i,"internal-error"),e.open({where:document.body,url:getIframeUrl(i),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},o=>new Promise(async(a,c)=>{await o.restyle({setHideOnLeave:!1});const d=_createError(i,"network-request-failed"),h=_window().setTimeout(()=>{c(d)},PING_TIMEOUT.get());function g(){_window().clearTimeout(h),a(o)}o.ping(g).then(g,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(i,e,s,o=DEFAULT_WIDTH,a=DEFAULT_HEIGHT){const c=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-o)/2,0).toString();let h="";const g=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:o.toString(),height:a.toString(),top:c,left:d}),_=getUA().toLowerCase();s&&(h=_isChromeIOS(_)?TARGET_BLANK:s),_isFirefox(_)&&(e=e||FIREFOX_EMPTY_URL,g.scrollbars="yes");const ft=Object.entries(g).reduce(($t,[Mt,Ft])=>`${$t}${Mt}=${Ft},`,"");if(_isIOSStandalone(_)&&h!=="_self")return openAsNewWindowIOS(e||"",h),new AuthPopup(null);const _t=window.open(e||"",h,ft);_assert$4(_t,i,"popup-blocked");try{_t.focus()}catch{}return new AuthPopup(_t)}function openAsNewWindowIOS(i,e){const s=document.createElement("a");s.href=i,s.target=e;const o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler";function _getRedirectUrl(i,e,s,o,a,c){_assert$4(i.config.authDomain,i,"auth-domain-config-required"),_assert$4(i.config.apiKey,i,"invalid-api-key");const d={apiKey:i.config.apiKey,appName:i.name,authType:s,redirectUrl:o,v:SDK_VERSION$1,eventId:a};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(i.languageCode),d.providerId=e.providerId||"",isEmpty(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries(c||{}))d[g]=_}if(e instanceof BaseOAuthProvider){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(d.scopes=g.join(","))}i.tenantId&&(d.tid=i.tenantId);const h=d;for(const g of Object.keys(h))h[g]===void 0&&delete h[g];return`${getHandlerBase(i)}?${querystring(h).slice(1)}`}function getHandlerBase({config:i}){return i.emulator?_emulatorUrl(i,EMULATOR_WIDGET_PATH):`https://${i.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,s,o,a){var c;debugAssert((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=_getRedirectUrl(e,s,o,_getCurrentUrl(),a);return _open(e,d,_generateEventId())}async _openRedirect(e,s,o,a){return await this._originValidation(e),_setWindowLocation(_getRedirectUrl(e,s,o,_getCurrentUrl(),a)),new Promise(()=>{})}_initialize(e){const s=e._key();if(this.eventManagers[s]){const{manager:a,promise:c}=this.eventManagers[s];return a?Promise.resolve(a):(debugAssert(c,"If manager is not set, promise should be"),c)}const o=this.initAndGetManager(e);return this.eventManagers[s]={promise:o},o.catch(()=>{delete this.eventManagers[s]}),o}async initAndGetManager(e){const s=await _openIframe(e),o=new AuthEventManager(e);return s.register("authEvent",a=>(_assert$4(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:o.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:o},this.iframes[e._key()]=s,o}_isIframeWebStorageSupported(e,s){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},a=>{var c;const d=(c=a==null?void 0:a[0])===null||c===void 0?void 0:c[WEB_STORAGE_SUPPORT_KEY];d!==void 0&&s(!!d),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const s=e._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=_validateOrigin$1(e)),this.originValidationPromises[s]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;class MultiFactorAssertionImpl{constructor(e){this.factorId=e}_process(e,s,o){switch(s.type){case"enroll":return this._finalizeEnroll(e,s.credential,o);case"signin":return this._finalizeSignIn(e,s.credential);default:return debugFail("unexpected MultiFactorSessionType")}}}class PhoneMultiFactorAssertionImpl extends MultiFactorAssertionImpl{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new PhoneMultiFactorAssertionImpl(e)}_finalizeEnroll(e,s,o){return finalizeEnrollPhoneMfa(e,{idToken:s,displayName:o,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,s){return finalizeSignInPhoneMfa(e,{mfaPendingCredential:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class PhoneMultiFactorGenerator{constructor(){}static assertion(e){return PhoneMultiFactorAssertionImpl._fromCredential(e)}}PhoneMultiFactorGenerator.FACTOR_ID="phone";var name$6="@firebase/auth",version$6="0.21.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const s=this.auth.onIdTokenChanged(o=>{e((o==null?void 0:o.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,s),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const s=this.internalListeners.get(e);s&&(this.internalListeners.delete(e),s(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert$4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function registerAuth(i){_registerComponent(new Component("auth",(e,{options:s})=>{const o=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),{apiKey:c,authDomain:d}=o.options;return((h,g)=>{_assert$4(c&&!c.includes(":"),"invalid-api-key",{appName:h.name}),_assert$4(!(d!=null&&d.includes(":")),"argument-error",{appName:h.name});const _={apiKey:c,authDomain:d,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(i)},ft=new AuthImpl(h,g,_);return _initializeAuthInstance(ft,s),ft})(o,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,s,o)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const s=_castAuth(e.getProvider("auth").getImmediate());return(o=>new AuthInterop(o))(s)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$6,version$6,getVersionForPlatform(i)),registerVersion(name$6,version$6,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60;getExperimentalSetting("authIdTokenMaxAge");registerAuth("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _cordovaWindow(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const REDIRECT_TIMEOUT_MS=2e3;async function _generateHandlerUrl(i,e,s){var o;const{BuildInfo:a}=_cordovaWindow();debugAssert(e.sessionId,"AuthEvent did not contain a session ID");const c=await computeSha256(e.sessionId),d={};return _isIOS()?d.ibi=a.packageName:_isAndroid()?d.apn=a.packageName:_fail(i,"operation-not-supported-in-this-environment"),a.displayName&&(d.appDisplayName=a.displayName),d.sessionId=c,_getRedirectUrl(i,s,e.type,void 0,(o=e.eventId)!==null&&o!==void 0?o:void 0,d)}async function _validateOrigin(i){const{BuildInfo:e}=_cordovaWindow(),s={};_isIOS()?s.iosBundleId=e.packageName:_isAndroid()?s.androidPackageName=e.packageName:_fail(i,"operation-not-supported-in-this-environment"),await _getProjectConfig(i,s)}function _performRedirect(i){const{cordova:e}=_cordovaWindow();return new Promise(s=>{e.plugins.browsertab.isAvailable(o=>{let a=null;o?e.plugins.browsertab.openUrl(i):a=e.InAppBrowser.open(i,_isIOS7Or8()?"_blank":"_system","location=yes"),s(a)})})}async function _waitForAppResume(i,e,s){const{cordova:o}=_cordovaWindow();let a=()=>{};try{await new Promise((c,d)=>{let h=null;function g(){var _t;c();const $t=(_t=o.plugins.browsertab)===null||_t===void 0?void 0:_t.close;typeof $t=="function"&&$t(),typeof(s==null?void 0:s.close)=="function"&&s.close()}function _(){h||(h=window.setTimeout(()=>{d(_createError(i,"redirect-cancelled-by-user"))},REDIRECT_TIMEOUT_MS))}function ft(){(document==null?void 0:document.visibilityState)==="visible"&&_()}e.addPassiveListener(g),document.addEventListener("resume",_,!1),_isAndroid()&&document.addEventListener("visibilitychange",ft,!1),a=()=>{e.removePassiveListener(g),document.removeEventListener("resume",_,!1),document.removeEventListener("visibilitychange",ft,!1),h&&window.clearTimeout(h)}})}finally{a()}}function _checkCordovaConfiguration(i){var e,s,o,a,c,d,h,g,_,ft;const _t=_cordovaWindow();_assert$4(typeof((e=_t==null?void 0:_t.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),_assert$4(typeof((s=_t==null?void 0:_t.BuildInfo)===null||s===void 0?void 0:s.packageName)<"u",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),_assert$4(typeof((c=(a=(o=_t==null?void 0:_t.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.openUrl)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_assert$4(typeof((g=(h=(d=_t==null?void 0:_t.cordova)===null||d===void 0?void 0:d.plugins)===null||h===void 0?void 0:h.browsertab)===null||g===void 0?void 0:g.isAvailable)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_assert$4(typeof((ft=(_=_t==null?void 0:_t.cordova)===null||_===void 0?void 0:_.InAppBrowser)===null||ft===void 0?void 0:ft.open)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function computeSha256(i){const e=stringToArrayBuffer(i),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(a=>a.toString(16).padStart(2,"0")).join("")}function stringToArrayBuffer(i){if(debugAssert(/[0-9a-zA-Z]+/.test(i),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(i);const e=new ArrayBuffer(i.length),s=new Uint8Array(e);for(let o=0;o<i.length;o++)s[o]=i.charCodeAt(o);return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SESSION_ID_LENGTH=20;class CordovaAuthEventManager extends AuthEventManager{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(s=>s(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function _generateNewEvent(i,e,s=null){return{type:e,eventId:s,urlResponse:null,sessionId:generateSessionId(),postBody:null,tenantId:i.tenantId,error:_createError(i,"no-auth-event")}}function _savePartialEvent(i,e){return storage()._set(persistenceKey(i),e)}async function _getAndRemoveEvent(i){const e=await storage()._get(persistenceKey(i));return e&&await storage()._remove(persistenceKey(i)),e}function _eventFromPartialAndUrl(i,e){var s,o;const a=_getDeepLinkFromCallback(e);if(a.includes("/__/auth/callback")){const c=searchParamsOrEmpty(a),d=c.firebaseError?parseJsonOrNull(decodeURIComponent(c.firebaseError)):null,h=(o=(s=d==null?void 0:d.code)===null||s===void 0?void 0:s.split("auth/"))===null||o===void 0?void 0:o[1],g=h?_createError(h):null;return g?{type:i.type,eventId:i.eventId,tenantId:i.tenantId,error:g,urlResponse:null,sessionId:null,postBody:null}:{type:i.type,eventId:i.eventId,tenantId:i.tenantId,sessionId:i.sessionId,urlResponse:a,postBody:null}}return null}function generateSessionId(){const i=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<SESSION_ID_LENGTH;s++){const o=Math.floor(Math.random()*e.length);i.push(e.charAt(o))}return i.join("")}function storage(){return _getInstance(browserLocalPersistence)}function persistenceKey(i){return _persistenceKeyName("authEvent",i.config.apiKey,i.name)}function parseJsonOrNull(i){try{return JSON.parse(i)}catch{return null}}function _getDeepLinkFromCallback(i){const e=searchParamsOrEmpty(i),s=e.link?decodeURIComponent(e.link):void 0,o=searchParamsOrEmpty(s).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return searchParamsOrEmpty(a).link||a||o||s||i}function searchParamsOrEmpty(i){if(!(i!=null&&i.includes("?")))return{};const[e,...s]=i.split("?");return querystringDecode(s.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INITIAL_EVENT_TIMEOUT_MS=500;class CordovaPopupRedirectResolver{constructor(){this._redirectPersistence=browserSessionPersistence,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _initialize(e){const s=e._key();let o=this.eventManagers.get(s);return o||(o=new CordovaAuthEventManager(e),this.eventManagers.set(s,o),this.attachCallbackListeners(e,o)),o}_openPopup(e){_fail(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,s,o,a){_checkCordovaConfiguration(e);const c=await this._initialize(e);await c.initialized(),c.resetRedirect(),_clearRedirectOutcomes(),await this._originValidation(e);const d=_generateNewEvent(e,o,a);await _savePartialEvent(e,d);const h=await _generateHandlerUrl(e,d,s),g=await _performRedirect(h);return _waitForAppResume(e,c,g)}_isIframeWebStorageSupported(e,s){throw new Error("Method not implemented.")}_originValidation(e){const s=e._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=_validateOrigin(e)),this.originValidationPromises[s]}attachCallbackListeners(e,s){const{universalLinks:o,handleOpenURL:a,BuildInfo:c}=_cordovaWindow(),d=setTimeout(async()=>{await _getAndRemoveEvent(e),s.onEvent(generateNoEvent())},INITIAL_EVENT_TIMEOUT_MS),h=async ft=>{clearTimeout(d);const _t=await _getAndRemoveEvent(e);let $t=null;_t&&(ft!=null&&ft.url)&&($t=_eventFromPartialAndUrl(_t,ft.url)),s.onEvent($t||generateNoEvent())};typeof o<"u"&&typeof o.subscribe=="function"&&o.subscribe(null,h);const g=a,_=`${c.packageName.toLowerCase()}://`;_cordovaWindow().handleOpenURL=async ft=>{if(ft.toLowerCase().startsWith(_)&&h({url:ft}),typeof g=="function")try{g(ft)}catch(_t){console.error(_t)}}}}const cordovaPopupRedirectResolver=CordovaPopupRedirectResolver;function generateNoEvent(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_createError("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function addFrameworkForLogging(i,e){_castAuth(i)._logFramework(e)}var name$5="@firebase/auth-compat",version$5="0.3.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CORDOVA_ONDEVICEREADY_TIMEOUT_MS=1e3;function _getCurrentScheme(){var i;return((i=self==null?void 0:self.location)===null||i===void 0?void 0:i.protocol)||null}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _isAndroidOrIosCordovaScheme(i=getUA()){return!!((_getCurrentScheme()==="file:"||_getCurrentScheme()==="ionic:"||_getCurrentScheme()==="capacitor:")&&i.toLowerCase().match(/iphone|ipad|ipod|android/))}function _isNativeEnvironment(){return isReactNative()||isNode()}function _isIe11(){return isIE()&&(document==null?void 0:document.documentMode)===11}function _isEdge(i=getUA()){return/Edge\/\d+/.test(i)}function _isLocalStorageNotSynchronized(i=getUA()){return _isIe11()||_isEdge(i)}function _isWebStorageSupported(){try{const i=self.localStorage,e=_generateEventId();if(i)return i.setItem(e,"1"),i.removeItem(e),_isLocalStorageNotSynchronized()?isIndexedDBAvailable():!0}catch{return _isWorker()&&isIndexedDBAvailable()}return!1}function _isWorker(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function _isPopupRedirectSupported(){return(_isHttpOrHttps()||isBrowserExtension()||_isAndroidOrIosCordovaScheme())&&!_isNativeEnvironment()&&_isWebStorageSupported()&&!_isWorker()}function _isLikelyCordova(){return _isAndroidOrIosCordovaScheme()&&typeof document<"u"}async function _isCordova(){return _isLikelyCordova()?new Promise(i=>{const e=setTimeout(()=>{i(!1)},CORDOVA_ONDEVICEREADY_TIMEOUT_MS);document.addEventListener("deviceready",()=>{clearTimeout(e),i(!0)})}):!1}function _getSelfWindow(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Persistence={LOCAL:"local",NONE:"none",SESSION:"session"},_assert$3=_assert$4,PERSISTENCE_KEY="persistence";function _validatePersistenceArgument(i,e){if(_assert$3(Object.values(Persistence).includes(e),i,"invalid-persistence-type"),isReactNative()){_assert$3(e!==Persistence.SESSION,i,"unsupported-persistence-type");return}if(isNode()){_assert$3(e===Persistence.NONE,i,"unsupported-persistence-type");return}if(_isWorker()){_assert$3(e===Persistence.NONE||e===Persistence.LOCAL&&isIndexedDBAvailable(),i,"unsupported-persistence-type");return}_assert$3(e===Persistence.NONE||_isWebStorageSupported(),i,"unsupported-persistence-type")}async function _savePersistenceForRedirect(i){await i._initializationPromise;const e=getSessionStorageIfAvailable(),s=_persistenceKeyName(PERSISTENCE_KEY,i.config.apiKey,i.name);e&&e.setItem(s,i._getPersistence())}function _getPersistencesFromRedirect(i,e){const s=getSessionStorageIfAvailable();if(!s)return[];const o=_persistenceKeyName(PERSISTENCE_KEY,i,e);switch(s.getItem(o)){case Persistence.NONE:return[inMemoryPersistence];case Persistence.LOCAL:return[indexedDBLocalPersistence,browserSessionPersistence];case Persistence.SESSION:return[browserSessionPersistence];default:return[]}}function getSessionStorageIfAvailable(){var i;try{return((i=_getSelfWindow())===null||i===void 0?void 0:i.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _assert$2=_assert$4;class CompatPopupRedirectResolver{constructor(){this.browserResolver=_getInstance(browserPopupRedirectResolver),this.cordovaResolver=_getInstance(cordovaPopupRedirectResolver),this.underlyingResolver=null,this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,s,o,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,s,o,a)}async _openRedirect(e,s,o,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,s,o,a)}_isIframeWebStorageSupported(e,s){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,s)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return _isLikelyCordova()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return _assert$2(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await _isCordova();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function unwrap(i){return i.unwrap()}function wrapped(i){return i.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function credentialFromResponse(i){return credentialFromObject(i)}function attachExtraErrorFields(i,e){var s;const o=(s=e.customData)===null||s===void 0?void 0:s._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const a=e;a.resolver=new MultiFactorResolver(i,getMultiFactorResolver(i,e))}else if(o){const a=credentialFromObject(e),c=e;a&&(c.credential=a,c.tenantId=o.tenantId||void 0,c.email=o.email||void 0,c.phoneNumber=o.phoneNumber||void 0)}}function credentialFromObject(i){const{_tokenResponse:e}=i instanceof FirebaseError?i.customData:i;if(!e)return null;if(!(i instanceof FirebaseError)&&"temporaryProof"in e&&"phoneNumber"in e)return PhoneAuthProvider$1.credentialFromResult(i);const s=e.providerId;if(!s||s===ProviderId.PASSWORD)return null;let o;switch(s){case ProviderId.GOOGLE:o=GoogleAuthProvider;break;case ProviderId.FACEBOOK:o=FacebookAuthProvider;break;case ProviderId.GITHUB:o=GithubAuthProvider;break;case ProviderId.TWITTER:o=TwitterAuthProvider;break;default:const{oauthIdToken:a,oauthAccessToken:c,oauthTokenSecret:d,pendingToken:h,nonce:g}=e;return!c&&!d&&!a&&!h?null:h?s.startsWith("saml.")?SAMLAuthCredential._create(s,h):OAuthCredential._fromParams({providerId:s,signInMethod:s,pendingToken:h,idToken:a,accessToken:c}):new OAuthProvider(s).credential({idToken:a,accessToken:c,rawNonce:g})}return i instanceof FirebaseError?o.credentialFromError(i):o.credentialFromResult(i)}function convertCredential(i,e){return e.catch(s=>{throw s instanceof FirebaseError&&attachExtraErrorFields(i,s),s}).then(s=>{const o=s.operationType,a=s.user;return{operationType:o,credential:credentialFromResponse(s),additionalUserInfo:getAdditionalUserInfo(s),user:User.getOrCreate(a)}})}async function convertConfirmationResult(i,e){const s=await e;return{verificationId:s.verificationId,confirm:o=>convertCredential(i,s.confirm(o))}}class MultiFactorResolver{constructor(e,s){this.resolver=s,this.auth=wrapped(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return convertCredential(unwrap(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this._delegate=e,this.multiFactor=multiFactor(e)}static getOrCreate(e){return User.USER_MAP.has(e)||User.USER_MAP.set(e,new User(e)),User.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return convertCredential(this.auth,linkWithCredential(this._delegate,e))}async linkWithPhoneNumber(e,s){return convertConfirmationResult(this.auth,linkWithPhoneNumber(this._delegate,e,s))}async linkWithPopup(e){return convertCredential(this.auth,linkWithPopup(this._delegate,e,CompatPopupRedirectResolver))}async linkWithRedirect(e){return await _savePersistenceForRedirect(_castAuth(this.auth)),linkWithRedirect(this._delegate,e,CompatPopupRedirectResolver)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return convertCredential(this.auth,reauthenticateWithCredential(this._delegate,e))}reauthenticateWithPhoneNumber(e,s){return convertConfirmationResult(this.auth,reauthenticateWithPhoneNumber(this._delegate,e,s))}reauthenticateWithPopup(e){return convertCredential(this.auth,reauthenticateWithPopup(this._delegate,e,CompatPopupRedirectResolver))}async reauthenticateWithRedirect(e){return await _savePersistenceForRedirect(_castAuth(this.auth)),reauthenticateWithRedirect(this._delegate,e,CompatPopupRedirectResolver)}sendEmailVerification(e){return sendEmailVerification(this._delegate,e)}async unlink(e){return await unlink(this._delegate,e),this}updateEmail(e){return updateEmail(this._delegate,e)}updatePassword(e){return updatePassword(this._delegate,e)}updatePhoneNumber(e){return updatePhoneNumber(this._delegate,e)}updateProfile(e){return updateProfile(this._delegate,e)}verifyBeforeUpdateEmail(e,s){return verifyBeforeUpdateEmail(this._delegate,e,s)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}User.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _assert$1=_assert$4;class Auth{constructor(e,s){if(this.app=e,s.isInitialized()){this._delegate=s.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:o}=e.options;_assert$1(o,"invalid-api-key",{appName:e.name}),_assert$1(o,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?CompatPopupRedirectResolver:void 0;this._delegate=s.initialize({options:{persistence:buildPersistenceHierarchy(o,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(debugErrorMap),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?User.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,s){connectAuthEmulator(this._delegate,e,s)}applyActionCode(e){return applyActionCode(this._delegate,e)}checkActionCode(e){return checkActionCode(this._delegate,e)}confirmPasswordReset(e,s){return confirmPasswordReset(this._delegate,e,s)}async createUserWithEmailAndPassword(e,s){return convertCredential(this._delegate,createUserWithEmailAndPassword(this._delegate,e,s))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return fetchSignInMethodsForEmail(this._delegate,e)}isSignInWithEmailLink(e){return isSignInWithEmailLink(this._delegate,e)}async getRedirectResult(){_assert$1(_isPopupRedirectSupported(),this._delegate,"operation-not-supported-in-this-environment");const e=await getRedirectResult(this._delegate,CompatPopupRedirectResolver);return e?convertCredential(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){addFrameworkForLogging(this._delegate,e)}onAuthStateChanged(e,s,o){const{next:a,error:c,complete:d}=wrapObservers(e,s,o);return this._delegate.onAuthStateChanged(a,c,d)}onIdTokenChanged(e,s,o){const{next:a,error:c,complete:d}=wrapObservers(e,s,o);return this._delegate.onIdTokenChanged(a,c,d)}sendSignInLinkToEmail(e,s){return sendSignInLinkToEmail(this._delegate,e,s)}sendPasswordResetEmail(e,s){return sendPasswordResetEmail(this._delegate,e,s||void 0)}async setPersistence(e){_validatePersistenceArgument(this._delegate,e);let s;switch(e){case Persistence.SESSION:s=browserSessionPersistence;break;case Persistence.LOCAL:s=await _getInstance(indexedDBLocalPersistence)._isAvailable()?indexedDBLocalPersistence:browserLocalPersistence;break;case Persistence.NONE:s=inMemoryPersistence;break;default:return _fail("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(s)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return convertCredential(this._delegate,signInAnonymously(this._delegate))}signInWithCredential(e){return convertCredential(this._delegate,signInWithCredential(this._delegate,e))}signInWithCustomToken(e){return convertCredential(this._delegate,signInWithCustomToken(this._delegate,e))}signInWithEmailAndPassword(e,s){return convertCredential(this._delegate,signInWithEmailAndPassword(this._delegate,e,s))}signInWithEmailLink(e,s){return convertCredential(this._delegate,signInWithEmailLink(this._delegate,e,s))}signInWithPhoneNumber(e,s){return convertConfirmationResult(this._delegate,signInWithPhoneNumber(this._delegate,e,s))}async signInWithPopup(e){return _assert$1(_isPopupRedirectSupported(),this._delegate,"operation-not-supported-in-this-environment"),convertCredential(this._delegate,signInWithPopup(this._delegate,e,CompatPopupRedirectResolver))}async signInWithRedirect(e){return _assert$1(_isPopupRedirectSupported(),this._delegate,"operation-not-supported-in-this-environment"),await _savePersistenceForRedirect(this._delegate),signInWithRedirect(this._delegate,e,CompatPopupRedirectResolver)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return verifyPasswordResetCode(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Auth.Persistence=Persistence;function wrapObservers(i,e,s){let o=i;typeof i!="function"&&({next:o,error:e,complete:s}=i);const a=o;return{next:d=>a(d&&User.getOrCreate(d)),error:e,complete:s}}function buildPersistenceHierarchy(i,e){const s=_getPersistencesFromRedirect(i,e);if(typeof self<"u"&&!s.includes(indexedDBLocalPersistence)&&s.push(indexedDBLocalPersistence),typeof window<"u")for(const o of[browserLocalPersistence,browserSessionPersistence])s.includes(o)||s.push(o);return s.includes(inMemoryPersistence)||s.push(inMemoryPersistence),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PhoneAuthProvider{constructor(){this.providerId="phone",this._delegate=new PhoneAuthProvider$1(unwrap(firebase.auth()))}static credential(e,s){return PhoneAuthProvider$1.credential(e,s)}verifyPhoneNumber(e,s){return this._delegate.verifyPhoneNumber(e,s)}unwrap(){return this._delegate}}PhoneAuthProvider.PHONE_SIGN_IN_METHOD=PhoneAuthProvider$1.PHONE_SIGN_IN_METHOD;PhoneAuthProvider.PROVIDER_ID=PhoneAuthProvider$1.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _assert=_assert$4;class RecaptchaVerifier{constructor(e,s,o=firebase.app()){var a;_assert((a=o.options)===null||a===void 0?void 0:a.apiKey,"invalid-api-key",{appName:o.name}),this._delegate=new RecaptchaVerifier$1(e,s,o.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AUTH_TYPE="auth-compat";function registerAuthCompat(i){i.INTERNAL.registerComponent(new Component(AUTH_TYPE,e=>{const s=e.getProvider("app-compat").getImmediate(),o=e.getProvider("auth");return new Auth(s,o)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ActionCodeOperation.EMAIL_SIGNIN,PASSWORD_RESET:ActionCodeOperation.PASSWORD_RESET,RECOVER_EMAIL:ActionCodeOperation.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ActionCodeOperation.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ActionCodeOperation.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ActionCodeOperation.VERIFY_EMAIL}},EmailAuthProvider,FacebookAuthProvider,GithubAuthProvider,GoogleAuthProvider,OAuthProvider,SAMLAuthProvider,PhoneAuthProvider,PhoneMultiFactorGenerator,RecaptchaVerifier,TwitterAuthProvider,Auth,AuthCredential,Error:FirebaseError}).setInstantiationMode("LAZY").setMultipleInstances(!1)),i.registerVersion(name$5,version$5)}registerAuthCompat(firebase);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},k$1,goog=goog||{},l=commonjsGlobal||self;function aa$1(){}function ba$1(i){var e=typeof i;return e=e!="object"?e:i?Array.isArray(i)?"array":e:"null",e=="array"||e=="object"&&typeof i.length=="number"}function p(i){var e=typeof i;return e=="object"&&i!=null||e=="function"}function ca$1(i){return Object.prototype.hasOwnProperty.call(i,da$1)&&i[da$1]||(i[da$1]=++ea$1)}var da$1="closure_uid_"+(1e9*Math.random()>>>0),ea$1=0;function fa$1(i,e,s){return i.call.apply(i.bind,arguments)}function ha$1(i,e,s){if(!i)throw Error();if(2<arguments.length){var o=Array.prototype.slice.call(arguments,2);return function(){var a=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(a,o),i.apply(e,a)}}return function(){return i.apply(e,arguments)}}function q$1(i,e,s){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?q$1=fa$1:q$1=ha$1,q$1.apply(null,arguments)}function ia$1(i,e){var s=Array.prototype.slice.call(arguments,1);return function(){var o=s.slice();return o.push.apply(o,arguments),i.apply(this,o)}}function t(i,e){function s(){}s.prototype=e.prototype,i.X=e.prototype,i.prototype=new s,i.prototype.constructor=i,i.Wb=function(o,a,c){for(var d=Array(arguments.length-2),h=2;h<arguments.length;h++)d[h-2]=arguments[h];return e.prototype[a].apply(o,d)}}function v$1(){this.s=this.s,this.o=this.o}var ja$1=0;v$1.prototype.s=!1;v$1.prototype.na=function(){!this.s&&(this.s=!0,this.M(),ja$1!=0)&&ca$1(this)};v$1.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const la$1=Array.prototype.indexOf?function(i,e){return Array.prototype.indexOf.call(i,e,void 0)}:function(i,e){if(typeof i=="string")return typeof e!="string"||e.length!=1?-1:i.indexOf(e,0);for(let s=0;s<i.length;s++)if(s in i&&i[s]===e)return s;return-1};function ma$1(i){const e=i.length;if(0<e){const s=Array(e);for(let o=0;o<e;o++)s[o]=i[o];return s}return[]}function na$1(i,e){for(let s=1;s<arguments.length;s++){const o=arguments[s];if(ba$1(o)){const a=i.length||0,c=o.length||0;i.length=a+c;for(let d=0;d<c;d++)i[a+d]=o[d]}else i.push(o)}}function w(i,e){this.type=i,this.g=this.target=e,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var oa$1=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var i=!1,e=Object.defineProperty({},"passive",{get:function(){i=!0}});try{l.addEventListener("test",aa$1,e),l.removeEventListener("test",aa$1,e)}catch{}return i}();function pa$1(i){return/^[\s\xa0]*$/.test(i)}var qa$1=String.prototype.trim?function(i){return i.trim()}:function(i){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(i)[1]};function ra$1(i,e){return i<e?-1:i>e?1:0}function sa$1(){var i=l.navigator;return i&&(i=i.userAgent)?i:""}function x$1(i){return sa$1().indexOf(i)!=-1}function ta$1(i){return ta$1[" "](i),i}ta$1[" "]=aa$1;function ua$1(i){var e=va$1;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=i(9)}var wa$1=x$1("Opera"),y=x$1("Trident")||x$1("MSIE"),xa$1=x$1("Edge"),ya$1=xa$1||y,za$1=x$1("Gecko")&&!(sa$1().toLowerCase().indexOf("webkit")!=-1&&!x$1("Edge"))&&!(x$1("Trident")||x$1("MSIE"))&&!x$1("Edge"),Aa$1=sa$1().toLowerCase().indexOf("webkit")!=-1&&!x$1("Edge");function Ba$1(){var i=l.document;return i?i.documentMode:void 0}var Ea$1;e:{var Fa$1="",Ga$1=function(){var i=sa$1();if(za$1)return/rv:([^\);]+)(\)|;)/.exec(i);if(xa$1)return/Edge\/([\d\.]+)/.exec(i);if(y)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i);if(Aa$1)return/WebKit\/(\S+)/.exec(i);if(wa$1)return/(?:Version)[ \/]?(\S+)/.exec(i)}();if(Ga$1&&(Fa$1=Ga$1?Ga$1[1]:""),y){var Ha$1=Ba$1();if(Ha$1!=null&&Ha$1>parseFloat(Fa$1)){Ea$1=String(Ha$1);break e}}Ea$1=Fa$1}var va$1={};function Ia$1(){return ua$1(function(){let i=0;const e=qa$1(String(Ea$1)).split("."),s=qa$1("9").split("."),o=Math.max(e.length,s.length);for(let d=0;i==0&&d<o;d++){var a=e[d]||"",c=s[d]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],c=/(\d*)(\D*)(.*)/.exec(c)||["","","",""],a[0].length==0&&c[0].length==0)break;i=ra$1(a[1].length==0?0:parseInt(a[1],10),c[1].length==0?0:parseInt(c[1],10))||ra$1(a[2].length==0,c[2].length==0)||ra$1(a[2],c[2]),a=a[3],c=c[3]}while(i==0)}return 0<=i})}var Ja$1;if(l.document&&y){var Ka$1=Ba$1();Ja$1=Ka$1||parseInt(Ea$1,10)||void 0}else Ja$1=void 0;var La$1=Ja$1;function z$1(i,e){if(w.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var s=this.type=i.type,o=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=e,e=i.relatedTarget){if(za$1){e:{try{ta$1(e.nodeName);var a=!0;break e}catch{}a=!1}a||(e=null)}}else s=="mouseover"?e=i.fromElement:s=="mouseout"&&(e=i.toElement);this.relatedTarget=e,o?(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:Ma$1[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&z$1.X.h.call(this)}}t(z$1,w);var Ma$1={2:"touch",3:"pen",4:"mouse"};z$1.prototype.h=function(){z$1.X.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var A="closure_listenable_"+(1e6*Math.random()|0),Na$1=0;function Oa$1(i,e,s,o,a){this.listener=i,this.proxy=null,this.src=e,this.type=s,this.capture=!!o,this.ha=a,this.key=++Na$1,this.ba=this.ea=!1}function Pa$1(i){i.ba=!0,i.listener=null,i.proxy=null,i.src=null,i.ha=null}function Qa$1(i,e,s){for(const o in i)e.call(s,i[o],o,i)}function Ra$1(i){const e={};for(const s in i)e[s]=i[s];return e}const Sa$1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ta$1(i,e){let s,o;for(let a=1;a<arguments.length;a++){o=arguments[a];for(s in o)i[s]=o[s];for(let c=0;c<Sa$1.length;c++)s=Sa$1[c],Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}}function Ua$1(i){this.src=i,this.g={},this.h=0}Ua$1.prototype.add=function(i,e,s,o,a){var c=i.toString();i=this.g[c],i||(i=this.g[c]=[],this.h++);var d=Va$1(i,e,o,a);return-1<d?(e=i[d],s||(e.ea=!1)):(e=new Oa$1(e,this.src,c,!!o,a),e.ea=s,i.push(e)),e};function Wa$1(i,e){var s=e.type;if(s in i.g){var o=i.g[s],a=la$1(o,e),c;(c=0<=a)&&Array.prototype.splice.call(o,a,1),c&&(Pa$1(e),i.g[s].length==0&&(delete i.g[s],i.h--))}}function Va$1(i,e,s,o){for(var a=0;a<i.length;++a){var c=i[a];if(!c.ba&&c.listener==e&&c.capture==!!s&&c.ha==o)return a}return-1}var Xa$1="closure_lm_"+(1e6*Math.random()|0),Ya$1={};function $a$1(i,e,s,o,a){if(o&&o.once)return ab(i,e,s,o,a);if(Array.isArray(e)){for(var c=0;c<e.length;c++)$a$1(i,e[c],s,o,a);return null}return s=bb(s),i&&i[A]?i.N(e,s,p(o)?!!o.capture:!!o,a):cb(i,e,s,!1,o,a)}function cb(i,e,s,o,a,c){if(!e)throw Error("Invalid event type");var d=p(a)?!!a.capture:!!a,h=db$1(i);if(h||(i[Xa$1]=h=new Ua$1(i)),s=h.add(e,s,o,d,c),s.proxy)return s;if(o=eb(),s.proxy=o,o.src=i,o.listener=s,i.addEventListener)oa$1||(a=d),a===void 0&&(a=!1),i.addEventListener(e.toString(),o,a);else if(i.attachEvent)i.attachEvent(fb(e.toString()),o);else if(i.addListener&&i.removeListener)i.addListener(o);else throw Error("addEventListener and attachEvent are unavailable.");return s}function eb(){function i(s){return e.call(i.src,i.listener,s)}const e=gb;return i}function ab(i,e,s,o,a){if(Array.isArray(e)){for(var c=0;c<e.length;c++)ab(i,e[c],s,o,a);return null}return s=bb(s),i&&i[A]?i.O(e,s,p(o)?!!o.capture:!!o,a):cb(i,e,s,!0,o,a)}function hb(i,e,s,o,a){if(Array.isArray(e))for(var c=0;c<e.length;c++)hb(i,e[c],s,o,a);else o=p(o)?!!o.capture:!!o,s=bb(s),i&&i[A]?(i=i.i,e=String(e).toString(),e in i.g&&(c=i.g[e],s=Va$1(c,s,o,a),-1<s&&(Pa$1(c[s]),Array.prototype.splice.call(c,s,1),c.length==0&&(delete i.g[e],i.h--)))):i&&(i=db$1(i))&&(e=i.g[e.toString()],i=-1,e&&(i=Va$1(e,s,o,a)),(s=-1<i?e[i]:null)&&ib(s))}function ib(i){if(typeof i!="number"&&i&&!i.ba){var e=i.src;if(e&&e[A])Wa$1(e.i,i);else{var s=i.type,o=i.proxy;e.removeEventListener?e.removeEventListener(s,o,i.capture):e.detachEvent?e.detachEvent(fb(s),o):e.addListener&&e.removeListener&&e.removeListener(o),(s=db$1(e))?(Wa$1(s,i),s.h==0&&(s.src=null,e[Xa$1]=null)):Pa$1(i)}}}function fb(i){return i in Ya$1?Ya$1[i]:Ya$1[i]="on"+i}function gb(i,e){if(i.ba)i=!0;else{e=new z$1(e,this);var s=i.listener,o=i.ha||i.src;i.ea&&ib(i),i=s.call(o,e)}return i}function db$1(i){return i=i[Xa$1],i instanceof Ua$1?i:null}var jb="__closure_events_fn_"+(1e9*Math.random()>>>0);function bb(i){return typeof i=="function"?i:(i[jb]||(i[jb]=function(e){return i.handleEvent(e)}),i[jb])}function B$1(){v$1.call(this),this.i=new Ua$1(this),this.P=this,this.I=null}t(B$1,v$1);B$1.prototype[A]=!0;B$1.prototype.removeEventListener=function(i,e,s,o){hb(this,i,e,s,o)};function C$1(i,e){var s,o=i.I;if(o)for(s=[];o;o=o.I)s.push(o);if(i=i.P,o=e.type||e,typeof e=="string")e=new w(e,i);else if(e instanceof w)e.target=e.target||i;else{var a=e;e=new w(o,i),Ta$1(e,a)}if(a=!0,s)for(var c=s.length-1;0<=c;c--){var d=e.g=s[c];a=kb(d,o,!0,e)&&a}if(d=e.g=i,a=kb(d,o,!0,e)&&a,a=kb(d,o,!1,e)&&a,s)for(c=0;c<s.length;c++)d=e.g=s[c],a=kb(d,o,!1,e)&&a}B$1.prototype.M=function(){if(B$1.X.M.call(this),this.i){var i=this.i,e;for(e in i.g){for(var s=i.g[e],o=0;o<s.length;o++)Pa$1(s[o]);delete i.g[e],i.h--}}this.I=null};B$1.prototype.N=function(i,e,s,o){return this.i.add(String(i),e,!1,s,o)};B$1.prototype.O=function(i,e,s,o){return this.i.add(String(i),e,!0,s,o)};function kb(i,e,s,o){if(e=i.i.g[String(e)],!e)return!0;e=e.concat();for(var a=!0,c=0;c<e.length;++c){var d=e[c];if(d&&!d.ba&&d.capture==s){var h=d.listener,g=d.ha||d.src;d.ea&&Wa$1(i.i,d),a=h.call(g,o)!==!1&&a}}return a&&!o.defaultPrevented}var lb=l.JSON.stringify;function mb(){var i=nb;let e=null;return i.g&&(e=i.g,i.g=i.g.next,i.g||(i.h=null),e.next=null),e}class ob{constructor(){this.h=this.g=null}add(e,s){const o=pb.get();o.set(e,s),this.h?this.h.next=o:this.g=o,this.h=o}}var pb=new class{constructor(i,e){this.i=i,this.j=e,this.h=0,this.g=null}get(){let i;return 0<this.h?(this.h--,i=this.g,this.g=i.next,i.next=null):i=this.i(),i}}(()=>new qb,i=>i.reset());class qb{constructor(){this.next=this.g=this.h=null}set(e,s){this.h=e,this.g=s,this.next=null}reset(){this.next=this.g=this.h=null}}function rb(i){l.setTimeout(()=>{throw i},0)}function sb(i,e){ub||vb(),wb||(ub(),wb=!0),nb.add(i,e)}var ub;function vb(){var i=l.Promise.resolve(void 0);ub=function(){i.then(xb)}}var wb=!1,nb=new ob;function xb(){for(var i;i=mb();){try{i.h.call(i.g)}catch(s){rb(s)}var e=pb;e.j(i),100>e.h&&(e.h++,i.next=e.g,e.g=i)}wb=!1}function yb(i,e){B$1.call(this),this.h=i||1,this.g=e||l,this.j=q$1(this.lb,this),this.l=Date.now()}t(yb,B$1);k$1=yb.prototype;k$1.ca=!1;k$1.R=null;k$1.lb=function(){if(this.ca){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-i):(this.R&&(this.g.clearTimeout(this.R),this.R=null),C$1(this,"tick"),this.ca&&(zb(this),this.start()))}};k$1.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function zb(i){i.ca=!1,i.R&&(i.g.clearTimeout(i.R),i.R=null)}k$1.M=function(){yb.X.M.call(this),zb(this),delete this.g};function Ab(i,e,s){if(typeof i=="function")s&&(i=q$1(i,s));else if(i&&typeof i.handleEvent=="function")i=q$1(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:l.setTimeout(i,e||0)}function Bb(i){i.g=Ab(()=>{i.g=null,i.i&&(i.i=!1,Bb(i))},i.j);const e=i.h;i.h=null,i.m.apply(null,e)}class Cb extends v$1{constructor(e,s){super(),this.m=e,this.j=s,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Bb(this)}M(){super.M(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function D$1(i){v$1.call(this),this.h=i,this.g={}}t(D$1,v$1);var Db=[];function Eb(i,e,s,o){Array.isArray(s)||(s&&(Db[0]=s.toString()),s=Db);for(var a=0;a<s.length;a++){var c=$a$1(e,s[a],o||i.handleEvent,!1,i.h||i);if(!c)break;i.g[c.key]=c}}function Fb(i){Qa$1(i.g,function(e,s){this.g.hasOwnProperty(s)&&ib(e)},i),i.g={}}D$1.prototype.M=function(){D$1.X.M.call(this),Fb(this)};D$1.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Gb(){this.g=!0}Gb.prototype.Aa=function(){this.g=!1};function Hb(i,e,s,o,a,c){i.info(function(){if(i.g)if(c)for(var d="",h=c.split("&"),g=0;g<h.length;g++){var _=h[g].split("=");if(1<_.length){var ft=_[0];_=_[1];var _t=ft.split("_");d=2<=_t.length&&_t[1]=="type"?d+(ft+"="+_+"&"):d+(ft+"=redacted&")}}else d=null;else d=c;return"XMLHTTP REQ ("+o+") [attempt "+a+"]: "+e+`
`+s+`
`+d})}function Ib(i,e,s,o,a,c,d){i.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+a+"]: "+e+`
`+s+`
`+c+" "+d})}function E(i,e,s,o){i.info(function(){return"XMLHTTP TEXT ("+e+"): "+Jb(i,s)+(o?" "+o:"")})}function Kb(i,e){i.info(function(){return"TIMEOUT: "+e})}Gb.prototype.info=function(){};function Jb(i,e){if(!i.g)return e;if(!e)return null;try{var s=JSON.parse(e);if(s){for(i=0;i<s.length;i++)if(Array.isArray(s[i])){var o=s[i];if(!(2>o.length)){var a=o[1];if(Array.isArray(a)&&!(1>a.length)){var c=a[0];if(c!="noop"&&c!="stop"&&c!="close")for(var d=1;d<a.length;d++)a[d]=""}}}}return lb(s)}catch{return e}}var G$1={},Lb=null;function Mb(){return Lb=Lb||new B$1}G$1.Pa="serverreachability";function Nb(i){w.call(this,G$1.Pa,i)}t(Nb,w);function H$1(i){const e=Mb();C$1(e,new Nb(e))}G$1.STAT_EVENT="statevent";function Ob(i,e){w.call(this,G$1.STAT_EVENT,i),this.stat=e}t(Ob,w);function I(i){const e=Mb();C$1(e,new Ob(e,i))}G$1.Qa="timingevent";function Pb(i,e){w.call(this,G$1.Qa,i),this.size=e}t(Pb,w);function J(i,e){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){i()},e)}var Qb={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Rb={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Sb(){}Sb.prototype.h=null;function Tb(i){return i.h||(i.h=i.i())}function Ub(){}var K$1={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Vb(){w.call(this,"d")}t(Vb,w);function Wb(){w.call(this,"c")}t(Wb,w);var Xb;function Yb(){}t(Yb,Sb);Yb.prototype.g=function(){return new XMLHttpRequest};Yb.prototype.i=function(){return{}};Xb=new Yb;function L$1(i,e,s,o){this.l=i,this.j=e,this.m=s,this.U=o||1,this.S=new D$1(this),this.O=Zb,i=ya$1?125:void 0,this.T=new yb(i),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new $b}function $b(){this.i=null,this.g="",this.h=!1}var Zb=45e3,ac$1={},bc$1={};k$1=L$1.prototype;k$1.setTimeout=function(i){this.O=i};function cc$1(i,e,s){i.K=1,i.v=dc$1(M$1(e)),i.s=s,i.P=!0,ec$1(i,null)}function ec$1(i,e){i.F=Date.now(),N$1(i),i.A=M$1(i.v);var s=i.A,o=i.U;Array.isArray(o)||(o=[String(o)]),fc$1(s.i,"t",o),i.C=0,s=i.l.H,i.h=new $b,i.g=gc$1(i.l,s?e:null,!i.s),0<i.N&&(i.L=new Cb(q$1(i.La,i,i.g),i.N)),Eb(i.S,i.g,"readystatechange",i.ib),e=i.H?Ra$1(i.H):{},i.s?(i.u||(i.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",i.g.da(i.A,i.u,i.s,e)):(i.u="GET",i.g.da(i.A,i.u,null,e)),H$1(),Hb(i.j,i.u,i.A,i.m,i.U,i.s)}k$1.ib=function(i){i=i.target;const e=this.L;e&&O$1(i)==3?e.l():this.La(i)};k$1.La=function(i){try{if(i==this.g)e:{const ft=O$1(this.g);var e=this.g.Ea();const _t=this.g.aa();if(!(3>ft)&&(ft!=3||ya$1||this.g&&(this.h.h||this.g.fa()||hc$1(this.g)))){this.I||ft!=4||e==7||(e==8||0>=_t?H$1(3):H$1(2)),ic$1(this);var s=this.g.aa();this.Y=s;t:if(jc$1(this)){var o=hc$1(this.g);i="";var a=o.length,c=O$1(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){P$1(this),Q$1(this);var d="";break t}this.h.i=new l.TextDecoder}for(e=0;e<a;e++)this.h.h=!0,i+=this.h.i.decode(o[e],{stream:c&&e==a-1});o.splice(0,a),this.h.g+=i,this.C=0,d=this.h.g}else d=this.g.fa();if(this.i=s==200,Ib(this.j,this.u,this.A,this.m,this.U,ft,s),this.i){if(this.Z&&!this.J){t:{if(this.g){var h,g=this.g;if((h=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!pa$1(h)){var _=h;break t}}_=null}if(s=_)E(this.j,this.m,s,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,kc$1(this,s);else{this.i=!1,this.o=3,I(12),P$1(this),Q$1(this);break e}}this.P?(lc$1(this,ft,d),ya$1&&this.i&&ft==3&&(Eb(this.S,this.T,"tick",this.hb),this.T.start())):(E(this.j,this.m,d,null),kc$1(this,d)),ft==4&&P$1(this),this.i&&!this.I&&(ft==4?mc$1(this.l,this):(this.i=!1,N$1(this)))}else s==400&&0<d.indexOf("Unknown SID")?(this.o=3,I(12)):(this.o=0,I(13)),P$1(this),Q$1(this)}}}catch{}finally{}};function jc$1(i){return i.g?i.u=="GET"&&i.K!=2&&i.l.Da:!1}function lc$1(i,e,s){let o=!0,a;for(;!i.I&&i.C<s.length;)if(a=nc$1(i,s),a==bc$1){e==4&&(i.o=4,I(14),o=!1),E(i.j,i.m,null,"[Incomplete Response]");break}else if(a==ac$1){i.o=4,I(15),E(i.j,i.m,s,"[Invalid Chunk]"),o=!1;break}else E(i.j,i.m,a,null),kc$1(i,a);jc$1(i)&&a!=bc$1&&a!=ac$1&&(i.h.g="",i.C=0),e!=4||s.length!=0||i.h.h||(i.o=1,I(16),o=!1),i.i=i.i&&o,o?0<s.length&&!i.$&&(i.$=!0,e=i.l,e.g==i&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),oc$1(e),e.K=!0,I(11))):(E(i.j,i.m,s,"[Invalid Chunked Response]"),P$1(i),Q$1(i))}k$1.hb=function(){if(this.g){var i=O$1(this.g),e=this.g.fa();this.C<e.length&&(ic$1(this),lc$1(this,i,e),this.i&&i!=4&&N$1(this))}};function nc$1(i,e){var s=i.C,o=e.indexOf(`
`,s);return o==-1?bc$1:(s=Number(e.substring(s,o)),isNaN(s)?ac$1:(o+=1,o+s>e.length?bc$1:(e=e.substr(o,s),i.C=o+s,e)))}k$1.cancel=function(){this.I=!0,P$1(this)};function N$1(i){i.V=Date.now()+i.O,pc$1(i,i.O)}function pc$1(i,e){if(i.B!=null)throw Error("WatchDog timer not null");i.B=J(q$1(i.gb,i),e)}function ic$1(i){i.B&&(l.clearTimeout(i.B),i.B=null)}k$1.gb=function(){this.B=null;const i=Date.now();0<=i-this.V?(Kb(this.j,this.A),this.K!=2&&(H$1(),I(17)),P$1(this),this.o=2,Q$1(this)):pc$1(this,this.V-i)};function Q$1(i){i.l.G==0||i.I||mc$1(i.l,i)}function P$1(i){ic$1(i);var e=i.L;e&&typeof e.na=="function"&&e.na(),i.L=null,zb(i.T),Fb(i.S),i.g&&(e=i.g,i.g=null,e.abort(),e.na())}function kc$1(i,e){try{var s=i.l;if(s.G!=0&&(s.g==i||qc$1(s.h,i))){if(!i.J&&qc$1(s.h,i)&&s.G==3){try{var o=s.Fa.g.parse(e)}catch{o=null}if(Array.isArray(o)&&o.length==3){var a=o;if(a[0]==0){e:if(!s.u){if(s.g)if(s.g.F+3e3<i.F)rc$1(s),sc$1(s);else break e;tc$1(s),I(18)}}else s.Ba=a[1],0<s.Ba-s.T&&37500>a[2]&&s.L&&s.A==0&&!s.v&&(s.v=J(q$1(s.cb,s),6e3));if(1>=uc$1(s.h)&&s.ja){try{s.ja()}catch{}s.ja=void 0}}else R(s,11)}else if((i.J||s.g==i)&&rc$1(s),!pa$1(e))for(a=s.Fa.g.parse(e),e=0;e<a.length;e++){let _=a[e];if(s.T=_[0],_=_[1],s.G==2)if(_[0]=="c"){s.I=_[1],s.ka=_[2];const ft=_[3];ft!=null&&(s.ma=ft,s.j.info("VER="+s.ma));const _t=_[4];_t!=null&&(s.Ca=_t,s.j.info("SVER="+s.Ca));const $t=_[5];$t!=null&&typeof $t=="number"&&0<$t&&(o=1.5*$t,s.J=o,s.j.info("backChannelRequestTimeoutMs_="+o)),o=s;const Mt=i.g;if(Mt){const Ft=Mt.g?Mt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ft){var c=o.h;c.g||Ft.indexOf("spdy")==-1&&Ft.indexOf("quic")==-1&&Ft.indexOf("h2")==-1||(c.j=c.l,c.g=new Set,c.h&&(vc$1(c,c.h),c.h=null))}if(o.D){const Ol=Mt.g?Mt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ol&&(o.za=Ol,S$1(o.F,o.D,Ol))}}s.G=3,s.l&&s.l.xa(),s.$&&(s.P=Date.now()-i.F,s.j.info("Handshake RTT: "+s.P+"ms")),o=s;var d=i;if(o.sa=wc$1(o,o.H?o.ka:null,o.V),d.J){xc$1(o.h,d);var h=d,g=o.J;g&&h.setTimeout(g),h.B&&(ic$1(h),N$1(h)),o.g=d}else yc$1(o);0<s.i.length&&zc$1(s)}else _[0]!="stop"&&_[0]!="close"||R(s,7);else s.G==3&&(_[0]=="stop"||_[0]=="close"?_[0]=="stop"?R(s,7):Ac$1(s):_[0]!="noop"&&s.l&&s.l.wa(_),s.A=0)}}H$1(4)}catch{}}function Bc$1(i){if(i.W&&typeof i.W=="function")return i.W();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if(typeof i=="string")return i.split("");if(ba$1(i)){for(var e=[],s=i.length,o=0;o<s;o++)e.push(i[o]);return e}e=[],s=0;for(o in i)e[s++]=i[o];return e}function Cc$1(i){if(i.oa&&typeof i.oa=="function")return i.oa();if(!i.W||typeof i.W!="function"){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(ba$1(i)||typeof i=="string"){var e=[];i=i.length;for(var s=0;s<i;s++)e.push(s);return e}e=[],s=0;for(const o in i)e[s++]=o;return e}}}function Dc$1(i,e){if(i.forEach&&typeof i.forEach=="function")i.forEach(e,void 0);else if(ba$1(i)||typeof i=="string")Array.prototype.forEach.call(i,e,void 0);else for(var s=Cc$1(i),o=Bc$1(i),a=o.length,c=0;c<a;c++)e.call(void 0,o[c],s&&s[c],i)}var Ec$1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fc$1(i,e){if(i){i=i.split("&");for(var s=0;s<i.length;s++){var o=i[s].indexOf("="),a=null;if(0<=o){var c=i[s].substring(0,o);a=i[s].substring(o+1)}else c=i[s];e(c,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}function T(i,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,i instanceof T){this.h=e!==void 0?e:i.h,Gc$1(this,i.j),this.s=i.s,this.g=i.g,Hc$1(this,i.m),this.l=i.l,e=i.i;var s=new Ic$1;s.i=e.i,e.g&&(s.g=new Map(e.g),s.h=e.h),Jc$1(this,s),this.o=i.o}else i&&(s=String(i).match(Ec$1))?(this.h=!!e,Gc$1(this,s[1]||"",!0),this.s=Kc$1(s[2]||""),this.g=Kc$1(s[3]||"",!0),Hc$1(this,s[4]),this.l=Kc$1(s[5]||"",!0),Jc$1(this,s[6]||"",!0),this.o=Kc$1(s[7]||"")):(this.h=!!e,this.i=new Ic$1(null,this.h))}T.prototype.toString=function(){var i=[],e=this.j;e&&i.push(Lc$1(e,Mc$1,!0),":");var s=this.g;return(s||e=="file")&&(i.push("//"),(e=this.s)&&i.push(Lc$1(e,Mc$1,!0),"@"),i.push(encodeURIComponent(String(s)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s=this.m,s!=null&&i.push(":",String(s))),(s=this.l)&&(this.g&&s.charAt(0)!="/"&&i.push("/"),i.push(Lc$1(s,s.charAt(0)=="/"?Nc$1:Oc$1,!0))),(s=this.i.toString())&&i.push("?",s),(s=this.o)&&i.push("#",Lc$1(s,Pc$1)),i.join("")};function M$1(i){return new T(i)}function Gc$1(i,e,s){i.j=s?Kc$1(e,!0):e,i.j&&(i.j=i.j.replace(/:$/,""))}function Hc$1(i,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);i.m=e}else i.m=null}function Jc$1(i,e,s){e instanceof Ic$1?(i.i=e,Qc$1(i.i,i.h)):(s||(e=Lc$1(e,Rc$1)),i.i=new Ic$1(e,i.h))}function S$1(i,e,s){i.i.set(e,s)}function dc$1(i){return S$1(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function Kc$1(i,e){return i?e?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Lc$1(i,e,s){return typeof i=="string"?(i=encodeURI(i).replace(e,Sc$1),s&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function Sc$1(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var Mc$1=/[#\/\?@]/g,Oc$1=/[#\?:]/g,Nc$1=/[#\?]/g,Rc$1=/[#\?@]/g,Pc$1=/#/g;function Ic$1(i,e){this.h=this.g=null,this.i=i||null,this.j=!!e}function U$1(i){i.g||(i.g=new Map,i.h=0,i.i&&Fc$1(i.i,function(e,s){i.add(decodeURIComponent(e.replace(/\+/g," ")),s)}))}k$1=Ic$1.prototype;k$1.add=function(i,e){U$1(this),this.i=null,i=V$1(this,i);var s=this.g.get(i);return s||this.g.set(i,s=[]),s.push(e),this.h+=1,this};function Tc$1(i,e){U$1(i),e=V$1(i,e),i.g.has(e)&&(i.i=null,i.h-=i.g.get(e).length,i.g.delete(e))}function Uc$1(i,e){return U$1(i),e=V$1(i,e),i.g.has(e)}k$1.forEach=function(i,e){U$1(this),this.g.forEach(function(s,o){s.forEach(function(a){i.call(e,a,o,this)},this)},this)};k$1.oa=function(){U$1(this);const i=Array.from(this.g.values()),e=Array.from(this.g.keys()),s=[];for(let o=0;o<e.length;o++){const a=i[o];for(let c=0;c<a.length;c++)s.push(e[o])}return s};k$1.W=function(i){U$1(this);let e=[];if(typeof i=="string")Uc$1(this,i)&&(e=e.concat(this.g.get(V$1(this,i))));else{i=Array.from(this.g.values());for(let s=0;s<i.length;s++)e=e.concat(i[s])}return e};k$1.set=function(i,e){return U$1(this),this.i=null,i=V$1(this,i),Uc$1(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[e]),this.h+=1,this};k$1.get=function(i,e){return i?(i=this.W(i),0<i.length?String(i[0]):e):e};function fc$1(i,e,s){Tc$1(i,e),0<s.length&&(i.i=null,i.g.set(V$1(i,e),ma$1(s)),i.h+=s.length)}k$1.toString=function(){if(this.i)return this.i;if(!this.g)return"";const i=[],e=Array.from(this.g.keys());for(var s=0;s<e.length;s++){var o=e[s];const c=encodeURIComponent(String(o)),d=this.W(o);for(o=0;o<d.length;o++){var a=c;d[o]!==""&&(a+="="+encodeURIComponent(String(d[o]))),i.push(a)}}return this.i=i.join("&")};function V$1(i,e){return e=String(e),i.j&&(e=e.toLowerCase()),e}function Qc$1(i,e){e&&!i.j&&(U$1(i),i.i=null,i.g.forEach(function(s,o){var a=o.toLowerCase();o!=a&&(Tc$1(this,o),fc$1(this,a,s))},i)),i.j=e}var Vc$1=class{constructor(e,s){this.h=e,this.g=s}};function Wc$1(i){this.l=i||Xc$1,l.PerformanceNavigationTiming?(i=l.performance.getEntriesByType("navigation"),i=0<i.length&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(l.g&&l.g.Ga&&l.g.Ga()&&l.g.Ga().$b),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Xc$1=10;function Yc$1(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function uc$1(i){return i.h?1:i.g?i.g.size:0}function qc$1(i,e){return i.h?i.h==e:i.g?i.g.has(e):!1}function vc$1(i,e){i.g?i.g.add(e):i.h=e}function xc$1(i,e){i.h&&i.h==e?i.h=null:i.g&&i.g.has(e)&&i.g.delete(e)}Wc$1.prototype.cancel=function(){if(this.i=Zc$1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const i of this.g.values())i.cancel();this.g.clear()}};function Zc$1(i){if(i.h!=null)return i.i.concat(i.h.D);if(i.g!=null&&i.g.size!==0){let e=i.i;for(const s of i.g.values())e=e.concat(s.D);return e}return ma$1(i.i)}function $c$1(){}$c$1.prototype.stringify=function(i){return l.JSON.stringify(i,void 0)};$c$1.prototype.parse=function(i){return l.JSON.parse(i,void 0)};function ad(){this.g=new $c$1}function bd(i,e,s){const o=s||"";try{Dc$1(i,function(a,c){let d=a;p(a)&&(d=lb(a)),e.push(o+c+"="+encodeURIComponent(d))})}catch(a){throw e.push(o+"type="+encodeURIComponent("_badmap")),a}}function cd(i,e){const s=new Gb;if(l.Image){const o=new Image;o.onload=ia$1(dd,s,o,"TestLoadImage: loaded",!0,e),o.onerror=ia$1(dd,s,o,"TestLoadImage: error",!1,e),o.onabort=ia$1(dd,s,o,"TestLoadImage: abort",!1,e),o.ontimeout=ia$1(dd,s,o,"TestLoadImage: timeout",!1,e),l.setTimeout(function(){o.ontimeout&&o.ontimeout()},1e4),o.src=i}else e(!1)}function dd(i,e,s,o,a){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,a(o)}catch{}}function ed(i){this.l=i.ac||null,this.j=i.jb||!1}t(ed,Sb);ed.prototype.g=function(){return new fd(this.l,this.j)};ed.prototype.i=function(i){return function(){return i}}({});function fd(i,e){B$1.call(this),this.D=i,this.u=e,this.m=void 0,this.readyState=gd,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}t(fd,B$1);var gd=0;k$1=fd.prototype;k$1.open=function(i,e){if(this.readyState!=gd)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=e,this.readyState=1,hd(this)};k$1.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(e.body=i),(this.D||l).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))};k$1.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,id(this)),this.readyState=gd};k$1.Wa=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,hd(this)),this.g&&(this.readyState=3,hd(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jd(this)}else i.text().then(this.Va.bind(this),this.ga.bind(this))};function jd(i){i.j.read().then(i.Ta.bind(i)).catch(i.ga.bind(i))}k$1.Ta=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var e=i.value?i.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!i.done}))&&(this.response=this.responseText+=e)}i.done?id(this):hd(this),this.readyState==3&&jd(this)}};k$1.Va=function(i){this.g&&(this.response=this.responseText=i,id(this))};k$1.Ua=function(i){this.g&&(this.response=i,id(this))};k$1.ga=function(){this.g&&id(this)};function id(i){i.readyState=4,i.l=null,i.j=null,i.A=null,hd(i)}k$1.setRequestHeader=function(i,e){this.v.append(i,e)};k$1.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""};k$1.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],e=this.h.entries();for(var s=e.next();!s.done;)s=s.value,i.push(s[0]+": "+s[1]),s=e.next();return i.join(`\r
`)};function hd(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(fd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});var kd=l.JSON.parse;function W$1(i){B$1.call(this),this.headers=new Map,this.u=i||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ld,this.K=this.L=!1}t(W$1,B$1);var ld="",md=/^https?$/i,nd=["POST","PUT"];k$1=W$1.prototype;k$1.Ka=function(i){this.L=i};k$1.da=function(i,e,s,o){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+i);e=e?e.toUpperCase():"GET",this.H=i,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Xb.g(),this.C=this.u?Tb(this.u):Tb(Xb),this.g.onreadystatechange=q$1(this.Ha,this);try{this.F=!0,this.g.open(e,String(i),!0),this.F=!1}catch(c){od(this,c);return}if(i=s||"",s=new Map(this.headers),o)if(Object.getPrototypeOf(o)===Object.prototype)for(var a in o)s.set(a,o[a]);else if(typeof o.keys=="function"&&typeof o.get=="function")for(const c of o.keys())s.set(c,o.get(c));else throw Error("Unknown input type for opt_headers: "+String(o));o=Array.from(s.keys()).find(c=>c.toLowerCase()=="content-type"),a=l.FormData&&i instanceof l.FormData,!(0<=la$1(nd,e))||o||a||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[c,d]of s)this.g.setRequestHeader(c,d);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{pd(this),0<this.B&&((this.K=qd(this.g))?(this.g.timeout=this.B,this.g.ontimeout=q$1(this.qa,this)):this.A=Ab(this.qa,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(c){od(this,c)}};function qd(i){return y&&Ia$1()&&typeof i.timeout=="number"&&i.ontimeout!==void 0}k$1.qa=function(){typeof goog<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,C$1(this,"timeout"),this.abort(8))};function od(i,e){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=e,i.m=5,rd(i),sd(i)}function rd(i){i.D||(i.D=!0,C$1(i,"complete"),C$1(i,"error"))}k$1.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,C$1(this,"complete"),C$1(this,"abort"),sd(this))};k$1.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),sd(this,!0)),W$1.X.M.call(this)};k$1.Ha=function(){this.s||(this.F||this.v||this.l?td(this):this.fb())};k$1.fb=function(){td(this)};function td(i){if(i.h&&typeof goog<"u"&&(!i.C[1]||O$1(i)!=4||i.aa()!=2)){if(i.v&&O$1(i)==4)Ab(i.Ha,0,i);else if(C$1(i,"readystatechange"),O$1(i)==4){i.h=!1;try{const h=i.aa();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var s;if(!(s=e)){var o;if(o=h===0){var a=String(i.H).match(Ec$1)[1]||null;if(!a&&l.self&&l.self.location){var c=l.self.location.protocol;a=c.substr(0,c.length-1)}o=!md.test(a?a.toLowerCase():"")}s=o}if(s)C$1(i,"complete"),C$1(i,"success");else{i.m=6;try{var d=2<O$1(i)?i.g.statusText:""}catch{d=""}i.j=d+" ["+i.aa()+"]",rd(i)}}finally{sd(i)}}}}function sd(i,e){if(i.g){pd(i);const s=i.g,o=i.C[0]?aa$1:null;i.g=null,i.C=null,e||C$1(i,"ready");try{s.onreadystatechange=o}catch{}}}function pd(i){i.g&&i.K&&(i.g.ontimeout=null),i.A&&(l.clearTimeout(i.A),i.A=null)}function O$1(i){return i.g?i.g.readyState:0}k$1.aa=function(){try{return 2<O$1(this)?this.g.status:-1}catch{return-1}};k$1.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};k$1.Sa=function(i){if(this.g){var e=this.g.responseText;return i&&e.indexOf(i)==0&&(e=e.substring(i.length)),kd(e)}};function hc$1(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.J){case ld:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}k$1.Ea=function(){return this.m};k$1.Oa=function(){return typeof this.j=="string"?this.j:String(this.j)};function ud(i){let e="";return Qa$1(i,function(s,o){e+=o,e+=":",e+=s,e+=`\r
`}),e}function vd(i,e,s){e:{for(o in s){var o=!1;break e}o=!0}o||(s=ud(s),typeof i=="string"?s!=null&&encodeURIComponent(String(s)):S$1(i,e,s))}function wd(i,e,s){return s&&s.internalChannelParams&&s.internalChannelParams[i]||e}function xd(i){this.Ca=0,this.i=[],this.j=new Gb,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=wd("failFast",!1,i),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=wd("baseRetryDelayMs",5e3,i),this.bb=wd("retryDelaySeedMs",1e4,i),this.$a=wd("forwardChannelMaxRetries",2,i),this.ta=wd("forwardChannelRequestTimeoutMs",2e4,i),this.ra=i&&i.xmlHttpFactory||void 0,this.Da=i&&i.Zb||!1,this.J=void 0,this.H=i&&i.supportsCrossDomainXhr||!1,this.I="",this.h=new Wc$1(i&&i.concurrentRequestLimit),this.Fa=new ad,this.O=i&&i.fastHandshake||!1,this.N=i&&i.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=i&&i.Xb||!1,i&&i.Aa&&this.j.Aa(),i&&i.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&i&&i.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}k$1=xd.prototype;k$1.ma=8;k$1.G=1;function Ac$1(i){if(yd(i),i.G==3){var e=i.U++,s=M$1(i.F);S$1(s,"SID",i.I),S$1(s,"RID",e),S$1(s,"TYPE","terminate"),zd(i,s),e=new L$1(i,i.j,e,void 0),e.K=2,e.v=dc$1(M$1(s)),s=!1,l.navigator&&l.navigator.sendBeacon&&(s=l.navigator.sendBeacon(e.v.toString(),"")),!s&&l.Image&&(new Image().src=e.v,s=!0),s||(e.g=gc$1(e.l,null),e.g.da(e.v)),e.F=Date.now(),N$1(e)}Ad(i)}function sc$1(i){i.g&&(oc$1(i),i.g.cancel(),i.g=null)}function yd(i){sc$1(i),i.u&&(l.clearTimeout(i.u),i.u=null),rc$1(i),i.h.cancel(),i.m&&(typeof i.m=="number"&&l.clearTimeout(i.m),i.m=null)}function zc$1(i){Yc$1(i.h)||i.m||(i.m=!0,sb(i.Ja,i),i.C=0)}function Bd(i,e){return uc$1(i.h)>=i.h.j-(i.m?1:0)?!1:i.m?(i.i=e.D.concat(i.i),!0):i.G==1||i.G==2||i.C>=(i.Za?0:i.$a)?!1:(i.m=J(q$1(i.Ja,i,e),Cd(i,i.C)),i.C++,!0)}k$1.Ja=function(i){if(this.m)if(this.m=null,this.G==1){if(!i){this.U=Math.floor(1e5*Math.random()),i=this.U++;const a=new L$1(this,this.j,i,void 0);let c=this.s;if(this.S&&(c?(c=Ra$1(c),Ta$1(c,this.S)):c=this.S),this.o!==null||this.N||(a.H=c,c=null),this.O)e:{for(var e=0,s=0;s<this.i.length;s++){t:{var o=this.i[s];if("__data__"in o.g&&(o=o.g.__data__,typeof o=="string")){o=o.length;break t}o=void 0}if(o===void 0)break;if(e+=o,4096<e){e=s;break e}if(e===4096||s===this.i.length-1){e=s+1;break e}}e=1e3}else e=1e3;e=Dd(this,a,e),s=M$1(this.F),S$1(s,"RID",i),S$1(s,"CVER",22),this.D&&S$1(s,"X-HTTP-Session-Id",this.D),zd(this,s),c&&(this.N?e="headers="+encodeURIComponent(String(ud(c)))+"&"+e:this.o&&vd(s,this.o,c)),vc$1(this.h,a),this.Ya&&S$1(s,"TYPE","init"),this.O?(S$1(s,"$req",e),S$1(s,"SID","null"),a.Z=!0,cc$1(a,s,null)):cc$1(a,s,e),this.G=2}}else this.G==3&&(i?Ed(this,i):this.i.length==0||Yc$1(this.h)||Ed(this))};function Ed(i,e){var s;e?s=e.m:s=i.U++;const o=M$1(i.F);S$1(o,"SID",i.I),S$1(o,"RID",s),S$1(o,"AID",i.T),zd(i,o),i.o&&i.s&&vd(o,i.o,i.s),s=new L$1(i,i.j,s,i.C+1),i.o===null&&(s.H=i.s),e&&(i.i=e.D.concat(i.i)),e=Dd(i,s,1e3),s.setTimeout(Math.round(.5*i.ta)+Math.round(.5*i.ta*Math.random())),vc$1(i.h,s),cc$1(s,o,e)}function zd(i,e){i.ia&&Qa$1(i.ia,function(s,o){S$1(e,o,s)}),i.l&&Dc$1({},function(s,o){S$1(e,o,s)})}function Dd(i,e,s){s=Math.min(i.i.length,s);var o=i.l?q$1(i.l.Ra,i.l,i):null;e:{var a=i.i;let c=-1;for(;;){const d=["count="+s];c==-1?0<s?(c=a[0].h,d.push("ofs="+c)):c=0:d.push("ofs="+c);let h=!0;for(let g=0;g<s;g++){let _=a[g].h;const ft=a[g].g;if(_-=c,0>_)c=Math.max(0,a[g].h-100),h=!1;else try{bd(ft,d,"req"+_+"_")}catch{o&&o(ft)}}if(h){o=d.join("&");break e}}}return i=i.i.splice(0,s),e.D=i,o}function yc$1(i){i.g||i.u||(i.Z=1,sb(i.Ia,i),i.A=0)}function tc$1(i){return i.g||i.u||3<=i.A?!1:(i.Z++,i.u=J(q$1(i.Ia,i),Cd(i,i.A)),i.A++,!0)}k$1.Ia=function(){if(this.u=null,Fd(this),this.$&&!(this.K||this.g==null||0>=this.P)){var i=2*this.P;this.j.info("BP detection timer enabled: "+i),this.B=J(q$1(this.eb,this),i)}};k$1.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,I(10),sc$1(this),Fd(this))};function oc$1(i){i.B!=null&&(l.clearTimeout(i.B),i.B=null)}function Fd(i){i.g=new L$1(i,i.j,"rpc",i.Z),i.o===null&&(i.g.H=i.s),i.g.N=0;var e=M$1(i.sa);S$1(e,"RID","rpc"),S$1(e,"SID",i.I),S$1(e,"CI",i.L?"0":"1"),S$1(e,"AID",i.T),S$1(e,"TYPE","xmlhttp"),zd(i,e),i.o&&i.s&&vd(e,i.o,i.s),i.J&&i.g.setTimeout(i.J);var s=i.g;i=i.ka,s.K=1,s.v=dc$1(M$1(e)),s.s=null,s.P=!0,ec$1(s,i)}k$1.cb=function(){this.v!=null&&(this.v=null,sc$1(this),tc$1(this),I(19))};function rc$1(i){i.v!=null&&(l.clearTimeout(i.v),i.v=null)}function mc$1(i,e){var s=null;if(i.g==e){rc$1(i),oc$1(i),i.g=null;var o=2}else if(qc$1(i.h,e))s=e.D,xc$1(i.h,e),o=1;else return;if(i.G!=0){if(i.pa=e.Y,e.i)if(o==1){s=e.s?e.s.length:0,e=Date.now()-e.F;var a=i.C;o=Mb(),C$1(o,new Pb(o,s)),zc$1(i)}else yc$1(i);else if(a=e.o,a==3||a==0&&0<i.pa||!(o==1&&Bd(i,e)||o==2&&tc$1(i)))switch(s&&0<s.length&&(e=i.h,e.i=e.i.concat(s)),a){case 1:R(i,5);break;case 4:R(i,10);break;case 3:R(i,6);break;default:R(i,2)}}}function Cd(i,e){let s=i.Xa+Math.floor(Math.random()*i.bb);return i.l||(s*=2),s*e}function R(i,e){if(i.j.info("Error code "+e),e==2){var s=null;i.l&&(s=null);var o=q$1(i.kb,i);s||(s=new T("//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Gc$1(s,"https"),dc$1(s)),cd(s.toString(),o)}else I(2);i.G=0,i.l&&i.l.va(e),Ad(i),yd(i)}k$1.kb=function(i){i?(this.j.info("Successfully pinged google.com"),I(2)):(this.j.info("Failed to ping google.com"),I(1))};function Ad(i){if(i.G=0,i.la=[],i.l){const e=Zc$1(i.h);(e.length!=0||i.i.length!=0)&&(na$1(i.la,e),na$1(i.la,i.i),i.h.i.length=0,ma$1(i.i),i.i.length=0),i.l.ua()}}function wc$1(i,e,s){var o=s instanceof T?M$1(s):new T(s,void 0);if(o.g!="")e&&(o.g=e+"."+o.g),Hc$1(o,o.m);else{var a=l.location;o=a.protocol,e=e?e+"."+a.hostname:a.hostname,a=+a.port;var c=new T(null,void 0);o&&Gc$1(c,o),e&&(c.g=e),a&&Hc$1(c,a),s&&(c.l=s),o=c}return s=i.D,e=i.za,s&&e&&S$1(o,s,e),S$1(o,"VER",i.ma),zd(i,o),o}function gc$1(i,e,s){if(e&&!i.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=s&&i.Da&&!i.ra?new W$1(new ed({jb:!0})):new W$1(i.ra),e.Ka(i.H),e}function Gd(){}k$1=Gd.prototype;k$1.xa=function(){};k$1.wa=function(){};k$1.va=function(){};k$1.ua=function(){};k$1.Ra=function(){};function Hd(){if(y&&!(10<=Number(La$1)))throw Error("Environmental error: no available transport.")}Hd.prototype.g=function(i,e){return new X$1(i,e)};function X$1(i,e){B$1.call(this),this.g=new xd(e),this.l=i,this.h=e&&e.messageUrlParams||null,i=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(i?i["X-WebChannel-Content-Type"]=e.messageContentType:i={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(i?i["X-WebChannel-Client-Profile"]=e.ya:i={"X-WebChannel-Client-Profile":e.ya}),this.g.S=i,(i=e&&e.Yb)&&!pa$1(i)&&(this.g.o=i),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!pa$1(e)&&(this.g.D=e,i=this.h,i!==null&&e in i&&(i=this.h,e in i&&delete i[e])),this.j=new Y$1(this)}t(X$1,B$1);X$1.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var i=this.g,e=this.l,s=this.h||void 0;I(0),i.V=e,i.ia=s||{},i.L=i.Y,i.F=wc$1(i,null,i.V),zc$1(i)};X$1.prototype.close=function(){Ac$1(this.g)};X$1.prototype.u=function(i){var e=this.g;if(typeof i=="string"){var s={};s.__data__=i,i=s}else this.v&&(s={},s.__data__=lb(i),i=s);e.i.push(new Vc$1(e.ab++,i)),e.G==3&&zc$1(e)};X$1.prototype.M=function(){this.g.l=null,delete this.j,Ac$1(this.g),delete this.g,X$1.X.M.call(this)};function Id(i){Vb.call(this);var e=i.__sm__;if(e){e:{for(const s in e){i=s;break e}i=void 0}(this.i=i)&&(i=this.i,e=e!==null&&i in e?e[i]:void 0),this.data=e}else this.data=i}t(Id,Vb);function Jd(){Wb.call(this),this.status=1}t(Jd,Wb);function Y$1(i){this.g=i}t(Y$1,Gd);Y$1.prototype.xa=function(){C$1(this.g,"a")};Y$1.prototype.wa=function(i){C$1(this.g,new Id(i))};Y$1.prototype.va=function(i){C$1(this.g,new Jd)};Y$1.prototype.ua=function(){C$1(this.g,"b")};Hd.prototype.createWebChannel=Hd.prototype.g;X$1.prototype.send=X$1.prototype.u;X$1.prototype.open=X$1.prototype.m;X$1.prototype.close=X$1.prototype.close;Qb.NO_ERROR=0;Qb.TIMEOUT=8;Qb.HTTP_ERROR=6;Rb.COMPLETE="complete";Ub.EventType=K$1;K$1.OPEN="a";K$1.CLOSE="b";K$1.ERROR="c";K$1.MESSAGE="d";B$1.prototype.listen=B$1.prototype.N;W$1.prototype.listenOnce=W$1.prototype.O;W$1.prototype.getLastError=W$1.prototype.Oa;W$1.prototype.getLastErrorCode=W$1.prototype.Ea;W$1.prototype.getStatus=W$1.prototype.aa;W$1.prototype.getResponseJson=W$1.prototype.Sa;W$1.prototype.getResponseText=W$1.prototype.fa;W$1.prototype.send=W$1.prototype.da;W$1.prototype.setWithCredentials=W$1.prototype.Ka;var createWebChannelTransport=function(){return new Hd},getStatEventTarget=function(){return Mb()},ErrorCode$1=Qb,EventType=Rb,Event=G$1,Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},FetchXmlHttpFactory=ed,WebChannel=Ub,XhrIo=W$1;const b="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}v.UNAUTHENTICATED=new v(null),v.GOOGLE_CREDENTIALS=new v("google-credentials-uid"),v.FIRST_PARTY=new v("first-party-uid"),v.MOCK_USER=new v("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P="9.17.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V=new Logger("@firebase/firestore");function S(){return V.logLevel}function D(i){V.setLogLevel(i)}function C(i,...e){if(V.logLevel<=LogLevel.DEBUG){const s=e.map(k);V.debug(`Firestore (${P}): ${i}`,...s)}}function x(i,...e){if(V.logLevel<=LogLevel.ERROR){const s=e.map(k);V.error(`Firestore (${P}): ${i}`,...s)}}function N(i,...e){if(V.logLevel<=LogLevel.WARN){const s=e.map(k);V.warn(`Firestore (${P}): ${i}`,...s)}}function k(i){if(typeof i=="string")return i;try{return e=i,JSON.stringify(e)}catch{return i}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O(i="Unexpected state"){const e=`FIRESTORE (${P}) INTERNAL ASSERTION FAILED: `+i;throw x(e),new Error(e)}function M(i,e){i||O()}function F(i,e){i||O()}function $(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends FirebaseError{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(){this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable(()=>s(v.UNAUTHENTICATED))}shutdown(){}}class G{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable(()=>s(this.token.user))}shutdown(){this.changeListener=null}}class Q{constructor(e){this.t=e,this.currentUser=v.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){let o=this.i;const a=g=>this.i!==o?(o=this.i,s(g)):Promise.resolve();let c=new q;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new q,e.enqueueRetryable(()=>a(this.currentUser))};const d=()=>{const g=c;e.enqueueRetryable(async()=>{await g.promise,await a(this.currentUser)})},h=g=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(g=>h(g)),setTimeout(()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?h(g):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new q)}},0),d()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then(o=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(M(typeof o.accessToken=="string"),new U(o.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return M(e===null||typeof e=="string"),new v(e)}}class j{constructor(e,s,o,a){this.h=e,this.l=s,this.m=o,this.g=a,this.type="FirstParty",this.user=v.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(M(!(typeof this.h!="object"||this.h===null||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class z{constructor(e,s,o,a){this.h=e,this.l=s,this.m=o,this.g=a}getToken(){return Promise.resolve(new j(this.h,this.l,this.m,this.g))}start(e,s){e.enqueueRetryable(()=>s(v.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class W{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class H{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,s){const o=c=>{c.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.A;return this.A=c.token,C("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?s(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>o(c))};const a=c=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.appCheck.addTokenListener(this.o)};this.T.onInit(c=>a(c)),setTimeout(()=>{if(!this.appCheck){const c=this.T.getImmediate({optional:!0});c?a(c):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(s=>s?(M(typeof s.token=="string"),this.A=s.token,new W(s.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let o=0;o<i;o++)s[o]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=Math.floor(256/e.length)*e.length;let o="";for(;o.length<20;){const a=Y(40);for(let c=0;c<a.length;++c)o.length<20&&a[c]<s&&(o+=e.charAt(a[c]%e.length))}return o}}function X(i,e){return i<e?-1:i>e?1:0}function tt(i,e,s){return i.length===e.length&&i.every((o,a)=>s(o,e[a]))}function et(i){return i+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new L(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new L(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<-62135596800)throw new L(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return nt.fromMillis(Date.now())}static fromDate(e){return nt.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),o=Math.floor(1e6*(e-1e3*s));return new nt(s,o)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.timestamp=e}static fromTimestamp(e){return new st(e)}static min(){return new st(new nt(0,0))}static max(){return new st(new nt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,s,o){s===void 0?s=0:s>e.length&&O(),o===void 0?o=e.length-s:o>e.length-s&&O(),this.segments=e,this.offset=s,this.len=o}get length(){return this.len}isEqual(e){return it.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof it?e.forEach(o=>{s.push(o)}):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,o=this.limit();s<o;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const o=Math.min(e.length,s.length);for(let a=0;a<o;a++){const c=e.get(a),d=s.get(a);if(c<d)return-1;if(c>d)return 1}return e.length<s.length?-1:e.length>s.length?1:0}}class rt extends it{construct(e,s,o){return new rt(e,s,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const s=[];for(const o of e){if(o.indexOf("//")>=0)throw new L(B.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);s.push(...o.split("/").filter(a=>a.length>0))}return new rt(s)}static emptyPath(){return new rt([])}}const ot=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ut extends it{construct(e,s,o){return new ut(e,s,o)}static isValidIdentifier(e){return ot.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ut.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ut(["__name__"])}static fromServerFormat(e){const s=[];let o="",a=0;const c=()=>{if(o.length===0)throw new L(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(o),o=""};let d=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new L(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new L(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);o+=g,a+=2}else h==="`"?(d=!d,a++):h!=="."||d?(o+=h,a++):(c(),a++)}if(c(),d)throw new L(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ut(s)}static emptyPath(){return new ut([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.path=e}static fromPath(e){return new ct(rt.fromString(e))}static fromName(e){return new ct(rt.fromString(e).popFirst(5))}static empty(){return new ct(rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return rt.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new rt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,s,o,a){this.indexId=e,this.collectionGroup=s,this.fields=o,this.indexState=a}}function ht(i){return i.fields.find(e=>e.kind===2)}function lt(i){return i.fields.filter(e=>e.kind!==2)}at.UNKNOWN_ID=-1;class dt{constructor(e,s){this.fieldPath=e,this.kind=s}}class wt{constructor(e,s){this.sequenceNumber=e,this.offset=s}static empty(){return new wt(0,yt.min())}}function mt(i,e){const s=i.toTimestamp().seconds,o=i.toTimestamp().nanoseconds+1,a=st.fromTimestamp(o===1e9?new nt(s+1,0):new nt(s,o));return new yt(a,ct.empty(),e)}function gt(i){return new yt(i.readTime,i.key,-1)}class yt{constructor(e,s,o){this.readTime=e,this.documentKey=s,this.largestBatchId=o}static min(){return new yt(st.min(),ct.empty(),-1)}static max(){return new yt(st.max(),ct.empty(),-1)}}function pt(i,e){let s=i.readTime.compareTo(e.readTime);return s!==0?s:(s=ct.comparator(i.documentKey,e.documentKey),s!==0?s:X(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const It="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tt{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Et(i){if(i.code!==B.FAILED_PRECONDITION||i.message!==It)throw i;C("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)},s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)})}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&O(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new At((o,a)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(o,a)},this.catchCallback=c=>{this.wrapFailure(s,c).next(o,a)}})}toPromise(){return new Promise((e,s)=>{this.next(e,s)})}wrapUserFunction(e){try{const s=e();return s instanceof At?s:At.resolve(s)}catch(s){return At.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction(()=>e(s)):At.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction(()=>e(s)):At.reject(s)}static resolve(e){return new At((s,o)=>{s(e)})}static reject(e){return new At((s,o)=>{o(e)})}static waitFor(e){return new At((s,o)=>{let a=0,c=0,d=!1;e.forEach(h=>{++a,h.next(()=>{++c,d&&c===a&&s()},g=>o(g))}),d=!0,c===a&&s()})}static or(e){let s=At.resolve(!1);for(const o of e)s=s.next(a=>a?At.resolve(a):o());return s}static forEach(e,s){const o=[];return e.forEach((a,c)=>{o.push(s.call(this,a,c))}),this.waitFor(o)}static mapArray(e,s){return new At((o,a)=>{const c=e.length,d=new Array(c);let h=0;for(let g=0;g<c;g++){const _=g;s(e[_]).next(ft=>{d[_]=ft,++h,h===c&&o(d)},ft=>a(ft))}})}static doWhile(e,s){return new At((o,a)=>{const c=()=>{e()===!0?s().next(()=>{c()},a):o()};c()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,s){this.action=e,this.transaction=s,this.aborted=!1,this.v=new q,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{s.error?this.v.reject(new Pt(e,s.error)):this.v.resolve()},this.transaction.onerror=o=>{const a=xt(o.target.error);this.v.reject(new Pt(e,a))}}static open(e,s,o,a){try{return new Rt(s,e.transaction(a,o))}catch(c){throw new Pt(s,c)}}get P(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const s=this.transaction.objectStore(e);return new St(s)}}class bt{constructor(e,s,o){this.name=e,this.version=s,this.S=o,bt.D(getUA())===12.2&&x("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),Dt(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!isIndexedDBAvailable())return!1;if(bt.N())return!0;const e=getUA(),s=bt.D(e),o=0<s&&s<10,a=bt.k(e),c=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||o||c)}static N(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.O)==="YES"}static M(e,s){return e.store(s)}static D(e){const s=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),o=s?s[1].split("_").slice(0,2).join("."):"-1";return Number(o)}static k(e){const s=e.match(/Android ([\d.]+)/i),o=s?s[1].split(".").slice(0,2).join("."):"-1";return Number(o)}async F(e){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=await new Promise((s,o)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=c=>{const d=c.target.result;s(d)},a.onblocked=()=>{o(new Pt(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=c=>{const d=c.target.error;d.name==="VersionError"?o(new L(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):d.name==="InvalidStateError"?o(new L(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d)):o(new Pt(e,d))},a.onupgradeneeded=c=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',c.oldVersion);const d=c.target.result;this.S.$(d,a.transaction,c.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=s=>this.B(s)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=s=>e(s))}async runTransaction(e,s,o,a){const c=s==="readonly";let d=0;for(;;){++d;try{this.db=await this.F(e);const h=Rt.open(this.db,e,c?"readonly":"readwrite",o),g=a(h).next(_=>(h.V(),_)).catch(_=>(h.abort(_),At.reject(_))).toPromise();return g.catch(()=>{}),await h.P,g}catch(h){const g=h,_=g.name!=="FirebaseError"&&d<3;if(C("SimpleDb","Transaction failed with error:",g.message,"Retrying:",_),this.close(),!_)return Promise.reject(g)}}}close(){this.db&&this.db.close(),this.db=void 0}}class vt{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return Dt(this.q.delete())}}class Pt extends L{constructor(e,s){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${s}`),this.name="IndexedDbTransactionError"}}function Vt(i){return i.name==="IndexedDbTransactionError"}class St{constructor(e){this.store=e}put(e,s){let o;return s!==void 0?(C("SimpleDb","PUT",this.store.name,e,s),o=this.store.put(s,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),o=this.store.put(e)),Dt(o)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),Dt(this.store.add(e))}get(e){return Dt(this.store.get(e)).next(s=>(s===void 0&&(s=null),C("SimpleDb","GET",this.store.name,e,s),s))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),Dt(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),Dt(this.store.count())}W(e,s){const o=this.options(e,s);if(o.index||typeof this.store.getAll!="function"){const a=this.cursor(o),c=[];return this.H(a,(d,h)=>{c.push(h)}).next(()=>c)}{const a=this.store.getAll(o.range);return new At((c,d)=>{a.onerror=h=>{d(h.target.error)},a.onsuccess=h=>{c(h.target.result)}})}}J(e,s){const o=this.store.getAll(e,s===null?void 0:s);return new At((a,c)=>{o.onerror=d=>{c(d.target.error)},o.onsuccess=d=>{a(d.target.result)}})}Y(e,s){C("SimpleDb","DELETE ALL",this.store.name);const o=this.options(e,s);o.Z=!1;const a=this.cursor(o);return this.H(a,(c,d,h)=>h.delete())}X(e,s){let o;s?o=e:(o={},s=e);const a=this.cursor(o);return this.H(a,s)}tt(e){const s=this.cursor({});return new At((o,a)=>{s.onerror=c=>{const d=xt(c.target.error);a(d)},s.onsuccess=c=>{const d=c.target.result;d?e(d.primaryKey,d.value).next(h=>{h?d.continue():o()}):o()}})}H(e,s){const o=[];return new At((a,c)=>{e.onerror=d=>{c(d.target.error)},e.onsuccess=d=>{const h=d.target.result;if(!h)return void a();const g=new vt(h),_=s(h.primaryKey,h.value,g);if(_ instanceof At){const ft=_.catch(_t=>(g.done(),At.reject(_t)));o.push(ft)}g.isDone?a():g.G===null?h.continue():h.continue(g.G)}}).next(()=>At.waitFor(o))}options(e,s){let o;return e!==void 0&&(typeof e=="string"?o=e:s=e),{index:o,range:s}}cursor(e){let s="next";if(e.reverse&&(s="prev"),e.index){const o=this.store.index(e.index);return e.Z?o.openKeyCursor(e.range,s):o.openCursor(e.range,s)}return this.store.openCursor(e.range,s)}}function Dt(i){return new At((e,s)=>{i.onsuccess=o=>{const a=o.target.result;e(a)},i.onerror=o=>{const a=xt(o.target.error);s(a)}})}let Ct=!1;function xt(i){const e=bt.D(getUA());if(e>=12.2&&e<13){const s="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(s)>=0){const o=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${s}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ct||(Ct=!0,setTimeout(()=>{throw o},0)),o}}return i}class Nt{constructor(e,s){this.asyncQueue=e,this.et=s,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}nt(e){C("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{C("IndexBackiller",`Documents written: ${await this.et.st()}`)}catch(s){Vt(s)?C("IndexBackiller","Ignoring IndexedDB error during index backfill: ",s):await Et(s)}await this.nt(6e4)})}}class kt{constructor(e,s){this.localStore=e,this.persistence=s}async st(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",s=>this.it(s,e))}it(e,s){const o=new Set;let a=s,c=!0;return At.doWhile(()=>c===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(d=>{if(d!==null&&!o.has(d))return C("IndexBackiller",`Processing collection: ${d}`),this.rt(e,d,a).next(h=>{a-=h,o.add(d)});c=!1})).next(()=>s-a)}rt(e,s,o){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,s).next(a=>this.localStore.localDocuments.getNextDocuments(e,s,a,o).next(c=>{const d=c.changes;return this.localStore.indexManager.updateIndexEntries(e,d).next(()=>this.ot(a,c)).next(h=>(C("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,s,h))).next(()=>d.size)}))}ot(e,s){let o=e;return s.changes.forEach((a,c)=>{const d=gt(c);pt(d,o)>0&&(o=d)}),new yt(o.readTime,o.documentKey,Math.max(s.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=o=>this.ut(o),this.ct=o=>s.writeSequenceNumber(o))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}Ot.at=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,s,o,a,c,d,h,g){this.databaseId=e,this.appId=s,this.persistenceKey=o,this.host=a,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=h,this.useFetchStreams=g}}class Lt{constructor(e,s){this.projectId=e,this.database=s||"(default)"}static empty(){return new Lt("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Lt&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(i){let e=0;for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&e++;return e}function Ut(i,e){for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&e(s,i[s])}function Kt(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(i){return i==null}function Qt(i){return i===0&&1/i==-1/0}function jt(i){return typeof i=="number"&&Number.isInteger(i)&&!Qt(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.binaryString=e}static fromBase64String(e){const s=function(o){try{return atob(o)}catch(a){throw a instanceof DOMException?new zt("Invalid base64 string: "+a):a}}(e);return new Ht(s)}static fromUint8Array(e){const s=function(o){let a="";for(let c=0;c<o.length;++c)a+=String.fromCharCode(o[c]);return a}(e);return new Ht(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const s=new Uint8Array(e.length);for(let o=0;o<e.length;o++)s[o]=e.charCodeAt(o);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const Jt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yt(i){if(M(!!i),typeof i=="string"){let e=0;const s=Jt.exec(i);if(M(!!s),s[1]){let a=s[1];a=(a+"000000000").substr(0,9),e=Number(a)}const o=new Date(i);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:Zt(i.seconds),nanos:Zt(i.nanos)}}function Zt(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Xt(i){return typeof i=="string"?Ht.fromBase64String(i):Ht.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(i){var e,s;return((s=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||s===void 0?void 0:s.stringValue)==="server_timestamp"}function ee(i){const e=i.mapValue.fields.__previous_value__;return te(e)?ee(e):e}function ne(i){const e=Yt(i.mapValue.fields.__local_write_time__.timestampValue);return new nt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ie={nullValue:"NULL_VALUE"};function re(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?te(i)?4:pe(i)?9007199254740991:10:O()}function oe(i,e){if(i===e)return!0;const s=re(i);if(s!==re(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return ne(i).isEqual(ne(e));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const c=Yt(o.timestampValue),d=Yt(a.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(o,a){return Xt(o.bytesValue).isEqual(Xt(a.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(o,a){return Zt(o.geoPointValue.latitude)===Zt(a.geoPointValue.latitude)&&Zt(o.geoPointValue.longitude)===Zt(a.geoPointValue.longitude)}(i,e);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return Zt(o.integerValue)===Zt(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const c=Zt(o.doubleValue),d=Zt(a.doubleValue);return c===d?Qt(c)===Qt(d):isNaN(c)&&isNaN(d)}return!1}(i,e);case 9:return tt(i.arrayValue.values||[],e.arrayValue.values||[],oe);case 10:return function(o,a){const c=o.mapValue.fields||{},d=a.mapValue.fields||{};if(qt(c)!==qt(d))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(d[h]===void 0||!oe(c[h],d[h])))return!1;return!0}(i,e);default:return O()}}function ue(i,e){return(i.values||[]).find(s=>oe(s,e))!==void 0}function ce(i,e){if(i===e)return 0;const s=re(i),o=re(e);if(s!==o)return X(s,o);switch(s){case 0:case 9007199254740991:return 0;case 1:return X(i.booleanValue,e.booleanValue);case 2:return function(a,c){const d=Zt(a.integerValue||a.doubleValue),h=Zt(c.integerValue||c.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1}(i,e);case 3:return ae(i.timestampValue,e.timestampValue);case 4:return ae(ne(i),ne(e));case 5:return X(i.stringValue,e.stringValue);case 6:return function(a,c){const d=Xt(a),h=Xt(c);return d.compareTo(h)}(i.bytesValue,e.bytesValue);case 7:return function(a,c){const d=a.split("/"),h=c.split("/");for(let g=0;g<d.length&&g<h.length;g++){const _=X(d[g],h[g]);if(_!==0)return _}return X(d.length,h.length)}(i.referenceValue,e.referenceValue);case 8:return function(a,c){const d=X(Zt(a.latitude),Zt(c.latitude));return d!==0?d:X(Zt(a.longitude),Zt(c.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return function(a,c){const d=a.values||[],h=c.values||[];for(let g=0;g<d.length&&g<h.length;++g){const _=ce(d[g],h[g]);if(_)return _}return X(d.length,h.length)}(i.arrayValue,e.arrayValue);case 10:return function(a,c){if(a===se.mapValue&&c===se.mapValue)return 0;if(a===se.mapValue)return 1;if(c===se.mapValue)return-1;const d=a.fields||{},h=Object.keys(d),g=c.fields||{},_=Object.keys(g);h.sort(),_.sort();for(let ft=0;ft<h.length&&ft<_.length;++ft){const _t=X(h[ft],_[ft]);if(_t!==0)return _t;const $t=ce(d[h[ft]],g[_[ft]]);if($t!==0)return $t}return X(h.length,_.length)}(i.mapValue,e.mapValue);default:throw O()}}function ae(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return X(i,e);const s=Yt(i),o=Yt(e),a=X(s.seconds,o.seconds);return a!==0?a:X(s.nanos,o.nanos)}function he(i){return le(i)}function le(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(o){const a=Yt(o);return`time(${a.seconds},${a.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?Xt(i.bytesValue).toBase64():"referenceValue"in i?(s=i.referenceValue,ct.fromName(s).toString()):"geoPointValue"in i?`geo(${(e=i.geoPointValue).latitude},${e.longitude})`:"arrayValue"in i?function(o){let a="[",c=!0;for(const d of o.values||[])c?c=!1:a+=",",a+=le(d);return a+"]"}(i.arrayValue):"mapValue"in i?function(o){const a=Object.keys(o.fields||{}).sort();let c="{",d=!0;for(const h of a)d?d=!1:c+=",",c+=`${h}:${le(o.fields[h])}`;return c+"}"}(i.mapValue):O();var e,s}function fe(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function de(i){return!!i&&"integerValue"in i}function _e(i){return!!i&&"arrayValue"in i}function we(i){return!!i&&"nullValue"in i}function me(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function ge(i){return!!i&&"mapValue"in i}function ye(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return Ut(i.mapValue.fields,(s,o)=>e.mapValue.fields[s]=ye(o)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(i.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=ye(i.arrayValue.values[s]);return e}return Object.assign({},i)}function pe(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function Ie(i){return"nullValue"in i?ie:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?fe(Lt.empty(),ct.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:O()}function Te(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?fe(Lt.empty(),ct.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?se:O()}function Ee(i,e){const s=ce(i.value,e.value);return s!==0?s:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function Ae(i,e){const s=ce(i.value,e.value);return s!==0?s:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,s){this.position=e,this.inclusive=s}}function be(i,e,s){let o=0;for(let a=0;a<i.position.length;a++){const c=e[a],d=i.position[a];if(c.field.isKeyField()?o=ct.comparator(ct.fromName(d.referenceValue),s.key):o=ce(d,s.data.field(c.field)),c.dir==="desc"&&(o*=-1),o!==0)break}return o}function ve(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let s=0;s<i.position.length;s++)if(!oe(i.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{}class Ve extends Pe{constructor(e,s,o){super(),this.field=e,this.op=s,this.value=o}static create(e,s,o){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,o):new $e(e,s,o):s==="array-contains"?new Ue(e,o):s==="in"?new Ke(e,o):s==="not-in"?new Ge(e,o):s==="array-contains-any"?new Qe(e,o):new Ve(e,s,o)}static createKeyFieldInFilter(e,s,o){return s==="in"?new Be(e,o):new Le(e,o)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&this.matchesComparison(ce(s,this.value)):s!==null&&re(this.value)===re(s)&&this.matchesComparison(ce(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Se extends Pe{constructor(e,s){super(),this.filters=e,this.op=s,this.ft=null}static create(e,s){return new Se(e,s)}matches(e){return De(this)?this.filters.find(s=>!s.matches(e))===void 0:this.filters.find(s=>s.matches(e))!==void 0}getFlattenedFilters(){return this.ft!==null||(this.ft=this.filters.reduce((e,s)=>e.concat(s.getFlattenedFilters()),[])),this.ft}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.dt(s=>s.isInequality());return e!==null?e.field:null}dt(e){for(const s of this.getFlattenedFilters())if(e(s))return s;return null}}function De(i){return i.op==="and"}function Ce(i){return i.op==="or"}function xe(i){return Ne(i)&&De(i)}function Ne(i){for(const e of i.filters)if(e instanceof Se)return!1;return!0}function ke(i){if(i instanceof Ve)return i.field.canonicalString()+i.op.toString()+he(i.value);if(xe(i))return i.filters.map(e=>ke(e)).join(",");{const e=i.filters.map(s=>ke(s)).join(",");return`${i.op}(${e})`}}function Oe(i,e){return i instanceof Ve?function(s,o){return o instanceof Ve&&s.op===o.op&&s.field.isEqual(o.field)&&oe(s.value,o.value)}(i,e):i instanceof Se?function(s,o){return o instanceof Se&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce((a,c,d)=>a&&Oe(c,o.filters[d]),!0):!1}(i,e):void O()}function Me(i,e){const s=i.filters.concat(e);return Se.create(s,i.op)}function Fe(i){return i instanceof Ve?function(e){return`${e.field.canonicalString()} ${e.op} ${he(e.value)}`}(i):i instanceof Se?function(e){return e.op.toString()+" {"+e.getFilters().map(Fe).join(" ,")+"}"}(i):"Filter"}class $e extends Ve{constructor(e,s,o){super(e,s,o),this.key=ct.fromName(o.referenceValue)}matches(e){const s=ct.comparator(e.key,this.key);return this.matchesComparison(s)}}class Be extends Ve{constructor(e,s){super(e,"in",s),this.keys=qe("in",s)}matches(e){return this.keys.some(s=>s.isEqual(e.key))}}class Le extends Ve{constructor(e,s){super(e,"not-in",s),this.keys=qe("not-in",s)}matches(e){return!this.keys.some(s=>s.isEqual(e.key))}}function qe(i,e){var s;return(((s=e.arrayValue)===null||s===void 0?void 0:s.values)||[]).map(o=>ct.fromName(o.referenceValue))}class Ue extends Ve{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return _e(s)&&ue(s.arrayValue,this.value)}}class Ke extends Ve{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&ue(this.value.arrayValue,s)}}class Ge extends Ve{constructor(e,s){super(e,"not-in",s)}matches(e){if(ue(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&!ue(this.value.arrayValue,s)}}class Qe extends Ve{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!_e(s)||!s.arrayValue.values)&&s.arrayValue.values.some(o=>ue(this.value.arrayValue,o))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,s="asc"){this.field=e,this.dir=s}}function ze(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,s){this.comparator=e,this.root=s||Je.EMPTY}insert(e,s){return new We(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Je.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Je.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return s.value;o<0?s=s.left:o>0&&(s=s.right)}return null}indexOf(e){let s=0,o=this.root;for(;!o.isEmpty();){const a=this.comparator(e,o.key);if(a===0)return s+o.left.size;a<0?o=o.left:(s+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((s,o)=>(e(s,o),!1))}toString(){const e=[];return this.inorderTraversal((s,o)=>(e.push(`${s}:${o}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new He(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new He(this.root,e,this.comparator,!1)}getReverseIterator(){return new He(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new He(this.root,e,this.comparator,!0)}}class He{constructor(e,s,o,a){this.isReverse=a,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=s?o(e.key,s):1,s&&a&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Je{constructor(e,s,o,a,c){this.key=e,this.value=s,this.color=o??Je.RED,this.left=a??Je.EMPTY,this.right=c??Je.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,o,a,c){return new Je(e??this.key,s??this.value,o??this.color,a??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,o){let a=this;const c=o(e,a.key);return a=c<0?a.copy(null,null,null,a.left.insert(e,s,o),null):c===0?a.copy(null,s,null,null,null):a.copy(null,null,null,null,a.right.insert(e,s,o)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Je.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let o,a=this;if(s(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,s),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),s(e,a.key)===0){if(a.right.isEmpty())return Je.EMPTY;o=a.right.min(),a=a.copy(o.key,o.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,s))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Je.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Je.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw O();const e=this.left.check();if(e!==this.right.check())throw O();return e+(this.isRed()?0:1)}}Je.EMPTY=null,Je.RED=!0,Je.BLACK=!1;Je.EMPTY=new class{constructor(){this.size=0}get key(){throw O()}get value(){throw O()}get color(){throw O()}get left(){throw O()}get right(){throw O()}copy(i,e,s,o,a){return this}insert(i,e,s){return new Je(i,e)}remove(i,e){return this}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((s,o)=>(e(s),!1))}forEachInRange(e,s){const o=this.data.getIteratorFrom(e[0]);for(;o.hasNext();){const a=o.getNext();if(this.comparator(a.key,e[1])>=0)return;s(a.key)}}forEachWhile(e,s){let o;for(o=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();o.hasNext();)if(!e(o.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new Ze(this.data.getIterator())}getIteratorFrom(e){return new Ze(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach(o=>{s=s.add(o)}),s}isEqual(e){if(!(e instanceof Ye)||this.size!==e.size)return!1;const s=this.data.getIterator(),o=e.data.getIterator();for(;s.hasNext();){const a=s.getNext().key,c=o.getNext().key;if(this.comparator(a,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(s=>{e.push(s)}),e}toString(){const e=[];return this.forEach(s=>e.push(s)),"SortedSet("+e.toString()+")"}copy(e){const s=new Ye(this.comparator);return s.data=e,s}}class Ze{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xe(i){return i.hasNext()?i.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.fields=e,e.sort(ut.comparator)}static empty(){return new tn([])}unionWith(e){let s=new Ye(ut.comparator);for(const o of this.fields)s=s.add(o);for(const o of e)s=s.add(o);return new tn(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return tt(this.fields,e.fields,(s,o)=>s.isEqual(o))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.value=e}static empty(){return new en({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let o=0;o<e.length-1;++o)if(s=(s.mapValue.fields||{})[e.get(o)],!ge(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=ye(s)}setAll(e){let s=ut.emptyPath(),o={},a=[];e.forEach((d,h)=>{if(!s.isImmediateParentOf(h)){const g=this.getFieldsMap(s);this.applyChanges(g,o,a),o={},a=[],s=h.popLast()}d?o[h.lastSegment()]=ye(d):a.push(h.lastSegment())});const c=this.getFieldsMap(s);this.applyChanges(c,o,a)}delete(e){const s=this.field(e.popLast());ge(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return oe(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let o=0;o<e.length;++o){let a=s.mapValue.fields[e.get(o)];ge(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},s.mapValue.fields[e.get(o)]=a),s=a}return s.mapValue.fields}applyChanges(e,s,o){Ut(s,(a,c)=>e[a]=c);for(const a of o)delete e[a]}clone(){return new en(ye(this.value))}}function nn(i){const e=[];return Ut(i.fields,(s,o)=>{const a=new ut([s]);if(ge(o)){const c=nn(o.mapValue).fields;if(c.length===0)e.push(a);else for(const d of c)e.push(a.child(d))}else e.push(a)}),new tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,s,o,a,c,d,h){this.key=e,this.documentType=s,this.version=o,this.readTime=a,this.createTime=c,this.data=d,this.documentState=h}static newInvalidDocument(e){return new sn(e,0,st.min(),st.min(),st.min(),en.empty(),0)}static newFoundDocument(e,s,o,a){return new sn(e,1,s,st.min(),o,a,0)}static newNoDocument(e,s){return new sn(e,2,s,st.min(),st.min(),en.empty(),0)}static newUnknownDocument(e,s){return new sn(e,3,s,st.min(),st.min(),en.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=en.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=en.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof sn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,s=null,o=[],a=[],c=null,d=null,h=null){this.path=e,this.collectionGroup=s,this.orderBy=o,this.filters=a,this.limit=c,this.startAt=d,this.endAt=h,this._t=null}}function on(i,e=null,s=[],o=[],a=null,c=null,d=null){return new rn(i,e,s,o,a,c,d)}function un(i){const e=$(i);if(e._t===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map(o=>ke(o)).join(","),s+="|ob:",s+=e.orderBy.map(o=>function(a){return a.field.canonicalString()+a.dir}(o)).join(","),Gt(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(o=>he(o)).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(o=>he(o)).join(",")),e._t=s}return e._t}function cn(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<i.orderBy.length;s++)if(!ze(i.orderBy[s],e.orderBy[s]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let s=0;s<i.filters.length;s++)if(!Oe(i.filters[s],e.filters[s]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!ve(i.startAt,e.startAt)&&ve(i.endAt,e.endAt)}function an(i){return ct.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function hn(i,e){return i.filters.filter(s=>s instanceof Ve&&s.field.isEqual(e))}function ln(i,e,s){let o=ie,a=!0;for(const c of hn(i,e)){let d=ie,h=!0;switch(c.op){case"<":case"<=":d=Ie(c.value);break;case"==":case"in":case">=":d=c.value;break;case">":d=c.value,h=!1;break;case"!=":case"not-in":d=ie}Ee({value:o,inclusive:a},{value:d,inclusive:h})<0&&(o=d,a=h)}if(s!==null){for(let c=0;c<i.orderBy.length;++c)if(i.orderBy[c].field.isEqual(e)){const d=s.position[c];Ee({value:o,inclusive:a},{value:d,inclusive:s.inclusive})<0&&(o=d,a=s.inclusive);break}}return{value:o,inclusive:a}}function fn(i,e,s){let o=se,a=!0;for(const c of hn(i,e)){let d=se,h=!0;switch(c.op){case">=":case">":d=Te(c.value),h=!1;break;case"==":case"in":case"<=":d=c.value;break;case"<":d=c.value,h=!1;break;case"!=":case"not-in":d=se}Ae({value:o,inclusive:a},{value:d,inclusive:h})>0&&(o=d,a=h)}if(s!==null){for(let c=0;c<i.orderBy.length;++c)if(i.orderBy[c].field.isEqual(e)){const d=s.position[c];Ae({value:o,inclusive:a},{value:d,inclusive:s.inclusive})>0&&(o=d,a=s.inclusive);break}}return{value:o,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,s=null,o=[],a=[],c=null,d="F",h=null,g=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=o,this.filters=a,this.limit=c,this.limitType=d,this.startAt=h,this.endAt=g,this.wt=null,this.gt=null,this.startAt,this.endAt}}function _n(i,e,s,o,a,c,d,h){return new dn(i,e,s,o,a,c,d,h)}function wn(i){return new dn(i)}function mn(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function gn(i){return i.explicitOrderBy.length>0?i.explicitOrderBy[0].field:null}function yn(i){for(const e of i.filters){const s=e.getFirstInequalityField();if(s!==null)return s}return null}function pn(i){return i.collectionGroup!==null}function In(i){const e=$(i);if(e.wt===null){e.wt=[];const s=yn(e),o=gn(e);if(s!==null&&o===null)s.isKeyField()||e.wt.push(new je(s)),e.wt.push(new je(ut.keyField(),"asc"));else{let a=!1;for(const c of e.explicitOrderBy)e.wt.push(c),c.field.isKeyField()&&(a=!0);if(!a){const c=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new je(ut.keyField(),c))}}}return e.wt}function Tn(i){const e=$(i);if(!e.gt)if(e.limitType==="F")e.gt=on(e.path,e.collectionGroup,In(e),e.filters,e.limit,e.startAt,e.endAt);else{const s=[];for(const c of In(e)){const d=c.dir==="desc"?"asc":"desc";s.push(new je(c.field,d))}const o=e.endAt?new Re(e.endAt.position,e.endAt.inclusive):null,a=e.startAt?new Re(e.startAt.position,e.startAt.inclusive):null;e.gt=on(e.path,e.collectionGroup,s,e.filters,e.limit,o,a)}return e.gt}function En(i,e){e.getFirstInequalityField(),yn(i);const s=i.filters.concat([e]);return new dn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),s,i.limit,i.limitType,i.startAt,i.endAt)}function An(i,e,s){return new dn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,s,i.startAt,i.endAt)}function Rn(i,e){return cn(Tn(i),Tn(e))&&i.limitType===e.limitType}function bn(i){return`${un(Tn(i))}|lt:${i.limitType}`}function vn(i){return`Query(target=${function(e){let s=e.path.canonicalString();return e.collectionGroup!==null&&(s+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(s+=`, filters: [${e.filters.map(o=>Fe(o)).join(", ")}]`),Gt(e.limit)||(s+=", limit: "+e.limit),e.orderBy.length>0&&(s+=`, orderBy: [${e.orderBy.map(o=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(o)).join(", ")}]`),e.startAt&&(s+=", startAt: ",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(o=>he(o)).join(",")),e.endAt&&(s+=", endAt: ",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(o=>he(o)).join(",")),`Target(${s})`}(Tn(i))}; limitType=${i.limitType})`}function Pn(i,e){return e.isFoundDocument()&&function(s,o){const a=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(a):ct.isDocumentKey(s.path)?s.path.isEqual(a):s.path.isImmediateParentOf(a)}(i,e)&&function(s,o){for(const a of In(s))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(i,e)&&function(s,o){for(const a of s.filters)if(!a.matches(o))return!1;return!0}(i,e)&&function(s,o){return!(s.startAt&&!function(a,c,d){const h=be(a,c,d);return a.inclusive?h<=0:h<0}(s.startAt,In(s),o)||s.endAt&&!function(a,c,d){const h=be(a,c,d);return a.inclusive?h>=0:h>0}(s.endAt,In(s),o))}(i,e)}function Vn(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function Sn(i){return(e,s)=>{let o=!1;for(const a of In(i)){const c=Dn(a,e,s);if(c!==0)return c;o=o||a.field.isKeyField()}return 0}}function Dn(i,e,s){const o=i.field.isKeyField()?ct.comparator(e.key,s.key):function(a,c,d){const h=c.data.field(a),g=d.data.field(a);return h!==null&&g!==null?ce(h,g):O()}(i.field,e,s);switch(i.dir){case"asc":return o;case"desc":return-1*o;default:return O()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(i,e){if(i.yt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qt(e)?"-0":e}}function xn(i){return{integerValue:""+i}}function Nn(i,e){return jt(e)?xn(e):Cn(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(){this._=void 0}}function On(i,e,s){return i instanceof $n?function(o,a){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&(c.fields.__previous_value__=a),{mapValue:c}}(s,e):i instanceof Bn?Ln(i,e):i instanceof qn?Un(i,e):function(o,a){const c=Fn(o,a),d=Gn(c)+Gn(o.It);return de(c)&&de(o.It)?xn(d):Cn(o.Tt,d)}(i,e)}function Mn(i,e,s){return i instanceof Bn?Ln(i,e):i instanceof qn?Un(i,e):s}function Fn(i,e){return i instanceof Kn?de(s=e)||function(o){return!!o&&"doubleValue"in o}(s)?e:{integerValue:0}:null;var s}class $n extends kn{}class Bn extends kn{constructor(e){super(),this.elements=e}}function Ln(i,e){const s=Qn(e);for(const o of i.elements)s.some(a=>oe(a,o))||s.push(o);return{arrayValue:{values:s}}}class qn extends kn{constructor(e){super(),this.elements=e}}function Un(i,e){let s=Qn(e);for(const o of i.elements)s=s.filter(a=>!oe(a,o));return{arrayValue:{values:s}}}class Kn extends kn{constructor(e,s){super(),this.Tt=e,this.It=s}}function Gn(i){return Zt(i.integerValue||i.doubleValue)}function Qn(i){return _e(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,s){this.field=e,this.transform=s}}function zn(i,e){return i.field.isEqual(e.field)&&function(s,o){return s instanceof Bn&&o instanceof Bn||s instanceof qn&&o instanceof qn?tt(s.elements,o.elements,oe):s instanceof Kn&&o instanceof Kn?oe(s.It,o.It):s instanceof $n&&o instanceof $n}(i.transform,e.transform)}class Wn{constructor(e,s){this.version=e,this.transformResults=s}}class Hn{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new Hn}static exists(e){return new Hn(void 0,e)}static updateTime(e){return new Hn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jn(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class Yn{}function Zn(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new cs(i.key,Hn.none()):new ss(i.key,i.data,Hn.none());{const s=i.data,o=en.empty();let a=new Ye(ut.comparator);for(let c of e.fields)if(!a.has(c)){let d=s.field(c);d===null&&c.length>1&&(c=c.popLast(),d=s.field(c)),d===null?o.delete(c):o.set(c,d),a=a.add(c)}return new is(i.key,o,new tn(a.toArray()),Hn.none())}}function Xn(i,e,s){i instanceof ss?function(o,a,c){const d=o.value.clone(),h=os(o.fieldTransforms,a,c.transformResults);d.setAll(h),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(i,e,s):i instanceof is?function(o,a,c){if(!Jn(o.precondition,a))return void a.convertToUnknownDocument(c.version);const d=os(o.fieldTransforms,a,c.transformResults),h=a.data;h.setAll(rs(o)),h.setAll(d),a.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(i,e,s):function(o,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,s)}function ts(i,e,s,o){return i instanceof ss?function(a,c,d,h){if(!Jn(a.precondition,c))return d;const g=a.value.clone(),_=us(a.fieldTransforms,h,c);return g.setAll(_),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),null}(i,e,s,o):i instanceof is?function(a,c,d,h){if(!Jn(a.precondition,c))return d;const g=us(a.fieldTransforms,h,c),_=c.data;return _.setAll(rs(a)),_.setAll(g),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(ft=>ft.field))}(i,e,s,o):function(a,c,d){return Jn(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d}(i,e,s)}function es(i,e){let s=null;for(const o of i.fieldTransforms){const a=e.data.field(o.field),c=Fn(o.transform,a||null);c!=null&&(s===null&&(s=en.empty()),s.set(o.field,c))}return s||null}function ns(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&tt(s,o,(a,c)=>zn(a,c))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class ss extends Yn{constructor(e,s,o,a=[]){super(),this.key=e,this.value=s,this.precondition=o,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class is extends Yn{constructor(e,s,o,a,c=[]){super(),this.key=e,this.data=s,this.fieldMask=o,this.precondition=a,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function rs(i){const e=new Map;return i.fieldMask.fields.forEach(s=>{if(!s.isEmpty()){const o=i.data.field(s);e.set(s,o)}}),e}function os(i,e,s){const o=new Map;M(i.length===s.length);for(let a=0;a<s.length;a++){const c=i[a],d=c.transform,h=e.data.field(c.field);o.set(c.field,Mn(d,h,s[a]))}return o}function us(i,e,s){const o=new Map;for(const a of i){const c=a.transform,d=s.data.field(a.field);o.set(a.field,On(c,d,e))}return o}class cs extends Yn{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class as extends Yn{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ls,fs;function ds(i){switch(i){default:return O();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function _s(i){if(i===void 0)return x("GRPC error has no .code"),B.UNKNOWN;switch(i){case ls.OK:return B.OK;case ls.CANCELLED:return B.CANCELLED;case ls.UNKNOWN:return B.UNKNOWN;case ls.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case ls.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case ls.INTERNAL:return B.INTERNAL;case ls.UNAVAILABLE:return B.UNAVAILABLE;case ls.UNAUTHENTICATED:return B.UNAUTHENTICATED;case ls.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case ls.NOT_FOUND:return B.NOT_FOUND;case ls.ALREADY_EXISTS:return B.ALREADY_EXISTS;case ls.PERMISSION_DENIED:return B.PERMISSION_DENIED;case ls.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case ls.ABORTED:return B.ABORTED;case ls.OUT_OF_RANGE:return B.OUT_OF_RANGE;case ls.UNIMPLEMENTED:return B.UNIMPLEMENTED;case ls.DATA_LOSS:return B.DATA_LOSS;default:return O()}}(fs=ls||(ls={}))[fs.OK=0]="OK",fs[fs.CANCELLED=1]="CANCELLED",fs[fs.UNKNOWN=2]="UNKNOWN",fs[fs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fs[fs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fs[fs.NOT_FOUND=5]="NOT_FOUND",fs[fs.ALREADY_EXISTS=6]="ALREADY_EXISTS",fs[fs.PERMISSION_DENIED=7]="PERMISSION_DENIED",fs[fs.UNAUTHENTICATED=16]="UNAUTHENTICATED",fs[fs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fs[fs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fs[fs.ABORTED=10]="ABORTED",fs[fs.OUT_OF_RANGE=11]="OUT_OF_RANGE",fs[fs.UNIMPLEMENTED=12]="UNIMPLEMENTED",fs[fs.INTERNAL=13]="INTERNAL",fs[fs.UNAVAILABLE=14]="UNAVAILABLE",fs[fs.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),o=this.inner[s];if(o!==void 0){for(const[a,c]of o)if(this.equalsFn(a,e))return c}}has(e){return this.get(e)!==void 0}set(e,s){const o=this.mapKeyFn(e),a=this.inner[o];if(a===void 0)return this.inner[o]=[[e,s]],void this.innerSize++;for(let c=0;c<a.length;c++)if(this.equalsFn(a[c][0],e))return void(a[c]=[e,s]);a.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return!1;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return o.length===1?delete this.inner[s]:o.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ut(this.inner,(s,o)=>{for(const[a,c]of o)e(a,c)})}isEmpty(){return Kt(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=new We(ct.comparator);function gs(){return ms}const ys=new We(ct.comparator);function ps(...i){let e=ys;for(const s of i)e=e.insert(s.key,s);return e}function Is(i){let e=ys;return i.forEach((s,o)=>e=e.insert(s,o.overlayedDocument)),e}function Ts(){return As()}function Es(){return As()}function As(){return new ws(i=>i.toString(),(i,e)=>i.isEqual(e))}const Rs=new We(ct.comparator),bs=new Ye(ct.comparator);function vs(...i){let e=bs;for(const s of i)e=e.add(s);return e}const Ps=new Ye(X);function Vs(){return Ps}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,s,o,a,c){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=o,this.documentUpdates=a,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,s,o){const a=new Map;return a.set(e,Ds.createSynthesizedTargetChangeForCurrentChange(e,s,o)),new Ss(st.min(),a,Vs(),gs(),vs())}}class Ds{constructor(e,s,o,a,c){this.resumeToken=e,this.current=s,this.addedDocuments=o,this.modifiedDocuments=a,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,s,o){return new Ds(o,s,vs(),vs(),vs())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,s,o,a){this.Et=e,this.removedTargetIds=s,this.key=o,this.At=a}}class xs{constructor(e,s){this.targetId=e,this.Rt=s}}class Ns{constructor(e,s,o=Ht.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=s,this.resumeToken=o,this.cause=a}}class ks{constructor(){this.bt=0,this.vt=Fs(),this.Pt=Ht.EMPTY_BYTE_STRING,this.Vt=!1,this.St=!0}get current(){return this.Vt}get resumeToken(){return this.Pt}get Dt(){return this.bt!==0}get Ct(){return this.St}xt(e){e.approximateByteSize()>0&&(this.St=!0,this.Pt=e)}Nt(){let e=vs(),s=vs(),o=vs();return this.vt.forEach((a,c)=>{switch(c){case 0:e=e.add(a);break;case 2:s=s.add(a);break;case 1:o=o.add(a);break;default:O()}}),new Ds(this.Pt,this.Vt,e,s,o)}kt(){this.St=!1,this.vt=Fs()}Ot(e,s){this.St=!0,this.vt=this.vt.insert(e,s)}Mt(e){this.St=!0,this.vt=this.vt.remove(e)}Ft(){this.bt+=1}$t(){this.bt-=1}Bt(){this.St=!0,this.Vt=!0}}class Os{constructor(e){this.Lt=e,this.qt=new Map,this.Ut=gs(),this.Kt=Ms(),this.Gt=new Ye(X)}Qt(e){for(const s of e.Et)e.At&&e.At.isFoundDocument()?this.jt(s,e.At):this.zt(s,e.key,e.At);for(const s of e.removedTargetIds)this.zt(s,e.key,e.At)}Wt(e){this.forEachTarget(e,s=>{const o=this.Ht(s);switch(e.state){case 0:this.Jt(s)&&o.xt(e.resumeToken);break;case 1:o.$t(),o.Dt||o.kt(),o.xt(e.resumeToken);break;case 2:o.$t(),o.Dt||this.removeTarget(s);break;case 3:this.Jt(s)&&(o.Bt(),o.xt(e.resumeToken));break;case 4:this.Jt(s)&&(this.Yt(s),o.xt(e.resumeToken));break;default:O()}})}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.qt.forEach((o,a)=>{this.Jt(a)&&s(a)})}Zt(e){const s=e.targetId,o=e.Rt.count,a=this.Xt(s);if(a){const c=a.target;if(an(c))if(o===0){const d=new ct(c.path);this.zt(s,d,sn.newNoDocument(d,st.min()))}else M(o===1);else this.te(s)!==o&&(this.Yt(s),this.Gt=this.Gt.add(s))}}ee(e){const s=new Map;this.qt.forEach((c,d)=>{const h=this.Xt(d);if(h){if(c.current&&an(h.target)){const g=new ct(h.target.path);this.Ut.get(g)!==null||this.ne(d,g)||this.zt(d,g,sn.newNoDocument(g,e))}c.Ct&&(s.set(d,c.Nt()),c.kt())}});let o=vs();this.Kt.forEach((c,d)=>{let h=!0;d.forEachWhile(g=>{const _=this.Xt(g);return!_||_.purpose===2||(h=!1,!1)}),h&&(o=o.add(c))}),this.Ut.forEach((c,d)=>d.setReadTime(e));const a=new Ss(e,s,this.Gt,this.Ut,o);return this.Ut=gs(),this.Kt=Ms(),this.Gt=new Ye(X),a}jt(e,s){if(!this.Jt(e))return;const o=this.ne(e,s.key)?2:0;this.Ht(e).Ot(s.key,o),this.Ut=this.Ut.insert(s.key,s),this.Kt=this.Kt.insert(s.key,this.se(s.key).add(e))}zt(e,s,o){if(!this.Jt(e))return;const a=this.Ht(e);this.ne(e,s)?a.Ot(s,1):a.Mt(s),this.Kt=this.Kt.insert(s,this.se(s).delete(e)),o&&(this.Ut=this.Ut.insert(s,o))}removeTarget(e){this.qt.delete(e)}te(e){const s=this.Ht(e).Nt();return this.Lt.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}Ft(e){this.Ht(e).Ft()}Ht(e){let s=this.qt.get(e);return s||(s=new ks,this.qt.set(e,s)),s}se(e){let s=this.Kt.get(e);return s||(s=new Ye(X),this.Kt=this.Kt.insert(e,s)),s}Jt(e){const s=this.Xt(e)!==null;return s||C("WatchChangeAggregator","Detected inactive target",e),s}Xt(e){const s=this.qt.get(e);return s&&s.Dt?null:this.Lt.ie(e)}Yt(e){this.qt.set(e,new ks),this.Lt.getRemoteKeysForTarget(e).forEach(s=>{this.zt(e,s,null)})}ne(e,s){return this.Lt.getRemoteKeysForTarget(e).has(s)}}function Ms(){return new We(ct.comparator)}function Fs(){return new We(ct.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Bs=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Ls=(()=>({and:"AND",or:"OR"}))();class qs{constructor(e,s){this.databaseId=e,this.yt=s}}function Us(i,e){return i.yt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ks(i,e){return i.yt?e.toBase64():e.toUint8Array()}function Gs(i,e){return Us(i,e.toTimestamp())}function Qs(i){return M(!!i),st.fromTimestamp(function(e){const s=Yt(e);return new nt(s.seconds,s.nanos)}(i))}function js(i,e){return function(s){return new rt(["projects",s.projectId,"databases",s.database])}(i).child("documents").child(e).canonicalString()}function zs(i){const e=rt.fromString(i);return M(pi(e)),e}function Ws(i,e){return js(i.databaseId,e.path)}function Hs(i,e){const s=zs(e);if(s.get(1)!==i.databaseId.projectId)throw new L(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+i.databaseId.projectId);if(s.get(3)!==i.databaseId.database)throw new L(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+i.databaseId.database);return new ct(Xs(s))}function Js(i,e){return js(i.databaseId,e)}function Ys(i){const e=zs(i);return e.length===4?rt.emptyPath():Xs(e)}function Zs(i){return new rt(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function Xs(i){return M(i.length>4&&i.get(4)==="documents"),i.popFirst(5)}function ti(i,e,s){return{name:Ws(i,e),fields:s.value.mapValue.fields}}function ei(i,e,s){const o=Hs(i,e.name),a=Qs(e.updateTime),c=e.createTime?Qs(e.createTime):st.min(),d=new en({mapValue:{fields:e.fields}}),h=sn.newFoundDocument(o,a,c,d);return s&&h.setHasCommittedMutations(),s?h.setHasCommittedMutations():h}function ni(i,e){return"found"in e?function(s,o){M(!!o.found),o.found.name,o.found.updateTime;const a=Hs(s,o.found.name),c=Qs(o.found.updateTime),d=o.found.createTime?Qs(o.found.createTime):st.min(),h=new en({mapValue:{fields:o.found.fields}});return sn.newFoundDocument(a,c,d,h)}(i,e):"missing"in e?function(s,o){M(!!o.missing),M(!!o.readTime);const a=Hs(s,o.missing),c=Qs(o.readTime);return sn.newNoDocument(a,c)}(i,e):O()}function si(i,e){let s;if("targetChange"in e){e.targetChange;const o=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:O()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],c=function(g,_){return g.yt?(M(_===void 0||typeof _=="string"),Ht.fromBase64String(_||"")):(M(_===void 0||_ instanceof Uint8Array),Ht.fromUint8Array(_||new Uint8Array))}(i,e.targetChange.resumeToken),d=e.targetChange.cause,h=d&&function(g){const _=g.code===void 0?B.UNKNOWN:_s(g.code);return new L(_,g.message||"")}(d);s=new Ns(o,a,c,h||null)}else if("documentChange"in e){e.documentChange;const o=e.documentChange;o.document,o.document.name,o.document.updateTime;const a=Hs(i,o.document.name),c=Qs(o.document.updateTime),d=o.document.createTime?Qs(o.document.createTime):st.min(),h=new en({mapValue:{fields:o.document.fields}}),g=sn.newFoundDocument(a,c,d,h),_=o.targetIds||[],ft=o.removedTargetIds||[];s=new Cs(_,ft,g.key,g)}else if("documentDelete"in e){e.documentDelete;const o=e.documentDelete;o.document;const a=Hs(i,o.document),c=o.readTime?Qs(o.readTime):st.min(),d=sn.newNoDocument(a,c),h=o.removedTargetIds||[];s=new Cs([],h,d.key,d)}else if("documentRemove"in e){e.documentRemove;const o=e.documentRemove;o.document;const a=Hs(i,o.document),c=o.removedTargetIds||[];s=new Cs([],c,a,null)}else{if(!("filter"in e))return O();{e.filter;const o=e.filter;o.targetId;const a=o.count||0,c=new hs(a),d=o.targetId;s=new xs(d,c)}}return s}function ii(i,e){let s;if(e instanceof ss)s={update:ti(i,e.key,e.value)};else if(e instanceof cs)s={delete:Ws(i,e.key)};else if(e instanceof is)s={update:ti(i,e.key,e.data),updateMask:yi(e.fieldMask)};else{if(!(e instanceof as))return O();s={verify:Ws(i,e.key)}}return e.fieldTransforms.length>0&&(s.updateTransforms=e.fieldTransforms.map(o=>function(a,c){const d=c.transform;if(d instanceof $n)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Bn)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof qn)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Kn)return{fieldPath:c.field.canonicalString(),increment:d.It};throw O()}(0,o))),e.precondition.isNone||(s.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:Gs(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:O()}(i,e.precondition)),s}function ri(i,e){const s=e.currentDocument?function(a){return a.updateTime!==void 0?Hn.updateTime(Qs(a.updateTime)):a.exists!==void 0?Hn.exists(a.exists):Hn.none()}(e.currentDocument):Hn.none(),o=e.updateTransforms?e.updateTransforms.map(a=>function(c,d){let h=null;if("setToServerValue"in d)M(d.setToServerValue==="REQUEST_TIME"),h=new $n;else if("appendMissingElements"in d){const _=d.appendMissingElements.values||[];h=new Bn(_)}else if("removeAllFromArray"in d){const _=d.removeAllFromArray.values||[];h=new qn(_)}else"increment"in d?h=new Kn(c,d.increment):O();const g=ut.fromServerFormat(d.fieldPath);return new jn(g,h)}(i,a)):[];if(e.update){e.update.name;const a=Hs(i,e.update.name),c=new en({mapValue:{fields:e.update.fields}});if(e.updateMask){const d=function(h){const g=h.fieldPaths||[];return new tn(g.map(_=>ut.fromServerFormat(_)))}(e.updateMask);return new is(a,c,d,s,o)}return new ss(a,c,s,o)}if(e.delete){const a=Hs(i,e.delete);return new cs(a,s)}if(e.verify){const a=Hs(i,e.verify);return new as(a,s)}return O()}function oi(i,e){return i&&i.length>0?(M(e!==void 0),i.map(s=>function(o,a){let c=o.updateTime?Qs(o.updateTime):Qs(a);return c.isEqual(st.min())&&(c=Qs(a)),new Wn(c,o.transformResults||[])}(s,e))):[]}function ui(i,e){return{documents:[Js(i,e.path)]}}function ci(i,e){const s={structuredQuery:{}},o=e.path;e.collectionGroup!==null?(s.parent=Js(i,o),s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s.parent=Js(i,o.popLast()),s.structuredQuery.from=[{collectionId:o.lastSegment()}]);const a=function(g){if(g.length!==0)return gi(Se.create(g,"and"))}(e.filters);a&&(s.structuredQuery.where=a);const c=function(g){if(g.length!==0)return g.map(_=>function(ft){return{field:wi(ft.field),direction:fi(ft.dir)}}(_))}(e.orderBy);c&&(s.structuredQuery.orderBy=c);const d=function(g,_){return g.yt||Gt(_)?_:{value:_}}(i,e.limit);var h;return d!==null&&(s.structuredQuery.limit=d),e.startAt&&(s.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(s.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),s}function ai(i){let e=Ys(i.parent);const s=i.structuredQuery,o=s.from?s.from.length:0;let a=null;if(o>0){M(o===1);const ft=s.from[0];ft.allDescendants?a=ft.collectionId:e=e.child(ft.collectionId)}let c=[];s.where&&(c=function(ft){const _t=li(ft);return _t instanceof Se&&xe(_t)?_t.getFilters():[_t]}(s.where));let d=[];s.orderBy&&(d=s.orderBy.map(ft=>function(_t){return new je(mi(_t.field),function($t){switch($t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_t.direction))}(ft)));let h=null;s.limit&&(h=function(ft){let _t;return _t=typeof ft=="object"?ft.value:ft,Gt(_t)?null:_t}(s.limit));let g=null;s.startAt&&(g=function(ft){const _t=!!ft.before,$t=ft.values||[];return new Re($t,_t)}(s.startAt));let _=null;return s.endAt&&(_=function(ft){const _t=!ft.before,$t=ft.values||[];return new Re($t,_t)}(s.endAt)),_n(e,a,d,c,h,"F",g,_)}function hi(i,e){const s=function(o,a){switch(a){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return O()}}(0,e.purpose);return s==null?null:{"goog-listen-tags":s}}function li(i){return i.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const s=mi(e.unaryFilter.field);return Ve.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=mi(e.unaryFilter.field);return Ve.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=mi(e.unaryFilter.field);return Ve.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=mi(e.unaryFilter.field);return Ve.create(c,"!=",{nullValue:"NULL_VALUE"});default:return O()}}(i):i.fieldFilter!==void 0?function(e){return Ve.create(mi(e.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return O()}}(e.fieldFilter.op),e.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(e){return Se.create(e.compositeFilter.filters.map(s=>li(s)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return O()}}(e.compositeFilter.op))}(i):O()}function fi(i){return $s[i]}function di(i){return Bs[i]}function _i(i){return Ls[i]}function wi(i){return{fieldPath:i.canonicalString()}}function mi(i){return ut.fromServerFormat(i.fieldPath)}function gi(i){return i instanceof Ve?function(e){if(e.op==="=="){if(me(e.value))return{unaryFilter:{field:wi(e.field),op:"IS_NAN"}};if(we(e.value))return{unaryFilter:{field:wi(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(me(e.value))return{unaryFilter:{field:wi(e.field),op:"IS_NOT_NAN"}};if(we(e.value))return{unaryFilter:{field:wi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wi(e.field),op:di(e.op),value:e.value}}}(i):i instanceof Se?function(e){const s=e.getFilters().map(o=>gi(o));return s.length===1?s[0]:{compositeFilter:{op:_i(e.op),filters:s}}}(i):O()}function yi(i){const e=[];return i.fields.forEach(s=>e.push(s.canonicalString())),{fieldPaths:e}}function pi(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(i){let e="";for(let s=0;s<i.length;s++)e.length>0&&(e=Ei(e)),e=Ti(i.get(s),e);return Ei(e)}function Ti(i,e){let s=e;const o=i.length;for(let a=0;a<o;a++){const c=i.charAt(a);switch(c){case"\0":s+="";break;case"":s+="";break;default:s+=c}}return s}function Ei(i){return i+""}function Ai(i){const e=i.length;if(M(e>=2),e===2)return M(i.charAt(0)===""&&i.charAt(1)===""),rt.emptyPath();const s=e-2,o=[];let a="";for(let c=0;c<e;){const d=i.indexOf("",c);switch((d<0||d>s)&&O(),i.charAt(d+1)){case"":const h=i.substring(c,d);let g;a.length===0?g=h:(a+=h,g=a,a=""),o.push(g);break;case"":a+=i.substring(c,d),a+="\0";break;case"":a+=i.substring(c,d+1);break;default:O()}c=d+2}return new rt(o)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(i,e){return[i,Ii(e)]}function vi(i,e,s){return[i,Ii(e),s]}const Pi={},Vi=["prefixPath","collectionGroup","readTime","documentId"],Si=["prefixPath","collectionGroup","documentId"],Di=["collectionGroup","readTime","prefixPath","documentId"],Ci=["canonicalId","targetId"],xi=["targetId","path"],Ni=["path","targetId"],ki=["collectionId","parent"],Oi=["indexId","uid"],Mi=["uid","sequenceNumber"],Fi=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$i=["indexId","uid","orderedDocumentKey"],Bi=["userId","collectionPath","documentId"],Li=["userId","collectionPath","largestBatchId"],qi=["userId","collectionGroup","largestBatchId"],Ui=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ki=[...Ui,"documentOverlays"],Gi=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Qi=Gi,ji=[...Qi,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends Tt{constructor(e,s){super(),this.re=e,this.currentSequenceNumber=s}}function Wi(i,e){const s=$(i);return bt.M(s.re,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,s,o,a){this.batchId=e,this.localWriteTime=s,this.baseMutations=o,this.mutations=a}applyToRemoteDocument(e,s){const o=s.mutationResults;for(let a=0;a<this.mutations.length;a++){const c=this.mutations[a];c.key.isEqual(e.key)&&Xn(c,e,o[a])}}applyToLocalView(e,s){for(const o of this.baseMutations)o.key.isEqual(e.key)&&(s=ts(o,e,s,this.localWriteTime));for(const o of this.mutations)o.key.isEqual(e.key)&&(s=ts(o,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const o=Es();return this.mutations.forEach(a=>{const c=e.get(a.key),d=c.overlayedDocument;let h=this.applyToLocalView(d,c.mutatedFields);h=s.has(a.key)?null:h;const g=Zn(d,h);g!==null&&o.set(a.key,g),d.isValidDocument()||d.convertToNoDocument(st.min())}),o}keys(){return this.mutations.reduce((e,s)=>e.add(s.key),vs())}isEqual(e){return this.batchId===e.batchId&&tt(this.mutations,e.mutations,(s,o)=>ns(s,o))&&tt(this.baseMutations,e.baseMutations,(s,o)=>ns(s,o))}}class Ji{constructor(e,s,o,a){this.batch=e,this.commitVersion=s,this.mutationResults=o,this.docVersions=a}static from(e,s,o){M(e.mutations.length===o.length);let a=Rs;const c=e.mutations;for(let d=0;d<c.length;d++)a=a.insert(c[d].key,o[d].version);return new Ji(e,s,o,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,s,o,a,c=st.min(),d=st.min(),h=Ht.EMPTY_BYTE_STRING){this.target=e,this.targetId=s,this.purpose=o,this.sequenceNumber=a,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=h}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,s){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.oe=e}}function tr(i,e){let s;if(e.document)s=ei(i.oe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const o=ct.fromSegments(e.noDocument.path),a=ir(e.noDocument.readTime);s=sn.newNoDocument(o,a),e.hasCommittedMutations&&s.setHasCommittedMutations()}else{if(!e.unknownDocument)return O();{const o=ct.fromSegments(e.unknownDocument.path),a=ir(e.unknownDocument.version);s=sn.newUnknownDocument(o,a)}}return e.readTime&&s.setReadTime(function(o){const a=new nt(o[0],o[1]);return st.fromTimestamp(a)}(e.readTime)),s}function er(i,e){const s=e.key,o={prefixPath:s.getCollectionPath().popLast().toArray(),collectionGroup:s.collectionGroup,documentId:s.path.lastSegment(),readTime:nr(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())o.document=function(a,c){return{name:Ws(a,c.key),fields:c.data.value.mapValue.fields,updateTime:Us(a,c.version.toTimestamp()),createTime:Us(a,c.createTime.toTimestamp())}}(i.oe,e);else if(e.isNoDocument())o.noDocument={path:s.path.toArray(),readTime:sr(e.version)};else{if(!e.isUnknownDocument())return O();o.unknownDocument={path:s.path.toArray(),version:sr(e.version)}}return o}function nr(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function sr(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ir(i){const e=new nt(i.seconds,i.nanoseconds);return st.fromTimestamp(e)}function rr(i,e){const s=(e.baseMutations||[]).map(c=>ri(i.oe,c));for(let c=0;c<e.mutations.length-1;++c){const d=e.mutations[c];if(c+1<e.mutations.length&&e.mutations[c+1].transform!==void 0){const h=e.mutations[c+1];d.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(c+1,1),++c}}const o=e.mutations.map(c=>ri(i.oe,c)),a=nt.fromMillis(e.localWriteTimeMs);return new Hi(e.batchId,a,s,o)}function or(i){const e=ir(i.readTime),s=i.lastLimboFreeSnapshotVersion!==void 0?ir(i.lastLimboFreeSnapshotVersion):st.min();let o;var a;return i.query.documents!==void 0?(M((a=i.query).documents.length===1),o=Tn(wn(Ys(a.documents[0])))):o=function(c){return Tn(ai(c))}(i.query),new Zi(o,i.targetId,0,i.lastListenSequenceNumber,e,s,Ht.fromBase64String(i.resumeToken))}function ur(i,e){const s=sr(e.snapshotVersion),o=sr(e.lastLimboFreeSnapshotVersion);let a;a=an(e.target)?ui(i.oe,e.target):ci(i.oe,e.target);const c=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:un(e.target),readTime:s,resumeToken:c,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:o,query:a}}function cr(i){const e=ai({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?An(e,e.limit,"L"):e}function ar(i,e){return new Yi(e.largestBatchId,ri(i.oe,e.overlayMutation))}function hr(i,e){const s=e.path.lastSegment();return[i,Ii(e.path.popLast()),s]}function lr(i,e,s,o){return{indexId:i,uid:e.uid||"",sequenceNumber:s,readTime:sr(o.readTime),documentKey:Ii(o.documentKey.path),largestBatchId:o.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{getBundleMetadata(e,s){return dr(e).get(s).next(o=>{if(o)return{id:(a=o).bundleId,createTime:ir(a.createTime),version:a.version};var a})}saveBundleMetadata(e,s){return dr(e).put({bundleId:(o=s).id,createTime:sr(Qs(o.createTime)),version:o.version});var o}getNamedQuery(e,s){return _r(e).get(s).next(o=>{if(o)return{name:(a=o).name,query:cr(a.bundledQuery),readTime:ir(a.readTime)};var a})}saveNamedQuery(e,s){return _r(e).put(function(o){return{name:o.name,readTime:sr(Qs(o.readTime)),bundledQuery:o.bundledQuery}}(s))}}function dr(i){return Wi(i,"bundles")}function _r(i){return Wi(i,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,s){this.Tt=e,this.userId=s}static ue(e,s){const o=s.uid||"";return new wr(e,o)}getOverlay(e,s){return mr(e).get(hr(this.userId,s)).next(o=>o?ar(this.Tt,o):null)}getOverlays(e,s){const o=Ts();return At.forEach(s,a=>this.getOverlay(e,a).next(c=>{c!==null&&o.set(a,c)})).next(()=>o)}saveOverlays(e,s,o){const a=[];return o.forEach((c,d)=>{const h=new Yi(s,d);a.push(this.ce(e,h))}),At.waitFor(a)}removeOverlaysForBatchId(e,s,o){const a=new Set;s.forEach(d=>a.add(Ii(d.getCollectionPath())));const c=[];return a.forEach(d=>{const h=IDBKeyRange.bound([this.userId,d,o],[this.userId,d,o+1],!1,!0);c.push(mr(e).Y("collectionPathOverlayIndex",h))}),At.waitFor(c)}getOverlaysForCollection(e,s,o){const a=Ts(),c=Ii(s),d=IDBKeyRange.bound([this.userId,c,o],[this.userId,c,Number.POSITIVE_INFINITY],!0);return mr(e).W("collectionPathOverlayIndex",d).next(h=>{for(const g of h){const _=ar(this.Tt,g);a.set(_.getKey(),_)}return a})}getOverlaysForCollectionGroup(e,s,o,a){const c=Ts();let d;const h=IDBKeyRange.bound([this.userId,s,o],[this.userId,s,Number.POSITIVE_INFINITY],!0);return mr(e).X({index:"collectionGroupOverlayIndex",range:h},(g,_,ft)=>{const _t=ar(this.Tt,_);c.size()<a||_t.largestBatchId===d?(c.set(_t.getKey(),_t),d=_t.largestBatchId):ft.done()}).next(()=>c)}ce(e,s){return mr(e).put(function(o,a,c){const[d,h,g]=hr(a,c.mutation.key);return{userId:a,collectionPath:h,documentId:g,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:ii(o.oe,c.mutation)}}(this.Tt,this.userId,s))}}function mr(i){return Wi(i,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){}ae(e,s){this.he(e,s),s.le()}he(e,s){if("nullValue"in e)this.fe(s,5);else if("booleanValue"in e)this.fe(s,10),s.de(e.booleanValue?1:0);else if("integerValue"in e)this.fe(s,15),s.de(Zt(e.integerValue));else if("doubleValue"in e){const o=Zt(e.doubleValue);isNaN(o)?this.fe(s,13):(this.fe(s,15),Qt(o)?s.de(0):s.de(o))}else if("timestampValue"in e){const o=e.timestampValue;this.fe(s,20),typeof o=="string"?s._e(o):(s._e(`${o.seconds||""}`),s.de(o.nanos||0))}else if("stringValue"in e)this.we(e.stringValue,s),this.me(s);else if("bytesValue"in e)this.fe(s,30),s.ge(Xt(e.bytesValue)),this.me(s);else if("referenceValue"in e)this.ye(e.referenceValue,s);else if("geoPointValue"in e){const o=e.geoPointValue;this.fe(s,45),s.de(o.latitude||0),s.de(o.longitude||0)}else"mapValue"in e?pe(e)?this.fe(s,Number.MAX_SAFE_INTEGER):(this.pe(e.mapValue,s),this.me(s)):"arrayValue"in e?(this.Ie(e.arrayValue,s),this.me(s)):O()}we(e,s){this.fe(s,25),this.Te(e,s)}Te(e,s){s._e(e)}pe(e,s){const o=e.fields||{};this.fe(s,55);for(const a of Object.keys(o))this.we(a,s),this.he(o[a],s)}Ie(e,s){const o=e.values||[];this.fe(s,50);for(const a of o)this.he(a,s)}ye(e,s){this.fe(s,37),ct.fromName(e).path.forEach(o=>{this.fe(s,60),this.Te(o,s)})}fe(e,s){e.de(s)}me(e){e.de(2)}}gr.Ee=new gr;function yr(i){if(i===0)return 8;let e=0;return!(i>>4)&&(e+=4,i<<=4),!(i>>6)&&(e+=2,i<<=2),!(i>>7)&&(e+=1),e}function pr(i){const e=64-function(s){let o=0;for(let a=0;a<8;++a){const c=yr(255&s[a]);if(o+=c,c!==8)break}return o}(i);return Math.ceil(e/8)}class Ir{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ae(e){const s=e[Symbol.iterator]();let o=s.next();for(;!o.done;)this.Re(o.value),o=s.next();this.be()}ve(e){const s=e[Symbol.iterator]();let o=s.next();for(;!o.done;)this.Pe(o.value),o=s.next();this.Ve()}Se(e){for(const s of e){const o=s.charCodeAt(0);if(o<128)this.Re(o);else if(o<2048)this.Re(960|o>>>6),this.Re(128|63&o);else if(s<"\uD800"||"\uDBFF"<s)this.Re(480|o>>>12),this.Re(128|63&o>>>6),this.Re(128|63&o);else{const a=s.codePointAt(0);this.Re(240|a>>>18),this.Re(128|63&a>>>12),this.Re(128|63&a>>>6),this.Re(128|63&a)}}this.be()}De(e){for(const s of e){const o=s.charCodeAt(0);if(o<128)this.Pe(o);else if(o<2048)this.Pe(960|o>>>6),this.Pe(128|63&o);else if(s<"\uD800"||"\uDBFF"<s)this.Pe(480|o>>>12),this.Pe(128|63&o>>>6),this.Pe(128|63&o);else{const a=s.codePointAt(0);this.Pe(240|a>>>18),this.Pe(128|63&a>>>12),this.Pe(128|63&a>>>6),this.Pe(128|63&a)}}this.Ve()}Ce(e){const s=this.xe(e),o=pr(s);this.Ne(1+o),this.buffer[this.position++]=255&o;for(let a=s.length-o;a<s.length;++a)this.buffer[this.position++]=255&s[a]}ke(e){const s=this.xe(e),o=pr(s);this.Ne(1+o),this.buffer[this.position++]=~(255&o);for(let a=s.length-o;a<s.length;++a)this.buffer[this.position++]=~(255&s[a])}Oe(){this.Me(255),this.Me(255)}Fe(){this.$e(255),this.$e(255)}reset(){this.position=0}seed(e){this.Ne(e.length),this.buffer.set(e,this.position),this.position+=e.length}Be(){return this.buffer.slice(0,this.position)}xe(e){const s=function(a){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,a,!1),new Uint8Array(c.buffer)}(e),o=(128&s[0])!=0;s[0]^=o?255:128;for(let a=1;a<s.length;++a)s[a]^=o?255:0;return s}Re(e){const s=255&e;s===0?(this.Me(0),this.Me(255)):s===255?(this.Me(255),this.Me(0)):this.Me(s)}Pe(e){const s=255&e;s===0?(this.$e(0),this.$e(255)):s===255?(this.$e(255),this.$e(0)):this.$e(e)}be(){this.Me(0),this.Me(1)}Ve(){this.$e(0),this.$e(1)}Me(e){this.Ne(1),this.buffer[this.position++]=e}$e(e){this.Ne(1),this.buffer[this.position++]=~e}Ne(e){const s=e+this.position;if(s<=this.buffer.length)return;let o=2*this.buffer.length;o<s&&(o=s);const a=new Uint8Array(o);a.set(this.buffer),this.buffer=a}}class Tr{constructor(e){this.Le=e}ge(e){this.Le.Ae(e)}_e(e){this.Le.Se(e)}de(e){this.Le.Ce(e)}le(){this.Le.Oe()}}class Er{constructor(e){this.Le=e}ge(e){this.Le.ve(e)}_e(e){this.Le.De(e)}de(e){this.Le.ke(e)}le(){this.Le.Fe()}}class Ar{constructor(){this.Le=new Ir,this.qe=new Tr(this.Le),this.Ue=new Er(this.Le)}seed(e){this.Le.seed(e)}Ke(e){return e===0?this.qe:this.Ue}Be(){return this.Le.Be()}reset(){this.Le.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,s,o,a){this.indexId=e,this.documentKey=s,this.arrayValue=o,this.directionalValue=a}Ge(){const e=this.directionalValue.length,s=e===0||this.directionalValue[e-1]===255?e+1:e,o=new Uint8Array(s);return o.set(this.directionalValue,0),s!==e?o.set([0],this.directionalValue.length):++o[o.length-1],new Rr(this.indexId,this.documentKey,this.arrayValue,o)}}function br(i,e){let s=i.indexId-e.indexId;return s!==0?s:(s=vr(i.arrayValue,e.arrayValue),s!==0?s:(s=vr(i.directionalValue,e.directionalValue),s!==0?s:ct.comparator(i.documentKey,e.documentKey)))}function vr(i,e){for(let s=0;s<i.length&&s<e.length;++s){const o=i[s]-e[s];if(o!==0)return o}return i.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Qe=e.orderBy,this.je=[];for(const s of e.filters){const o=s;o.isInequality()?this.ze=o:this.je.push(o)}}We(e){M(e.collectionGroup===this.collectionId);const s=ht(e);if(s!==void 0&&!this.He(s))return!1;const o=lt(e);let a=0,c=0;for(;a<o.length&&this.He(o[a]);++a);if(a===o.length)return!0;if(this.ze!==void 0){const d=o[a];if(!this.Je(this.ze,d)||!this.Ye(this.Qe[c++],d))return!1;++a}for(;a<o.length;++a){const d=o[a];if(c>=this.Qe.length||!this.Ye(this.Qe[c++],d))return!1}return!0}He(e){for(const s of this.je)if(this.Je(s,e))return!0;return!1}Je(e,s){if(e===void 0||!e.field.isEqual(s.fieldPath))return!1;const o=e.op==="array-contains"||e.op==="array-contains-any";return s.kind===2===o}Ye(e,s){return!!e.field.isEqual(s.fieldPath)&&(s.kind===0&&e.dir==="asc"||s.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(i){var e,s;if(M(i instanceof Ve||i instanceof Se),i instanceof Ve){if(i instanceof Ke){const a=((s=(e=i.value.arrayValue)===null||e===void 0?void 0:e.values)===null||s===void 0?void 0:s.map(c=>Ve.create(i.field,"==",c)))||[];return Se.create(a,"or")}return i}const o=i.filters.map(a=>Vr(a));return Se.create(o,i.op)}function Sr(i){if(i.getFilters().length===0)return[];const e=Nr(Vr(i));return M(xr(e)),Dr(e)||Cr(e)?[e]:e.getFilters()}function Dr(i){return i instanceof Ve}function Cr(i){return i instanceof Se&&xe(i)}function xr(i){return Dr(i)||Cr(i)||function(e){if(e instanceof Se&&Ce(e)){for(const s of e.getFilters())if(!Dr(s)&&!Cr(s))return!1;return!0}return!1}(i)}function Nr(i){if(M(i instanceof Ve||i instanceof Se),i instanceof Ve)return i;if(i.filters.length===1)return Nr(i.filters[0]);const e=i.filters.map(o=>Nr(o));let s=Se.create(e,i.op);return s=Mr(s),xr(s)?s:(M(s instanceof Se),M(De(s)),M(s.filters.length>1),s.filters.reduce((o,a)=>kr(o,a)))}function kr(i,e){let s;return M(i instanceof Ve||i instanceof Se),M(e instanceof Ve||e instanceof Se),s=i instanceof Ve?e instanceof Ve?function(o,a){return Se.create([o,a],"and")}(i,e):Or(i,e):e instanceof Ve?Or(e,i):function(o,a){if(M(o.filters.length>0&&a.filters.length>0),De(o)&&De(a))return Me(o,a.getFilters());const c=Ce(o)?o:a,d=Ce(o)?a:o,h=c.filters.map(g=>kr(g,d));return Se.create(h,"or")}(i,e),Mr(s)}function Or(i,e){if(De(e))return Me(e,i.getFilters());{const s=e.filters.map(o=>kr(i,o));return Se.create(s,"or")}}function Mr(i){if(M(i instanceof Ve||i instanceof Se),i instanceof Ve)return i;const e=i.getFilters();if(e.length===1)return Mr(e[0]);if(Ne(i))return i;const s=e.map(a=>Mr(a)),o=[];return s.forEach(a=>{a instanceof Ve?o.push(a):a instanceof Se&&(a.op===i.op?o.push(...a.filters):o.push(a))}),o.length===1?o[0]:Se.create(o,i.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(){this.Ze=new $r}addToCollectionParentIndex(e,s){return this.Ze.add(s),At.resolve()}getCollectionParents(e,s){return At.resolve(this.Ze.getEntries(s))}addFieldIndex(e,s){return At.resolve()}deleteFieldIndex(e,s){return At.resolve()}getDocumentsMatchingTarget(e,s){return At.resolve(null)}getIndexType(e,s){return At.resolve(0)}getFieldIndexes(e,s){return At.resolve([])}getNextCollectionGroupToUpdate(e){return At.resolve(null)}getMinOffset(e,s){return At.resolve(yt.min())}getMinOffsetFromCollectionGroup(e,s){return At.resolve(yt.min())}updateCollectionGroup(e,s,o){return At.resolve()}updateIndexEntries(e,s){return At.resolve()}}class $r{constructor(){this.index={}}add(e){const s=e.lastSegment(),o=e.popLast(),a=this.index[s]||new Ye(rt.comparator),c=!a.has(o);return this.index[s]=a.add(o),c}has(e){const s=e.lastSegment(),o=e.popLast(),a=this.index[s];return a&&a.has(o)}getEntries(e){return(this.index[e]||new Ye(rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=new Uint8Array(0);class Lr{constructor(e,s){this.user=e,this.databaseId=s,this.Xe=new $r,this.tn=new ws(o=>un(o),(o,a)=>cn(o,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,s){if(!this.Xe.has(s)){const o=s.lastSegment(),a=s.popLast();e.addOnCommittedListener(()=>{this.Xe.add(s)});const c={collectionId:o,parent:Ii(a)};return qr(e).put(c)}return At.resolve()}getCollectionParents(e,s){const o=[],a=IDBKeyRange.bound([s,""],[et(s),""],!1,!0);return qr(e).W(a).next(c=>{for(const d of c){if(d.collectionId!==s)break;o.push(Ai(d.parent))}return o})}addFieldIndex(e,s){const o=Kr(e),a=function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(s);delete a.indexId;const c=o.add(a);if(s.indexState){const d=Gr(e);return c.next(h=>{d.put(lr(h,this.user,s.indexState.sequenceNumber,s.indexState.offset))})}return c.next()}deleteFieldIndex(e,s){const o=Kr(e),a=Gr(e),c=Ur(e);return o.delete(s.indexId).next(()=>a.delete(IDBKeyRange.bound([s.indexId],[s.indexId+1],!1,!0))).next(()=>c.delete(IDBKeyRange.bound([s.indexId],[s.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,s){const o=Ur(e);let a=!0;const c=new Map;return At.forEach(this.en(s),d=>this.nn(e,d).next(h=>{a&&(a=!!h),c.set(d,h)})).next(()=>{if(a){let d=vs();const h=[];return At.forEach(c,(g,_)=>{var ft;C("IndexedDbIndexManager",`Using index ${ft=g,`id=${ft.indexId}|cg=${ft.collectionGroup}|f=${ft.fields.map(Ml=>`${Ml.fieldPath}:${Ml.kind}`).join(",")}`} to execute ${un(s)}`);const _t=function(Ml,Su){const _d=ht(Su);if(_d===void 0)return null;for(const ep of hn(Ml,_d.fieldPath))switch(ep.op){case"array-contains-any":return ep.value.arrayValue.values||[];case"array-contains":return[ep.value]}return null}(_,g),$t=function(Ml,Su){const _d=new Map;for(const ep of lt(Su))for(const tp of hn(Ml,ep.fieldPath))switch(tp.op){case"==":case"in":_d.set(ep.fieldPath.canonicalString(),tp.value);break;case"not-in":case"!=":return _d.set(ep.fieldPath.canonicalString(),tp.value),Array.from(_d.values())}return null}(_,g),Mt=function(Ml,Su){const _d=[];let ep=!0;for(const tp of lt(Su)){const np=tp.kind===0?ln(Ml,tp.fieldPath,Ml.startAt):fn(Ml,tp.fieldPath,Ml.startAt);_d.push(np.value),ep&&(ep=np.inclusive)}return new Re(_d,ep)}(_,g),Ft=function(Ml,Su){const _d=[];let ep=!0;for(const tp of lt(Su)){const np=tp.kind===0?fn(Ml,tp.fieldPath,Ml.endAt):ln(Ml,tp.fieldPath,Ml.endAt);_d.push(np.value),ep&&(ep=np.inclusive)}return new Re(_d,ep)}(_,g),Ol=this.sn(g,_,Mt),Vl=this.sn(g,_,Ft),Nl=this.rn(g,_,$t),xl=this.on(g.indexId,_t,Ol,Mt.inclusive,Vl,Ft.inclusive,Nl);return At.forEach(xl,Ml=>o.J(Ml,s.limit).next(Su=>{Su.forEach(_d=>{const ep=ct.fromSegments(_d.documentKey);d.has(ep)||(d=d.add(ep),h.push(ep))})}))}).next(()=>h)}return At.resolve(null)})}en(e){let s=this.tn.get(e);return s||(e.filters.length===0?s=[e]:s=Sr(Se.create(e.filters,"and")).map(o=>on(e.path,e.collectionGroup,e.orderBy,o.getFilters(),e.limit,e.startAt,e.endAt)),this.tn.set(e,s),s)}on(e,s,o,a,c,d,h){const g=(s!=null?s.length:1)*Math.max(o.length,c.length),_=g/(s!=null?s.length:1),ft=[];for(let _t=0;_t<g;++_t){const $t=s?this.un(s[_t/_]):Br,Mt=this.cn(e,$t,o[_t%_],a),Ft=this.an(e,$t,c[_t%_],d),Ol=h.map(Vl=>this.cn(e,$t,Vl,!0));ft.push(...this.createRange(Mt,Ft,Ol))}return ft}cn(e,s,o,a){const c=new Rr(e,ct.empty(),s,o);return a?c:c.Ge()}an(e,s,o,a){const c=new Rr(e,ct.empty(),s,o);return a?c.Ge():c}nn(e,s){const o=new Pr(s),a=s.collectionGroup!=null?s.collectionGroup:s.path.lastSegment();return this.getFieldIndexes(e,a).next(c=>{let d=null;for(const h of c)o.We(h)&&(!d||h.fields.length>d.fields.length)&&(d=h);return d})}getIndexType(e,s){let o=2;const a=this.en(s);return At.forEach(a,c=>this.nn(e,c).next(d=>{d?o!==0&&d.fields.length<function(h){let g=new Ye(ut.comparator),_=!1;for(const ft of h.filters)for(const _t of ft.getFlattenedFilters())_t.field.isKeyField()||(_t.op==="array-contains"||_t.op==="array-contains-any"?_=!0:g=g.add(_t.field));for(const ft of h.orderBy)ft.field.isKeyField()||(g=g.add(ft.field));return g.size+(_?1:0)}(c)&&(o=1):o=0})).next(()=>function(c){return c.limit!==null}(s)&&a.length>1&&o===2?1:o)}hn(e,s){const o=new Ar;for(const a of lt(e)){const c=s.data.field(a.fieldPath);if(c==null)return null;const d=o.Ke(a.kind);gr.Ee.ae(c,d)}return o.Be()}un(e){const s=new Ar;return gr.Ee.ae(e,s.Ke(0)),s.Be()}ln(e,s){const o=new Ar;return gr.Ee.ae(fe(this.databaseId,s),o.Ke(function(a){const c=lt(a);return c.length===0?0:c[c.length-1].kind}(e))),o.Be()}rn(e,s,o){if(o===null)return[];let a=[];a.push(new Ar);let c=0;for(const d of lt(e)){const h=o[c++];for(const g of a)if(this.fn(s,d.fieldPath)&&_e(h))a=this.dn(a,d,h);else{const _=g.Ke(d.kind);gr.Ee.ae(h,_)}}return this._n(a)}sn(e,s,o){return this.rn(e,s,o.position)}_n(e){const s=[];for(let o=0;o<e.length;++o)s[o]=e[o].Be();return s}dn(e,s,o){const a=[...e],c=[];for(const d of o.arrayValue.values||[])for(const h of a){const g=new Ar;g.seed(h.Be()),gr.Ee.ae(d,g.Ke(s.kind)),c.push(g)}return c}fn(e,s){return!!e.filters.find(o=>o instanceof Ve&&o.field.isEqual(s)&&(o.op==="in"||o.op==="not-in"))}getFieldIndexes(e,s){const o=Kr(e),a=Gr(e);return(s?o.W("collectionGroupIndex",IDBKeyRange.bound(s,s)):o.W()).next(c=>{const d=[];return At.forEach(c,h=>a.get([h.indexId,this.uid]).next(g=>{d.push(function(_,ft){const _t=ft?new wt(ft.sequenceNumber,new yt(ir(ft.readTime),new ct(Ai(ft.documentKey)),ft.largestBatchId)):wt.empty(),$t=_.fields.map(([Mt,Ft])=>new dt(ut.fromServerFormat(Mt),Ft));return new at(_.indexId,_.collectionGroup,$t,_t)}(h,g))})).next(()=>d)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(s=>s.length===0?null:(s.sort((o,a)=>{const c=o.indexState.sequenceNumber-a.indexState.sequenceNumber;return c!==0?c:X(o.collectionGroup,a.collectionGroup)}),s[0].collectionGroup))}updateCollectionGroup(e,s,o){const a=Kr(e),c=Gr(e);return this.wn(e).next(d=>a.W("collectionGroupIndex",IDBKeyRange.bound(s,s)).next(h=>At.forEach(h,g=>c.put(lr(g.indexId,this.user,d,o)))))}updateIndexEntries(e,s){const o=new Map;return At.forEach(s,(a,c)=>{const d=o.get(a.collectionGroup);return(d?At.resolve(d):this.getFieldIndexes(e,a.collectionGroup)).next(h=>(o.set(a.collectionGroup,h),At.forEach(h,g=>this.mn(e,a,g).next(_=>{const ft=this.gn(c,g);return _.isEqual(ft)?At.resolve():this.yn(e,c,g,_,ft)}))))})}pn(e,s,o,a){return Ur(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.ln(o,s.key),documentKey:s.key.path.toArray()})}In(e,s,o,a){return Ur(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.ln(o,s.key),s.key.path.toArray()])}mn(e,s,o){const a=Ur(e);let c=new Ye(br);return a.X({index:"documentKeyIndex",range:IDBKeyRange.only([o.indexId,this.uid,this.ln(o,s)])},(d,h)=>{c=c.add(new Rr(o.indexId,s,h.arrayValue,h.directionalValue))}).next(()=>c)}gn(e,s){let o=new Ye(br);const a=this.hn(s,e);if(a==null)return o;const c=ht(s);if(c!=null){const d=e.data.field(c.fieldPath);if(_e(d))for(const h of d.arrayValue.values||[])o=o.add(new Rr(s.indexId,e.key,this.un(h),a))}else o=o.add(new Rr(s.indexId,e.key,Br,a));return o}yn(e,s,o,a,c){C("IndexedDbIndexManager","Updating index entries for document '%s'",s.key);const d=[];return function(h,g,_,ft,_t){const $t=h.getIterator(),Mt=g.getIterator();let Ft=Xe($t),Ol=Xe(Mt);for(;Ft||Ol;){let Vl=!1,Nl=!1;if(Ft&&Ol){const xl=_(Ft,Ol);xl<0?Nl=!0:xl>0&&(Vl=!0)}else Ft!=null?Nl=!0:Vl=!0;Vl?(ft(Ol),Ol=Xe(Mt)):Nl?(_t(Ft),Ft=Xe($t)):(Ft=Xe($t),Ol=Xe(Mt))}}(a,c,br,h=>{d.push(this.pn(e,s,o,h))},h=>{d.push(this.In(e,s,o,h))}),At.waitFor(d)}wn(e){let s=1;return Gr(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(o,a,c)=>{c.done(),s=a.sequenceNumber+1}).next(()=>s)}createRange(e,s,o){o=o.sort((d,h)=>br(d,h)).filter((d,h,g)=>!h||br(d,g[h-1])!==0);const a=[];a.push(e);for(const d of o){const h=br(d,e),g=br(d,s);if(h===0)a[0]=e.Ge();else if(h>0&&g<0)a.push(d),a.push(d.Ge());else if(g>0)break}a.push(s);const c=[];for(let d=0;d<a.length;d+=2){if(this.Tn(a[d],a[d+1]))return[];const h=[a[d].indexId,this.uid,a[d].arrayValue,a[d].directionalValue,Br,[]],g=[a[d+1].indexId,this.uid,a[d+1].arrayValue,a[d+1].directionalValue,Br,[]];c.push(IDBKeyRange.bound(h,g))}return c}Tn(e,s){return br(e,s)>0}getMinOffsetFromCollectionGroup(e,s){return this.getFieldIndexes(e,s).next(Qr)}getMinOffset(e,s){return At.mapArray(this.en(s),o=>this.nn(e,o).next(a=>a||O())).next(Qr)}}function qr(i){return Wi(i,"collectionParents")}function Ur(i){return Wi(i,"indexEntries")}function Kr(i){return Wi(i,"indexConfiguration")}function Gr(i){return Wi(i,"indexState")}function Qr(i){M(i.length!==0);let e=i[0].indexState.offset,s=e.largestBatchId;for(let o=1;o<i.length;o++){const a=i[o].indexState.offset;pt(a,e)<0&&(e=a),s<a.largestBatchId&&(s=a.largestBatchId)}return new yt(e.readTime,e.documentKey,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class zr{constructor(e,s,o){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=s,this.maximumSequenceNumbersToCollect=o}static withCacheSize(e){return new zr(e,zr.DEFAULT_COLLECTION_PERCENTILE,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(i,e,s){const o=i.store("mutations"),a=i.store("documentMutations"),c=[],d=IDBKeyRange.only(s.batchId);let h=0;const g=o.X({range:d},(ft,_t,$t)=>(h++,$t.delete()));c.push(g.next(()=>{M(h===1)}));const _=[];for(const ft of s.mutations){const _t=vi(e,ft.key.path,s.batchId);c.push(a.delete(_t)),_.push(ft.key)}return At.waitFor(c).next(()=>_)}function Hr(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw O();e=i.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zr.DEFAULT_COLLECTION_PERCENTILE=10,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zr.DEFAULT=new zr(41943040,zr.DEFAULT_COLLECTION_PERCENTILE,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zr.DISABLED=new zr(-1,0,0);class Jr{constructor(e,s,o,a){this.userId=e,this.Tt=s,this.indexManager=o,this.referenceDelegate=a,this.En={}}static ue(e,s,o,a){M(e.uid!=="");const c=e.isAuthenticated()?e.uid:"";return new Jr(c,s,o,a)}checkEmpty(e){let s=!0;const o=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zr(e).X({index:"userMutationsIndex",range:o},(a,c,d)=>{s=!1,d.done()}).next(()=>s)}addMutationBatch(e,s,o,a){const c=Xr(e),d=Zr(e);return d.add({}).next(h=>{M(typeof h=="number");const g=new Hi(h,s,o,a),_=function($t,Mt,Ft){const Ol=Ft.baseMutations.map(Nl=>ii($t.oe,Nl)),Vl=Ft.mutations.map(Nl=>ii($t.oe,Nl));return{userId:Mt,batchId:Ft.batchId,localWriteTimeMs:Ft.localWriteTime.toMillis(),baseMutations:Ol,mutations:Vl}}(this.Tt,this.userId,g),ft=[];let _t=new Ye(($t,Mt)=>X($t.canonicalString(),Mt.canonicalString()));for(const $t of a){const Mt=vi(this.userId,$t.key.path,h);_t=_t.add($t.key.path.popLast()),ft.push(d.put(_)),ft.push(c.put(Mt,Pi))}return _t.forEach($t=>{ft.push(this.indexManager.addToCollectionParentIndex(e,$t))}),e.addOnCommittedListener(()=>{this.En[h]=g.keys()}),At.waitFor(ft).next(()=>g)})}lookupMutationBatch(e,s){return Zr(e).get(s).next(o=>o?(M(o.userId===this.userId),rr(this.Tt,o)):null)}An(e,s){return this.En[s]?At.resolve(this.En[s]):this.lookupMutationBatch(e,s).next(o=>{if(o){const a=o.keys();return this.En[s]=a,a}return null})}getNextMutationBatchAfterBatchId(e,s){const o=s+1,a=IDBKeyRange.lowerBound([this.userId,o]);let c=null;return Zr(e).X({index:"userMutationsIndex",range:a},(d,h,g)=>{h.userId===this.userId&&(M(h.batchId>=o),c=rr(this.Tt,h)),g.done()}).next(()=>c)}getHighestUnacknowledgedBatchId(e){const s=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let o=-1;return Zr(e).X({index:"userMutationsIndex",range:s,reverse:!0},(a,c,d)=>{o=c.batchId,d.done()}).next(()=>o)}getAllMutationBatches(e){const s=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Zr(e).W("userMutationsIndex",s).next(o=>o.map(a=>rr(this.Tt,a)))}getAllMutationBatchesAffectingDocumentKey(e,s){const o=bi(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=[];return Xr(e).X({range:a},(d,h,g)=>{const[_,ft,_t]=d,$t=Ai(ft);if(_===this.userId&&s.path.isEqual($t))return Zr(e).get(_t).next(Mt=>{if(!Mt)throw O();M(Mt.userId===this.userId),c.push(rr(this.Tt,Mt))});g.done()}).next(()=>c)}getAllMutationBatchesAffectingDocumentKeys(e,s){let o=new Ye(X);const a=[];return s.forEach(c=>{const d=bi(this.userId,c.path),h=IDBKeyRange.lowerBound(d),g=Xr(e).X({range:h},(_,ft,_t)=>{const[$t,Mt,Ft]=_,Ol=Ai(Mt);$t===this.userId&&c.path.isEqual(Ol)?o=o.add(Ft):_t.done()});a.push(g)}),At.waitFor(a).next(()=>this.Rn(e,o))}getAllMutationBatchesAffectingQuery(e,s){const o=s.path,a=o.length+1,c=bi(this.userId,o),d=IDBKeyRange.lowerBound(c);let h=new Ye(X);return Xr(e).X({range:d},(g,_,ft)=>{const[_t,$t,Mt]=g,Ft=Ai($t);_t===this.userId&&o.isPrefixOf(Ft)?Ft.length===a&&(h=h.add(Mt)):ft.done()}).next(()=>this.Rn(e,h))}Rn(e,s){const o=[],a=[];return s.forEach(c=>{a.push(Zr(e).get(c).next(d=>{if(d===null)throw O();M(d.userId===this.userId),o.push(rr(this.Tt,d))}))}),At.waitFor(a).next(()=>o)}removeMutationBatch(e,s){return Wr(e.re,this.userId,s).next(o=>(e.addOnCommittedListener(()=>{this.bn(s.batchId)}),At.forEach(o,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}bn(e){delete this.En[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(s=>{if(!s)return At.resolve();const o=IDBKeyRange.lowerBound([this.userId]),a=[];return Xr(e).X({range:o},(c,d,h)=>{if(c[0]===this.userId){const g=Ai(c[1]);a.push(g)}else h.done()}).next(()=>{M(a.length===0)})})}containsKey(e,s){return Yr(e,this.userId,s)}vn(e){return to(e).get(this.userId).next(s=>s||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Yr(i,e,s){const o=bi(e,s.path),a=o[1],c=IDBKeyRange.lowerBound(o);let d=!1;return Xr(i).X({range:c,Z:!0},(h,g,_)=>{const[ft,_t,$t]=h;ft===e&&_t===a&&(d=!0),_.done()}).next(()=>d)}function Zr(i){return Wi(i,"mutations")}function Xr(i){return Wi(i,"documentMutations")}function to(i){return Wi(i,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.Pn=e}next(){return this.Pn+=2,this.Pn}static Vn(){return new eo(0)}static Sn(){return new eo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,s){this.referenceDelegate=e,this.Tt=s}allocateTargetId(e){return this.Dn(e).next(s=>{const o=new eo(s.highestTargetId);return s.highestTargetId=o.next(),this.Cn(e,s).next(()=>s.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Dn(e).next(s=>st.fromTimestamp(new nt(s.lastRemoteSnapshotVersion.seconds,s.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Dn(e).next(s=>s.highestListenSequenceNumber)}setTargetsMetadata(e,s,o){return this.Dn(e).next(a=>(a.highestListenSequenceNumber=s,o&&(a.lastRemoteSnapshotVersion=o.toTimestamp()),s>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=s),this.Cn(e,a)))}addTargetData(e,s){return this.xn(e,s).next(()=>this.Dn(e).next(o=>(o.targetCount+=1,this.Nn(s,o),this.Cn(e,o))))}updateTargetData(e,s){return this.xn(e,s)}removeTargetData(e,s){return this.removeMatchingKeysForTargetId(e,s.targetId).next(()=>so(e).delete(s.targetId)).next(()=>this.Dn(e)).next(o=>(M(o.targetCount>0),o.targetCount-=1,this.Cn(e,o)))}removeTargets(e,s,o){let a=0;const c=[];return so(e).X((d,h)=>{const g=or(h);g.sequenceNumber<=s&&o.get(g.targetId)===null&&(a++,c.push(this.removeTargetData(e,g)))}).next(()=>At.waitFor(c)).next(()=>a)}forEachTarget(e,s){return so(e).X((o,a)=>{const c=or(a);s(c)})}Dn(e){return io(e).get("targetGlobalKey").next(s=>(M(s!==null),s))}Cn(e,s){return io(e).put("targetGlobalKey",s)}xn(e,s){return so(e).put(ur(this.Tt,s))}Nn(e,s){let o=!1;return e.targetId>s.highestTargetId&&(s.highestTargetId=e.targetId,o=!0),e.sequenceNumber>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=e.sequenceNumber,o=!0),o}getTargetCount(e){return this.Dn(e).next(s=>s.targetCount)}getTargetData(e,s){const o=un(s),a=IDBKeyRange.bound([o,Number.NEGATIVE_INFINITY],[o,Number.POSITIVE_INFINITY]);let c=null;return so(e).X({range:a,index:"queryTargetsIndex"},(d,h,g)=>{const _=or(h);cn(s,_.target)&&(c=_,g.done())}).next(()=>c)}addMatchingKeys(e,s,o){const a=[],c=ro(e);return s.forEach(d=>{const h=Ii(d.path);a.push(c.put({targetId:o,path:h})),a.push(this.referenceDelegate.addReference(e,o,d))}),At.waitFor(a)}removeMatchingKeys(e,s,o){const a=ro(e);return At.forEach(s,c=>{const d=Ii(c.path);return At.waitFor([a.delete([o,d]),this.referenceDelegate.removeReference(e,o,c)])})}removeMatchingKeysForTargetId(e,s){const o=ro(e),a=IDBKeyRange.bound([s],[s+1],!1,!0);return o.delete(a)}getMatchingKeysForTargetId(e,s){const o=IDBKeyRange.bound([s],[s+1],!1,!0),a=ro(e);let c=vs();return a.X({range:o,Z:!0},(d,h,g)=>{const _=Ai(d[1]),ft=new ct(_);c=c.add(ft)}).next(()=>c)}containsKey(e,s){const o=Ii(s.path),a=IDBKeyRange.bound([o],[et(o)],!1,!0);let c=0;return ro(e).X({index:"documentTargetsIndex",Z:!0,range:a},([d,h],g,_)=>{d!==0&&(c++,_.done())}).next(()=>c>0)}ie(e,s){return so(e).get(s).next(o=>o?or(o):null)}}function so(i){return Wi(i,"targets")}function io(i){return Wi(i,"targetGlobal")}function ro(i){return Wi(i,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo([i,e],[s,o]){const a=X(i,s);return a===0?X(e,o):a}class uo{constructor(e){this.kn=e,this.buffer=new Ye(oo),this.On=0}Mn(){return++this.On}Fn(e){const s=[e,this.Mn()];if(this.buffer.size<this.kn)this.buffer=this.buffer.add(s);else{const o=this.buffer.last();oo(s,o)<0&&(this.buffer=this.buffer.delete(o).add(s))}}get maxValue(){return this.buffer.last()[0]}}class co{constructor(e,s,o){this.garbageCollector=e,this.asyncQueue=s,this.localStore=o,this.$n=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Bn(6e4)}stop(){this.$n&&(this.$n.cancel(),this.$n=null)}get started(){return this.$n!==null}Bn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.$n=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.$n=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(s){Vt(s)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",s):await Et(s)}await this.Bn(3e5)})}}class ao{constructor(e,s){this.Ln=e,this.params=s}calculateTargetCount(e,s){return this.Ln.qn(e).next(o=>Math.floor(s/100*o))}nthSequenceNumber(e,s){if(s===0)return At.resolve(Ot.at);const o=new uo(s);return this.Ln.forEachTarget(e,a=>o.Fn(a.sequenceNumber)).next(()=>this.Ln.Un(e,a=>o.Fn(a))).next(()=>o.maxValue)}removeTargets(e,s,o){return this.Ln.removeTargets(e,s,o)}removeOrphanedDocuments(e,s){return this.Ln.removeOrphanedDocuments(e,s)}collect(e,s){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),At.resolve(jr)):this.getCacheSize(e).next(o=>o<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${o} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jr):this.Kn(e,s))}getCacheSize(e){return this.Ln.getCacheSize(e)}Kn(e,s){let o,a,c,d,h,g,_;const ft=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_t=>(_t>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_t}`),a=this.params.maximumSequenceNumbersToCollect):a=_t,d=Date.now(),this.nthSequenceNumber(e,a))).next(_t=>(o=_t,h=Date.now(),this.removeTargets(e,o,s))).next(_t=>(c=_t,g=Date.now(),this.removeOrphanedDocuments(e,o))).next(_t=>(_=Date.now(),S()<=LogLevel.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-ft}ms
	Determined least recently used ${a} in `+(h-d)+`ms
	Removed ${c} targets in `+(g-h)+`ms
	Removed ${_t} documents in `+(_-g)+`ms
Total Duration: ${_-ft}ms`),At.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:c,documentsRemoved:_t})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,s){this.db=e,this.garbageCollector=function(o,a){return new ao(o,a)}(this,s)}qn(e){const s=this.Gn(e);return this.db.getTargetCache().getTargetCount(e).next(o=>s.next(a=>o+a))}Gn(e){let s=0;return this.Un(e,o=>{s++}).next(()=>s)}forEachTarget(e,s){return this.db.getTargetCache().forEachTarget(e,s)}Un(e,s){return this.Qn(e,(o,a)=>s(a))}addReference(e,s,o){return lo(e,o)}removeReference(e,s,o){return lo(e,o)}removeTargets(e,s,o){return this.db.getTargetCache().removeTargets(e,s,o)}markPotentiallyOrphaned(e,s){return lo(e,s)}jn(e,s){return function(o,a){let c=!1;return to(o).tt(d=>Yr(o,d,a).next(h=>(h&&(c=!0),At.resolve(!h)))).next(()=>c)}(e,s)}removeOrphanedDocuments(e,s){const o=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let c=0;return this.Qn(e,(d,h)=>{if(h<=s){const g=this.jn(e,d).next(_=>{if(!_)return c++,o.getEntry(e,d).next(()=>(o.removeEntry(d,st.min()),ro(e).delete([0,Ii(d.path)])))});a.push(g)}}).next(()=>At.waitFor(a)).next(()=>o.apply(e)).next(()=>c)}removeTarget(e,s){const o=s.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,o)}updateLimboDocument(e,s){return lo(e,s)}Qn(e,s){const o=ro(e);let a,c=Ot.at;return o.X({index:"documentTargetsIndex"},([d,h],{path:g,sequenceNumber:_})=>{d===0?(c!==Ot.at&&s(new ct(Ai(a)),c),c=_,a=g):c=Ot.at}).next(()=>{c!==Ot.at&&s(new ct(Ai(a)),c)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lo(i,e){return ro(i).put(function(s,o){return{targetId:0,path:Ii(s.path),sequenceNumber:o}}(e,i.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(){this.changes=new ws(e=>e.toString(),(e,s)=>e.isEqual(s)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,sn.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const o=this.changes.get(s);return o!==void 0?At.resolve(o):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.Tt=e}setIndexManager(e){this.indexManager=e}addEntry(e,s,o){return yo(e).put(o)}removeEntry(e,s,o){return yo(e).delete(function(a,c){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],nr(c),d[d.length-1]]}(s,o))}updateMetadata(e,s){return this.getMetadata(e).next(o=>(o.byteSize+=s,this.zn(e,o)))}getEntry(e,s){let o=sn.newInvalidDocument(s);return yo(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(po(s))},(a,c)=>{o=this.Wn(s,c)}).next(()=>o)}Hn(e,s){let o={size:0,document:sn.newInvalidDocument(s)};return yo(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(po(s))},(a,c)=>{o={document:this.Wn(s,c),size:Hr(c)}}).next(()=>o)}getEntries(e,s){let o=gs();return this.Jn(e,s,(a,c)=>{const d=this.Wn(a,c);o=o.insert(a,d)}).next(()=>o)}Yn(e,s){let o=gs(),a=new We(ct.comparator);return this.Jn(e,s,(c,d)=>{const h=this.Wn(c,d);o=o.insert(c,h),a=a.insert(c,Hr(d))}).next(()=>({documents:o,Zn:a}))}Jn(e,s,o){if(s.isEmpty())return At.resolve();let a=new Ye(To);s.forEach(g=>a=a.add(g));const c=IDBKeyRange.bound(po(a.first()),po(a.last())),d=a.getIterator();let h=d.getNext();return yo(e).X({index:"documentKeyIndex",range:c},(g,_,ft)=>{const _t=ct.fromSegments([..._.prefixPath,_.collectionGroup,_.documentId]);for(;h&&To(h,_t)<0;)o(h,null),h=d.getNext();h&&h.isEqual(_t)&&(o(h,_),h=d.hasNext()?d.getNext():null),h?ft.j(po(h)):ft.done()}).next(()=>{for(;h;)o(h,null),h=d.hasNext()?d.getNext():null})}getDocumentsMatchingQuery(e,s,o,a){const c=s.path,d=[c.popLast().toArray(),c.lastSegment(),nr(o.readTime),o.documentKey.path.isEmpty()?"":o.documentKey.path.lastSegment()],h=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return yo(e).W(IDBKeyRange.bound(d,h,!0)).next(g=>{let _=gs();for(const ft of g){const _t=this.Wn(ct.fromSegments(ft.prefixPath.concat(ft.collectionGroup,ft.documentId)),ft);_t.isFoundDocument()&&(Pn(s,_t)||a.has(_t.key))&&(_=_.insert(_t.key,_t))}return _})}getAllFromCollectionGroup(e,s,o,a){let c=gs();const d=Io(s,o),h=Io(s,yt.max());return yo(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(d,h,!0)},(g,_,ft)=>{const _t=this.Wn(ct.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);c=c.insert(_t.key,_t),c.size===a&&ft.done()}).next(()=>c)}newChangeBuffer(e){return new mo(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(s=>s.byteSize)}getMetadata(e){return go(e).get("remoteDocumentGlobalKey").next(s=>(M(!!s),s))}zn(e,s){return go(e).put("remoteDocumentGlobalKey",s)}Wn(e,s){if(s){const o=tr(this.Tt,s);if(!(o.isNoDocument()&&o.version.isEqual(st.min())))return o}return sn.newInvalidDocument(e)}}function wo(i){return new _o(i)}class mo extends fo{constructor(e,s){super(),this.Xn=e,this.trackRemovals=s,this.ts=new ws(o=>o.toString(),(o,a)=>o.isEqual(a))}applyChanges(e){const s=[];let o=0,a=new Ye((c,d)=>X(c.canonicalString(),d.canonicalString()));return this.changes.forEach((c,d)=>{const h=this.ts.get(c);if(s.push(this.Xn.removeEntry(e,c,h.readTime)),d.isValidDocument()){const g=er(this.Xn.Tt,d);a=a.add(c.path.popLast());const _=Hr(g);o+=_-h.size,s.push(this.Xn.addEntry(e,c,g))}else if(o-=h.size,this.trackRemovals){const g=er(this.Xn.Tt,d.convertToNoDocument(st.min()));s.push(this.Xn.addEntry(e,c,g))}}),a.forEach(c=>{s.push(this.Xn.indexManager.addToCollectionParentIndex(e,c))}),s.push(this.Xn.updateMetadata(e,o)),At.waitFor(s)}getFromCache(e,s){return this.Xn.Hn(e,s).next(o=>(this.ts.set(s,{size:o.size,readTime:o.document.readTime}),o.document))}getAllFromCache(e,s){return this.Xn.Yn(e,s).next(({documents:o,Zn:a})=>(a.forEach((c,d)=>{this.ts.set(c,{size:d,readTime:o.get(c).readTime})}),o))}}function go(i){return Wi(i,"remoteDocumentGlobal")}function yo(i){return Wi(i,"remoteDocumentsV14")}function po(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Io(i,e){const s=e.documentKey.path.toArray();return[i,nr(e.readTime),s.slice(0,s.length-2),s.length>0?s[s.length-1]:""]}function To(i,e){const s=i.path.toArray(),o=e.path.toArray();let a=0;for(let c=0;c<s.length-2&&c<o.length-2;++c)if(a=X(s[c],o[c]),a)return a;return a=X(s.length,o.length),a||(a=X(s[s.length-2],o[o.length-2]),a||X(s[s.length-1],o[o.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,s,o,a){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=o,this.indexManager=a}getDocument(e,s){let o=null;return this.documentOverlayCache.getOverlay(e,s).next(a=>(o=a,this.remoteDocumentCache.getEntry(e,s))).next(a=>(o!==null&&ts(o.mutation,a,tn.empty(),nt.now()),a))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next(o=>this.getLocalViewOfDocuments(e,o,vs()).next(()=>o))}getLocalViewOfDocuments(e,s,o=vs()){const a=Ts();return this.populateOverlays(e,a,s).next(()=>this.computeViews(e,s,a,o).next(c=>{let d=ps();return c.forEach((h,g)=>{d=d.insert(h,g.overlayedDocument)}),d}))}getOverlayedDocuments(e,s){const o=Ts();return this.populateOverlays(e,o,s).next(()=>this.computeViews(e,s,o,vs()))}populateOverlays(e,s,o){const a=[];return o.forEach(c=>{s.has(c)||a.push(c)}),this.documentOverlayCache.getOverlays(e,a).next(c=>{c.forEach((d,h)=>{s.set(d,h)})})}computeViews(e,s,o,a){let c=gs();const d=As(),h=As();return s.forEach((g,_)=>{const ft=o.get(_.key);a.has(_.key)&&(ft===void 0||ft.mutation instanceof is)?c=c.insert(_.key,_):ft!==void 0?(d.set(_.key,ft.mutation.getFieldMask()),ts(ft.mutation,_,ft.mutation.getFieldMask(),nt.now())):d.set(_.key,tn.empty())}),this.recalculateAndSaveOverlays(e,c).next(g=>(g.forEach((_,ft)=>d.set(_,ft)),s.forEach((_,ft)=>{var _t;return h.set(_,new Eo(ft,(_t=d.get(_))!==null&&_t!==void 0?_t:null))}),h))}recalculateAndSaveOverlays(e,s){const o=As();let a=new We((d,h)=>d-h),c=vs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next(d=>{for(const h of d)h.keys().forEach(g=>{const _=s.get(g);if(_===null)return;let ft=o.get(g)||tn.empty();ft=h.applyToLocalView(_,ft),o.set(g,ft);const _t=(a.get(h.batchId)||vs()).add(g);a=a.insert(h.batchId,_t)})}).next(()=>{const d=[],h=a.getReverseIterator();for(;h.hasNext();){const g=h.getNext(),_=g.key,ft=g.value,_t=Es();ft.forEach($t=>{if(!c.has($t)){const Mt=Zn(s.get($t),o.get($t));Mt!==null&&_t.set($t,Mt),c=c.add($t)}}),d.push(this.documentOverlayCache.saveOverlays(e,_,_t))}return At.waitFor(d)}).next(()=>o)}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next(o=>this.recalculateAndSaveOverlays(e,o))}getDocumentsMatchingQuery(e,s,o){return function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):pn(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,o):this.getDocumentsMatchingCollectionQuery(e,s,o)}getNextDocuments(e,s,o,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,o,a).next(c=>{const d=a-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,o.largestBatchId,a-c.size):At.resolve(Ts());let h=-1,g=c;return d.next(_=>At.forEach(_,(ft,_t)=>(h<_t.largestBatchId&&(h=_t.largestBatchId),c.get(ft)?At.resolve():this.remoteDocumentCache.getEntry(e,ft).next($t=>{g=g.insert(ft,$t)}))).next(()=>this.populateOverlays(e,_,c)).next(()=>this.computeViews(e,g,_,vs())).next(ft=>({batchId:h,changes:Is(ft)})))})}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new ct(s)).next(o=>{let a=ps();return o.isFoundDocument()&&(a=a.insert(o.key,o)),a})}getDocumentsMatchingCollectionGroupQuery(e,s,o){const a=s.collectionGroup;let c=ps();return this.indexManager.getCollectionParents(e,a).next(d=>At.forEach(d,h=>{const g=function(_,ft){return new dn(ft,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(s,h.child(a));return this.getDocumentsMatchingCollectionQuery(e,g,o).next(_=>{_.forEach((ft,_t)=>{c=c.insert(ft,_t)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,s,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,o.largestBatchId).next(c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,o,a))).next(c=>{a.forEach((h,g)=>{const _=g.getKey();c.get(_)===null&&(c=c.insert(_,sn.newInvalidDocument(_)))});let d=ps();return c.forEach((h,g)=>{const _=a.get(h);_!==void 0&&ts(_.mutation,g,tn.empty(),nt.now()),Pn(s,g)&&(d=d.insert(h,g))}),d})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this.Tt=e,this.es=new Map,this.ns=new Map}getBundleMetadata(e,s){return At.resolve(this.es.get(s))}saveBundleMetadata(e,s){var o;return this.es.set(s.id,{id:(o=s).id,version:o.version,createTime:Qs(o.createTime)}),At.resolve()}getNamedQuery(e,s){return At.resolve(this.ns.get(s))}saveNamedQuery(e,s){return this.ns.set(s.name,function(o){return{name:o.name,query:cr(o.bundledQuery),readTime:Qs(o.readTime)}}(s)),At.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.overlays=new We(ct.comparator),this.ss=new Map}getOverlay(e,s){return At.resolve(this.overlays.get(s))}getOverlays(e,s){const o=Ts();return At.forEach(s,a=>this.getOverlay(e,a).next(c=>{c!==null&&o.set(a,c)})).next(()=>o)}saveOverlays(e,s,o){return o.forEach((a,c)=>{this.ce(e,s,c)}),At.resolve()}removeOverlaysForBatchId(e,s,o){const a=this.ss.get(o);return a!==void 0&&(a.forEach(c=>this.overlays=this.overlays.remove(c)),this.ss.delete(o)),At.resolve()}getOverlaysForCollection(e,s,o){const a=Ts(),c=s.length+1,d=new ct(s.child("")),h=this.overlays.getIteratorFrom(d);for(;h.hasNext();){const g=h.getNext().value,_=g.getKey();if(!s.isPrefixOf(_.path))break;_.path.length===c&&g.largestBatchId>o&&a.set(g.getKey(),g)}return At.resolve(a)}getOverlaysForCollectionGroup(e,s,o,a){let c=new We((_,ft)=>_-ft);const d=this.overlays.getIterator();for(;d.hasNext();){const _=d.getNext().value;if(_.getKey().getCollectionGroup()===s&&_.largestBatchId>o){let ft=c.get(_.largestBatchId);ft===null&&(ft=Ts(),c=c.insert(_.largestBatchId,ft)),ft.set(_.getKey(),_)}}const h=Ts(),g=c.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach((_,ft)=>h.set(_,ft)),!(h.size()>=a)););return At.resolve(h)}ce(e,s,o){const a=this.overlays.get(o.key);if(a!==null){const d=this.ss.get(a.largestBatchId).delete(o.key);this.ss.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(o.key,new Yi(s,o));let c=this.ss.get(s);c===void 0&&(c=vs(),this.ss.set(s,c)),this.ss.set(s,c.add(o.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(){this.rs=new Ye(Po.os),this.us=new Ye(Po.cs)}isEmpty(){return this.rs.isEmpty()}addReference(e,s){const o=new Po(e,s);this.rs=this.rs.add(o),this.us=this.us.add(o)}hs(e,s){e.forEach(o=>this.addReference(o,s))}removeReference(e,s){this.ls(new Po(e,s))}fs(e,s){e.forEach(o=>this.removeReference(o,s))}ds(e){const s=new ct(new rt([])),o=new Po(s,e),a=new Po(s,e+1),c=[];return this.us.forEachInRange([o,a],d=>{this.ls(d),c.push(d.key)}),c}_s(){this.rs.forEach(e=>this.ls(e))}ls(e){this.rs=this.rs.delete(e),this.us=this.us.delete(e)}ws(e){const s=new ct(new rt([])),o=new Po(s,e),a=new Po(s,e+1);let c=vs();return this.us.forEachInRange([o,a],d=>{c=c.add(d.key)}),c}containsKey(e){const s=new Po(e,0),o=this.rs.firstAfterOrEqual(s);return o!==null&&e.isEqual(o.key)}}class Po{constructor(e,s){this.key=e,this.gs=s}static os(e,s){return ct.comparator(e.key,s.key)||X(e.gs,s.gs)}static cs(e,s){return X(e.gs,s.gs)||ct.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.ys=1,this.ps=new Ye(Po.os)}checkEmpty(e){return At.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,o,a){const c=this.ys;this.ys++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new Hi(c,s,o,a);this.mutationQueue.push(d);for(const h of a)this.ps=this.ps.add(new Po(h.key,c)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return At.resolve(d)}lookupMutationBatch(e,s){return At.resolve(this.Is(s))}getNextMutationBatchAfterBatchId(e,s){const o=s+1,a=this.Ts(o),c=a<0?0:a;return At.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return At.resolve(this.mutationQueue.length===0?-1:this.ys-1)}getAllMutationBatches(e){return At.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const o=new Po(s,0),a=new Po(s,Number.POSITIVE_INFINITY),c=[];return this.ps.forEachInRange([o,a],d=>{const h=this.Is(d.gs);c.push(h)}),At.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,s){let o=new Ye(X);return s.forEach(a=>{const c=new Po(a,0),d=new Po(a,Number.POSITIVE_INFINITY);this.ps.forEachInRange([c,d],h=>{o=o.add(h.gs)})}),At.resolve(this.Es(o))}getAllMutationBatchesAffectingQuery(e,s){const o=s.path,a=o.length+1;let c=o;ct.isDocumentKey(c)||(c=c.child(""));const d=new Po(new ct(c),0);let h=new Ye(X);return this.ps.forEachWhile(g=>{const _=g.key.path;return!!o.isPrefixOf(_)&&(_.length===a&&(h=h.add(g.gs)),!0)},d),At.resolve(this.Es(h))}Es(e){const s=[];return e.forEach(o=>{const a=this.Is(o);a!==null&&s.push(a)}),s}removeMutationBatch(e,s){M(this.As(s.batchId,"removed")===0),this.mutationQueue.shift();let o=this.ps;return At.forEach(s.mutations,a=>{const c=new Po(a.key,s.batchId);return o=o.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.ps=o})}bn(e){}containsKey(e,s){const o=new Po(s,0),a=this.ps.firstAfterOrEqual(o);return At.resolve(s.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,At.resolve()}As(e,s){return this.Ts(e)}Ts(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Is(e){const s=this.Ts(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e){this.Rs=e,this.docs=new We(ct.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const o=s.key,a=this.docs.get(o),c=a?a.size:0,d=this.Rs(s);return this.docs=this.docs.insert(o,{document:s.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,o.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const o=this.docs.get(s);return At.resolve(o?o.document.mutableCopy():sn.newInvalidDocument(s))}getEntries(e,s){let o=gs();return s.forEach(a=>{const c=this.docs.get(a);o=o.insert(a,c?c.document.mutableCopy():sn.newInvalidDocument(a))}),At.resolve(o)}getDocumentsMatchingQuery(e,s,o,a){let c=gs();const d=s.path,h=new ct(d.child("")),g=this.docs.getIteratorFrom(h);for(;g.hasNext();){const{key:_,value:{document:ft}}=g.getNext();if(!d.isPrefixOf(_.path))break;_.path.length>d.length+1||pt(gt(ft),o)<=0||(a.has(ft.key)||Pn(s,ft))&&(c=c.insert(ft.key,ft.mutableCopy()))}return At.resolve(c)}getAllFromCollectionGroup(e,s,o,a){O()}bs(e,s){return At.forEach(this.docs,o=>s(o))}newChangeBuffer(e){return new Do(this)}getSize(e){return At.resolve(this.size)}}class Do extends fo{constructor(e){super(),this.Xn=e}applyChanges(e){const s=[];return this.changes.forEach((o,a)=>{a.isValidDocument()?s.push(this.Xn.addEntry(e,a)):this.Xn.removeEntry(o)}),At.waitFor(s)}getFromCache(e,s){return this.Xn.getEntry(e,s)}getAllFromCache(e,s){return this.Xn.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e){this.persistence=e,this.vs=new ws(s=>un(s),cn),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.Ps=0,this.Vs=new vo,this.targetCount=0,this.Ss=eo.Vn()}forEachTarget(e,s){return this.vs.forEach((o,a)=>s(a)),At.resolve()}getLastRemoteSnapshotVersion(e){return At.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return At.resolve(this.Ps)}allocateTargetId(e){return this.highestTargetId=this.Ss.next(),At.resolve(this.highestTargetId)}setTargetsMetadata(e,s,o){return o&&(this.lastRemoteSnapshotVersion=o),s>this.Ps&&(this.Ps=s),At.resolve()}xn(e){this.vs.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.Ss=new eo(s),this.highestTargetId=s),e.sequenceNumber>this.Ps&&(this.Ps=e.sequenceNumber)}addTargetData(e,s){return this.xn(s),this.targetCount+=1,At.resolve()}updateTargetData(e,s){return this.xn(s),At.resolve()}removeTargetData(e,s){return this.vs.delete(s.target),this.Vs.ds(s.targetId),this.targetCount-=1,At.resolve()}removeTargets(e,s,o){let a=0;const c=[];return this.vs.forEach((d,h)=>{h.sequenceNumber<=s&&o.get(h.targetId)===null&&(this.vs.delete(d),c.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)}),At.waitFor(c).next(()=>a)}getTargetCount(e){return At.resolve(this.targetCount)}getTargetData(e,s){const o=this.vs.get(s)||null;return At.resolve(o)}addMatchingKeys(e,s,o){return this.Vs.hs(s,o),At.resolve()}removeMatchingKeys(e,s,o){this.Vs.fs(s,o);const a=this.persistence.referenceDelegate,c=[];return a&&s.forEach(d=>{c.push(a.markPotentiallyOrphaned(e,d))}),At.waitFor(c)}removeMatchingKeysForTargetId(e,s){return this.Vs.ds(s),At.resolve()}getMatchingKeysForTargetId(e,s){const o=this.Vs.ws(s);return At.resolve(o)}containsKey(e,s){return At.resolve(this.Vs.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,s){this.Ds={},this.overlays={},this.Cs=new Ot(0),this.xs=!1,this.xs=!0,this.referenceDelegate=e(this),this.Ns=new Co(this),this.indexManager=new Fr,this.remoteDocumentCache=function(o){return new So(o)}(o=>this.referenceDelegate.ks(o)),this.Tt=new Xi(s),this.Os=new Ro(this.Tt)}start(){return Promise.resolve()}shutdown(){return this.xs=!1,Promise.resolve()}get started(){return this.xs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new bo,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let o=this.Ds[e.toKey()];return o||(o=new Vo(s,this.referenceDelegate),this.Ds[e.toKey()]=o),o}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Os}runTransaction(e,s,o){C("MemoryPersistence","Starting transaction:",e);const a=new No(this.Cs.next());return this.referenceDelegate.Ms(),o(a).next(c=>this.referenceDelegate.Fs(a).next(()=>c)).toPromise().then(c=>(a.raiseOnCommittedEvent(),c))}$s(e,s){return At.or(Object.values(this.Ds).map(o=>()=>o.containsKey(e,s)))}}class No extends Tt{constructor(e){super(),this.currentSequenceNumber=e}}class ko{constructor(e){this.persistence=e,this.Bs=new vo,this.Ls=null}static qs(e){return new ko(e)}get Us(){if(this.Ls)return this.Ls;throw O()}addReference(e,s,o){return this.Bs.addReference(o,s),this.Us.delete(o.toString()),At.resolve()}removeReference(e,s,o){return this.Bs.removeReference(o,s),this.Us.add(o.toString()),At.resolve()}markPotentiallyOrphaned(e,s){return this.Us.add(s.toString()),At.resolve()}removeTarget(e,s){this.Bs.ds(s.targetId).forEach(a=>this.Us.add(a.toString()));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,s.targetId).next(a=>{a.forEach(c=>this.Us.add(c.toString()))}).next(()=>o.removeTargetData(e,s))}Ms(){this.Ls=new Set}Fs(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return At.forEach(this.Us,o=>{const a=ct.fromPath(o);return this.Ks(e,a).next(c=>{c||s.removeEntry(a,st.min())})}).next(()=>(this.Ls=null,s.apply(e)))}updateLimboDocument(e,s){return this.Ks(e,s).next(o=>{o?this.Us.delete(s.toString()):this.Us.add(s.toString())})}ks(e){return 0}Ks(e,s){return At.or([()=>At.resolve(this.Bs.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.$s(e,s)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.Tt=e}$(e,s,o,a){const c=new Rt("createOrUpgrade",s);o<1&&a>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ri,{unique:!0}),h.createObjectStore("documentMutations")}(e),Mo(e),function(h){h.createObjectStore("remoteDocuments")}(e));let d=At.resolve();return o<3&&a>=3&&(o!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),Mo(e)),d=d.next(()=>function(h){const g=h.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:st.min().toTimestamp(),targetCount:0};return g.put("targetGlobalKey",_)}(c))),o<4&&a>=4&&(o!==0&&(d=d.next(()=>function(h,g){return g.store("mutations").W().next(_=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ri,{unique:!0});const ft=g.store("mutations"),_t=_.map($t=>ft.put($t));return At.waitFor(_t)})}(e,c))),d=d.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),o<5&&a>=5&&(d=d.next(()=>this.Gs(c))),o<6&&a>=6&&(d=d.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Qs(c)))),o<7&&a>=7&&(d=d.next(()=>this.js(c))),o<8&&a>=8&&(d=d.next(()=>this.zs(e,c))),o<9&&a>=9&&(d=d.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),o<10&&a>=10&&(d=d.next(()=>this.Ws(c))),o<11&&a>=11&&(d=d.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),o<12&&a>=12&&(d=d.next(()=>{(function(h){const g=h.createObjectStore("documentOverlays",{keyPath:Bi});g.createIndex("collectionPathOverlayIndex",Li,{unique:!1}),g.createIndex("collectionGroupOverlayIndex",qi,{unique:!1})})(e)})),o<13&&a>=13&&(d=d.next(()=>function(h){const g=h.createObjectStore("remoteDocumentsV14",{keyPath:Vi});g.createIndex("documentKeyIndex",Si),g.createIndex("collectionGroupIndex",Di)}(e)).next(()=>this.Hs(e,c)).next(()=>e.deleteObjectStore("remoteDocuments"))),o<14&&a>=14&&(d=d.next(()=>this.Js(e,c))),o<15&&a>=15&&(d=d.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:Oi}).createIndex("sequenceNumberIndex",Mi,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:Fi}).createIndex("documentKeyIndex",$i,{unique:!1})}(e))),d}Qs(e){let s=0;return e.store("remoteDocuments").X((o,a)=>{s+=Hr(a)}).next(()=>{const o={byteSize:s};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",o)})}Gs(e){const s=e.store("mutationQueues"),o=e.store("mutations");return s.W().next(a=>At.forEach(a,c=>{const d=IDBKeyRange.bound([c.userId,-1],[c.userId,c.lastAcknowledgedBatchId]);return o.W("userMutationsIndex",d).next(h=>At.forEach(h,g=>{M(g.userId===c.userId);const _=rr(this.Tt,g);return Wr(e,c.userId,_).next(()=>{})}))}))}js(e){const s=e.store("targetDocuments"),o=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const c=[];return o.X((d,h)=>{const g=new rt(d),_=function(ft){return[0,Ii(ft)]}(g);c.push(s.get(_).next(ft=>ft?At.resolve():(_t=>s.put({targetId:0,path:Ii(_t),sequenceNumber:a.highestListenSequenceNumber}))(g)))}).next(()=>At.waitFor(c))})}zs(e,s){e.createObjectStore("collectionParents",{keyPath:ki});const o=s.store("collectionParents"),a=new $r,c=d=>{if(a.add(d)){const h=d.lastSegment(),g=d.popLast();return o.put({collectionId:h,parent:Ii(g)})}};return s.store("remoteDocuments").X({Z:!0},(d,h)=>{const g=new rt(d);return c(g.popLast())}).next(()=>s.store("documentMutations").X({Z:!0},([d,h,g],_)=>{const ft=Ai(h);return c(ft.popLast())}))}Ws(e){const s=e.store("targets");return s.X((o,a)=>{const c=or(a),d=ur(this.Tt,c);return s.put(d)})}Hs(e,s){const o=s.store("remoteDocuments"),a=[];return o.X((c,d)=>{const h=s.store("remoteDocumentsV14"),g=(_=d,_.document?new ct(rt.fromString(_.document.name).popFirst(5)):_.noDocument?ct.fromSegments(_.noDocument.path):_.unknownDocument?ct.fromSegments(_.unknownDocument.path):O()).path.toArray();var _;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ft={prefixPath:g.slice(0,g.length-2),collectionGroup:g[g.length-2],documentId:g[g.length-1],readTime:d.readTime||[0,0],unknownDocument:d.unknownDocument,noDocument:d.noDocument,document:d.document,hasCommittedMutations:!!d.hasCommittedMutations};a.push(h.put(ft))}).next(()=>At.waitFor(a))}Js(e,s){const o=s.store("mutations"),a=wo(this.Tt),c=new xo(ko.qs,this.Tt.oe);return o.W().next(d=>{const h=new Map;return d.forEach(g=>{var _;let ft=(_=h.get(g.userId))!==null&&_!==void 0?_:vs();rr(this.Tt,g).keys().forEach(_t=>ft=ft.add(_t)),h.set(g.userId,ft)}),At.forEach(h,(g,_)=>{const ft=new v(_),_t=wr.ue(this.Tt,ft),$t=c.getIndexManager(ft),Mt=Jr.ue(ft,this.Tt,$t,c.referenceDelegate);return new Ao(a,Mt,_t,$t).recalculateAndSaveOverlaysForDocumentKeys(new zi(s,Ot.at),g).next()})})}}function Mo(i){i.createObjectStore("targetDocuments",{keyPath:xi}).createIndex("documentTargetsIndex",Ni,{unique:!0}),i.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ci,{unique:!0}),i.createObjectStore("targetGlobal")}const Fo="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class $o{constructor(e,s,o,a,c,d,h,g,_,ft,_t=15){if(this.allowTabSynchronization=e,this.persistenceKey=s,this.clientId=o,this.Ys=c,this.window=d,this.document=h,this.Zs=_,this.Xs=ft,this.ti=_t,this.Cs=null,this.xs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ei=null,this.inForeground=!1,this.ni=null,this.si=null,this.ii=Number.NEGATIVE_INFINITY,this.ri=$t=>Promise.resolve(),!$o.C())throw new L(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ho(this,a),this.oi=s+"main",this.Tt=new Xi(g),this.ui=new bt(this.oi,this.ti,new Oo(this.Tt)),this.Ns=new no(this.referenceDelegate,this.Tt),this.remoteDocumentCache=wo(this.Tt),this.Os=new fr,this.window&&this.window.localStorage?this.ci=this.window.localStorage:(this.ci=null,ft===!1&&x("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(B.FAILED_PRECONDITION,Fo);return this.hi(),this.li(),this.fi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ns.getHighestSequenceNumber(e))}).then(e=>{this.Cs=new Ot(e,this.Zs)}).then(()=>{this.xs=!0}).catch(e=>(this.ui&&this.ui.close(),Promise.reject(e)))}di(e){return this.ri=async s=>{if(this.started)return e(s)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ui.L(async s=>{s.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ys.enqueueAndForget(async()=>{this.started&&await this.ai()}))}ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Lo(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this._i(e).next(s=>{s||(this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)))})}).next(()=>this.wi(e)).next(s=>this.isPrimary&&!s?this.mi(e).next(()=>!1):!!s&&this.gi(e).next(()=>!0))).catch(e=>{if(Vt(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ys.enqueueRetryable(()=>this.ri(e)),this.isPrimary=e})}_i(e){return Bo(e).get("owner").next(s=>At.resolve(this.yi(s)))}pi(e){return Lo(e).delete(this.clientId)}async Ii(){if(this.isPrimary&&!this.Ti(this.ii,18e5)){this.ii=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",s=>{const o=Wi(s,"clientMetadata");return o.W().next(a=>{const c=this.Ei(a,18e5),d=a.filter(h=>c.indexOf(h)===-1);return At.forEach(d,h=>o.delete(h.clientId)).next(()=>d)})}).catch(()=>[]);if(this.ci)for(const s of e)this.ci.removeItem(this.Ai(s.clientId))}}fi(){this.si=this.Ys.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ai().then(()=>this.Ii()).then(()=>this.fi()))}yi(e){return!!e&&e.ownerId===this.clientId}wi(e){return this.Xs?At.resolve(!0):Bo(e).get("owner").next(s=>{if(s!==null&&this.Ti(s.leaseTimestampMs,5e3)&&!this.Ri(s.ownerId)){if(this.yi(s)&&this.networkEnabled)return!0;if(!this.yi(s)){if(!s.allowTabSynchronization)throw new L(B.FAILED_PRECONDITION,Fo);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lo(e).W().next(o=>this.Ei(o,5e3).find(a=>{if(this.clientId!==a.clientId){const c=!this.networkEnabled&&a.networkEnabled,d=!this.inForeground&&a.inForeground,h=this.networkEnabled===a.networkEnabled;if(c||d&&h)return!0}return!1})===void 0)}).next(s=>(this.isPrimary!==s&&C("IndexedDbPersistence",`Client ${s?"is":"is not"} eligible for a primary lease.`),s))}async shutdown(){this.xs=!1,this.bi(),this.si&&(this.si.cancel(),this.si=null),this.vi(),this.Pi(),await this.ui.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const s=new zi(e,Ot.at);return this.mi(s).next(()=>this.pi(s))}),this.ui.close(),this.Vi()}Ei(e,s){return e.filter(o=>this.Ti(o.updateTimeMs,s)&&!this.Ri(o.clientId))}Si(){return this.runTransaction("getActiveClients","readonly",e=>Lo(e).W().next(s=>this.Ei(s,18e5).map(o=>o.clientId)))}get started(){return this.xs}getMutationQueue(e,s){return Jr.ue(e,this.Tt,s,this.referenceDelegate)}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Lr(e,this.Tt.oe.databaseId)}getDocumentOverlayCache(e){return wr.ue(this.Tt,e)}getBundleCache(){return this.Os}runTransaction(e,s,o){C("IndexedDbPersistence","Starting transaction:",e);const a=s==="readonly"?"readonly":"readwrite",c=(d=this.ti)===15?ji:d===14?Qi:d===13?Gi:d===12?Ki:d===11?Ui:void O();var d;let h;return this.ui.runTransaction(e,a,c,g=>(h=new zi(g,this.Cs?this.Cs.next():Ot.at),s==="readwrite-primary"?this._i(h).next(_=>!!_||this.wi(h)).next(_=>{if(!_)throw x(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)),new L(B.FAILED_PRECONDITION,It);return o(h)}).next(_=>this.gi(h).next(()=>_)):this.Di(h).next(()=>o(h)))).then(g=>(h.raiseOnCommittedEvent(),g))}Di(e){return Bo(e).get("owner").next(s=>{if(s!==null&&this.Ti(s.leaseTimestampMs,5e3)&&!this.Ri(s.ownerId)&&!this.yi(s)&&!(this.Xs||this.allowTabSynchronization&&s.allowTabSynchronization))throw new L(B.FAILED_PRECONDITION,Fo)})}gi(e){const s={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Bo(e).put("owner",s)}static C(){return bt.C()}mi(e){const s=Bo(e);return s.get("owner").next(o=>this.yi(o)?(C("IndexedDbPersistence","Releasing primary lease."),s.delete("owner")):At.resolve())}Ti(e,s){const o=Date.now();return!(e<o-s)&&(!(e>o)||(x(`Detected an update time that is in the future: ${e} > ${o}`),!1))}hi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ni=()=>{this.Ys.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ai()))},this.document.addEventListener("visibilitychange",this.ni),this.inForeground=this.document.visibilityState==="visible")}vi(){this.ni&&(this.document.removeEventListener("visibilitychange",this.ni),this.ni=null)}li(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ei=()=>{this.bi(),isSafari()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Ys.enterRestrictedMode(!0),this.Ys.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ei))}Pi(){this.ei&&(this.window.removeEventListener("pagehide",this.ei),this.ei=null)}Ri(e){var s;try{const o=((s=this.ci)===null||s===void 0?void 0:s.getItem(this.Ai(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${o?"is":"is not"} zombied in LocalStorage`),o}catch(o){return x("IndexedDbPersistence","Failed to get zombied client id.",o),!1}}bi(){if(this.ci)try{this.ci.setItem(this.Ai(this.clientId),String(Date.now()))}catch(e){x("Failed to set zombie client id.",e)}}Vi(){if(this.ci)try{this.ci.removeItem(this.Ai(this.clientId))}catch{}}Ai(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Bo(i){return Wi(i,"owner")}function Lo(i){return Wi(i,"clientMetadata")}function qo(i,e){let s=i.projectId;return i.isDefaultDatabase||(s+="."+i.database),"firestore/"+e+"/"+s+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,s,o,a){this.targetId=e,this.fromCache=s,this.Ci=o,this.xi=a}static Ni(e,s){let o=vs(),a=vs();for(const c of s.docChanges)switch(c.type){case 0:o=o.add(c.doc.key);break;case 1:a=a.add(c.doc.key)}return new Uo(e,s.fromCache,o,a)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){this.ki=!1}initialize(e,s){this.Oi=e,this.indexManager=s,this.ki=!0}getDocumentsMatchingQuery(e,s,o,a){return this.Mi(e,s).next(c=>c||this.Fi(e,s,a,o)).next(c=>c||this.$i(e,s))}Mi(e,s){if(mn(s))return At.resolve(null);let o=Tn(s);return this.indexManager.getIndexType(e,o).next(a=>a===0?null:(s.limit!==null&&a===1&&(s=An(s,null,"F"),o=Tn(s)),this.indexManager.getDocumentsMatchingTarget(e,o).next(c=>{const d=vs(...c);return this.Oi.getDocuments(e,d).next(h=>this.indexManager.getMinOffset(e,o).next(g=>{const _=this.Bi(s,h);return this.Li(s,_,d,g.readTime)?this.Mi(e,An(s,null,"F")):this.qi(e,_,s,g)}))})))}Fi(e,s,o,a){return mn(s)||a.isEqual(st.min())?this.$i(e,s):this.Oi.getDocuments(e,o).next(c=>{const d=this.Bi(s,c);return this.Li(s,d,o,a)?this.$i(e,s):(S()<=LogLevel.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),vn(s)),this.qi(e,d,s,mt(a,-1)))})}Bi(e,s){let o=new Ye(Sn(e));return s.forEach((a,c)=>{Pn(e,c)&&(o=o.add(c))}),o}Li(e,s,o,a){if(e.limit===null)return!1;if(o.size!==s.size)return!0;const c=e.limitType==="F"?s.last():s.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(a)>0)}$i(e,s){return S()<=LogLevel.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",vn(s)),this.Oi.getDocumentsMatchingQuery(e,s,yt.min())}qi(e,s,o,a){return this.Oi.getDocumentsMatchingQuery(e,o,a).next(c=>(s.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,s,o,a){this.persistence=e,this.Ui=s,this.Tt=a,this.Ki=new We(X),this.Gi=new ws(c=>un(c),cn),this.Qi=new Map,this.ji=e.getRemoteDocumentCache(),this.Ns=e.getTargetCache(),this.Os=e.getBundleCache(),this.zi(o)}zi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ao(this.ji,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ji.setIndexManager(this.indexManager),this.Ui.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",s=>e.collect(s,this.Ki))}}function Qo(i,e,s,o){return new Go(i,e,s,o)}async function jo(i,e){const s=$(i);return await s.persistence.runTransaction("Handle user change","readonly",o=>{let a;return s.mutationQueue.getAllMutationBatches(o).next(c=>(a=c,s.zi(e),s.mutationQueue.getAllMutationBatches(o))).next(c=>{const d=[],h=[];let g=vs();for(const _ of a){d.push(_.batchId);for(const ft of _.mutations)g=g.add(ft.key)}for(const _ of c){h.push(_.batchId);for(const ft of _.mutations)g=g.add(ft.key)}return s.localDocuments.getDocuments(o,g).next(_=>({Wi:_,removedBatchIds:d,addedBatchIds:h}))})})}function zo(i,e){const s=$(i);return s.persistence.runTransaction("Acknowledge batch","readwrite-primary",o=>{const a=e.batch.keys(),c=s.ji.newChangeBuffer({trackRemovals:!0});return function(d,h,g,_){const ft=g.batch,_t=ft.keys();let $t=At.resolve();return _t.forEach(Mt=>{$t=$t.next(()=>_.getEntry(h,Mt)).next(Ft=>{const Ol=g.docVersions.get(Mt);M(Ol!==null),Ft.version.compareTo(Ol)<0&&(ft.applyToRemoteDocument(Ft,g),Ft.isValidDocument()&&(Ft.setReadTime(g.commitVersion),_.addEntry(Ft)))})}),$t.next(()=>d.mutationQueue.removeMutationBatch(h,ft))}(s,o,e,c).next(()=>c.apply(o)).next(()=>s.mutationQueue.performConsistencyCheck(o)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(o,a,e.batch.batchId)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(o,function(d){let h=vs();for(let g=0;g<d.mutationResults.length;++g)d.mutationResults[g].transformResults.length>0&&(h=h.add(d.batch.mutations[g].key));return h}(e))).next(()=>s.localDocuments.getDocuments(o,a))})}function Wo(i){const e=$(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",s=>e.Ns.getLastRemoteSnapshotVersion(s))}function Ho(i,e){const s=$(i),o=e.snapshotVersion;let a=s.Ki;return s.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=s.ji.newChangeBuffer({trackRemovals:!0});a=s.Ki;const h=[];e.targetChanges.forEach((ft,_t)=>{const $t=a.get(_t);if(!$t)return;h.push(s.Ns.removeMatchingKeys(c,ft.removedDocuments,_t).next(()=>s.Ns.addMatchingKeys(c,ft.addedDocuments,_t)));let Mt=$t.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.has(_t)?Mt=Mt.withResumeToken(Ht.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):ft.resumeToken.approximateByteSize()>0&&(Mt=Mt.withResumeToken(ft.resumeToken,o)),a=a.insert(_t,Mt),function(Ft,Ol,Vl){return Ft.resumeToken.approximateByteSize()===0||Ol.snapshotVersion.toMicroseconds()-Ft.snapshotVersion.toMicroseconds()>=3e8?!0:Vl.addedDocuments.size+Vl.modifiedDocuments.size+Vl.removedDocuments.size>0}($t,Mt,ft)&&h.push(s.Ns.updateTargetData(c,Mt))});let g=gs(),_=vs();if(e.documentUpdates.forEach(ft=>{e.resolvedLimboDocuments.has(ft)&&h.push(s.persistence.referenceDelegate.updateLimboDocument(c,ft))}),h.push(Jo(c,d,e.documentUpdates).next(ft=>{g=ft.Hi,_=ft.Ji})),!o.isEqual(st.min())){const ft=s.Ns.getLastRemoteSnapshotVersion(c).next(_t=>s.Ns.setTargetsMetadata(c,c.currentSequenceNumber,o));h.push(ft)}return At.waitFor(h).next(()=>d.apply(c)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,g,_)).next(()=>g)}).then(c=>(s.Ki=a,c))}function Jo(i,e,s){let o=vs(),a=vs();return s.forEach(c=>o=o.add(c)),e.getEntries(i,o).next(c=>{let d=gs();return s.forEach((h,g)=>{const _=c.get(h);g.isFoundDocument()!==_.isFoundDocument()&&(a=a.add(h)),g.isNoDocument()&&g.version.isEqual(st.min())?(e.removeEntry(h,g.readTime),d=d.insert(h,g)):!_.isValidDocument()||g.version.compareTo(_.version)>0||g.version.compareTo(_.version)===0&&_.hasPendingWrites?(e.addEntry(g),d=d.insert(h,g)):C("LocalStore","Ignoring outdated watch update for ",h,". Current version:",_.version," Watch version:",g.version)}),{Hi:d,Ji:a}})}function Yo(i,e){const s=$(i);return s.persistence.runTransaction("Get next mutation batch","readonly",o=>(e===void 0&&(e=-1),s.mutationQueue.getNextMutationBatchAfterBatchId(o,e)))}function Zo(i,e){const s=$(i);return s.persistence.runTransaction("Allocate target","readwrite",o=>{let a;return s.Ns.getTargetData(o,e).next(c=>c?(a=c,At.resolve(a)):s.Ns.allocateTargetId(o).next(d=>(a=new Zi(e,d,0,o.currentSequenceNumber),s.Ns.addTargetData(o,a).next(()=>a))))}).then(o=>{const a=s.Ki.get(o.targetId);return(a===null||o.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(s.Ki=s.Ki.insert(o.targetId,o),s.Gi.set(e,o.targetId)),o})}async function Xo(i,e,s){const o=$(i),a=o.Ki.get(e),c=s?"readwrite":"readwrite-primary";try{s||await o.persistence.runTransaction("Release target",c,d=>o.persistence.referenceDelegate.removeTarget(d,a))}catch(d){if(!Vt(d))throw d;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${d}`)}o.Ki=o.Ki.remove(e),o.Gi.delete(a.target)}function tu(i,e,s){const o=$(i);let a=st.min(),c=vs();return o.persistence.runTransaction("Execute query","readonly",d=>function(h,g,_){const ft=$(h),_t=ft.Gi.get(_);return _t!==void 0?At.resolve(ft.Ki.get(_t)):ft.Ns.getTargetData(g,_)}(o,d,Tn(e)).next(h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,o.Ns.getMatchingKeysForTargetId(d,h.targetId).next(g=>{c=g})}).next(()=>o.Ui.getDocumentsMatchingQuery(d,e,s?a:st.min(),s?c:vs())).next(h=>(su(o,Vn(e),h),{documents:h,Yi:c})))}function eu(i,e){const s=$(i),o=$(s.Ns),a=s.Ki.get(e);return a?Promise.resolve(a.target):s.persistence.runTransaction("Get target data","readonly",c=>o.ie(c,e).next(d=>d?d.target:null))}function nu(i,e){const s=$(i),o=s.Qi.get(e)||st.min();return s.persistence.runTransaction("Get new document changes","readonly",a=>s.ji.getAllFromCollectionGroup(a,e,mt(o,-1),Number.MAX_SAFE_INTEGER)).then(a=>(su(s,e,a),a))}function su(i,e,s){let o=i.Qi.get(e)||st.min();s.forEach((a,c)=>{c.readTime.compareTo(o)>0&&(o=c.readTime)}),i.Qi.set(e,o)}async function iu(i,e,s,o){const a=$(i);let c=vs(),d=gs();for(const _ of s){const ft=e.Zi(_.metadata.name);_.document&&(c=c.add(ft));const _t=e.Xi(_);_t.setReadTime(e.tr(_.metadata.readTime)),d=d.insert(ft,_t)}const h=a.ji.newChangeBuffer({trackRemovals:!0}),g=await Zo(a,function(_){return Tn(wn(rt.fromString(`__bundle__/docs/${_}`)))}(o));return a.persistence.runTransaction("Apply bundle documents","readwrite",_=>Jo(_,h,d).next(ft=>(h.apply(_),ft)).next(ft=>a.Ns.removeMatchingKeysForTargetId(_,g.targetId).next(()=>a.Ns.addMatchingKeys(_,c,g.targetId)).next(()=>a.localDocuments.getLocalViewOfDocuments(_,ft.Hi,ft.Ji)).next(()=>ft.Hi)))}async function ru(i,e,s=vs()){const o=await Zo(i,Tn(cr(e.bundledQuery))),a=$(i);return a.persistence.runTransaction("Save named query","readwrite",c=>{const d=Qs(e.readTime);if(o.snapshotVersion.compareTo(d)>=0)return a.Os.saveNamedQuery(c,e);const h=o.withResumeToken(Ht.EMPTY_BYTE_STRING,d);return a.Ki=a.Ki.insert(h.targetId,h),a.Ns.updateTargetData(c,h).next(()=>a.Ns.removeMatchingKeysForTargetId(c,o.targetId)).next(()=>a.Ns.addMatchingKeys(c,s,o.targetId)).next(()=>a.Os.saveNamedQuery(c,e))})}function ou(i,e){return`firestore_clients_${i}_${e}`}function uu(i,e,s){let o=`firestore_mutations_${i}_${s}`;return e.isAuthenticated()&&(o+=`_${e.uid}`),o}function cu(i,e){return`firestore_targets_${i}_${e}`}class au{constructor(e,s,o,a){this.user=e,this.batchId=s,this.state=o,this.error=a}static er(e,s,o){const a=JSON.parse(o);let c,d=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return d&&a.error&&(d=typeof a.error.message=="string"&&typeof a.error.code=="string",d&&(c=new L(a.error.code,a.error.message))),d?new au(e,s,a.state,c):(x("SharedClientState",`Failed to parse mutation state for ID '${s}': ${o}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class hu{constructor(e,s,o){this.targetId=e,this.state=s,this.error=o}static er(e,s){const o=JSON.parse(s);let a,c=typeof o=="object"&&["not-current","current","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return c&&o.error&&(c=typeof o.error.message=="string"&&typeof o.error.code=="string",c&&(a=new L(o.error.code,o.error.message))),c?new hu(e,o.state,a):(x("SharedClientState",`Failed to parse target state for ID '${e}': ${s}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class lu{constructor(e,s){this.clientId=e,this.activeTargetIds=s}static er(e,s){const o=JSON.parse(s);let a=typeof o=="object"&&o.activeTargetIds instanceof Array,c=Vs();for(let d=0;a&&d<o.activeTargetIds.length;++d)a=jt(o.activeTargetIds[d]),c=c.add(o.activeTargetIds[d]);return a?new lu(e,c):(x("SharedClientState",`Failed to parse client data for instance '${e}': ${s}`),null)}}class fu{constructor(e,s){this.clientId=e,this.onlineState=s}static er(e){const s=JSON.parse(e);return typeof s=="object"&&["Unknown","Online","Offline"].indexOf(s.onlineState)!==-1&&typeof s.clientId=="string"?new fu(s.clientId,s.onlineState):(x("SharedClientState",`Failed to parse online state: ${e}`),null)}}class du{constructor(){this.activeTargetIds=Vs()}sr(e){this.activeTargetIds=this.activeTargetIds.add(e)}ir(e){this.activeTargetIds=this.activeTargetIds.delete(e)}nr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _u{constructor(e,s,o,a,c){this.window=e,this.Ys=s,this.persistenceKey=o,this.rr=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ur=this.cr.bind(this),this.ar=new We(X),this.started=!1,this.hr=[];const d=o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=c,this.lr=ou(this.persistenceKey,this.rr),this.dr=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.ar=this.ar.insert(this.rr,new du),this._r=new RegExp(`^firestore_clients_${d}_([^_]*)$`),this.wr=new RegExp(`^firestore_mutations_${d}_(\\d+)(?:_(.*))?$`),this.mr=new RegExp(`^firestore_targets_${d}_(\\d+)$`),this.gr=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.yr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ur)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Si();for(const o of e){if(o===this.rr)continue;const a=this.getItem(ou(this.persistenceKey,o));if(a){const c=lu.er(o,a);c&&(this.ar=this.ar.insert(c.clientId,c))}}this.pr();const s=this.storage.getItem(this.gr);if(s){const o=this.Ir(s);o&&this.Tr(o)}for(const o of this.hr)this.cr(o);this.hr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.dr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Er(this.ar)}isActiveQueryTarget(e){let s=!1;return this.ar.forEach((o,a)=>{a.activeTargetIds.has(e)&&(s=!0)}),s}addPendingMutation(e){this.Ar(e,"pending")}updateMutationState(e,s,o){this.Ar(e,s,o),this.Rr(e)}addLocalQueryTarget(e){let s="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem(cu(this.persistenceKey,e));if(o){const a=hu.er(e,o);a&&(s=a.state)}}return this.br.sr(e),this.pr(),s}removeLocalQueryTarget(e){this.br.ir(e),this.pr()}isLocalQueryTarget(e){return this.br.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cu(this.persistenceKey,e))}updateQueryState(e,s,o){this.vr(e,s,o)}handleUserChange(e,s,o){s.forEach(a=>{this.Rr(a)}),this.currentUser=e,o.forEach(a=>{this.addPendingMutation(a)})}setOnlineState(e){this.Pr(e)}notifyBundleLoaded(e){this.Vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ur),this.removeItem(this.lr),this.started=!1)}getItem(e){const s=this.storage.getItem(e);return C("SharedClientState","READ",e,s),s}setItem(e,s){C("SharedClientState","SET",e,s),this.storage.setItem(e,s)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}cr(e){const s=e;if(s.storageArea===this.storage){if(C("SharedClientState","EVENT",s.key,s.newValue),s.key===this.lr)return void x("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ys.enqueueRetryable(async()=>{if(this.started){if(s.key!==null){if(this._r.test(s.key)){if(s.newValue==null){const o=this.Sr(s.key);return this.Dr(o,null)}{const o=this.Cr(s.key,s.newValue);if(o)return this.Dr(o.clientId,o)}}else if(this.wr.test(s.key)){if(s.newValue!==null){const o=this.Nr(s.key,s.newValue);if(o)return this.kr(o)}}else if(this.mr.test(s.key)){if(s.newValue!==null){const o=this.Or(s.key,s.newValue);if(o)return this.Mr(o)}}else if(s.key===this.gr){if(s.newValue!==null){const o=this.Ir(s.newValue);if(o)return this.Tr(o)}}else if(s.key===this.dr){const o=function(a){let c=Ot.at;if(a!=null)try{const d=JSON.parse(a);M(typeof d=="number"),c=d}catch(d){x("SharedClientState","Failed to read sequence number from WebStorage",d)}return c}(s.newValue);o!==Ot.at&&this.sequenceNumberHandler(o)}else if(s.key===this.yr){const o=this.Fr(s.newValue);await Promise.all(o.map(a=>this.syncEngine.$r(a)))}}}else this.hr.push(s)})}}get br(){return this.ar.get(this.rr)}pr(){this.setItem(this.lr,this.br.nr())}Ar(e,s,o){const a=new au(this.currentUser,e,s,o),c=uu(this.persistenceKey,this.currentUser,e);this.setItem(c,a.nr())}Rr(e){const s=uu(this.persistenceKey,this.currentUser,e);this.removeItem(s)}Pr(e){const s={clientId:this.rr,onlineState:e};this.storage.setItem(this.gr,JSON.stringify(s))}vr(e,s,o){const a=cu(this.persistenceKey,e),c=new hu(e,s,o);this.setItem(a,c.nr())}Vr(e){const s=JSON.stringify(Array.from(e));this.setItem(this.yr,s)}Sr(e){const s=this._r.exec(e);return s?s[1]:null}Cr(e,s){const o=this.Sr(e);return lu.er(o,s)}Nr(e,s){const o=this.wr.exec(e),a=Number(o[1]),c=o[2]!==void 0?o[2]:null;return au.er(new v(c),a,s)}Or(e,s){const o=this.mr.exec(e),a=Number(o[1]);return hu.er(a,s)}Ir(e){return fu.er(e)}Fr(e){return JSON.parse(e)}async kr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Br(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Mr(e){return this.syncEngine.Lr(e.targetId,e.state,e.error)}Dr(e,s){const o=s?this.ar.insert(e,s):this.ar.remove(e),a=this.Er(this.ar),c=this.Er(o),d=[],h=[];return c.forEach(g=>{a.has(g)||d.push(g)}),a.forEach(g=>{c.has(g)||h.push(g)}),this.syncEngine.qr(d,h).then(()=>{this.ar=o})}Tr(e){this.ar.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Er(e){let s=Vs();return e.forEach((o,a)=>{s=s.unionWith(a.activeTargetIds)}),s}}class wu{constructor(){this.Ur=new du,this.Kr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,o){}addLocalQueryTarget(e){return this.Ur.sr(e),this.Kr[e]||"not-current"}updateQueryState(e,s,o){this.Kr[e]=s}removeLocalQueryTarget(e){this.Ur.ir(e)}isLocalQueryTarget(e){return this.Ur.activeTargetIds.has(e)}clearQueryState(e){delete this.Kr[e]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(e){return this.Ur.activeTargetIds.has(e)}start(){return this.Ur=new du,Promise.resolve()}handleUserChange(e,s,o){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{Gr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this.Qr=()=>this.jr(),this.zr=()=>this.Wr(),this.Hr=[],this.Jr()}Gr(e){this.Hr.push(e)}shutdown(){window.removeEventListener("online",this.Qr),window.removeEventListener("offline",this.zr)}Jr(){window.addEventListener("online",this.Qr),window.addEventListener("offline",this.zr)}jr(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Hr)e(0)}Wr(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Hr)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.Yr=e.Yr,this.Zr=e.Zr}Xr(e){this.eo=e}no(e){this.so=e}onMessage(e){this.io=e}close(){this.Zr()}send(e){this.Yr(e)}ro(){this.eo()}oo(e){this.so(e)}uo(e){this.io(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const s=e.ssl?"https":"http";this.co=s+"://"+e.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get ho(){return!1}lo(e,s,o,a,c){const d=this.fo(e,s);C("RestConnection","Sending: ",d,o);const h={};return this._o(h,a,c),this.wo(e,d,h,o).then(g=>(C("RestConnection","Received: ",g),g),g=>{throw N("RestConnection",`${e} failed with error: `,g,"url: ",d,"request:",o),g})}mo(e,s,o,a,c,d){return this.lo(e,s,o,a,c)}_o(e,s,o){e["X-Goog-Api-Client"]="gl-js/ fire/"+P,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((a,c)=>e[c]=a),o&&o.headers.forEach((a,c)=>e[c]=a)}fo(e,s){const o=yu[e];return`${this.co}/v1/${s}:${o}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}wo(e,s,o,a){return new Promise((c,d)=>{const h=new XhrIo;h.setWithCredentials(!0),h.listenOnce(EventType.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ErrorCode$1.NO_ERROR:const _=h.getResponseJson();C("Connection","XHR received:",JSON.stringify(_)),c(_);break;case ErrorCode$1.TIMEOUT:C("Connection",'RPC "'+e+'" timed out'),d(new L(B.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode$1.HTTP_ERROR:const ft=h.getStatus();if(C("Connection",'RPC "'+e+'" failed with status:',ft,"response text:",h.getResponseText()),ft>0){let _t=h.getResponseJson();Array.isArray(_t)&&(_t=_t[0]);const $t=_t==null?void 0:_t.error;if($t&&$t.status&&$t.message){const Mt=function(Ft){const Ol=Ft.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(Ol)>=0?Ol:B.UNKNOWN}($t.status);d(new L(Mt,$t.message))}else d(new L(B.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new L(B.UNAVAILABLE,"Connection failed."));break;default:O()}}finally{C("Connection",'RPC "'+e+'" completed.')}});const g=JSON.stringify(a);h.send(s,"POST",g,o,15)})}yo(e,s,o){const a=[this.co,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=createWebChannelTransport(),d=getStatEventTarget(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new FetchXmlHttpFactory({})),this._o(h.initMessageHeaders,s,o),h.encodeInitMessageHeaders=!0;const g=a.join("");C("Connection","Creating WebChannel: "+g,h);const _=c.createWebChannel(g,h);let ft=!1,_t=!1;const $t=new pu({Yr:Ft=>{_t?C("Connection","Not sending because WebChannel is closed:",Ft):(ft||(C("Connection","Opening WebChannel transport."),_.open(),ft=!0),C("Connection","WebChannel sending:",Ft),_.send(Ft))},Zr:()=>_.close()}),Mt=(Ft,Ol,Vl)=>{Ft.listen(Ol,Nl=>{try{Vl(Nl)}catch(xl){setTimeout(()=>{throw xl},0)}})};return Mt(_,WebChannel.EventType.OPEN,()=>{_t||C("Connection","WebChannel transport opened.")}),Mt(_,WebChannel.EventType.CLOSE,()=>{_t||(_t=!0,C("Connection","WebChannel transport closed"),$t.oo())}),Mt(_,WebChannel.EventType.ERROR,Ft=>{_t||(_t=!0,N("Connection","WebChannel transport errored:",Ft),$t.oo(new L(B.UNAVAILABLE,"The operation could not be completed")))}),Mt(_,WebChannel.EventType.MESSAGE,Ft=>{var Ol;if(!_t){const Vl=Ft.data[0];M(!!Vl);const Nl=Vl,xl=Nl.error||((Ol=Nl[0])===null||Ol===void 0?void 0:Ol.error);if(xl){C("Connection","WebChannel received error:",xl);const Ml=xl.status;let Su=function(ep){const tp=ls[ep];if(tp!==void 0)return _s(tp)}(Ml),_d=xl.message;Su===void 0&&(Su=B.INTERNAL,_d="Unknown error status: "+Ml+" with message "+xl.message),_t=!0,$t.oo(new L(Su,_d)),_.close()}else C("Connection","WebChannel received:",Vl),$t.uo(Vl)}}),Mt(d,Event.STAT_EVENT,Ft=>{Ft.stat===Stat.PROXY?C("Connection","Detected buffering proxy"):Ft.stat===Stat.NOPROXY&&C("Connection","Detected no buffering proxy")}),setTimeout(()=>{$t.ro()},0),$t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(){return typeof window<"u"?window:null}function Eu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(i){return new qs(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,s,o=1e3,a=1.5,c=6e4){this.Ys=e,this.timerId=s,this.po=o,this.Io=a,this.To=c,this.Eo=0,this.Ao=null,this.Ro=Date.now(),this.reset()}reset(){this.Eo=0}bo(){this.Eo=this.To}vo(e){this.cancel();const s=Math.floor(this.Eo+this.Po()),o=Math.max(0,Date.now()-this.Ro),a=Math.max(0,s-o);a>0&&C("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Eo} ms, delay with jitter: ${s} ms, last attempt: ${o} ms ago)`),this.Ao=this.Ys.enqueueAfterDelay(this.timerId,a,()=>(this.Ro=Date.now(),e())),this.Eo*=this.Io,this.Eo<this.po&&(this.Eo=this.po),this.Eo>this.To&&(this.Eo=this.To)}Vo(){this.Ao!==null&&(this.Ao.skipDelay(),this.Ao=null)}cancel(){this.Ao!==null&&(this.Ao.cancel(),this.Ao=null)}Po(){return(Math.random()-.5)*this.Eo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,s,o,a,c,d,h,g){this.Ys=e,this.So=o,this.Do=a,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=h,this.listener=g,this.state=0,this.Co=0,this.xo=null,this.No=null,this.stream=null,this.ko=new Ru(e,s)}Oo(){return this.state===1||this.state===5||this.Mo()}Mo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Fo()}async stop(){this.Oo()&&await this.close(0)}$o(){this.state=0,this.ko.reset()}Bo(){this.Mo()&&this.xo===null&&(this.xo=this.Ys.enqueueAfterDelay(this.So,6e4,()=>this.Lo()))}qo(e){this.Uo(),this.stream.send(e)}async Lo(){if(this.Mo())return this.close(0)}Uo(){this.xo&&(this.xo.cancel(),this.xo=null)}Ko(){this.No&&(this.No.cancel(),this.No=null)}async close(e,s){this.Uo(),this.Ko(),this.ko.cancel(),this.Co++,e!==4?this.ko.reset():s&&s.code===B.RESOURCE_EXHAUSTED?(x(s.toString()),x("Using maximum backoff delay to prevent overloading the backend."),this.ko.bo()):s&&s.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Go(),this.stream.close(),this.stream=null),this.state=e,await this.listener.no(s)}Go(){}auth(){this.state=1;const e=this.Qo(this.Co),s=this.Co;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([o,a])=>{this.Co===s&&this.jo(o,a)},o=>{e(()=>{const a=new L(B.UNKNOWN,"Fetching auth token failed: "+o.message);return this.zo(a)})})}jo(e,s){const o=this.Qo(this.Co);this.stream=this.Wo(e,s),this.stream.Xr(()=>{o(()=>(this.state=2,this.No=this.Ys.enqueueAfterDelay(this.Do,1e4,()=>(this.Mo()&&(this.state=3),Promise.resolve())),this.listener.Xr()))}),this.stream.no(a=>{o(()=>this.zo(a))}),this.stream.onMessage(a=>{o(()=>this.onMessage(a))})}Fo(){this.state=5,this.ko.vo(async()=>{this.state=0,this.start()})}zo(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Qo(e){return s=>{this.Ys.enqueueAndForget(()=>this.Co===e?s():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vu extends bu{constructor(e,s,o,a,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,o,a,d),this.Tt=c}Wo(e,s){return this.connection.yo("Listen",e,s)}onMessage(e){this.ko.reset();const s=si(this.Tt,e),o=function(a){if(!("targetChange"in a))return st.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?st.min():c.readTime?Qs(c.readTime):st.min()}(e);return this.listener.Ho(s,o)}Jo(e){const s={};s.database=Zs(this.Tt),s.addTarget=function(a,c){let d;const h=c.target;return d=an(h)?{documents:ui(a,h)}:{query:ci(a,h)},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0?d.resumeToken=Ks(a,c.resumeToken):c.snapshotVersion.compareTo(st.min())>0&&(d.readTime=Us(a,c.snapshotVersion.toTimestamp())),d}(this.Tt,e);const o=hi(this.Tt,e);o&&(s.labels=o),this.qo(s)}Yo(e){const s={};s.database=Zs(this.Tt),s.removeTarget=e,this.qo(s)}}class Pu extends bu{constructor(e,s,o,a,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",s,o,a,d),this.Tt=c,this.Zo=!1}get Xo(){return this.Zo}start(){this.Zo=!1,this.lastStreamToken=void 0,super.start()}Go(){this.Zo&&this.tu([])}Wo(e,s){return this.connection.yo("Write",e,s)}onMessage(e){if(M(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Zo){this.ko.reset();const s=oi(e.writeResults,e.commitTime),o=Qs(e.commitTime);return this.listener.eu(o,s)}return M(!e.writeResults||e.writeResults.length===0),this.Zo=!0,this.listener.nu()}su(){const e={};e.database=Zs(this.Tt),this.qo(e)}tu(e){const s={streamToken:this.lastStreamToken,writes:e.map(o=>ii(this.Tt,o))};this.qo(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends class{}{constructor(e,s,o,a){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=o,this.Tt=a,this.iu=!1}ru(){if(this.iu)throw new L(B.FAILED_PRECONDITION,"The client has already been terminated.")}lo(e,s,o){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.lo(e,s,o,a,c)).catch(a=>{throw a.name==="FirebaseError"?(a.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(B.UNKNOWN,a.toString())})}mo(e,s,o,a){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.mo(e,s,o,c,d,a)).catch(c=>{throw c.name==="FirebaseError"?(c.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new L(B.UNKNOWN,c.toString())})}terminate(){this.iu=!0}}class Du{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.ou=0,this.uu=null,this.cu=!0}au(){this.ou===0&&(this.hu("Unknown"),this.uu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.uu=null,this.lu("Backend didn't respond within 10 seconds."),this.hu("Offline"),Promise.resolve())))}fu(e){this.state==="Online"?this.hu("Unknown"):(this.ou++,this.ou>=1&&(this.du(),this.lu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.hu("Offline")))}set(e){this.du(),this.ou=0,e==="Online"&&(this.cu=!1),this.hu(e)}hu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}lu(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.cu?(x(s),this.cu=!1):C("OnlineStateTracker",s)}du(){this.uu!==null&&(this.uu.cancel(),this.uu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,s,o,a,c){this.localStore=e,this.datastore=s,this.asyncQueue=o,this.remoteSyncer={},this._u=[],this.wu=new Map,this.mu=new Set,this.gu=[],this.yu=c,this.yu.Gr(d=>{o.enqueueAndForget(async()=>{Lu(this)&&(C("RemoteStore","Restarting streams for network reachability change."),await async function(h){const g=$(h);g.mu.add(4),await Nu(g),g.pu.set("Unknown"),g.mu.delete(4),await xu(g)}(this))})}),this.pu=new Du(o,a)}}async function xu(i){if(Lu(i))for(const e of i.gu)await e(!0)}async function Nu(i){for(const e of i.gu)await e(!1)}function ku(i,e){const s=$(i);s.wu.has(e.targetId)||(s.wu.set(e.targetId,e),Bu(s)?$u(s):ic(s).Mo()&&Mu(s,e))}function Ou(i,e){const s=$(i),o=ic(s);s.wu.delete(e),o.Mo()&&Fu(s,e),s.wu.size===0&&(o.Mo()?o.Bo():Lu(s)&&s.pu.set("Unknown"))}function Mu(i,e){i.Iu.Ft(e.targetId),ic(i).Jo(e)}function Fu(i,e){i.Iu.Ft(e),ic(i).Yo(e)}function $u(i){i.Iu=new Os({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),ie:e=>i.wu.get(e)||null}),ic(i).start(),i.pu.au()}function Bu(i){return Lu(i)&&!ic(i).Oo()&&i.wu.size>0}function Lu(i){return $(i).mu.size===0}function qu(i){i.Iu=void 0}async function Uu(i){i.wu.forEach((e,s)=>{Mu(i,e)})}async function Ku(i,e){qu(i),Bu(i)?(i.pu.fu(e),$u(i)):i.pu.set("Unknown")}async function Gu(i,e,s){if(i.pu.set("Online"),e instanceof Ns&&e.state===2&&e.cause)try{await async function(o,a){const c=a.cause;for(const d of a.targetIds)o.wu.has(d)&&(await o.remoteSyncer.rejectListen(d,c),o.wu.delete(d),o.Iu.removeTarget(d))}(i,e)}catch(o){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),o),await Qu(i,o)}else if(e instanceof Cs?i.Iu.Qt(e):e instanceof xs?i.Iu.Zt(e):i.Iu.Wt(e),!s.isEqual(st.min()))try{const o=await Wo(i.localStore);s.compareTo(o)>=0&&await function(a,c){const d=a.Iu.ee(c);return d.targetChanges.forEach((h,g)=>{if(h.resumeToken.approximateByteSize()>0){const _=a.wu.get(g);_&&a.wu.set(g,_.withResumeToken(h.resumeToken,c))}}),d.targetMismatches.forEach(h=>{const g=a.wu.get(h);if(!g)return;a.wu.set(h,g.withResumeToken(Ht.EMPTY_BYTE_STRING,g.snapshotVersion)),Fu(a,h);const _=new Zi(g.target,h,1,g.sequenceNumber);Mu(a,_)}),a.remoteSyncer.applyRemoteEvent(d)}(i,s)}catch(o){C("RemoteStore","Failed to raise snapshot:",o),await Qu(i,o)}}async function Qu(i,e,s){if(!Vt(e))throw e;i.mu.add(1),await Nu(i),i.pu.set("Offline"),s||(s=()=>Wo(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{C("RemoteStore","Retrying IndexedDB access"),await s(),i.mu.delete(1),await xu(i)})}function ju(i,e){return e().catch(s=>Qu(i,s,e))}async function zu(i){const e=$(i),s=rc(e);let o=e._u.length>0?e._u[e._u.length-1].batchId:-1;for(;Wu(e);)try{const a=await Yo(e.localStore,o);if(a===null){e._u.length===0&&s.Bo();break}o=a.batchId,Hu(e,a)}catch(a){await Qu(e,a)}Ju(e)&&Yu(e)}function Wu(i){return Lu(i)&&i._u.length<10}function Hu(i,e){i._u.push(e);const s=rc(i);s.Mo()&&s.Xo&&s.tu(e.mutations)}function Ju(i){return Lu(i)&&!rc(i).Oo()&&i._u.length>0}function Yu(i){rc(i).start()}async function Zu(i){rc(i).su()}async function Xu(i){const e=rc(i);for(const s of i._u)e.tu(s.mutations)}async function tc(i,e,s){const o=i._u.shift(),a=Ji.from(o,e,s);await ju(i,()=>i.remoteSyncer.applySuccessfulWrite(a)),await zu(i)}async function ec(i,e){e&&rc(i).Xo&&await async function(s,o){if(a=o.code,ds(a)&&a!==B.ABORTED){const c=s._u.shift();rc(s).$o(),await ju(s,()=>s.remoteSyncer.rejectFailedWrite(c.batchId,o)),await zu(s)}var a}(i,e),Ju(i)&&Yu(i)}async function nc(i,e){const s=$(i);s.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");const o=Lu(s);s.mu.add(3),await Nu(s),o&&s.pu.set("Unknown"),await s.remoteSyncer.handleCredentialChange(e),s.mu.delete(3),await xu(s)}async function sc(i,e){const s=$(i);e?(s.mu.delete(2),await xu(s)):e||(s.mu.add(2),await Nu(s),s.pu.set("Unknown"))}function ic(i){return i.Tu||(i.Tu=function(e,s,o){const a=$(e);return a.ru(),new vu(s,a.connection,a.authCredentials,a.appCheckCredentials,a.Tt,o)}(i.datastore,i.asyncQueue,{Xr:Uu.bind(null,i),no:Ku.bind(null,i),Ho:Gu.bind(null,i)}),i.gu.push(async e=>{e?(i.Tu.$o(),Bu(i)?$u(i):i.pu.set("Unknown")):(await i.Tu.stop(),qu(i))})),i.Tu}function rc(i){return i.Eu||(i.Eu=function(e,s,o){const a=$(e);return a.ru(),new Pu(s,a.connection,a.authCredentials,a.appCheckCredentials,a.Tt,o)}(i.datastore,i.asyncQueue,{Xr:Zu.bind(null,i),no:ec.bind(null,i),nu:Xu.bind(null,i),eu:tc.bind(null,i)}),i.gu.push(async e=>{e?(i.Eu.$o(),await zu(i)):(await i.Eu.stop(),i._u.length>0&&(C("RemoteStore",`Stopping write stream with ${i._u.length} pending writes`),i._u=[]))})),i.Eu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,s,o,a,c){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=o,this.op=a,this.removalCallback=c,this.deferred=new q,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}static createAndSchedule(e,s,o,a,c){const d=Date.now()+o,h=new oc(e,s,d,a,c);return h.start(o),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uc(i,e){if(x("AsyncQueue",`${e}: ${i}`),Vt(i))return new L(B.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e){this.comparator=e?(s,o)=>e(s,o)||ct.comparator(s.key,o.key):(s,o)=>ct.comparator(s.key,o.key),this.keyedMap=ps(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new cc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((s,o)=>(e(s),!1))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof cc)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),o=e.sortedSet.getIterator();for(;s.hasNext();){const a=s.getNext().key,c=o.getNext().key;if(!a.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(s=>{e.push(s.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const o=new cc;return o.comparator=this.comparator,o.keyedMap=e,o.sortedSet=s,o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(){this.Au=new We(ct.comparator)}track(e){const s=e.doc.key,o=this.Au.get(s);o?e.type!==0&&o.type===3?this.Au=this.Au.insert(s,e):e.type===3&&o.type!==1?this.Au=this.Au.insert(s,{type:o.type,doc:e.doc}):e.type===2&&o.type===2?this.Au=this.Au.insert(s,{type:2,doc:e.doc}):e.type===2&&o.type===0?this.Au=this.Au.insert(s,{type:0,doc:e.doc}):e.type===1&&o.type===0?this.Au=this.Au.remove(s):e.type===1&&o.type===2?this.Au=this.Au.insert(s,{type:1,doc:o.doc}):e.type===0&&o.type===1?this.Au=this.Au.insert(s,{type:2,doc:e.doc}):O():this.Au=this.Au.insert(s,e)}Ru(){const e=[];return this.Au.inorderTraversal((s,o)=>{e.push(o)}),e}}class hc{constructor(e,s,o,a,c,d,h,g,_){this.query=e,this.docs=s,this.oldDocs=o,this.docChanges=a,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=h,this.excludesMetadataChanges=g,this.hasCachedResults=_}static fromInitialDocuments(e,s,o,a,c){const d=[];return s.forEach(h=>{d.push({type:0,doc:h})}),new hc(e,s,cc.emptySet(s),d,o,a,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Rn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,o=e.docChanges;if(s.length!==o.length)return!1;for(let a=0;a<s.length;a++)if(s[a].type!==o[a].type||!s[a].doc.isEqual(o[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(){this.bu=void 0,this.listeners=[]}}class fc{constructor(){this.queries=new ws(e=>bn(e),Rn),this.onlineState="Unknown",this.vu=new Set}}async function dc(i,e){const s=$(i),o=e.query;let a=!1,c=s.queries.get(o);if(c||(a=!0,c=new lc),a)try{c.bu=await s.onListen(o)}catch(d){const h=uc(d,`Initialization of query '${vn(e.query)}' failed`);return void e.onError(h)}s.queries.set(o,c),c.listeners.push(e),e.Pu(s.onlineState),c.bu&&e.Vu(c.bu)&&gc(s)}async function _c(i,e){const s=$(i),o=e.query;let a=!1;const c=s.queries.get(o);if(c){const d=c.listeners.indexOf(e);d>=0&&(c.listeners.splice(d,1),a=c.listeners.length===0)}if(a)return s.queries.delete(o),s.onUnlisten(o)}function wc(i,e){const s=$(i);let o=!1;for(const a of e){const c=a.query,d=s.queries.get(c);if(d){for(const h of d.listeners)h.Vu(a)&&(o=!0);d.bu=a}}o&&gc(s)}function mc(i,e,s){const o=$(i),a=o.queries.get(e);if(a)for(const c of a.listeners)c.onError(s);o.queries.delete(e)}function gc(i){i.vu.forEach(e=>{e.next()})}class yc{constructor(e,s,o){this.query=e,this.Su=s,this.Du=!1,this.Cu=null,this.onlineState="Unknown",this.options=o||{}}Vu(e){if(!this.options.includeMetadataChanges){const o=[];for(const a of e.docChanges)a.type!==3&&o.push(a);e=new hc(e.query,e.docs,e.oldDocs,o,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.Du?this.xu(e)&&(this.Su.next(e),s=!0):this.Nu(e,this.onlineState)&&(this.ku(e),s=!0),this.Cu=e,s}onError(e){this.Su.error(e)}Pu(e){this.onlineState=e;let s=!1;return this.Cu&&!this.Du&&this.Nu(this.Cu,e)&&(this.ku(this.Cu),s=!0),s}Nu(e,s){if(!e.fromCache)return!0;const o=s!=="Offline";return(!this.options.Ou||!o)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}xu(e){if(e.docChanges.length>0)return!0;const s=this.Cu&&this.Cu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}ku(e){e=hc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Du=!0,this.Su.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,s){this.Mu=e,this.byteLength=s}Fu(){return"metadata"in this.Mu}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e){this.Tt=e}Zi(e){return Hs(this.Tt,e)}Xi(e){return e.metadata.exists?ei(this.Tt,e.document,!1):sn.newNoDocument(this.Zi(e.metadata.name),this.tr(e.metadata.readTime))}tr(e){return Qs(e)}}class Tc{constructor(e,s,o){this.$u=e,this.localStore=s,this.Tt=o,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Ec(e)}Bu(e){this.progress.bytesLoaded+=e.byteLength;let s=this.progress.documentsLoaded;if(e.Mu.namedQuery)this.queries.push(e.Mu.namedQuery);else if(e.Mu.documentMetadata){this.documents.push({metadata:e.Mu.documentMetadata}),e.Mu.documentMetadata.exists||++s;const o=rt.fromString(e.Mu.documentMetadata.name);this.collectionGroups.add(o.get(o.length-2))}else e.Mu.document&&(this.documents[this.documents.length-1].document=e.Mu.document,++s);return s!==this.progress.documentsLoaded?(this.progress.documentsLoaded=s,Object.assign({},this.progress)):null}Lu(e){const s=new Map,o=new Ic(this.Tt);for(const a of e)if(a.metadata.queries){const c=o.Zi(a.metadata.name);for(const d of a.metadata.queries){const h=(s.get(d)||vs()).add(c);s.set(d,h)}}return s}async complete(){const e=await iu(this.localStore,new Ic(this.Tt),this.documents,this.$u.id),s=this.Lu(this.documents);for(const o of this.queries)await ru(this.localStore,o,s.get(o.name));return this.progress.taskState="Success",{progress:this.progress,qu:this.collectionGroups,Uu:e}}}function Ec(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this.key=e}}class Rc{constructor(e){this.key=e}}class bc{constructor(e,s){this.query=e,this.Ku=s,this.Gu=null,this.hasCachedResults=!1,this.current=!1,this.Qu=vs(),this.mutatedKeys=vs(),this.ju=Sn(e),this.zu=new cc(this.ju)}get Wu(){return this.Ku}Hu(e,s){const o=s?s.Ju:new ac,a=s?s.zu:this.zu;let c=s?s.mutatedKeys:this.mutatedKeys,d=a,h=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,_=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((ft,_t)=>{const $t=a.get(ft),Mt=Pn(this.query,_t)?_t:null,Ft=!!$t&&this.mutatedKeys.has($t.key),Ol=!!Mt&&(Mt.hasLocalMutations||this.mutatedKeys.has(Mt.key)&&Mt.hasCommittedMutations);let Vl=!1;$t&&Mt?$t.data.isEqual(Mt.data)?Ft!==Ol&&(o.track({type:3,doc:Mt}),Vl=!0):this.Yu($t,Mt)||(o.track({type:2,doc:Mt}),Vl=!0,(g&&this.ju(Mt,g)>0||_&&this.ju(Mt,_)<0)&&(h=!0)):!$t&&Mt?(o.track({type:0,doc:Mt}),Vl=!0):$t&&!Mt&&(o.track({type:1,doc:$t}),Vl=!0,(g||_)&&(h=!0)),Vl&&(Mt?(d=d.add(Mt),c=Ol?c.add(ft):c.delete(ft)):(d=d.delete(ft),c=c.delete(ft)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const ft=this.query.limitType==="F"?d.last():d.first();d=d.delete(ft.key),c=c.delete(ft.key),o.track({type:1,doc:ft})}return{zu:d,Ju:o,Li:h,mutatedKeys:c}}Yu(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,o){const a=this.zu;this.zu=e.zu,this.mutatedKeys=e.mutatedKeys;const c=e.Ju.Ru();c.sort((_,ft)=>function(_t,$t){const Mt=Ft=>{switch(Ft){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O()}};return Mt(_t)-Mt($t)}(_.type,ft.type)||this.ju(_.doc,ft.doc)),this.Zu(o);const d=s?this.Xu():[],h=this.Qu.size===0&&this.current?1:0,g=h!==this.Gu;return this.Gu=h,c.length!==0||g?{snapshot:new hc(this.query,e.zu,a,c,e.mutatedKeys,h===0,g,!1,!!o&&o.resumeToken.approximateByteSize()>0),tc:d}:{tc:d}}Pu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({zu:this.zu,Ju:new ac,mutatedKeys:this.mutatedKeys,Li:!1},!1)):{tc:[]}}ec(e){return!this.Ku.has(e)&&!!this.zu.has(e)&&!this.zu.get(e).hasLocalMutations}Zu(e){e&&(e.addedDocuments.forEach(s=>this.Ku=this.Ku.add(s)),e.modifiedDocuments.forEach(s=>{}),e.removedDocuments.forEach(s=>this.Ku=this.Ku.delete(s)),this.current=e.current)}Xu(){if(!this.current)return[];const e=this.Qu;this.Qu=vs(),this.zu.forEach(o=>{this.ec(o.key)&&(this.Qu=this.Qu.add(o.key))});const s=[];return e.forEach(o=>{this.Qu.has(o)||s.push(new Rc(o))}),this.Qu.forEach(o=>{e.has(o)||s.push(new Ac(o))}),s}nc(e){this.Ku=e.Yi,this.Qu=vs();const s=this.Hu(e.documents);return this.applyChanges(s,!0)}sc(){return hc.fromInitialDocuments(this.query,this.zu,this.mutatedKeys,this.Gu===0,this.hasCachedResults)}}class vc{constructor(e,s,o){this.query=e,this.targetId=s,this.view=o}}class Pc{constructor(e){this.key=e,this.ic=!1}}class Vc{constructor(e,s,o,a,c,d){this.localStore=e,this.remoteStore=s,this.eventManager=o,this.sharedClientState=a,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.rc={},this.oc=new ws(h=>bn(h),Rn),this.uc=new Map,this.cc=new Set,this.ac=new We(ct.comparator),this.hc=new Map,this.lc=new vo,this.fc={},this.dc=new Map,this._c=eo.Sn(),this.onlineState="Unknown",this.wc=void 0}get isPrimaryClient(){return this.wc===!0}}async function Sc(i,e){const s=ia(i);let o,a;const c=s.oc.get(e);if(c)o=c.targetId,s.sharedClientState.addLocalQueryTarget(o),a=c.view.sc();else{const d=await Zo(s.localStore,Tn(e));s.isPrimaryClient&&ku(s.remoteStore,d);const h=s.sharedClientState.addLocalQueryTarget(d.targetId);o=d.targetId,a=await Dc(s,e,o,h==="current",d.resumeToken)}return a}async function Dc(i,e,s,o,a){i.mc=(_t,$t,Mt)=>async function(Ft,Ol,Vl,Nl){let xl=Ol.view.Hu(Vl);xl.Li&&(xl=await tu(Ft.localStore,Ol.query,!1).then(({documents:_d})=>Ol.view.Hu(_d,xl)));const Ml=Nl&&Nl.targetChanges.get(Ol.targetId),Su=Ol.view.applyChanges(xl,Ft.isPrimaryClient,Ml);return Kc(Ft,Ol.targetId,Su.tc),Su.snapshot}(i,_t,$t,Mt);const c=await tu(i.localStore,e,!0),d=new bc(e,c.Yi),h=d.Hu(c.documents),g=Ds.createSynthesizedTargetChangeForCurrentChange(s,o&&i.onlineState!=="Offline",a),_=d.applyChanges(h,i.isPrimaryClient,g);Kc(i,s,_.tc);const ft=new vc(e,s,d);return i.oc.set(e,ft),i.uc.has(s)?i.uc.get(s).push(e):i.uc.set(s,[e]),_.snapshot}async function Cc(i,e){const s=$(i),o=s.oc.get(e),a=s.uc.get(o.targetId);if(a.length>1)return s.uc.set(o.targetId,a.filter(c=>!Rn(c,e))),void s.oc.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await Xo(s.localStore,o.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(o.targetId),Ou(s.remoteStore,o.targetId),qc(s,o.targetId)}).catch(Et)):(qc(s,o.targetId),await Xo(s.localStore,o.targetId,!0))}async function xc(i,e,s){const o=ra(i);try{const a=await function(c,d){const h=$(c),g=nt.now(),_=d.reduce(($t,Mt)=>$t.add(Mt.key),vs());let ft,_t;return h.persistence.runTransaction("Locally write mutations","readwrite",$t=>{let Mt=gs(),Ft=vs();return h.ji.getEntries($t,_).next(Ol=>{Mt=Ol,Mt.forEach((Vl,Nl)=>{Nl.isValidDocument()||(Ft=Ft.add(Vl))})}).next(()=>h.localDocuments.getOverlayedDocuments($t,Mt)).next(Ol=>{ft=Ol;const Vl=[];for(const Nl of d){const xl=es(Nl,ft.get(Nl.key).overlayedDocument);xl!=null&&Vl.push(new is(Nl.key,xl,nn(xl.value.mapValue),Hn.exists(!0)))}return h.mutationQueue.addMutationBatch($t,g,Vl,d)}).next(Ol=>{_t=Ol;const Vl=Ol.applyToLocalDocumentSet(ft,Ft);return h.documentOverlayCache.saveOverlays($t,Ol.batchId,Vl)})}).then(()=>({batchId:_t.batchId,changes:Is(ft)}))}(o.localStore,e);o.sharedClientState.addPendingMutation(a.batchId),function(c,d,h){let g=c.fc[c.currentUser.toKey()];g||(g=new We(X)),g=g.insert(d,h),c.fc[c.currentUser.toKey()]=g}(o,a.batchId,s),await jc(o,a.changes),await zu(o.remoteStore)}catch(a){const c=uc(a,"Failed to persist write");s.reject(c)}}async function Nc(i,e){const s=$(i);try{const o=await Ho(s.localStore,e);e.targetChanges.forEach((a,c)=>{const d=s.hc.get(c);d&&(M(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?d.ic=!0:a.modifiedDocuments.size>0?M(d.ic):a.removedDocuments.size>0&&(M(d.ic),d.ic=!1))}),await jc(s,o,e)}catch(o){await Et(o)}}function kc(i,e,s){const o=$(i);if(o.isPrimaryClient&&s===0||!o.isPrimaryClient&&s===1){const a=[];o.oc.forEach((c,d)=>{const h=d.view.Pu(e);h.snapshot&&a.push(h.snapshot)}),function(c,d){const h=$(c);h.onlineState=d;let g=!1;h.queries.forEach((_,ft)=>{for(const _t of ft.listeners)_t.Pu(d)&&(g=!0)}),g&&gc(h)}(o.eventManager,e),a.length&&o.rc.Ho(a),o.onlineState=e,o.isPrimaryClient&&o.sharedClientState.setOnlineState(e)}}async function Oc(i,e,s){const o=$(i);o.sharedClientState.updateQueryState(e,"rejected",s);const a=o.hc.get(e),c=a&&a.key;if(c){let d=new We(ct.comparator);d=d.insert(c,sn.newNoDocument(c,st.min()));const h=vs().add(c),g=new Ss(st.min(),new Map,new Ye(X),d,h);await Nc(o,g),o.ac=o.ac.remove(c),o.hc.delete(e),Qc(o)}else await Xo(o.localStore,e,!1).then(()=>qc(o,e,s)).catch(Et)}async function Mc(i,e){const s=$(i),o=e.batch.batchId;try{const a=await zo(s.localStore,e);Lc(s,o,null),Bc(s,o),s.sharedClientState.updateMutationState(o,"acknowledged"),await jc(s,a)}catch(a){await Et(a)}}async function Fc(i,e,s){const o=$(i);try{const a=await function(c,d){const h=$(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let _;return h.mutationQueue.lookupMutationBatch(g,d).next(ft=>(M(ft!==null),_=ft.keys(),h.mutationQueue.removeMutationBatch(g,ft))).next(()=>h.mutationQueue.performConsistencyCheck(g)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(g,_,d)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_)).next(()=>h.localDocuments.getDocuments(g,_))})}(o.localStore,e);Lc(o,e,s),Bc(o,e),o.sharedClientState.updateMutationState(e,"rejected",s),await jc(o,a)}catch(a){await Et(a)}}async function $c(i,e){const s=$(i);Lu(s.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const o=await function(c){const d=$(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>d.mutationQueue.getHighestUnacknowledgedBatchId(h))}(s.localStore);if(o===-1)return void e.resolve();const a=s.dc.get(o)||[];a.push(e),s.dc.set(o,a)}catch(o){const a=uc(o,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function Bc(i,e){(i.dc.get(e)||[]).forEach(s=>{s.resolve()}),i.dc.delete(e)}function Lc(i,e,s){const o=$(i);let a=o.fc[o.currentUser.toKey()];if(a){const c=a.get(e);c&&(s?c.reject(s):c.resolve(),a=a.remove(e)),o.fc[o.currentUser.toKey()]=a}}function qc(i,e,s=null){i.sharedClientState.removeLocalQueryTarget(e);for(const o of i.uc.get(e))i.oc.delete(o),s&&i.rc.gc(o,s);i.uc.delete(e),i.isPrimaryClient&&i.lc.ds(e).forEach(o=>{i.lc.containsKey(o)||Uc(i,o)})}function Uc(i,e){i.cc.delete(e.path.canonicalString());const s=i.ac.get(e);s!==null&&(Ou(i.remoteStore,s),i.ac=i.ac.remove(e),i.hc.delete(s),Qc(i))}function Kc(i,e,s){for(const o of s)o instanceof Ac?(i.lc.addReference(o.key,e),Gc(i,o)):o instanceof Rc?(C("SyncEngine","Document no longer in limbo: "+o.key),i.lc.removeReference(o.key,e),i.lc.containsKey(o.key)||Uc(i,o.key)):O()}function Gc(i,e){const s=e.key,o=s.path.canonicalString();i.ac.get(s)||i.cc.has(o)||(C("SyncEngine","New document in limbo: "+s),i.cc.add(o),Qc(i))}function Qc(i){for(;i.cc.size>0&&i.ac.size<i.maxConcurrentLimboResolutions;){const e=i.cc.values().next().value;i.cc.delete(e);const s=new ct(rt.fromString(e)),o=i._c.next();i.hc.set(o,new Pc(s)),i.ac=i.ac.insert(s,o),ku(i.remoteStore,new Zi(Tn(wn(s.path)),o,2,Ot.at))}}async function jc(i,e,s){const o=$(i),a=[],c=[],d=[];o.oc.isEmpty()||(o.oc.forEach((h,g)=>{d.push(o.mc(g,e,s).then(_=>{if((_||s)&&o.isPrimaryClient&&o.sharedClientState.updateQueryState(g.targetId,_!=null&&_.fromCache?"not-current":"current"),_){a.push(_);const ft=Uo.Ni(g.targetId,_);c.push(ft)}}))}),await Promise.all(d),o.rc.Ho(a),await async function(h,g){const _=$(h);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",ft=>At.forEach(g,_t=>At.forEach(_t.Ci,$t=>_.persistence.referenceDelegate.addReference(ft,_t.targetId,$t)).next(()=>At.forEach(_t.xi,$t=>_.persistence.referenceDelegate.removeReference(ft,_t.targetId,$t)))))}catch(ft){if(!Vt(ft))throw ft;C("LocalStore","Failed to update sequence numbers: "+ft)}for(const ft of g){const _t=ft.targetId;if(!ft.fromCache){const $t=_.Ki.get(_t),Mt=$t.snapshotVersion,Ft=$t.withLastLimboFreeSnapshotVersion(Mt);_.Ki=_.Ki.insert(_t,Ft)}}}(o.localStore,c))}async function zc(i,e){const s=$(i);if(!s.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());const o=await jo(s.localStore,e);s.currentUser=e,function(a,c){a.dc.forEach(d=>{d.forEach(h=>{h.reject(new L(B.CANCELLED,c))})}),a.dc.clear()}(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,o.removedBatchIds,o.addedBatchIds),await jc(s,o.Wi)}}function Wc(i,e){const s=$(i),o=s.hc.get(e);if(o&&o.ic)return vs().add(o.key);{let a=vs();const c=s.uc.get(e);if(!c)return a;for(const d of c){const h=s.oc.get(d);a=a.unionWith(h.view.Wu)}return a}}async function Hc(i,e){const s=$(i),o=await tu(s.localStore,e.query,!0),a=e.view.nc(o);return s.isPrimaryClient&&Kc(s,e.targetId,a.tc),a}async function Jc(i,e){const s=$(i);return nu(s.localStore,e).then(o=>jc(s,o))}async function Yc(i,e,s,o){const a=$(i),c=await function(d,h){const g=$(d),_=$(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",ft=>_.An(ft,h).next(_t=>_t?g.localDocuments.getDocuments(ft,_t):At.resolve(null)))}(a.localStore,e);c!==null?(s==="pending"?await zu(a.remoteStore):s==="acknowledged"||s==="rejected"?(Lc(a,e,o||null),Bc(a,e),function(d,h){$($(d).mutationQueue).bn(h)}(a.localStore,e)):O(),await jc(a,c)):C("SyncEngine","Cannot apply mutation batch with id: "+e)}async function Zc(i,e){const s=$(i);if(ia(s),ra(s),e===!0&&s.wc!==!0){const o=s.sharedClientState.getAllActiveQueryTargets(),a=await Xc(s,o.toArray());s.wc=!0,await sc(s.remoteStore,!0);for(const c of a)ku(s.remoteStore,c)}else if(e===!1&&s.wc!==!1){const o=[];let a=Promise.resolve();s.uc.forEach((c,d)=>{s.sharedClientState.isLocalQueryTarget(d)?o.push(d):a=a.then(()=>(qc(s,d),Xo(s.localStore,d,!0))),Ou(s.remoteStore,d)}),await a,await Xc(s,o),function(c){const d=$(c);d.hc.forEach((h,g)=>{Ou(d.remoteStore,g)}),d.lc._s(),d.hc=new Map,d.ac=new We(ct.comparator)}(s),s.wc=!1,await sc(s.remoteStore,!1)}}async function Xc(i,e,s){const o=$(i),a=[],c=[];for(const d of e){let h;const g=o.uc.get(d);if(g&&g.length!==0){h=await Zo(o.localStore,Tn(g[0]));for(const _ of g){const ft=o.oc.get(_),_t=await Hc(o,ft);_t.snapshot&&c.push(_t.snapshot)}}else{const _=await eu(o.localStore,d);h=await Zo(o.localStore,_),await Dc(o,ta(_),d,!1,h.resumeToken)}a.push(h)}return o.rc.Ho(c),a}function ta(i){return _n(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function ea(i){const e=$(i);return $($(e.localStore).persistence).Si()}async function na(i,e,s,o){const a=$(i);if(a.wc)return void C("SyncEngine","Ignoring unexpected query state notification.");const c=a.uc.get(e);if(c&&c.length>0)switch(s){case"current":case"not-current":{const d=await nu(a.localStore,Vn(c[0])),h=Ss.createSynthesizedRemoteEventForCurrentChange(e,s==="current",Ht.EMPTY_BYTE_STRING);await jc(a,d,h);break}case"rejected":await Xo(a.localStore,e,!0),qc(a,e,o);break;default:O()}}async function sa(i,e,s){const o=ia(i);if(o.wc){for(const a of e){if(o.uc.has(a)){C("SyncEngine","Adding an already active target "+a);continue}const c=await eu(o.localStore,a),d=await Zo(o.localStore,c);await Dc(o,ta(c),d.targetId,!1,d.resumeToken),ku(o.remoteStore,d)}for(const a of s)o.uc.has(a)&&await Xo(o.localStore,a,!1).then(()=>{Ou(o.remoteStore,a),qc(o,a)}).catch(Et)}}function ia(i){const e=$(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nc.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wc.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Oc.bind(null,e),e.rc.Ho=wc.bind(null,e.eventManager),e.rc.gc=mc.bind(null,e.eventManager),e}function ra(i){const e=$(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Mc.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Fc.bind(null,e),e}function oa(i,e,s){const o=$(i);(async function(a,c,d){try{const h=await c.getMetadata();if(await function(_t,$t){const Mt=$(_t),Ft=Qs($t.createTime);return Mt.persistence.runTransaction("hasNewerBundle","readonly",Ol=>Mt.Os.getBundleMetadata(Ol,$t.id)).then(Ol=>!!Ol&&Ol.createTime.compareTo(Ft)>=0)}(a.localStore,h))return await c.close(),d._completeWith(function(_t){return{taskState:"Success",documentsLoaded:_t.totalDocuments,bytesLoaded:_t.totalBytes,totalDocuments:_t.totalDocuments,totalBytes:_t.totalBytes}}(h)),Promise.resolve(new Set);d._updateProgress(Ec(h));const g=new Tc(h,a.localStore,c.Tt);let _=await c.yc();for(;_;){const _t=await g.Bu(_);_t&&d._updateProgress(_t),_=await c.yc()}const ft=await g.complete();return await jc(a,ft.Uu,void 0),await function(_t,$t){const Mt=$(_t);return Mt.persistence.runTransaction("Save bundle","readwrite",Ft=>Mt.Os.saveBundleMetadata(Ft,$t))}(a.localStore,h),d._completeWith(ft.progress),Promise.resolve(ft.qu)}catch(h){return N("SyncEngine",`Loading bundle failed with ${h}`),d._failWith(h),Promise.resolve(new Set)}})(o,e,s).then(a=>{o.sharedClientState.notifyBundleLoaded(a)})}class ua{constructor(){this.synchronizeTabs=!1}async initialize(e){this.Tt=Au(e.databaseInfo.databaseId),this.sharedClientState=this.Ic(e),this.persistence=this.Tc(e),await this.persistence.start(),this.localStore=this.Ec(e),this.gcScheduler=this.Ac(e,this.localStore),this.indexBackfillerScheduler=this.Rc(e,this.localStore)}Ac(e,s){return null}Rc(e,s){return null}Ec(e){return Qo(this.persistence,new Ko,e.initialUser,this.Tt)}Tc(e){return new xo(ko.qs,this.Tt)}Ic(e){return new wu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ca extends ua{constructor(e,s,o){super(),this.bc=e,this.cacheSizeBytes=s,this.forceOwnership=o,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.bc.initialize(this,e),await ra(this.bc.syncEngine),await zu(this.bc.remoteStore),await this.persistence.di(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Ec(e){return Qo(this.persistence,new Ko,e.initialUser,this.Tt)}Ac(e,s){const o=this.persistence.referenceDelegate.garbageCollector;return new co(o,e.asyncQueue,s)}Rc(e,s){const o=new kt(s,this.persistence);return new Nt(e.asyncQueue,o)}Tc(e){const s=qo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),o=this.cacheSizeBytes!==void 0?zr.withCacheSize(this.cacheSizeBytes):zr.DEFAULT;return new $o(this.synchronizeTabs,s,e.clientId,o,e.asyncQueue,Tu(),Eu(),this.Tt,this.sharedClientState,!!this.forceOwnership)}Ic(e){return new wu}}class aa extends ca{constructor(e,s){super(e,s,!1),this.bc=e,this.cacheSizeBytes=s,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const s=this.bc.syncEngine;this.sharedClientState instanceof _u&&(this.sharedClientState.syncEngine={Br:Yc.bind(null,s),Lr:na.bind(null,s),qr:sa.bind(null,s),Si:ea.bind(null,s),$r:Jc.bind(null,s)},await this.sharedClientState.start()),await this.persistence.di(async o=>{await Zc(this.bc.syncEngine,o),this.gcScheduler&&(o&&!this.gcScheduler.started?this.gcScheduler.start():o||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(o&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():o||this.indexBackfillerScheduler.stop())})}Ic(e){const s=Tu();if(!_u.C(s))throw new L(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const o=qo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new _u(s,e.asyncQueue,o,e.clientId,e.initialUser)}}class ha{async initialize(e,s){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>kc(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=zc.bind(null,this.syncEngine),await sc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new fc}createDatastore(e){const s=Au(e.databaseInfo.databaseId),o=(a=e.databaseInfo,new Iu(a));var a;return function(c,d,h,g){return new Vu(c,d,h,g)}(e.authCredentials,e.appCheckCredentials,o,s)}createRemoteStore(e){return s=this.localStore,o=this.datastore,a=e.asyncQueue,c=h=>kc(this.syncEngine,h,0),d=gu.C()?new gu:new mu,new Cu(s,o,a,c,d);var s,o,a,c,d}createSyncEngine(e,s){return function(o,a,c,d,h,g,_){const ft=new Vc(o,a,c,d,h,g);return _&&(ft.wc=!0),ft}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}terminate(){return async function(e){const s=$(e);C("RemoteStore","RemoteStore shutting down."),s.mu.add(5),await Nu(s),s.yu.shutdown(),s.pu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(i,e=10240){let s=0;return{async read(){if(s<i.byteLength){const o={value:i.slice(s,s+e),done:!1};return s+=e,o}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.vc(this.observer.next,e)}error(e){this.observer.error?this.vc(this.observer.error,e):x("Uncaught Error in snapshot listener:",e.toString())}Pc(){this.muted=!0}vc(e,s){this.muted||setTimeout(()=>{this.muted||e(s)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,s){this.Vc=e,this.Tt=s,this.metadata=new q,this.buffer=new Uint8Array,this.Sc=new TextDecoder("utf-8"),this.Dc().then(o=>{o&&o.Fu()?this.metadata.resolve(o.Mu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(o==null?void 0:o.Mu)}`))},o=>this.metadata.reject(o))}close(){return this.Vc.cancel()}async getMetadata(){return this.metadata.promise}async yc(){return await this.getMetadata(),this.Dc()}async Dc(){const e=await this.Cc();if(e===null)return null;const s=this.Sc.decode(e),o=Number(s);isNaN(o)&&this.xc(`length string (${s}) is not valid number`);const a=await this.Nc(o);return new pc(JSON.parse(a),e.length+o)}kc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Cc(){for(;this.kc()<0&&!await this.Oc(););if(this.buffer.length===0)return null;const e=this.kc();e<0&&this.xc("Reached the end of bundle when a length string is expected.");const s=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),s}async Nc(e){for(;this.buffer.length<e;)await this.Oc()&&this.xc("Reached the end of bundle when more is expected.");const s=this.Sc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),s}xc(e){throw this.Vc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Oc(){const e=await this.Vc.read();if(!e.done){const s=new Uint8Array(this.buffer.length+e.value.length);s.set(this.buffer),s.set(e.value,this.buffer.length),this.buffer=s}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new L(B.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const s=await async function(o,a){const c=$(o),d=Zs(c.Tt)+"/documents",h={documents:a.map(_t=>Ws(c.Tt,_t))},g=await c.mo("BatchGetDocuments",d,h,a.length),_=new Map;g.forEach(_t=>{const $t=ni(c.Tt,_t);_.set($t.key.toString(),$t)});const ft=[];return a.forEach(_t=>{const $t=_.get(_t.toString());M(!!$t),ft.push($t)}),ft}(this.datastore,e);return s.forEach(o=>this.recordVersion(o)),s}set(e,s){this.write(s.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,s){try{this.write(s.toMutation(e,this.preconditionForUpdate(e)))}catch(o){this.lastWriteError=o}this.writtenDocs.add(e.toString())}delete(e){this.write(new cs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(s=>{e.delete(s.key.toString())}),e.forEach((s,o)=>{const a=ct.fromPath(o);this.mutations.push(new as(a,this.precondition(a)))}),await async function(s,o){const a=$(s),c=Zs(a.Tt)+"/documents",d={writes:o.map(h=>ii(a.Tt,h))};await a.lo("Commit",c,d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let s;if(e.isFoundDocument())s=e.version;else{if(!e.isNoDocument())throw O();s=st.min()}const o=this.readVersions.get(e.key.toString());if(o){if(!s.isEqual(o))throw new L(B.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),s)}precondition(e){const s=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&s?s.isEqual(st.min())?Hn.exists(!1):Hn.updateTime(s):Hn.none()}preconditionForUpdate(e){const s=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&s){if(s.isEqual(st.min()))throw new L(B.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Hn.updateTime(s)}return Hn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,s,o,a,c){this.asyncQueue=e,this.datastore=s,this.options=o,this.updateFunction=a,this.deferred=c,this.Mc=o.maxAttempts,this.ko=new Ru(this.asyncQueue,"transaction_retry")}run(){this.Mc-=1,this.Fc()}Fc(){this.ko.vo(async()=>{const e=new _a(this.datastore),s=this.$c(e);s&&s.then(o=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(o)}).catch(a=>{this.Bc(a)}))}).catch(o=>{this.Bc(o)})})}$c(e){try{const s=this.updateFunction(e);return!Gt(s)&&s.catch&&s.then?s:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(s){return this.deferred.reject(s),null}}Bc(e){this.Mc>0&&this.Lc(e)?(this.Mc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Fc(),Promise.resolve()))):this.deferred.reject(e)}Lc(e){if(e.name==="FirebaseError"){const s=e.code;return s==="aborted"||s==="failed-precondition"||s==="already-exists"||!ds(s)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e,s,o,a){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=o,this.databaseInfo=a,this.user=v.UNAUTHENTICATED,this.clientId=Z.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(o,async c=>{C("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(o,c=>(C("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(B.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new q;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const o=uc(s,"Failed to shutdown persistence");e.reject(o)}}),e.promise}}async function ga(i,e){i.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");const s=await i.getConfiguration();await e.initialize(s);let o=s.initialUser;i.setCredentialChangeListener(async a=>{o.isEqual(a)||(await jo(e.localStore,a),o=a)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i.offlineComponents=e}async function ya(i,e){i.asyncQueue.verifyOperationInProgress();const s=await pa(i);C("FirestoreClient","Initializing OnlineComponentProvider");const o=await i.getConfiguration();await e.initialize(s,o),i.setCredentialChangeListener(a=>nc(e.remoteStore,a)),i.setAppCheckTokenChangeListener((a,c)=>nc(e.remoteStore,c)),i.onlineComponents=e}async function pa(i){return i.offlineComponents||(C("FirestoreClient","Using default OfflineComponentProvider"),await ga(i,new ua)),i.offlineComponents}async function Ia(i){return i.onlineComponents||(C("FirestoreClient","Using default OnlineComponentProvider"),await ya(i,new ha)),i.onlineComponents}function Ta(i){return pa(i).then(e=>e.persistence)}function Ea(i){return pa(i).then(e=>e.localStore)}function Aa(i){return Ia(i).then(e=>e.remoteStore)}function Ra(i){return Ia(i).then(e=>e.syncEngine)}function ba(i){return Ia(i).then(e=>e.datastore)}async function va(i){const e=await Ia(i),s=e.eventManager;return s.onListen=Sc.bind(null,e.syncEngine),s.onUnlisten=Cc.bind(null,e.syncEngine),s}function Pa(i){return i.asyncQueue.enqueue(async()=>{const e=await Ta(i),s=await Aa(i);return e.setNetworkEnabled(!0),function(o){const a=$(o);return a.mu.delete(0),xu(a)}(s)})}function Va(i){return i.asyncQueue.enqueue(async()=>{const e=await Ta(i),s=await Aa(i);return e.setNetworkEnabled(!1),async function(o){const a=$(o);a.mu.add(0),await Nu(a),a.pu.set("Offline")}(s)})}function Sa(i,e){const s=new q;return i.asyncQueue.enqueueAndForget(async()=>async function(o,a,c){try{const d=await function(h,g){const _=$(h);return _.persistence.runTransaction("read document","readonly",ft=>_.localDocuments.getDocument(ft,g))}(o,a);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new L(B.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const h=uc(d,`Failed to get document '${a} from cache`);c.reject(h)}}(await Ea(i),e,s)),s.promise}function Da(i,e,s={}){const o=new q;return i.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,g){const _=new fa({next:_t=>{c.enqueueAndForget(()=>_c(a,ft));const $t=_t.docs.has(d);!$t&&_t.fromCache?g.reject(new L(B.UNAVAILABLE,"Failed to get document because the client is offline.")):$t&&_t.fromCache&&h&&h.source==="server"?g.reject(new L(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(_t)},error:_t=>g.reject(_t)}),ft=new yc(wn(d.path),_,{includeMetadataChanges:!0,Ou:!0});return dc(a,ft)}(await va(i),i.asyncQueue,e,s,o)),o.promise}function Ca(i,e){const s=new q;return i.asyncQueue.enqueueAndForget(async()=>async function(o,a,c){try{const d=await tu(o,a,!0),h=new bc(a,d.Yi),g=h.Hu(d.documents),_=h.applyChanges(g,!1);c.resolve(_.snapshot)}catch(d){const h=uc(d,`Failed to execute query '${a} against cache`);c.reject(h)}}(await Ea(i),e,s)),s.promise}function xa(i,e,s={}){const o=new q;return i.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,g){const _=new fa({next:_t=>{c.enqueueAndForget(()=>_c(a,ft)),_t.fromCache&&h.source==="server"?g.reject(new L(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(_t)},error:_t=>g.reject(_t)}),ft=new yc(d,_,{includeMetadataChanges:!0,Ou:!0});return dc(a,ft)}(await va(i),i.asyncQueue,e,s,o)),o.promise}function Na(i,e){const s=new fa(e);return i.asyncQueue.enqueueAndForget(async()=>function(o,a){$(o).vu.add(a),a.next()}(await va(i),s)),()=>{s.Pc(),i.asyncQueue.enqueueAndForget(async()=>function(o,a){$(o).vu.delete(a)}(await va(i),s))}}function ka(i,e,s,o){const a=function(c,d){let h;return h=typeof c=="string"?new TextEncoder().encode(c):c,function(g,_){return new da(g,_)}(function(g,_){if(g instanceof Uint8Array)return la(g,_);if(g instanceof ArrayBuffer)return la(new Uint8Array(g),_);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),d)}(s,Au(e));i.asyncQueue.enqueueAndForget(async()=>{oa(await Ra(i),a,o)})}function Oa(i,e){return i.asyncQueue.enqueue(async()=>function(s,o){const a=$(s);return a.persistence.runTransaction("Get named query","readonly",c=>a.Os.getNamedQuery(c,o))}(await Ea(i),e))}const Ma=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(i,e,s){if(!s)throw new L(B.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function $a(i,e,s,o){if(e===!0&&o===!0)throw new L(B.INVALID_ARGUMENT,`${i} and ${s} cannot be used together.`)}function Ba(i){if(!ct.isDocumentKey(i))throw new L(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function La(i){if(ct.isDocumentKey(i))throw new L(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function qa(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":O()}function Ua(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new L(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=qa(i);throw new L(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return i}function Ka(i,e){if(e<=0)throw new L(B.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e){var s;if(e.host===void 0){if(e.ssl!==void 0)throw new L(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(s=e.ssl)===null||s===void 0||s;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,$a("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,s,o,a){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=o,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ga({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new L(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ga(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new K;switch(s.type){case"gapi":const o=s.client;return new z(o,s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new L(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const s=Ma.get(e);s&&(C("ComponentProvider","Removing Datastore"),Ma.delete(e),s.terminate())}(this),Promise.resolve()}}function ja(i,e,s,o={}){var a;const c=(i=Ua(i,Qa))._getSettings();if(c.host!=="firestore.googleapis.com"&&c.host!==e&&N("Host has been set in both settings() and useEmulator(), emulator host will be used"),i._setSettings(Object.assign(Object.assign({},c),{host:`${e}:${s}`,ssl:!1})),o.mockUserToken){let d,h;if(typeof o.mockUserToken=="string")d=o.mockUserToken,h=v.MOCK_USER;else{d=createMockUserToken(o.mockUserToken,(a=i._app)===null||a===void 0?void 0:a.options.projectId);const g=o.mockUserToken.sub||o.mockUserToken.user_id;if(!g)throw new L(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new v(g)}i._authCredentials=new G(new U(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,s,o){this.converter=s,this._key=o,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ha(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new za(this.firestore,e,this._key)}}class Wa{constructor(e,s,o){this.converter=s,this._query=o,this.type="query",this.firestore=e}withConverter(e){return new Wa(this.firestore,e,this._query)}}class Ha extends Wa{constructor(e,s,o){super(e,s,wn(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new za(this.firestore,null,new ct(e))}withConverter(e){return new Ha(this.firestore,e,this._path)}}function Ja(i,e,...s){if(i=getModularInstance(i),Fa("collection","path",e),i instanceof Qa){const o=rt.fromString(e,...s);return La(o),new Ha(i,null,o)}{if(!(i instanceof za||i instanceof Ha))throw new L(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=i._path.child(rt.fromString(e,...s));return La(o),new Ha(i.firestore,null,o)}}function Ya(i,e){if(i=Ua(i,Qa),Fa("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new L(B.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Wa(i,null,function(s){return new dn(rt.emptyPath(),s)}(e))}function Za(i,e,...s){if(i=getModularInstance(i),arguments.length===1&&(e=Z.R()),Fa("doc","path",e),i instanceof Qa){const o=rt.fromString(e,...s);return Ba(o),new za(i,null,new ct(o))}{if(!(i instanceof za||i instanceof Ha))throw new L(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=i._path.child(rt.fromString(e,...s));return Ba(o),new za(i.firestore,i instanceof Ha?i.converter:null,new ct(o))}}function Xa(i,e){return i=getModularInstance(i),e=getModularInstance(e),(i instanceof za||i instanceof Ha)&&(e instanceof za||e instanceof Ha)&&i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter}function th(i,e){return i=getModularInstance(i),e=getModularInstance(e),i instanceof Wa&&e instanceof Wa&&i.firestore===e.firestore&&Rn(i._query,e._query)&&i.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(){this.qc=Promise.resolve(),this.Uc=[],this.Kc=!1,this.Gc=[],this.Qc=null,this.jc=!1,this.zc=!1,this.Wc=[],this.ko=new Ru(this,"async_queue_retry"),this.Hc=()=>{const s=Eu();s&&C("AsyncQueue","Visibility state changed to "+s.visibilityState),this.ko.Vo()};const e=Eu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Hc)}get isShuttingDown(){return this.Kc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Jc(),this.Yc(e)}enterRestrictedMode(e){if(!this.Kc){this.Kc=!0,this.zc=e||!1;const s=Eu();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this.Hc)}}enqueue(e){if(this.Jc(),this.Kc)return new Promise(()=>{});const s=new q;return this.Yc(()=>this.Kc&&this.zc?Promise.resolve():(e().then(s.resolve,s.reject),s.promise)).then(()=>s.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Uc.push(e),this.Zc()))}async Zc(){if(this.Uc.length!==0){try{await this.Uc[0](),this.Uc.shift(),this.ko.reset()}catch(e){if(!Vt(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.Uc.length>0&&this.ko.vo(()=>this.Zc())}}Yc(e){const s=this.qc.then(()=>(this.jc=!0,e().catch(o=>{this.Qc=o,this.jc=!1;const a=function(c){let d=c.message||"";return c.stack&&(d=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),d}(o);throw x("INTERNAL UNHANDLED ERROR: ",a),o}).then(o=>(this.jc=!1,o))));return this.qc=s,s}enqueueAfterDelay(e,s,o){this.Jc(),this.Wc.indexOf(e)>-1&&(s=0);const a=oc.createAndSchedule(this,e,s,o,c=>this.Xc(c));return this.Gc.push(a),a}Jc(){this.Qc&&O()}verifyOperationInProgress(){}async ta(){let e;do e=this.qc,await e;while(e!==this.qc)}ea(e){for(const s of this.Gc)if(s.timerId===e)return!0;return!1}na(e){return this.ta().then(()=>{this.Gc.sort((s,o)=>s.targetTimeMs-o.targetTimeMs);for(const s of this.Gc)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.ta()})}sa(e){this.Wc.push(e)}Xc(e){const s=this.Gc.indexOf(e);this.Gc.splice(s,1)}}function nh(i){return function(e,s){if(typeof e!="object"||e===null)return!1;const o=e;for(const a of s)if(a in o&&typeof o[a]=="function")return!0;return!1}(i,["next","error","complete"])}class sh{constructor(){this._progressObserver={},this._taskCompletionResolver=new q,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,s,o){this._progressObserver={next:e,error:s,complete:o}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,s){return this._taskCompletionResolver.promise.then(e,s)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih=-1;class rh extends Qa{constructor(e,s,o,a){super(e,s,o,a),this.type="firestore",this._queue=new eh,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ah(this),this._firestoreClient.terminate()}}function ch(i){return i._firestoreClient||ah(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function ah(i){var e;const s=i._freezeSettings(),o=function(a,c,d,h){return new Bt(a,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,s);i._firestoreClient=new ma(i._authCredentials,i._appCheckCredentials,i._queue,o)}function hh(i,e){Ih(i=Ua(i,rh));const s=ch(i),o=i._freezeSettings(),a=new ha;return fh(s,a,new ca(a,o.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function lh(i){Ih(i=Ua(i,rh));const e=ch(i),s=i._freezeSettings(),o=new ha;return fh(e,o,new aa(o,s.cacheSizeBytes))}function fh(i,e,s){const o=new q;return i.asyncQueue.enqueue(async()=>{try{await ga(i,s),await ya(i,e),o.resolve()}catch(a){const c=a;if(!function(d){return d.name==="FirebaseError"?d.code===B.FAILED_PRECONDITION||d.code===B.UNIMPLEMENTED:typeof DOMException<"u"&&d instanceof DOMException?d.code===22||d.code===20||d.code===11:!0}(c))throw c;N("Error enabling offline persistence. Falling back to persistence disabled: "+c),o.reject(c)}}).then(()=>o.promise)}function dh(i){if(i._initialized&&!i._terminated)throw new L(B.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new q;return i._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(s){if(!bt.C())return Promise.resolve();const o=s+"main";await bt.delete(o)}(qo(i._databaseId,i._persistenceKey)),e.resolve()}catch(s){e.reject(s)}}),e.promise}function _h(i){return function(e){const s=new q;return e.asyncQueue.enqueueAndForget(async()=>$c(await Ra(e),s)),s.promise}(ch(i=Ua(i,rh)))}function wh(i){return Pa(ch(i=Ua(i,rh)))}function mh(i){return Va(ch(i=Ua(i,rh)))}function yh(i,e){const s=ch(i=Ua(i,rh)),o=new sh;return ka(s,i._databaseId,e,o),o}function ph(i,e){return Oa(ch(i=Ua(i,rh)),e).then(s=>s?new Wa(i,null,s.query):null)}function Ih(i){if(i._initialized||i._terminated)throw new L(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ah(Ht.fromBase64String(e))}catch(s){throw new L(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new Ah(Ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new L(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new L(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new L(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh=/^__.*__$/;class Sh{constructor(e,s,o){this.data=e,this.fieldMask=s,this.fieldTransforms=o}toMutation(e,s){return this.fieldMask!==null?new is(e,this.data,this.fieldMask,s,this.fieldTransforms):new ss(e,this.data,s,this.fieldTransforms)}}class Dh{constructor(e,s,o){this.data=e,this.fieldMask=s,this.fieldTransforms=o}toMutation(e,s){return new is(e,this.data,this.fieldMask,s,this.fieldTransforms)}}function Ch(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O()}}class xh{constructor(e,s,o,a,c,d){this.settings=e,this.databaseId=s,this.Tt=o,this.ignoreUndefinedProperties=a,c===void 0&&this.ia(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get ra(){return this.settings.ra}oa(e){return new xh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.Tt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ua(e){var s;const o=(s=this.path)===null||s===void 0?void 0:s.child(e),a=this.oa({path:o,ca:!1});return a.aa(e),a}ha(e){var s;const o=(s=this.path)===null||s===void 0?void 0:s.child(e),a=this.oa({path:o,ca:!1});return a.ia(),a}la(e){return this.oa({path:void 0,ca:!0})}fa(e){return Zh(e,this.settings.methodName,this.settings.da||!1,this.path,this.settings._a)}contains(e){return this.fieldMask.find(s=>e.isPrefixOf(s))!==void 0||this.fieldTransforms.find(s=>e.isPrefixOf(s.field))!==void 0}ia(){if(this.path)for(let e=0;e<this.path.length;e++)this.aa(this.path.get(e))}aa(e){if(e.length===0)throw this.fa("Document fields must not be empty");if(Ch(this.ra)&&Vh.test(e))throw this.fa('Document fields cannot begin and end with "__"')}}class Nh{constructor(e,s,o){this.databaseId=e,this.ignoreUndefinedProperties=s,this.Tt=o||Au(e)}wa(e,s,o,a=!1){return new xh({ra:e,methodName:s,_a:o,path:ut.emptyPath(),ca:!1,da:a},this.databaseId,this.Tt,this.ignoreUndefinedProperties)}}function kh(i){const e=i._freezeSettings(),s=Au(i._databaseId);return new Nh(i._databaseId,!!e.ignoreUndefinedProperties,s)}function Oh(i,e,s,o,a,c={}){const d=i.wa(c.merge||c.mergeFields?2:0,e,s,a);Wh("Data must be an object, but it was:",d,o);const h=jh(o,d);let g,_;if(c.merge)g=new tn(d.fieldMask),_=d.fieldTransforms;else if(c.mergeFields){const ft=[];for(const _t of c.mergeFields){const $t=Hh(e,_t,s);if(!d.contains($t))throw new L(B.INVALID_ARGUMENT,`Field '${$t}' is specified in your field mask but missing from your input data.`);Xh(ft,$t)||ft.push($t)}g=new tn(ft),_=d.fieldTransforms.filter(_t=>g.covers(_t.field))}else g=null,_=d.fieldTransforms;return new Sh(new en(h),g,_)}class Mh extends vh{_toFieldTransform(e){if(e.ra!==2)throw e.ra===1?e.fa(`${this._methodName}() can only appear at the top level of your update data`):e.fa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mh}}function Fh(i,e,s){return new xh({ra:3,_a:e.settings._a,methodName:i._methodName,ca:s},e.databaseId,e.Tt,e.ignoreUndefinedProperties)}class $h extends vh{_toFieldTransform(e){return new jn(e.path,new $n)}isEqual(e){return e instanceof $h}}class Bh extends vh{constructor(e,s){super(e),this.ma=s}_toFieldTransform(e){const s=Fh(this,e,!0),o=this.ma.map(c=>Qh(c,s)),a=new Bn(o);return new jn(e.path,a)}isEqual(e){return this===e}}class Lh extends vh{constructor(e,s){super(e),this.ma=s}_toFieldTransform(e){const s=Fh(this,e,!0),o=this.ma.map(c=>Qh(c,s)),a=new qn(o);return new jn(e.path,a)}isEqual(e){return this===e}}class qh extends vh{constructor(e,s){super(e),this.ga=s}_toFieldTransform(e){const s=new Kn(e.Tt,Nn(e.Tt,this.ga));return new jn(e.path,s)}isEqual(e){return this===e}}function Uh(i,e,s,o){const a=i.wa(1,e,s);Wh("Data must be an object, but it was:",a,o);const c=[],d=en.empty();Ut(o,(g,_)=>{const ft=Yh(e,g,s);_=getModularInstance(_);const _t=a.ha(ft);if(_ instanceof Mh)c.push(ft);else{const $t=Qh(_,_t);$t!=null&&(c.push(ft),d.set(ft,$t))}});const h=new tn(c);return new Dh(d,h,a.fieldTransforms)}function Kh(i,e,s,o,a,c){const d=i.wa(1,e,s),h=[Hh(e,o,s)],g=[a];if(c.length%2!=0)throw new L(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let $t=0;$t<c.length;$t+=2)h.push(Hh(e,c[$t])),g.push(c[$t+1]);const _=[],ft=en.empty();for(let $t=h.length-1;$t>=0;--$t)if(!Xh(_,h[$t])){const Mt=h[$t];let Ft=g[$t];Ft=getModularInstance(Ft);const Ol=d.ha(Mt);if(Ft instanceof Mh)_.push(Mt);else{const Vl=Qh(Ft,Ol);Vl!=null&&(_.push(Mt),ft.set(Mt,Vl))}}const _t=new tn(_);return new Dh(ft,_t,d.fieldTransforms)}function Gh(i,e,s,o=!1){return Qh(s,i.wa(o?4:3,e))}function Qh(i,e){if(zh(i=getModularInstance(i)))return Wh("Unsupported field value:",e,i),jh(i,e);if(i instanceof vh)return function(s,o){if(!Ch(o.ra))throw o.fa(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.fa(`${s._methodName}() is not currently supported inside arrays`);const a=s._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.ca&&e.ra!==4)throw e.fa("Nested arrays are not supported");return function(s,o){const a=[];let c=0;for(const d of s){let h=Qh(d,o.la(c));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),c++}return{arrayValue:{values:a}}}(i,e)}return function(s,o){if((s=getModularInstance(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return Nn(o.Tt,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const a=nt.fromDate(s);return{timestampValue:Us(o.Tt,a)}}if(s instanceof nt){const a=new nt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Us(o.Tt,a)}}if(s instanceof Ph)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Ah)return{bytesValue:Ks(o.Tt,s._byteString)};if(s instanceof za){const a=o.databaseId,c=s.firestore._databaseId;if(!c.isEqual(a))throw o.fa(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:js(s.firestore._databaseId||o.databaseId,s._key.path)}}throw o.fa(`Unsupported field value: ${qa(s)}`)}(i,e)}function jh(i,e){const s={};return Kt(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ut(i,(o,a)=>{const c=Qh(a,e.ua(o));c!=null&&(s[o]=c)}),{mapValue:{fields:s}}}function zh(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof nt||i instanceof Ph||i instanceof Ah||i instanceof za||i instanceof vh)}function Wh(i,e,s){if(!zh(s)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(s)){const o=qa(s);throw o==="an object"?e.fa(i+" a custom object"):e.fa(i+" "+o)}}function Hh(i,e,s){if((e=getModularInstance(e))instanceof Rh)return e._internalPath;if(typeof e=="string")return Yh(i,e);throw Zh("Field path arguments must be of type string or ",i,!1,void 0,s)}const Jh=new RegExp("[~\\*/\\[\\]]");function Yh(i,e,s){if(e.search(Jh)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,s);try{return new Rh(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,s)}}function Zh(i,e,s,o,a){const c=o&&!o.isEmpty(),d=a!==void 0;let h=`Function ${e}() called with invalid data`;s&&(h+=" (via `toFirestore()`)"),h+=". ";let g="";return(c||d)&&(g+=" (found",c&&(g+=` in field ${o}`),d&&(g+=` in document ${a}`),g+=")"),new L(B.INVALID_ARGUMENT,h+i+g)}function Xh(i,e){return i.some(s=>s.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,s,o,a,c){this._firestore=e,this._userDataWriter=s,this._key=o,this._document=a,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new za(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new el(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const s=this._document.data.field(nl("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class el extends tl{data(){return super.data()}}function nl(i,e){return typeof e=="string"?Yh(i,e):e instanceof Rh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new L(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class il{}class rl extends il{}function ol(i,e,...s){let o=[];e instanceof il&&o.push(e),o=o.concat(s),function(a){const c=a.filter(h=>h instanceof al).length,d=a.filter(h=>h instanceof ul).length;if(c>1||c>0&&d>0)throw new L(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(o);for(const a of o)i=a._apply(i);return i}class ul extends rl{constructor(e,s,o){super(),this._field=e,this._op=s,this._value=o,this.type="where"}static _create(e,s,o){return new ul(e,s,o)}_apply(e){const s=this._parse(e);return vl(e._query,s),new Wa(e.firestore,e.converter,En(e._query,s))}_parse(e){const s=kh(e.firestore);return function(a,c,d,h,g,_,ft){let _t;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new L(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){bl(ft,_);const $t=[];for(const Mt of ft)$t.push(Rl(h,a,Mt));_t={arrayValue:{values:$t}}}else _t=Rl(h,a,ft)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||bl(ft,_),_t=Gh(d,c,ft,_==="in"||_==="not-in");return Ve.create(g,_,_t)}(e._query,"where",s,e.firestore._databaseId,this._field,this._op,this._value)}}function cl(i,e,s){const o=e,a=nl("where",i);return ul._create(a,o,s)}class al extends il{constructor(e,s){super(),this.type=e,this._queryConstraints=s}static _create(e,s){return new al(e,s)}_parse(e){const s=this._queryConstraints.map(o=>o._parse(e)).filter(o=>o.getFilters().length>0);return s.length===1?s[0]:Se.create(s,this._getOperator())}_apply(e){const s=this._parse(e);return s.getFilters().length===0?e:(function(o,a){let c=o;const d=a.getFlattenedFilters();for(const h of d)vl(c,h),c=En(c,h)}(e._query,s),new Wa(e.firestore,e.converter,En(e._query,s)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fl extends rl{constructor(e,s){super(),this._field=e,this._direction=s,this.type="orderBy"}static _create(e,s){return new fl(e,s)}_apply(e){const s=function(o,a,c){if(o.startAt!==null)throw new L(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new L(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const d=new je(a,c);return function(h,g){if(gn(h)===null){const _=yn(h);_!==null&&Pl(h,_,g.field)}}(o,d),d}(e._query,this._field,this._direction);return new Wa(e.firestore,e.converter,function(o,a){const c=o.explicitOrderBy.concat([a]);return new dn(o.path,o.collectionGroup,c,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,s))}}function dl(i,e="asc"){const s=e,o=nl("orderBy",i);return fl._create(o,s)}class _l extends rl{constructor(e,s,o){super(),this.type=e,this._limit=s,this._limitType=o}static _create(e,s,o){return new _l(e,s,o)}_apply(e){return new Wa(e.firestore,e.converter,An(e._query,this._limit,this._limitType))}}function wl(i){return Ka("limit",i),_l._create("limit",i,"F")}function ml(i){return Ka("limitToLast",i),_l._create("limitToLast",i,"L")}class gl extends rl{constructor(e,s,o){super(),this.type=e,this._docOrFields=s,this._inclusive=o}static _create(e,s,o){return new gl(e,s,o)}_apply(e){const s=Al(e,this.type,this._docOrFields,this._inclusive);return new Wa(e.firestore,e.converter,function(o,a){return new dn(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,a,o.endAt)}(e._query,s))}}function yl(...i){return gl._create("startAt",i,!0)}function pl(...i){return gl._create("startAfter",i,!1)}class Il extends rl{constructor(e,s,o){super(),this.type=e,this._docOrFields=s,this._inclusive=o}static _create(e,s,o){return new Il(e,s,o)}_apply(e){const s=Al(e,this.type,this._docOrFields,this._inclusive);return new Wa(e.firestore,e.converter,function(o,a){return new dn(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,a)}(e._query,s))}}function Tl(...i){return Il._create("endBefore",i,!1)}function El(...i){return Il._create("endAt",i,!0)}function Al(i,e,s,o){if(s[0]=getModularInstance(s[0]),s[0]instanceof tl)return function(a,c,d,h,g){if(!h)throw new L(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const _=[];for(const ft of In(a))if(ft.field.isKeyField())_.push(fe(c,h.key));else{const _t=h.data.field(ft.field);if(te(_t))throw new L(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+ft.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(_t===null){const $t=ft.field.canonicalString();throw new L(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${$t}' (used as the orderBy) does not exist.`)}_.push(_t)}return new Re(_,g)}(i._query,i.firestore._databaseId,e,s[0]._document,o);{const a=kh(i.firestore);return function(c,d,h,g,_,ft){const _t=c.explicitOrderBy;if(_.length>_t.length)throw new L(B.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const $t=[];for(let Mt=0;Mt<_.length;Mt++){const Ft=_[Mt];if(_t[Mt].field.isKeyField()){if(typeof Ft!="string")throw new L(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof Ft}`);if(!pn(c)&&Ft.indexOf("/")!==-1)throw new L(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${Ft}' contains a slash.`);const Ol=c.path.child(rt.fromString(Ft));if(!ct.isDocumentKey(Ol))throw new L(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${Ol}' is not because it contains an odd number of segments.`);const Vl=new ct(Ol);$t.push(fe(d,Vl))}else{const Ol=Gh(h,g,Ft);$t.push(Ol)}}return new Re($t,ft)}(i._query,i.firestore._databaseId,a,e,s,o)}}function Rl(i,e,s){if(typeof(s=getModularInstance(s))=="string"){if(s==="")throw new L(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pn(e)&&s.indexOf("/")!==-1)throw new L(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${s}' contains a '/' character.`);const o=e.path.child(rt.fromString(s));if(!ct.isDocumentKey(o))throw new L(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${o}' is not because it has an odd number of segments (${o.length}).`);return fe(i,new ct(o))}if(s instanceof za)return fe(i,s._key);throw new L(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qa(s)}.`)}function bl(i,e){if(!Array.isArray(i)||i.length===0)throw new L(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vl(i,e){if(e.isInequality()){const o=yn(i),a=e.field;if(o!==null&&!o.isEqual(a))throw new L(B.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${o.toString()}' and '${a.toString()}'`);const c=gn(i);c!==null&&Pl(i,a,c)}const s=function(o,a){for(const c of o)for(const d of c.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null}(i.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(s!==null)throw s===e.op?new L(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${s.toString()}' filters.`)}function Pl(i,e,s){if(!s.isEqual(e))throw new L(B.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${s.toString()}' instead.`)}class Sl{convertValue(e,s="none"){switch(re(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(Xt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 10:return this.convertObject(e.mapValue,s);default:throw O()}}convertObject(e,s){const o={};return Ut(e.fields,(a,c)=>{o[a]=this.convertValue(c,s)}),o}convertGeoPoint(e){return new Ph(Zt(e.latitude),Zt(e.longitude))}convertArray(e,s){return(e.values||[]).map(o=>this.convertValue(o,s))}convertServerTimestamp(e,s){switch(s){case"previous":const o=ee(e);return o==null?null:this.convertValue(o,s);case"estimate":return this.convertTimestamp(ne(e));default:return null}}convertTimestamp(e){const s=Yt(e);return new nt(s.seconds,s.nanos)}convertDocumentKey(e,s){const o=rt.fromString(e);M(pi(o));const a=new Lt(o.get(1),o.get(3)),c=new ct(o.popFirst(5));return a.isEqual(s)||x(`Document ${c} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(i,e,s){let o;return o=i?s&&(s.merge||s.mergeFields)?i.toFirestore(e,s):i.toFirestore(e):e,o}class Cl extends Sl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ah(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new za(this.firestore,null,s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $l extends tl{constructor(e,s,o,a,c,d){super(e,s,o,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new Bl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const o=this._document.data.field(nl("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o,s.serverTimestamps)}}}class Bl extends $l{data(e={}){return super.data(e)}}class Ll{constructor(e,s,o,a){this._firestore=e,this._userDataWriter=s,this._snapshot=a,this.metadata=new Fl(a.hasPendingWrites,a.fromCache),this.query=o}get docs(){const e=[];return this.forEach(s=>e.push(s)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach(o=>{e.call(s,new Bl(this._firestore,this._userDataWriter,o.key,o,new Fl(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new L(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map(d=>{const h=new Bl(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Fl(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(d=>a||d.type!==3).map(d=>{const h=new Bl(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Fl(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,_=-1;return d.type!==0&&(g=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),_=c.indexOf(d.doc.key)),{type:ql(d.type),doc:h,oldIndex:g,newIndex:_}})}}(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}}function ql(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O()}}function Ul(i,e){return i instanceof $l&&e instanceof $l?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(i._document===null?e._document===null:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof Ll&&e instanceof Ll&&i._firestore===e._firestore&&th(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kl(i){i=Ua(i,za);const e=Ua(i.firestore,rh);return Da(ch(e),i._key).then(s=>sf(e,i,s))}class Gl extends Sl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ah(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new za(this.firestore,null,s)}}function Ql(i){i=Ua(i,za);const e=Ua(i.firestore,rh),s=ch(e),o=new Gl(e);return Sa(s,i._key).then(a=>new $l(e,o,i._key,a,new Fl(a!==null&&a.hasLocalMutations,!0),i.converter))}function jl(i){i=Ua(i,za);const e=Ua(i.firestore,rh);return Da(ch(e),i._key,{source:"server"}).then(s=>sf(e,i,s))}function zl(i){i=Ua(i,Wa);const e=Ua(i.firestore,rh),s=ch(e),o=new Gl(e);return sl(i._query),xa(s,i._query).then(a=>new Ll(e,o,i,a))}function Wl(i){i=Ua(i,Wa);const e=Ua(i.firestore,rh),s=ch(e),o=new Gl(e);return Ca(s,i._query).then(a=>new Ll(e,o,i,a))}function Hl(i){i=Ua(i,Wa);const e=Ua(i.firestore,rh),s=ch(e),o=new Gl(e);return xa(s,i._query,{source:"server"}).then(a=>new Ll(e,o,i,a))}function Jl(i,e,s){i=Ua(i,za);const o=Ua(i.firestore,rh),a=Dl(i.converter,e,s);return nf(o,[Oh(kh(o),"setDoc",i._key,a,i.converter!==null,s).toMutation(i._key,Hn.none())])}function Yl(i,e,s,...o){i=Ua(i,za);const a=Ua(i.firestore,rh),c=kh(a);let d;return d=typeof(e=getModularInstance(e))=="string"||e instanceof Rh?Kh(c,"updateDoc",i._key,e,s,o):Uh(c,"updateDoc",i._key,e),nf(a,[d.toMutation(i._key,Hn.exists(!0))])}function Zl(i){return nf(Ua(i.firestore,rh),[new cs(i._key,Hn.none())])}function Xl(i,e){const s=Ua(i.firestore,rh),o=Za(i),a=Dl(i.converter,e);return nf(s,[Oh(kh(i.firestore),"addDoc",o._key,a,i.converter!==null,{}).toMutation(o._key,Hn.exists(!1))]).then(()=>o)}function tf(i,...e){var s,o,a;i=getModularInstance(i);let c={includeMetadataChanges:!1},d=0;typeof e[d]!="object"||nh(e[d])||(c=e[d],d++);const h={includeMetadataChanges:c.includeMetadataChanges};if(nh(e[d])){const _t=e[d];e[d]=(s=_t.next)===null||s===void 0?void 0:s.bind(_t),e[d+1]=(o=_t.error)===null||o===void 0?void 0:o.bind(_t),e[d+2]=(a=_t.complete)===null||a===void 0?void 0:a.bind(_t)}let g,_,ft;if(i instanceof za)_=Ua(i.firestore,rh),ft=wn(i._key.path),g={next:_t=>{e[d]&&e[d](sf(_,i,_t))},error:e[d+1],complete:e[d+2]};else{const _t=Ua(i,Wa);_=Ua(_t.firestore,rh),ft=_t._query;const $t=new Gl(_);g={next:Mt=>{e[d]&&e[d](new Ll(_,$t,_t,Mt))},error:e[d+1],complete:e[d+2]},sl(i._query)}return function(_t,$t,Mt,Ft){const Ol=new fa(Ft),Vl=new yc($t,Ol,Mt);return _t.asyncQueue.enqueueAndForget(async()=>dc(await va(_t),Vl)),()=>{Ol.Pc(),_t.asyncQueue.enqueueAndForget(async()=>_c(await va(_t),Vl))}}(ch(_),ft,h,g)}function ef(i,e){return Na(ch(i=Ua(i,rh)),nh(e)?e:{next:e})}function nf(i,e){return function(s,o){const a=new q;return s.asyncQueue.enqueueAndForget(async()=>xc(await Ra(s),o,a)),a.promise}(ch(i),e)}function sf(i,e,s){const o=s.docs.get(e._key),a=new Gl(i);return new $l(i,a,e._key,o,new Fl(s.hasPendingWrites,s.fromCache),e.converter)}const uf={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,s){this._firestore=e,this._commitHandler=s,this._mutations=[],this._committed=!1,this._dataReader=kh(e)}set(e,s,o){this._verifyNotCommitted();const a=af(e,this._firestore),c=Dl(a.converter,s,o),d=Oh(this._dataReader,"WriteBatch.set",a._key,c,a.converter!==null,o);return this._mutations.push(d.toMutation(a._key,Hn.none())),this}update(e,s,o,...a){this._verifyNotCommitted();const c=af(e,this._firestore);let d;return d=typeof(s=getModularInstance(s))=="string"||s instanceof Rh?Kh(this._dataReader,"WriteBatch.update",c._key,s,o,a):Uh(this._dataReader,"WriteBatch.update",c._key,s),this._mutations.push(d.toMutation(c._key,Hn.exists(!0))),this}delete(e){this._verifyNotCommitted();const s=af(e,this._firestore);return this._mutations=this._mutations.concat(new cs(s._key,Hn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function af(i,e){if((i=getModularInstance(i)).firestore!==e)throw new L(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf extends class{constructor(e,s){this._firestore=e,this._transaction=s,this._dataReader=kh(e)}get(e){const s=af(e,this._firestore),o=new Cl(this._firestore);return this._transaction.lookup([s._key]).then(a=>{if(!a||a.length!==1)return O();const c=a[0];if(c.isFoundDocument())return new tl(this._firestore,o,c.key,c,s.converter);if(c.isNoDocument())return new tl(this._firestore,o,s._key,null,s.converter);throw O()})}set(e,s,o){const a=af(e,this._firestore),c=Dl(a.converter,s,o),d=Oh(this._dataReader,"Transaction.set",a._key,c,a.converter!==null,o);return this._transaction.set(a._key,d),this}update(e,s,o,...a){const c=af(e,this._firestore);let d;return d=typeof(s=getModularInstance(s))=="string"||s instanceof Rh?Kh(this._dataReader,"Transaction.update",c._key,s,o,a):Uh(this._dataReader,"Transaction.update",c._key,s),this._transaction.update(c._key,d),this}delete(e){const s=af(e,this._firestore);return this._transaction.delete(s._key),this}}{constructor(e,s){super(e,s),this._firestore=e}get(e){const s=af(e,this._firestore),o=new Gl(this._firestore);return super.get(e).then(a=>new $l(this._firestore,o,s._key,a._document,new Fl(!1,!1),s.converter))}}function lf(i,e,s){i=Ua(i,rh);const o=Object.assign(Object.assign({},uf),s);return function(a){if(a.maxAttempts<1)throw new L(B.INVALID_ARGUMENT,"Max attempts must be at least 1")}(o),function(a,c,d){const h=new q;return a.asyncQueue.enqueueAndForget(async()=>{const g=await ba(a);new wa(a.asyncQueue,g,d,c,h).run()}),h.promise}(ch(i),a=>e(new hf(i,a)),o)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(){return new Mh("deleteField")}function df(){return new $h("serverTimestamp")}function _f(...i){return new Bh("arrayUnion",i)}function wf(...i){return new Lh("arrayRemove",i)}function mf(i){return new qh("increment",i)}(function(i,e=!0){(function(s){P=s})(SDK_VERSION$1),_registerComponent(new Component("firestore",(s,{instanceIdentifier:o,options:a})=>{const c=s.getProvider("app").getImmediate(),d=new rh(new Q(s.getProvider("auth-internal")),new H(s.getProvider("app-check-internal")),function(h,g){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lt(h.options.projectId,g)}(c,o),c);return a=Object.assign({useFetchStreams:e},a),d._setSettings(a),d},"PUBLIC").setMultipleInstances(!0)),registerVersion(b,"3.8.4",i),registerVersion(b,"3.8.4","esm2017")})();const name$4="@firebase/firestore-compat",version$4="0.3.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function validateSetOptions(i,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new L("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertUint8ArrayAvailable(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function assertBase64Available(){if(!Wt())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}let Blob$1=class Dp{constructor(e){this._delegate=e}static fromBase64String(e){return assertBase64Available(),new Dp(Ah.fromBase64String(e))}static fromUint8Array(e){return assertUint8ArrayAvailable(),new Dp(Ah.fromUint8Array(e))}toBase64(){return assertBase64Available(),this._delegate.toBase64()}toUint8Array(){return assertUint8ArrayAvailable(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isPartialObserver(i){return implementsAnyMethods(i,["next","error","complete"])}function implementsAnyMethods(i,e){if(typeof i!="object"||i===null)return!1;const s=i;for(const o of e)if(o in s&&typeof s[o]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IndexedDbPersistenceProvider{enableIndexedDbPersistence(e,s){return hh(e._delegate,{forceOwnership:s})}enableMultiTabIndexedDbPersistence(e){return lh(e._delegate)}clearIndexedDbPersistence(e){return dh(e._delegate)}}class Firestore{constructor(e,s,o){this._delegate=s,this._persistenceProvider=o,this.INTERNAL={delete:()=>this.terminate()},e instanceof Lt||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const s=this._delegate._getSettings();!e.merge&&s.host!==e.host&&N("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},s),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,s,o={}){ja(this._delegate,e,s,o)}enableNetwork(){return wh(this._delegate)}disableNetwork(){return mh(this._delegate)}enablePersistence(e){let s=!1,o=!1;return e&&(s=!!e.synchronizeTabs,o=!!e.experimentalForceOwningTab,$a("synchronizeTabs",s,"experimentalForceOwningTab",o)),s?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,o)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return _h(this._delegate)}onSnapshotsInSync(e){return ef(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new CollectionReference(this,Ja(this._delegate,e))}catch(s){throw replaceFunctionName(s,"collection()","Firestore.collection()")}}doc(e){try{return new DocumentReference(this,Za(this._delegate,e))}catch(s){throw replaceFunctionName(s,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Query$1(this,Ya(this._delegate,e))}catch(s){throw replaceFunctionName(s,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return lf(this._delegate,s=>e(new Transaction(this,s)))}batch(){return ch(this._delegate),new WriteBatch(new cf(this._delegate,e=>nf(this._delegate,e)))}loadBundle(e){return yh(this._delegate,e)}namedQuery(e){return ph(this._delegate,e).then(s=>s?new Query$1(this,s):null)}}class UserDataWriter extends Sl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Blob$1(new Ah(e))}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return DocumentReference.forKey(s,this.firestore,null)}}function setLogLevel(i){D(i)}class Transaction{constructor(e,s){this._firestore=e,this._delegate=s,this._userDataWriter=new UserDataWriter(e)}get(e){const s=castReference(e);return this._delegate.get(s).then(o=>new DocumentSnapshot(this._firestore,new $l(this._firestore._delegate,this._userDataWriter,o._key,o._document,o.metadata,s.converter)))}set(e,s,o){const a=castReference(e);return o?(validateSetOptions("Transaction.set",o),this._delegate.set(a,s,o)):this._delegate.set(a,s),this}update(e,s,o,...a){const c=castReference(e);return arguments.length===2?this._delegate.update(c,s):this._delegate.update(c,s,o,...a),this}delete(e){const s=castReference(e);return this._delegate.delete(s),this}}class WriteBatch{constructor(e){this._delegate=e}set(e,s,o){const a=castReference(e);return o?(validateSetOptions("WriteBatch.set",o),this._delegate.set(a,s,o)):this._delegate.set(a,s),this}update(e,s,o,...a){const c=castReference(e);return arguments.length===2?this._delegate.update(c,s):this._delegate.update(c,s,o,...a),this}delete(e){const s=castReference(e);return this._delegate.delete(s),this}commit(){return this._delegate.commit()}}class FirestoreDataConverter{constructor(e,s,o){this._firestore=e,this._userDataWriter=s,this._delegate=o}fromFirestore(e,s){const o=new Bl(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new QueryDocumentSnapshot(this._firestore,o),s??{})}toFirestore(e,s){return s?this._delegate.toFirestore(e,s):this._delegate.toFirestore(e)}static getInstance(e,s){const o=FirestoreDataConverter.INSTANCES;let a=o.get(e);a||(a=new WeakMap,o.set(e,a));let c=a.get(s);return c||(c=new FirestoreDataConverter(e,new UserDataWriter(e),s),a.set(s,c)),c}}FirestoreDataConverter.INSTANCES=new WeakMap;class DocumentReference{constructor(e,s){this.firestore=e,this._delegate=s,this._userDataWriter=new UserDataWriter(e)}static forPath(e,s,o){if(e.length%2!==0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new DocumentReference(s,new za(s._delegate,o,new ct(e)))}static forKey(e,s,o){return new DocumentReference(s,new za(s._delegate,o,e))}get id(){return this._delegate.id}get parent(){return new CollectionReference(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new CollectionReference(this.firestore,Ja(this._delegate,e))}catch(s){throw replaceFunctionName(s,"collection()","DocumentReference.collection()")}}isEqual(e){return e=getModularInstance(e),e instanceof za?Xa(this._delegate,e):!1}set(e,s){s=validateSetOptions("DocumentReference.set",s);try{return s?Jl(this._delegate,e,s):Jl(this._delegate,e)}catch(o){throw replaceFunctionName(o,"setDoc()","DocumentReference.set()")}}update(e,s,...o){try{return arguments.length===1?Yl(this._delegate,e):Yl(this._delegate,e,s,...o)}catch(a){throw replaceFunctionName(a,"updateDoc()","DocumentReference.update()")}}delete(){return Zl(this._delegate)}onSnapshot(...e){const s=extractSnapshotOptions(e),o=wrapObserver(e,a=>new DocumentSnapshot(this.firestore,new $l(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return tf(this._delegate,s,o)}get(e){let s;return(e==null?void 0:e.source)==="cache"?s=Ql(this._delegate):(e==null?void 0:e.source)==="server"?s=jl(this._delegate):s=Kl(this._delegate),s.then(o=>new DocumentSnapshot(this.firestore,new $l(this.firestore._delegate,this._userDataWriter,o._key,o._document,o.metadata,this._delegate.converter)))}withConverter(e){return new DocumentReference(this.firestore,e?this._delegate.withConverter(FirestoreDataConverter.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function replaceFunctionName(i,e,s){return i.message=i.message.replace(e,s),i}function extractSnapshotOptions(i){for(const e of i)if(typeof e=="object"&&!isPartialObserver(e))return e;return{}}function wrapObserver(i,e){var s,o;let a;return isPartialObserver(i[0])?a=i[0]:isPartialObserver(i[1])?a=i[1]:typeof i[0]=="function"?a={next:i[0],error:i[1],complete:i[2]}:a={next:i[1],error:i[2],complete:i[3]},{next:c=>{a.next&&a.next(e(c))},error:(s=a.error)===null||s===void 0?void 0:s.bind(a),complete:(o=a.complete)===null||o===void 0?void 0:o.bind(a)}}class DocumentSnapshot{constructor(e,s){this._firestore=e,this._delegate=s}get ref(){return new DocumentReference(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,s){return this._delegate.get(e,s)}isEqual(e){return Ul(this._delegate,e._delegate)}}class QueryDocumentSnapshot extends DocumentSnapshot{data(e){const s=this._delegate.data(e);return F(s!==void 0),s}}let Query$1=class Cp{constructor(e,s){this.firestore=e,this._delegate=s,this._userDataWriter=new UserDataWriter(e)}where(e,s,o){try{return new Cp(this.firestore,ol(this._delegate,cl(e,s,o)))}catch(a){throw replaceFunctionName(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,s){try{return new Cp(this.firestore,ol(this._delegate,dl(e,s)))}catch(o){throw replaceFunctionName(o,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Cp(this.firestore,ol(this._delegate,wl(e)))}catch(s){throw replaceFunctionName(s,"limit()","Query.limit()")}}limitToLast(e){try{return new Cp(this.firestore,ol(this._delegate,ml(e)))}catch(s){throw replaceFunctionName(s,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Cp(this.firestore,ol(this._delegate,yl(...e)))}catch(s){throw replaceFunctionName(s,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Cp(this.firestore,ol(this._delegate,pl(...e)))}catch(s){throw replaceFunctionName(s,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Cp(this.firestore,ol(this._delegate,Tl(...e)))}catch(s){throw replaceFunctionName(s,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Cp(this.firestore,ol(this._delegate,El(...e)))}catch(s){throw replaceFunctionName(s,"endAt()","Query.endAt()")}}isEqual(e){return th(this._delegate,e._delegate)}get(e){let s;return(e==null?void 0:e.source)==="cache"?s=Wl(this._delegate):(e==null?void 0:e.source)==="server"?s=Hl(this._delegate):s=zl(this._delegate),s.then(o=>new QuerySnapshot(this.firestore,new Ll(this.firestore._delegate,this._userDataWriter,this._delegate,o._snapshot)))}onSnapshot(...e){const s=extractSnapshotOptions(e),o=wrapObserver(e,a=>new QuerySnapshot(this.firestore,new Ll(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return tf(this._delegate,s,o)}withConverter(e){return new Cp(this.firestore,e?this._delegate.withConverter(FirestoreDataConverter.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class DocumentChange{constructor(e,s){this._firestore=e,this._delegate=s}get type(){return this._delegate.type}get doc(){return new QueryDocumentSnapshot(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class QuerySnapshot{constructor(e,s){this._firestore=e,this._delegate=s}get query(){return new Query$1(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new QueryDocumentSnapshot(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(s=>new DocumentChange(this._firestore,s))}forEach(e,s){this._delegate.forEach(o=>{e.call(s,new QueryDocumentSnapshot(this._firestore,o))})}isEqual(e){return Ul(this._delegate,e._delegate)}}class CollectionReference extends Query$1{constructor(e,s){super(e,s),this.firestore=e,this._delegate=s}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new DocumentReference(this.firestore,e):null}doc(e){try{return e===void 0?new DocumentReference(this.firestore,Za(this._delegate)):new DocumentReference(this.firestore,Za(this._delegate,e))}catch(s){throw replaceFunctionName(s,"doc()","CollectionReference.doc()")}}add(e){return Xl(this._delegate,e).then(s=>new DocumentReference(this.firestore,s))}isEqual(e){return Xa(this._delegate,e._delegate)}withConverter(e){return new CollectionReference(this.firestore,e?this._delegate.withConverter(FirestoreDataConverter.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function castReference(i){return Ua(i,za)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...e){this._delegate=new Rh(...e)}static documentId(){return new FieldPath(ut.keyField().canonicalString())}isEqual(e){return e=getModularInstance(e),e instanceof Rh?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor(e){this._delegate=e}static serverTimestamp(){const e=df();return e._methodName="FieldValue.serverTimestamp",new FieldValue(e)}static delete(){const e=ff();return e._methodName="FieldValue.delete",new FieldValue(e)}static arrayUnion(...e){const s=_f(...e);return s._methodName="FieldValue.arrayUnion",new FieldValue(s)}static arrayRemove(...e){const s=wf(...e);return s._methodName="FieldValue.arrayRemove",new FieldValue(s)}static increment(e){const s=mf(e);return s._methodName="FieldValue.increment",new FieldValue(s)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const firestoreNamespace={Firestore,GeoPoint:Ph,Timestamp:nt,Blob:Blob$1,Transaction,WriteBatch,DocumentReference,DocumentSnapshot,Query:Query$1,QueryDocumentSnapshot,QuerySnapshot,CollectionReference,FieldPath,FieldValue,setLogLevel,CACHE_SIZE_UNLIMITED:ih};function configureForFirebase(i,e){i.INTERNAL.registerComponent(new Component("firestore-compat",s=>{const o=s.getProvider("app-compat").getImmediate(),a=s.getProvider("firestore").getImmediate();return e(o,a)},"PUBLIC").setServiceProps(Object.assign({},firestoreNamespace)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerFirestore(i){configureForFirebase(i,(e,s)=>new Firestore(e,s,new IndexedDbPersistenceProvider)),i.registerVersion(name$4,version$4)}registerFirestore(firebase);const name$3="@firebase/database",version$3="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SDK_VERSION="";function setSDKVersion(i){SDK_VERSION=i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DOMStorageWrapper{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,s){s==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),stringify(s))}get(e){const s=this.domStorage_.getItem(this.prefixedName_(e));return s==null?null:jsonEval(s)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MemoryStorage{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,s){s==null?delete this.cache_[e]:this.cache_[e]=s}get(e){return contains(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const createStoragefor=function(i){try{if(typeof window<"u"&&typeof window[i]<"u"){const e=window[i];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new DOMStorageWrapper(e)}}catch{}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$1=new Logger("@firebase/database"),LUIDGenerator=function(){let i=1;return function(){return i++}}(),sha1=function(i){const e=stringToByteArray(i),s=new Sha1;s.update(e);const o=s.digest();return base64.encodeByteArray(o)},buildLogMessage_=function(...i){let e="";for(let s=0;s<i.length;s++){const o=i[s];Array.isArray(o)||o&&typeof o=="object"&&typeof o.length=="number"?e+=buildLogMessage_.apply(null,o):typeof o=="object"?e+=stringify(o):e+=o,e+=" "}return e};let logger=null,firstLog_=!0;const enableLogging$1=function(i,e){assert(!e||i===!0||i===!1,"Can't turn on custom loggers persistently."),i===!0?(logClient$1.logLevel=LogLevel.VERBOSE,logger=logClient$1.log.bind(logClient$1),e&&SessionStorage.set("logging_enabled",!0)):typeof i=="function"?logger=i:(logger=null,SessionStorage.remove("logging_enabled"))},log=function(...i){if(firstLog_===!0&&(firstLog_=!1,logger===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging$1(!0)),logger){const e=buildLogMessage_.apply(null,i);logger(e)}},logWrapper=function(i){return function(...e){log(i,...e)}},error=function(...i){const e="FIREBASE INTERNAL ERROR: "+buildLogMessage_(...i);logClient$1.error(e)},fatal=function(...i){const e=`FIREBASE FATAL ERROR: ${buildLogMessage_(...i)}`;throw logClient$1.error(e),new Error(e)},warn$1=function(...i){const e="FIREBASE WARNING: "+buildLogMessage_(...i);logClient$1.warn(e)},warnIfPageIsSecure=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn$1("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(i){return typeof i=="number"&&(i!==i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(i){if(document.readyState==="complete")i();else{let e=!1;const s=function(){if(!document.body){setTimeout(s,Math.floor(10));return}e||(e=!0,i())};document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("load",s,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&s()}),window.attachEvent("onload",s))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(i,e){if(i===e)return 0;if(i===MIN_NAME||e===MAX_NAME)return-1;if(e===MIN_NAME||i===MAX_NAME)return 1;{const s=tryParseInt(i),o=tryParseInt(e);return s!==null?o!==null?s-o===0?i.length-e.length:s-o:-1:o!==null?1:i<e?-1:1}},stringCompare=function(i,e){return i===e?0:i<e?-1:1},requireKey=function(i,e){if(e&&i in e)return e[i];throw new Error("Missing required key ("+i+") in object: "+stringify(e))},ObjectToUniqueKey=function(i){if(typeof i!="object"||i===null)return stringify(i);const e=[];for(const o in i)e.push(o);e.sort();let s="{";for(let o=0;o<e.length;o++)o!==0&&(s+=","),s+=stringify(e[o]),s+=":",s+=ObjectToUniqueKey(i[e[o]]);return s+="}",s},splitStringBySize=function(i,e){const s=i.length;if(s<=e)return[i];const o=[];for(let a=0;a<s;a+=e)a+e>s?o.push(i.substring(a,s)):o.push(i.substring(a,a+e));return o};function each(i,e){for(const s in i)i.hasOwnProperty(s)&&e(s,i[s])}const doubleToIEEE754String=function(i){assert(!isInvalidJSONNumber(i),"Invalid JSON number");const e=11,s=52,o=(1<<e-1)-1;let a,c,d,h,g;i===0?(c=0,d=0,a=1/i===-1/0?1:0):(a=i<0,i=Math.abs(i),i>=Math.pow(2,1-o)?(h=Math.min(Math.floor(Math.log(i)/Math.LN2),o),c=h+o,d=Math.round(i*Math.pow(2,s-h)-Math.pow(2,s))):(c=0,d=Math.round(i/Math.pow(2,1-o-s))));const _=[];for(g=s;g;g-=1)_.push(d%2?1:0),d=Math.floor(d/2);for(g=e;g;g-=1)_.push(c%2?1:0),c=Math.floor(c/2);_.push(a?1:0),_.reverse();const ft=_.join("");let _t="";for(g=0;g<64;g+=8){let $t=parseInt(ft.substr(g,8),2).toString(16);$t.length===1&&($t="0"+$t),_t=_t+$t}return _t.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function errorForServerCode(i,e){let s="Unknown Error";i==="too_big"?s="The data requested exceeds the maximum size that can be accessed with a single request.":i==="permission_denied"?s="Client doesn't have permission to access the desired data.":i==="unavailable"&&(s="The service is unavailable");const o=new Error(i+" at "+e._path.toString()+": "+s);return o.code=i.toUpperCase(),o}const INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),INTEGER_32_MIN=-2147483648,INTEGER_32_MAX=2147483647,tryParseInt=function(i){if(INTEGER_REGEXP_.test(i)){const e=Number(i);if(e>=INTEGER_32_MIN&&e<=INTEGER_32_MAX)return e}return null},exceptionGuard=function(i){try{i()}catch(e){setTimeout(()=>{const s=e.stack||"";throw warn$1("Exception was thrown by user callback.",s),e},Math.floor(0))}},beingCrawled=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(i,e){const s=setTimeout(i,e);return typeof s=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(s):typeof s=="object"&&s.unref&&s.unref(),s};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AppCheckTokenProvider{constructor(e,s){this.appName_=e,this.appCheckProvider=s,this.appCheck=s==null?void 0:s.getImmediate({optional:!0}),this.appCheck||s==null||s.get().then(o=>this.appCheck=o)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((s,o)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(s,o):s(null)},0)})}addTokenChangeListener(e){var s;(s=this.appCheckProvider)===null||s===void 0||s.get().then(o=>o.addTokenListener(e))}notifyForInvalidToken(){warn$1(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAuthTokenProvider{constructor(e,s,o){this.appName_=e,this.firebaseOptions_=s,this.authProvider_=o,this.auth_=null,this.auth_=o.getImmediate({optional:!0}),this.auth_||o.onInit(a=>this.auth_=a)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(s=>s&&s.code==="auth/token-not-initialized"?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(s)):new Promise((s,o)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(s,o):s(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(s=>s.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(s=>s.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn$1(e)}}class EmulatorTokenProvider{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}EmulatorTokenProvider.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN_RE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LAST_SESSION_PARAM="ls",APPLICATION_ID_PARAM="p",APP_CHECK_TOKEN_PARAM="ac",WEBSOCKET="websocket",LONG_POLLING="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RepoInfo{constructor(e,s,o,a,c=!1,d="",h=!1,g=!1){this.secure=s,this.namespace=o,this.webSocketOnly=a,this.nodeAdmin=c,this.persistenceKey=d,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=g,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&PersistentStorage.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",s=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${s}`}}function repoInfoNeedsQueryParam(i){return i.host!==i.internalHost||i.isCustomHost()||i.includeNamespaceInQueryParams}function repoInfoConnectionURL(i,e,s){assert(typeof e=="string","typeof type must == string"),assert(typeof s=="object","typeof params must == object");let o;if(e===WEBSOCKET)o=(i.secure?"wss://":"ws://")+i.internalHost+"/.ws?";else if(e===LONG_POLLING)o=(i.secure?"https://":"http://")+i.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);repoInfoNeedsQueryParam(i)&&(s.ns=i.namespace);const a=[];return each(s,(c,d)=>{a.push(c+"="+d)}),o+a.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsCollection{constructor(){this.counters_={}}incrementCounter(e,s=1){contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=s}get(){return deepCopy(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const collections={},reporters={};function statsManagerGetCollection(i){const e=i.toString();return collections[e]||(collections[e]=new StatsCollection),collections[e]}function statsManagerGetOrCreateReporter(i,e){const s=i.toString();return reporters[s]||(reporters[s]=e()),reporters[s]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PacketReceiver{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,s){this.closeAfterResponse=e,this.onClose=s,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,s){for(this.pendingResponses[e]=s;this.pendingResponses[this.currentResponseNum];){const o=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let a=0;a<o.length;++a)o[a]&&exceptionGuard(()=>{this.onMessage_(o[a])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4;class BrowserPollConnection{constructor(e,s,o,a,c,d,h){this.connId=e,this.repoInfo=s,this.applicationId=o,this.appCheckToken=a,this.authToken=c,this.transportSessionId=d,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(e),this.stats_=statsManagerGetCollection(s),this.urlFn=g=>(this.appCheckToken&&(g[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),repoInfoConnectionURL(s,LONG_POLLING,g))}open(e,s){this.curSegmentNum=0,this.onDisconnect_=s,this.myPacketOrderer=new PacketReceiver(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(()=>{if(this.isClosed_)return;this.scriptTagHolder=new FirebaseIFrameScriptHolder((...c)=>{const[d,h,g,_,ft]=c;if(this.incrementIncomingBytes_(c),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,d===FIREBASE_LONGPOLL_START_PARAM)this.id=h,this.password=g;else if(d===FIREBASE_LONGPOLL_CLOSE_COMMAND)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+d)},(...c)=>{const[d,h]=c;this.incrementIncomingBytes_(c),this.myPacketOrderer.handleResponse(d,h)},()=>{this.onClosed_()},this.urlFn);const o={};o[FIREBASE_LONGPOLL_START_PARAM]="t",o[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(o[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=this.scriptTagHolder.uniqueCallbackIdentifier),o[VERSION_PARAM]=PROTOCOL_VERSION,this.transportSessionId&&(o[TRANSPORT_SESSION_PARAM]=this.transportSessionId),this.lastSessionId&&(o[LAST_SESSION_PARAM]=this.lastSessionId),this.applicationId&&(o[APPLICATION_ID_PARAM]=this.applicationId),this.appCheckToken&&(o[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(o[REFERER_PARAM]=FORGE_REF);const a=this.urlFn(o);this.log_("Connecting via long-poll to "+a),this.scriptTagHolder.addTag(a,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){BrowserPollConnection.forceAllow_=!0}static forceDisallow(){BrowserPollConnection.forceDisallow_=!0}static isAvailable(){return BrowserPollConnection.forceAllow_?!0:!BrowserPollConnection.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const s=stringify(e);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);const o=base64Encode(s),a=splitStringBySize(o,MAX_PAYLOAD_SIZE);for(let c=0;c<a.length;c++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,a.length,a[c]),this.curSegmentNum++}addDisconnectPingFrame(e,s){this.myDisconnFrame=document.createElement("iframe");const o={};o[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",o[FIREBASE_LONGPOLL_ID_PARAM]=e,o[FIREBASE_LONGPOLL_PW_PARAM]=s,this.myDisconnFrame.src=this.urlFn(o),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const s=stringify(e).length;this.bytesReceived+=s,this.stats_.incrementCounter("bytes_received",s)}}class FirebaseIFrameScriptHolder{constructor(e,s,o,a){this.onDisconnect=o,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=e,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=s,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();let c="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(c='<script>document.domain="'+document.domain+'";<\/script>');const d="<html><body>"+c+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(d),this.myIFrame.doc.close()}catch(h){log("frame writing exception"),h.stack&&log(h.stack),log(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||log("No IE domain setting required")}catch{const o=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+o+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,s){for(this.myID=e,this.myPW=s,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,e[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,e[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;let s=this.urlFn(e),o="",a=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+o.length<=MAX_URL_DATA_SIZE;){const d=this.pendingSegs.shift();o=o+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+a+"="+d.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+a+"="+d.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+a+"="+d.d,a++}return s=s+o,this.addLongPollTag_(s,this.currentSerial),!0}else return!1}enqueueSegment(e,s,o){this.pendingSegs.push({seg:e,ts:s,d:o}),this.alive&&this.newRequest_()}addLongPollTag_(e,s){this.outstandingRequests.add(s);const o=()=>{this.outstandingRequests.delete(s),this.newRequest_()},a=setTimeout(o,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),c=()=>{clearTimeout(a),o()};this.addTag(e,c)}addTag(e,s){setTimeout(()=>{try{if(!this.sendNewPolls)return;const o=this.myIFrame.doc.createElement("script");o.type="text/javascript",o.async=!0,o.src=e,o.onload=o.onreadystatechange=function(){const a=o.readyState;(!a||a==="loaded"||a==="complete")&&(o.onload=o.onreadystatechange=null,o.parentNode&&o.parentNode.removeChild(o),s())},o.onerror=()=>{log("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(o)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3;let WebSocketImpl=null;typeof MozWebSocket<"u"?WebSocketImpl=MozWebSocket:typeof WebSocket<"u"&&(WebSocketImpl=WebSocket);class WebSocketConnection{constructor(e,s,o,a,c,d,h){this.connId=e,this.applicationId=o,this.appCheckToken=a,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(s),this.connURL=WebSocketConnection.connectionURL_(s,d,h,a,o),this.nodeAdmin=s.nodeAdmin}static connectionURL_(e,s,o,a,c){const d={};return d[VERSION_PARAM]=PROTOCOL_VERSION,typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(d[REFERER_PARAM]=FORGE_REF),s&&(d[TRANSPORT_SESSION_PARAM]=s),o&&(d[LAST_SESSION_PARAM]=o),a&&(d[APP_CHECK_TOKEN_PARAM]=a),c&&(d[APPLICATION_ID_PARAM]=c),repoInfoConnectionURL(e,WEBSOCKET,d)}open(e,s){this.onDisconnect=s,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{let o;isNodeSdk(),this.mySock=new WebSocketImpl(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const a=o.message||o.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const a=o.message||o.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){WebSocketConnection.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const s=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(s);o&&o.length>1&&parseFloat(o[1])<4.4&&(e=!0)}return!e&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_}static previouslyFailed(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0}markConnectionHealthy(){PersistentStorage.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const s=this.frames.join("");this.frames=null;const o=jsonEval(s);this.onMessage(o)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(assert(this.frames===null,"We already have a frame buffer"),e.length<=6){const s=Number(e);if(!isNaN(s))return this.handleNewFrameCount_(s),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const s=e.data;if(this.bytesReceived+=s.length,this.stats_.incrementCounter("bytes_received",s.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(s);else{const o=this.extractFrameCount_(s);o!==null&&this.appendFrame_(o)}}send(e){this.resetKeepAlive();const s=stringify(e);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);const o=splitStringBySize(s,WEBSOCKET_MAX_FRAME_SIZE);o.length>1&&this.sendString_(String(o.length));for(let a=0;a<o.length;a++)this.sendString_(o[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))}sendString_(e){try{this.mySock.send(e)}catch(s){this.log_("Exception thrown from WebSocket.send():",s.message||s.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}WebSocketConnection.responsesRequiredToBeHealthy=2;WebSocketConnection.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransportManager{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[BrowserPollConnection,WebSocketConnection]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const s=WebSocketConnection&&WebSocketConnection.isAvailable();let o=s&&!WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(s||warn$1("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[WebSocketConnection];else{const a=this.transports_=[];for(const c of TransportManager.ALL_TRANSPORTS)c&&c.isAvailable()&&a.push(c);TransportManager.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}TransportManager.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h";class Connection{constructor(e,s,o,a,c,d,h,g,_,ft){this.id=e,this.repoInfo_=s,this.applicationId_=o,this.appCheckToken_=a,this.authToken_=c,this.onMessage_=d,this.onReady_=h,this.onDisconnect_=g,this.onKill_=_,this.lastSessionId=ft,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(s),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const s=this.connReceiver_(this.conn_),o=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(s,o)},Math.floor(0));const a=e.healthyTimeout||0;a>0&&(this.healthyTimeout_=setTimeoutNonBlocking(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(a)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return s=>{e===this.conn_?this.onConnectionLost_(s):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return s=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(s):e===this.secondaryConn_?this.onSecondaryMessageReceived_(s):this.log_("message on old connection"))}}sendRequest(e){const s={t:"d",d:e};this.sendData_(s)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(MESSAGE_TYPE in e){const s=e[MESSAGE_TYPE];s===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():s===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):s===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const s=requireKey("t",e),o=requireKey("d",e);if(s==="c")this.onSecondaryControl_(o);else if(s==="d")this.pendingDataMessages.push(o);else throw new Error("Unknown protocol layer: "+s)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const s=requireKey("t",e),o=requireKey("d",e);s==="c"?this.onControl_(o):s==="d"&&this.onDataMessage_(o)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const s=requireKey(MESSAGE_TYPE,e);if(MESSAGE_DATA in e){const o=e[MESSAGE_DATA];if(s===SERVER_HELLO){const a=Object.assign({},o);this.repoInfo_.isUsingEmulator&&(a.h=this.repoInfo_.host),this.onHandshake_(a)}else if(s===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else s===CONTROL_SHUTDOWN?this.onConnectionShutdown_(o):s===CONTROL_RESET?this.onReset_(o):s===CONTROL_ERROR?error("Server Error: "+o):s===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error("Unknown control packet command: "+s)}}onHandshake_(e){const s=e.ts,o=e.v,a=e.h;this.sessionId=e.s,this.repoInfo_.host=a,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,s),PROTOCOL_VERSION!==o&&warn$1("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const s=this.connReceiver_(this.secondaryConn_),o=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(s,o),setTimeoutNonBlocking(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,s){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(s,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ServerActions{put(e,s,o,a){}merge(e,s,o,a){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,s,o){}onDisconnectMerge(e,s,o){}onDisconnectCancel(e,s){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventEmitter{constructor(e){this.allowedEvents_=e,this.listeners_={},assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...s){if(Array.isArray(this.listeners_[e])){const o=[...this.listeners_[e]];for(let a=0;a<o.length;a++)o[a].callback.apply(o[a].context,s)}}on(e,s,o){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:s,context:o});const a=this.getInitialEvent(e);a&&s.apply(o,a)}off(e,s,o){this.validateEventType_(e);const a=this.listeners_[e]||[];for(let c=0;c<a.length;c++)if(a[c].callback===s&&(!o||o===a[c].context)){a.splice(c,1);return}}validateEventType_(e){assert(this.allowedEvents_.find(s=>s===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnlineMonitor extends EventEmitter{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!isMobileCordova()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new OnlineMonitor}getInitialEvent(e){return assert(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_PATH_DEPTH=32,MAX_PATH_LENGTH_BYTES=768;class Path{constructor(e,s){if(s===void 0){this.pieces_=e.split("/");let o=0;for(let a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[o]=this.pieces_[a],o++);this.pieces_.length=o,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=s}toString(){let e="";for(let s=this.pieceNum_;s<this.pieces_.length;s++)this.pieces_[s]!==""&&(e+="/"+this.pieces_[s]);return e||"/"}}function newEmptyPath(){return new Path("")}function pathGetFront(i){return i.pieceNum_>=i.pieces_.length?null:i.pieces_[i.pieceNum_]}function pathGetLength(i){return i.pieces_.length-i.pieceNum_}function pathPopFront(i){let e=i.pieceNum_;return e<i.pieces_.length&&e++,new Path(i.pieces_,e)}function pathGetBack(i){return i.pieceNum_<i.pieces_.length?i.pieces_[i.pieces_.length-1]:null}function pathToUrlEncodedString(i){let e="";for(let s=i.pieceNum_;s<i.pieces_.length;s++)i.pieces_[s]!==""&&(e+="/"+encodeURIComponent(String(i.pieces_[s])));return e||"/"}function pathSlice(i,e=0){return i.pieces_.slice(i.pieceNum_+e)}function pathParent(i){if(i.pieceNum_>=i.pieces_.length)return null;const e=[];for(let s=i.pieceNum_;s<i.pieces_.length-1;s++)e.push(i.pieces_[s]);return new Path(e,0)}function pathChild(i,e){const s=[];for(let o=i.pieceNum_;o<i.pieces_.length;o++)s.push(i.pieces_[o]);if(e instanceof Path)for(let o=e.pieceNum_;o<e.pieces_.length;o++)s.push(e.pieces_[o]);else{const o=e.split("/");for(let a=0;a<o.length;a++)o[a].length>0&&s.push(o[a])}return new Path(s,0)}function pathIsEmpty(i){return i.pieceNum_>=i.pieces_.length}function newRelativePath(i,e){const s=pathGetFront(i),o=pathGetFront(e);if(s===null)return e;if(s===o)return newRelativePath(pathPopFront(i),pathPopFront(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+i+")")}function pathCompare(i,e){const s=pathSlice(i,0),o=pathSlice(e,0);for(let a=0;a<s.length&&a<o.length;a++){const c=nameCompare(s[a],o[a]);if(c!==0)return c}return s.length===o.length?0:s.length<o.length?-1:1}function pathEquals(i,e){if(pathGetLength(i)!==pathGetLength(e))return!1;for(let s=i.pieceNum_,o=e.pieceNum_;s<=i.pieces_.length;s++,o++)if(i.pieces_[s]!==e.pieces_[o])return!1;return!0}function pathContains(i,e){let s=i.pieceNum_,o=e.pieceNum_;if(pathGetLength(i)>pathGetLength(e))return!1;for(;s<i.pieces_.length;){if(i.pieces_[s]!==e.pieces_[o])return!1;++s,++o}return!0}class ValidationPath{constructor(e,s){this.errorPrefix_=s,this.parts_=pathSlice(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let o=0;o<this.parts_.length;o++)this.byteLength_+=stringLength(this.parts_[o]);validationPathCheckValid(this)}}function validationPathPush(i,e){i.parts_.length>0&&(i.byteLength_+=1),i.parts_.push(e),i.byteLength_+=stringLength(e),validationPathCheckValid(i)}function validationPathPop(i){const e=i.parts_.pop();i.byteLength_-=stringLength(e),i.parts_.length>0&&(i.byteLength_-=1)}function validationPathCheckValid(i){if(i.byteLength_>MAX_PATH_LENGTH_BYTES)throw new Error(i.errorPrefix_+"has a key path longer than "+MAX_PATH_LENGTH_BYTES+" bytes ("+i.byteLength_+").");if(i.parts_.length>MAX_PATH_DEPTH)throw new Error(i.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+MAX_PATH_DEPTH+") or object contains a cycle "+validationPathToErrorString(i))}function validationPathToErrorString(i){return i.parts_.length===0?"":"in property '"+i.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VisibilityMonitor extends EventEmitter{constructor(){super(["visible"]);let e,s;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(s="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(s="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(s="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(s="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,s&&document.addEventListener(s,()=>{const o=!document[e];o!==this.visible_&&(this.visible_=o,this.trigger("visible",o))},!1)}static getInstance(){return new VisibilityMonitor}getInitialEvent(e){return assert(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_TOKEN_THRESHOLD=3;class PersistentConnection extends ServerActions{constructor(e,s,o,a,c,d,h,g){if(super(),this.repoInfo_=e,this.applicationId_=s,this.onDataUpdate_=o,this.onConnectStatus_=a,this.onServerInfoUpdate_=c,this.authTokenProvider_=d,this.appCheckTokenProvider_=h,this.authOverride_=g,this.id=PersistentConnection.nextPersistentConnectionId_++,this.log_=logWrapper("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RECONNECT_MIN_DELAY,this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,g&&!isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VisibilityMonitor.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",this.onOnline_,this)}sendRequest(e,s,o){const a=++this.requestNumber_,c={r:a,a:e,b:s};this.log_(stringify(c)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),o&&(this.requestCBHash_[a]=o)}get(e){this.initConnection_();const s=new Deferred,a={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:d=>{const h=d.d;d.s==="ok"?s.resolve(h):s.reject(h)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;const c=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(c),s.promise}listen(e,s,o,a){this.initConnection_();const c=e._queryIdentifier,d=e._path.toString();this.log_("Listen called for "+d+" "+c),this.listens.has(d)||this.listens.set(d,new Map),assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens.get(d).has(c),"listen() called twice for same path/queryId.");const h={onComplete:a,hashFn:s,query:e,tag:o};this.listens.get(d).set(c,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const s=this.outstandingGets_[e];this.sendRequest("g",s.request,o=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),s.onComplete&&s.onComplete(o)})}sendListen_(e){const s=e.query,o=s._path.toString(),a=s._queryIdentifier;this.log_("Listen on "+o+" for "+a);const c={p:o},d="q";e.tag&&(c.q=s._queryObject,c.t=e.tag),c.h=e.hashFn(),this.sendRequest(d,c,h=>{const g=h.d,_=h.s;PersistentConnection.warnOnListenWarnings_(g,s),(this.listens.get(o)&&this.listens.get(o).get(a))===e&&(this.log_("listen response",h),_!=="ok"&&this.removeListen_(o,a),e.onComplete&&e.onComplete(_,g))})}static warnOnListenWarnings_(e,s){if(e&&typeof e=="object"&&contains(e,"w")){const o=safeGet(e,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const a='".indexOn": "'+s._queryParams.getIndex().toString()+'"',c=s._path.toString();warn$1(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,s=isValidFormat(e)?"auth":"gauth",o={cred:e};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(s,o,a=>{const c=a.s,d=a.d||"error";this.authToken_===e&&(c==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,d))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const s=e.s,o=e.d||"error";s==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(s,o)})}unlisten(e,s){const o=e._path.toString(),a=e._queryIdentifier;this.log_("Unlisten called for "+o+" "+a),assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,a)&&this.connected_&&this.sendUnlisten_(o,a,e._queryObject,s)}sendUnlisten_(e,s,o,a){this.log_("Unlisten on "+e+" for "+s);const c={p:e},d="n";a&&(c.q=o,c.t=a),this.sendRequest(d,c)}onDisconnectPut(e,s,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,s,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:s,onComplete:o})}onDisconnectMerge(e,s,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,s,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:s,onComplete:o})}onDisconnectCancel(e,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:s})}sendOnDisconnect_(e,s,o,a){const c={p:s,d:o};this.log_("onDisconnect "+e,c),this.sendRequest(e,c,d=>{a&&setTimeout(()=>{a(d.s,d.d)},Math.floor(0))})}put(e,s,o,a){this.putInternal("p",e,s,o,a)}merge(e,s,o,a){this.putInternal("m",e,s,o,a)}putInternal(e,s,o,a,c){this.initConnection_();const d={p:s,d:o};c!==void 0&&(d.h=c),this.outstandingPuts_.push({action:e,request:d,onComplete:a}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+s)}sendPut_(e){const s=this.outstandingPuts_[e].action,o=this.outstandingPuts_[e].request,a=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(s,o,c=>{this.log_(s+" response",c),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(c.s,c.d)})}reportStats(e){if(this.connected_){const s={c:e};this.log_("reportStats",s),this.sendRequest("s",s,o=>{if(o.s!=="ok"){const c=o.d;this.log_("reportStats","Error sending stats: "+c)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+stringify(e));const s=e.r,o=this.requestCBHash_[s];o&&(delete this.requestCBHash_[s],o(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,s){this.log_("handleServerMessage",e,s),e==="d"?this.onDataUpdate_(s.p,s.d,!1,s.t):e==="m"?this.onDataUpdate_(s.p,s.d,!0,s.t):e==="c"?this.onListenRevoked_(s.p,s.q):e==="ac"?this.onAuthRevoked_(s.s,s.d):e==="apc"?this.onAppCheckRevoked_(s.s,s.d):e==="sd"?this.onSecurityDebugPacket_(s):error("Unrecognized action received from server: "+stringify(e)+`
Are you using the latest client?`)}onReady_(e,s){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=s,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let s=Math.max(0,this.reconnectDelay_-e);s=Math.random()*s,this.log_("Trying to reconnect in "+s+"ms"),this.scheduleConnect_(s),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),s=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+PersistentConnection.nextConnectionId_++,c=this.lastSessionId;let d=!1,h=null;const g=function(){h?h.close():(d=!0,o())},_=function(_t){assert(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(_t)};this.realtime_={close:g,sendRequest:_};const ft=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[_t,$t]=await Promise.all([this.authTokenProvider_.getToken(ft),this.appCheckTokenProvider_.getToken(ft)]);d?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),this.authToken_=_t&&_t.accessToken,this.appCheckToken_=$t&&$t.token,h=new Connection(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,s,o,Mt=>{warn$1(Mt+" ("+this.repoInfo_.toString()+")"),this.interrupt(SERVER_KILL_INTERRUPT_REASON)},c))}catch(_t){this.log_("Failed to get token: "+_t),d||(this.repoInfo_.nodeAdmin&&warn$1(_t),g())}}}interrupt(e){log("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){log("Resuming connection for reason: "+e),delete this.interruptReasons_[e],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const s=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:s})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const s=this.outstandingPuts_[e];s&&"h"in s.request&&s.queued&&(s.onComplete&&s.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,s){let o;s?o=s.map(c=>ObjectToUniqueKey(c)).join("$"):o="default";const a=this.removeListen_(e,o);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(e,s){const o=new Path(e).toString();let a;if(this.listens.has(o)){const c=this.listens.get(o);a=c.get(s),c.delete(s),c.size===0&&this.listens.delete(o)}else a=void 0;return a}onAuthRevoked_(e,s){log("Auth token revoked: "+e+"/"+s),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,s){log("App check token revoked: "+e+"/"+s),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=INVALID_TOKEN_THRESHOLD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const s of e.values())this.sendListen_(s);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let s="js";e["sdk."+s+"."+SDK_VERSION.replace(/\./g,"-")]=1,isMobileCordova()?e["framework.cordova"]=1:isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&e}}PersistentConnection.nextPersistentConnectionId_=0;PersistentConnection.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NamedNode{constructor(e,s){this.name=e,this.node=s}static Wrap(e,s){return new NamedNode(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Index{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,s){const o=new NamedNode(MIN_NAME,e),a=new NamedNode(MIN_NAME,s);return this.compare(o,a)!==0}minPost(){return NamedNode.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __EMPTY_NODE;class KeyIndex extends Index{static get __EMPTY_NODE(){return __EMPTY_NODE}static set __EMPTY_NODE(e){__EMPTY_NODE=e}compare(e,s){return nameCompare(e.name,s.name)}isDefinedOn(e){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,s){return!1}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,__EMPTY_NODE)}makePost(e,s){return assert(typeof e=="string","KeyIndex indexValue must always be a string."),new NamedNode(e,__EMPTY_NODE)}toString(){return".key"}}const KEY_INDEX=new KeyIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMapIterator{constructor(e,s,o,a,c=null){this.isReverse_=a,this.resultGenerator_=c,this.nodeStack_=[];let d=1;for(;!e.isEmpty();)if(e=e,d=s?o(e.key,s):1,a&&(d*=-1),d<0)this.isReverse_?e=e.left:e=e.right;else if(d===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),s;if(this.resultGenerator_?s=this.resultGenerator_(e.key,e.value):s={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return s}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class LLRBNode{constructor(e,s,o,a,c){this.key=e,this.value=s,this.color=o??LLRBNode.RED,this.left=a??SortedMap.EMPTY_NODE,this.right=c??SortedMap.EMPTY_NODE}copy(e,s,o,a,c){return new LLRBNode(e??this.key,s??this.value,o??this.color,a??this.left,c??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,o){let a=this;const c=o(e,a.key);return c<0?a=a.copy(null,null,null,a.left.insert(e,s,o),null):c===0?a=a.copy(null,s,null,null,null):a=a.copy(null,null,null,null,a.right.insert(e,s,o)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,s){let o,a;if(o=this,s(e,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(e,s),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),s(e,o.key)===0){if(o.right.isEmpty())return SortedMap.EMPTY_NODE;a=o.right.min_(),o=o.copy(a.key,a.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(e,s))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}LLRBNode.RED=!0;LLRBNode.BLACK=!1;class LLRBEmptyNode{copy(e,s,o,a,c){return this}insert(e,s,o){return new LLRBNode(e,s,null)}remove(e,s){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class SortedMap{constructor(e,s=SortedMap.EMPTY_NODE){this.comparator_=e,this.root_=s}insert(e,s){return new SortedMap(this.comparator_,this.root_.insert(e,s,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let s,o=this.root_;for(;!o.isEmpty();){if(s=this.comparator_(e,o.key),s===0)return o.value;s<0?o=o.left:s>0&&(o=o.right)}return null}getPredecessorKey(e){let s,o=this.root_,a=null;for(;!o.isEmpty();)if(s=this.comparator_(e,o.key),s===0){if(o.left.isEmpty())return a?a.key:null;for(o=o.left;!o.right.isEmpty();)o=o.right;return o.key}else s<0?o=o.left:s>0&&(a=o,o=o.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new SortedMapIterator(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,s){return new SortedMapIterator(this.root_,e,this.comparator_,!1,s)}getReverseIteratorFrom(e,s){return new SortedMapIterator(this.root_,e,this.comparator_,!0,s)}getReverseIterator(e){return new SortedMapIterator(this.root_,null,this.comparator_,!0,e)}}SortedMap.EMPTY_NODE=new LLRBEmptyNode;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAME_ONLY_COMPARATOR(i,e){return nameCompare(i.name,e.name)}function NAME_COMPARATOR(i,e){return nameCompare(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MAX_NODE$2;function setMaxNode$1(i){MAX_NODE$2=i}const priorityHashText=function(i){return typeof i=="number"?"number:"+doubleToIEEE754String(i):"string:"+i},validatePriorityNode=function(i){if(i.isLeafNode()){const e=i.val();assert(typeof e=="string"||typeof e=="number"||typeof e=="object"&&contains(e,".sv"),"Priority must be a string or number.")}else assert(i===MAX_NODE$2||i.isEmpty(),"priority of unexpected type.");assert(i===MAX_NODE$2||i.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __childrenNodeConstructor;class LeafNode{constructor(e,s=LeafNode.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=s,this.lazyHash_=null,assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}static set __childrenNodeConstructor(e){__childrenNodeConstructor=e}static get __childrenNodeConstructor(){return __childrenNodeConstructor}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new LeafNode(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pathIsEmpty(e)?this:pathGetFront(e)===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,s){return null}updateImmediateChild(e,s){return e===".priority"?this.updatePriority(s):s.isEmpty()&&e!==".priority"?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,s).updatePriority(this.priorityNode_)}updateChild(e,s){const o=pathGetFront(e);return o===null?s:s.isEmpty()&&o!==".priority"?this:(assert(o!==".priority"||pathGetLength(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(e),s)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,s){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+priorityHashText(this.priorityNode_.val())+":");const s=typeof this.value_;e+=s+":",s==="number"?e+=doubleToIEEE754String(this.value_):e+=this.value_,this.lazyHash_=sha1(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof LeafNode.__childrenNodeConstructor?-1:(assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const s=typeof e.value_,o=typeof this.value_,a=LeafNode.VALUE_TYPE_ORDER.indexOf(s),c=LeafNode.VALUE_TYPE_ORDER.indexOf(o);return assert(a>=0,"Unknown leaf type: "+s),assert(c>=0,"Unknown leaf type: "+o),a===c?o==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:c-a}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const s=e;return this.value_===s.value_&&this.priorityNode_.equals(s.priorityNode_)}else return!1}}LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nodeFromJSON$1,MAX_NODE$1;function setNodeFromJSON(i){nodeFromJSON$1=i}function setMaxNode(i){MAX_NODE$1=i}class PriorityIndex extends Index{compare(e,s){const o=e.node.getPriority(),a=s.node.getPriority(),c=o.compareTo(a);return c===0?nameCompare(e.name,s.name):c}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,s){return!e.getPriority().equals(s.getPriority())}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))}makePost(e,s){const o=nodeFromJSON$1(e);return new NamedNode(s,new LeafNode("[PRIORITY-POST]",o))}toString(){return".priority"}}const PRIORITY_INDEX=new PriorityIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LOG_2=Math.log(2);class Base12Num{constructor(e){const s=c=>parseInt(Math.log(c)/LOG_2,10),o=c=>parseInt(Array(c+1).join("1"),2);this.count=s(e+1),this.current_=this.count-1;const a=o(this.count);this.bits_=e+1&a}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const buildChildSet=function(i,e,s,o){i.sort(e);const a=function(g,_){const ft=_-g;let _t,$t;if(ft===0)return null;if(ft===1)return _t=i[g],$t=s?s(_t):_t,new LLRBNode($t,_t.node,LLRBNode.BLACK,null,null);{const Mt=parseInt(ft/2,10)+g,Ft=a(g,Mt),Ol=a(Mt+1,_);return _t=i[Mt],$t=s?s(_t):_t,new LLRBNode($t,_t.node,LLRBNode.BLACK,Ft,Ol)}},c=function(g){let _=null,ft=null,_t=i.length;const $t=function(Ft,Ol){const Vl=_t-Ft,Nl=_t;_t-=Ft;const xl=a(Vl+1,Nl),Ml=i[Vl],Su=s?s(Ml):Ml;Mt(new LLRBNode(Su,Ml.node,Ol,null,xl))},Mt=function(Ft){_?(_.left=Ft,_=Ft):(ft=Ft,_=Ft)};for(let Ft=0;Ft<g.count;++Ft){const Ol=g.nextBitIsOne(),Vl=Math.pow(2,g.count-(Ft+1));Ol?$t(Vl,LLRBNode.BLACK):($t(Vl,LLRBNode.BLACK),$t(Vl,LLRBNode.RED))}return ft},d=new Base12Num(i.length),h=c(d);return new SortedMap(o||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _defaultIndexMap;const fallbackObject={};class IndexMap{constructor(e,s){this.indexes_=e,this.indexSet_=s}static get Default(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap}get(e){const s=safeGet(this.indexes_,e);if(!s)throw new Error("No index defined for "+e);return s instanceof SortedMap?s:null}hasIndex(e){return contains(this.indexSet_,e.toString())}addIndex(e,s){assert(e!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const o=[];let a=!1;const c=s.getIterator(NamedNode.Wrap);let d=c.getNext();for(;d;)a=a||e.isDefinedOn(d.node),o.push(d),d=c.getNext();let h;a?h=buildChildSet(o,e.getCompare()):h=fallbackObject;const g=e.toString(),_=Object.assign({},this.indexSet_);_[g]=e;const ft=Object.assign({},this.indexes_);return ft[g]=h,new IndexMap(ft,_)}addToIndexes(e,s){const o=map(this.indexes_,(a,c)=>{const d=safeGet(this.indexSet_,c);if(assert(d,"Missing index implementation for "+c),a===fallbackObject)if(d.isDefinedOn(e.node)){const h=[],g=s.getIterator(NamedNode.Wrap);let _=g.getNext();for(;_;)_.name!==e.name&&h.push(_),_=g.getNext();return h.push(e),buildChildSet(h,d.getCompare())}else return fallbackObject;else{const h=s.get(e.name);let g=a;return h&&(g=g.remove(new NamedNode(e.name,h))),g.insert(e,e.node)}});return new IndexMap(o,this.indexSet_)}removeFromIndexes(e,s){const o=map(this.indexes_,a=>{if(a===fallbackObject)return a;{const c=s.get(e.name);return c?a.remove(new NamedNode(e.name,c)):a}});return new IndexMap(o,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EMPTY_NODE;class ChildrenNode{constructor(e,s,o){this.children_=e,this.priorityNode_=s,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||EMPTY_NODE}updatePriority(e){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const s=this.children_.get(e);return s===null?EMPTY_NODE:s}}getChild(e){const s=pathGetFront(e);return s===null?this:this.getImmediateChild(s).getChild(pathPopFront(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,s){if(assert(s,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(s);{const o=new NamedNode(e,s);let a,c;s.isEmpty()?(a=this.children_.remove(e),c=this.indexMap_.removeFromIndexes(o,this.children_)):(a=this.children_.insert(e,s),c=this.indexMap_.addToIndexes(o,this.children_));const d=a.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(a,d,c)}}updateChild(e,s){const o=pathGetFront(e);if(o===null)return s;{assert(pathGetFront(e)!==".priority"||pathGetLength(e)===1,".priority must be the last token in a path");const a=this.getImmediateChild(o).updateChild(pathPopFront(e),s);return this.updateImmediateChild(o,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const s={};let o=0,a=0,c=!0;if(this.forEachChild(PRIORITY_INDEX,(d,h)=>{s[d]=h.val(e),o++,c&&ChildrenNode.INTEGER_REGEXP_.test(d)?a=Math.max(a,Number(d)):c=!1}),!e&&c&&a<2*o){const d=[];for(const h in s)d[h]=s[h];return d}else return e&&!this.getPriority().isEmpty()&&(s[".priority"]=this.getPriority().val()),s}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,(s,o)=>{const a=o.hash();a!==""&&(e+=":"+s+":"+a)}),this.lazyHash_=e===""?"":sha1(e)}return this.lazyHash_}getPredecessorChildName(e,s,o){const a=this.resolveIndex_(o);if(a){const c=a.getPredecessorKey(new NamedNode(e,s));return c?c.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const s=this.resolveIndex_(e);if(s){const o=s.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(e){const s=this.getFirstChildName(e);return s?new NamedNode(s,this.children_.get(s)):null}getLastChildName(e){const s=this.resolveIndex_(e);if(s){const o=s.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(e){const s=this.getLastChildName(e);return s?new NamedNode(s,this.children_.get(s)):null}forEachChild(e,s){const o=this.resolveIndex_(e);return o?o.inorderTraversal(a=>s(a.name,a.node)):this.children_.inorderTraversal(s)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,s){const o=this.resolveIndex_(s);if(o)return o.getIteratorFrom(e,a=>a);{const a=this.children_.getIteratorFrom(e.name,NamedNode.Wrap);let c=a.peek();for(;c!=null&&s.compare(c,e)<0;)a.getNext(),c=a.peek();return a}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,s){const o=this.resolveIndex_(s);if(o)return o.getReverseIteratorFrom(e,a=>a);{const a=this.children_.getReverseIteratorFrom(e.name,NamedNode.Wrap);let c=a.peek();for(;c!=null&&s.compare(c,e)>0;)a.getNext(),c=a.peek();return a}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===MAX_NODE?-1:0}withIndex(e){if(e===KEY_INDEX||this.indexMap_.hasIndex(e))return this;{const s=this.indexMap_.addIndex(e,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,s)}}isIndexed(e){return e===KEY_INDEX||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const s=e;if(this.getPriority().equals(s.getPriority()))if(this.children_.count()===s.children_.count()){const o=this.getIterator(PRIORITY_INDEX),a=s.getIterator(PRIORITY_INDEX);let c=o.getNext(),d=a.getNext();for(;c&&d;){if(c.name!==d.name||!c.node.equals(d.node))return!1;c=o.getNext(),d=a.getNext()}return c===null&&d===null}else return!1;else return!1}}resolveIndex_(e){return e===KEY_INDEX?null:this.indexMap_.get(e.toString())}}ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class MaxNode extends ChildrenNode{constructor(){super(new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ChildrenNode.EMPTY_NODE}isEmpty(){return!1}}const MAX_NODE=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE)}});KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode.__childrenNodeConstructor=ChildrenNode;setMaxNode$1(MAX_NODE);setMaxNode(MAX_NODE);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USE_HINZE=!0;function nodeFromJSON(i,e=null){if(i===null)return ChildrenNode.EMPTY_NODE;if(typeof i=="object"&&".priority"in i&&(e=i[".priority"]),assert(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof i=="object"&&".value"in i&&i[".value"]!==null&&(i=i[".value"]),typeof i!="object"||".sv"in i){const s=i;return new LeafNode(s,nodeFromJSON(e))}if(!(i instanceof Array)&&USE_HINZE){const s=[];let o=!1;if(each(i,(d,h)=>{if(d.substring(0,1)!=="."){const g=nodeFromJSON(h);g.isEmpty()||(o=o||!g.getPriority().isEmpty(),s.push(new NamedNode(d,g)))}}),s.length===0)return ChildrenNode.EMPTY_NODE;const c=buildChildSet(s,NAME_ONLY_COMPARATOR,d=>d.name,NAME_COMPARATOR);if(o){const d=buildChildSet(s,PRIORITY_INDEX.getCompare());return new ChildrenNode(c,nodeFromJSON(e),new IndexMap({".priority":d},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(c,nodeFromJSON(e),IndexMap.Default)}else{let s=ChildrenNode.EMPTY_NODE;return each(i,(o,a)=>{if(contains(i,o)&&o.substring(0,1)!=="."){const c=nodeFromJSON(a);(c.isLeafNode()||!c.isEmpty())&&(s=s.updateImmediateChild(o,c))}}),s.updatePriority(nodeFromJSON(e))}}setNodeFromJSON(nodeFromJSON);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PathIndex extends Index{constructor(e){super(),this.indexPath_=e,assert(!pathIsEmpty(e)&&pathGetFront(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,s){const o=this.extractChild(e.node),a=this.extractChild(s.node),c=o.compareTo(a);return c===0?nameCompare(e.name,s.name):c}makePost(e,s){const o=nodeFromJSON(e),a=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,o);return new NamedNode(s,a)}maxPost(){const e=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE);return new NamedNode(MAX_NAME,e)}toString(){return pathSlice(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ValueIndex extends Index{compare(e,s){const o=e.node.compareTo(s.node);return o===0?nameCompare(e.name,s.name):o}isDefinedOn(e){return!0}indexedValueChanged(e,s){return!e.equals(s)}minPost(){return NamedNode.MIN}maxPost(){return NamedNode.MAX}makePost(e,s){const o=nodeFromJSON(e);return new NamedNode(s,o)}toString(){return".value"}}const VALUE_INDEX=new ValueIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function changeValue(i){return{type:"value",snapshotNode:i}}function changeChildAdded(i,e){return{type:"child_added",snapshotNode:e,childName:i}}function changeChildRemoved(i,e){return{type:"child_removed",snapshotNode:e,childName:i}}function changeChildChanged(i,e,s){return{type:"child_changed",snapshotNode:e,childName:i,oldSnap:s}}function changeChildMoved(i,e){return{type:"child_moved",snapshotNode:e,childName:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IndexedFilter{constructor(e){this.index_=e}updateChild(e,s,o,a,c,d){assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(s);return h.getChild(a).equals(o.getChild(a))&&h.isEmpty()===o.isEmpty()||(d!=null&&(o.isEmpty()?e.hasChild(s)?d.trackChildChange(changeChildRemoved(s,h)):assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?d.trackChildChange(changeChildAdded(s,o)):d.trackChildChange(changeChildChanged(s,o,h))),e.isLeafNode()&&o.isEmpty())?e:e.updateImmediateChild(s,o).withIndex(this.index_)}updateFullNode(e,s,o){return o!=null&&(e.isLeafNode()||e.forEachChild(PRIORITY_INDEX,(a,c)=>{s.hasChild(a)||o.trackChildChange(changeChildRemoved(a,c))}),s.isLeafNode()||s.forEachChild(PRIORITY_INDEX,(a,c)=>{if(e.hasChild(a)){const d=e.getImmediateChild(a);d.equals(c)||o.trackChildChange(changeChildChanged(a,c,d))}else o.trackChildChange(changeChildAdded(a,c))})),s.withIndex(this.index_)}updatePriority(e,s){return e.isEmpty()?ChildrenNode.EMPTY_NODE:e.updatePriority(s)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RangedFilter{constructor(e){this.indexedFilter_=new IndexedFilter(e.getIndex()),this.index_=e.getIndex(),this.startPost_=RangedFilter.getStartPost_(e),this.endPost_=RangedFilter.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const s=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,o=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return s&&o}updateChild(e,s,o,a,c,d){return this.matches(new NamedNode(s,o))||(o=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(e,s,o,a,c,d)}updateFullNode(e,s,o){s.isLeafNode()&&(s=ChildrenNode.EMPTY_NODE);let a=s.withIndex(this.index_);a=a.updatePriority(ChildrenNode.EMPTY_NODE);const c=this;return s.forEachChild(PRIORITY_INDEX,(d,h)=>{c.matches(new NamedNode(d,h))||(a=a.updateImmediateChild(d,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,a,o)}updatePriority(e,s){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const s=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),s)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const s=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),s)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LimitedFilter{constructor(e){this.withinDirectionalStart=s=>this.reverse_?this.withinEndPost(s):this.withinStartPost(s),this.withinDirectionalEnd=s=>this.reverse_?this.withinStartPost(s):this.withinEndPost(s),this.withinStartPost=s=>{const o=this.index_.compare(this.rangedFilter_.getStartPost(),s);return this.startIsInclusive_?o<=0:o<0},this.withinEndPost=s=>{const o=this.index_.compare(s,this.rangedFilter_.getEndPost());return this.endIsInclusive_?o<=0:o<0},this.rangedFilter_=new RangedFilter(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,s,o,a,c,d){return this.rangedFilter_.matches(new NamedNode(s,o))||(o=ChildrenNode.EMPTY_NODE),e.getImmediateChild(s).equals(o)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,s,o,a,c,d):this.fullLimitUpdateChild_(e,s,o,c,d)}updateFullNode(e,s,o){let a;if(s.isLeafNode()||s.isEmpty())a=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<s.numChildren()&&s.isIndexed(this.index_)){a=ChildrenNode.EMPTY_NODE.withIndex(this.index_);let c;this.reverse_?c=s.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):c=s.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let d=0;for(;c.hasNext()&&d<this.limit_;){const h=c.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))a=a.updateImmediateChild(h.name,h.node),d++;else break;else continue}}else{a=s.withIndex(this.index_),a=a.updatePriority(ChildrenNode.EMPTY_NODE);let c;this.reverse_?c=a.getReverseIterator(this.index_):c=a.getIterator(this.index_);let d=0;for(;c.hasNext();){const h=c.getNext();d<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?d++:a=a.updateImmediateChild(h.name,ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,a,o)}updatePriority(e,s){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,s,o,a,c){let d;if(this.reverse_){const _t=this.index_.getCompare();d=($t,Mt)=>_t(Mt,$t)}else d=this.index_.getCompare();const h=e;assert(h.numChildren()===this.limit_,"");const g=new NamedNode(s,o),_=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),ft=this.rangedFilter_.matches(g);if(h.hasChild(s)){const _t=h.getImmediateChild(s);let $t=a.getChildAfterChild(this.index_,_,this.reverse_);for(;$t!=null&&($t.name===s||h.hasChild($t.name));)$t=a.getChildAfterChild(this.index_,$t,this.reverse_);const Mt=$t==null?1:d($t,g);if(ft&&!o.isEmpty()&&Mt>=0)return c!=null&&c.trackChildChange(changeChildChanged(s,o,_t)),h.updateImmediateChild(s,o);{c!=null&&c.trackChildChange(changeChildRemoved(s,_t));const Ol=h.updateImmediateChild(s,ChildrenNode.EMPTY_NODE);return $t!=null&&this.rangedFilter_.matches($t)?(c!=null&&c.trackChildChange(changeChildAdded($t.name,$t.node)),Ol.updateImmediateChild($t.name,$t.node)):Ol}}else return o.isEmpty()?e:ft&&d(_,g)>=0?(c!=null&&(c.trackChildChange(changeChildRemoved(_.name,_.node)),c.trackChildChange(changeChildAdded(s,o))),h.updateImmediateChild(s,o).updateImmediateChild(_.name,ChildrenNode.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryParams{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME}hasEnd(){return this.endSet_}getIndexEndValue(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX}copy(){const e=new QueryParams;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function queryParamsGetNodeFilter(i){return i.loadsAllData()?new IndexedFilter(i.getIndex()):i.hasLimit()?new LimitedFilter(i):new RangedFilter(i)}function queryParamsLimitToFirst(i,e){const s=i.copy();return s.limitSet_=!0,s.limit_=e,s.viewFrom_="l",s}function queryParamsLimitToLast(i,e){const s=i.copy();return s.limitSet_=!0,s.limit_=e,s.viewFrom_="r",s}function queryParamsStartAt(i,e,s){const o=i.copy();return o.startSet_=!0,e===void 0&&(e=null),o.indexStartValue_=e,s!=null?(o.startNameSet_=!0,o.indexStartName_=s):(o.startNameSet_=!1,o.indexStartName_=""),o}function queryParamsStartAfter(i,e,s){let o;return i.index_===KEY_INDEX||s?o=queryParamsStartAt(i,e,s):o=queryParamsStartAt(i,e,MAX_NAME),o.startAfterSet_=!0,o}function queryParamsEndAt(i,e,s){const o=i.copy();return o.endSet_=!0,e===void 0&&(e=null),o.indexEndValue_=e,s!==void 0?(o.endNameSet_=!0,o.indexEndName_=s):(o.endNameSet_=!1,o.indexEndName_=""),o}function queryParamsEndBefore(i,e,s){let o;return i.index_===KEY_INDEX||s?o=queryParamsEndAt(i,e,s):o=queryParamsEndAt(i,e,MIN_NAME),o.endBeforeSet_=!0,o}function queryParamsOrderBy(i,e){const s=i.copy();return s.index_=e,s}function queryParamsToRestQueryStringParameters(i){const e={};if(i.isDefault())return e;let s;if(i.index_===PRIORITY_INDEX?s="$priority":i.index_===VALUE_INDEX?s="$value":i.index_===KEY_INDEX?s="$key":(assert(i.index_ instanceof PathIndex,"Unrecognized index type!"),s=i.index_.toString()),e.orderBy=stringify(s),i.startSet_){const o=i.startAfterSet_?"startAfter":"startAt";e[o]=stringify(i.indexStartValue_),i.startNameSet_&&(e[o]+=","+stringify(i.indexStartName_))}if(i.endSet_){const o=i.endBeforeSet_?"endBefore":"endAt";e[o]=stringify(i.indexEndValue_),i.endNameSet_&&(e[o]+=","+stringify(i.indexEndName_))}return i.limitSet_&&(i.isViewFromLeft()?e.limitToFirst=i.limit_:e.limitToLast=i.limit_),e}function queryParamsGetQueryObject(i){const e={};if(i.startSet_&&(e.sp=i.indexStartValue_,i.startNameSet_&&(e.sn=i.indexStartName_),e.sin=!i.startAfterSet_),i.endSet_&&(e.ep=i.indexEndValue_,i.endNameSet_&&(e.en=i.indexEndName_),e.ein=!i.endBeforeSet_),i.limitSet_){e.l=i.limit_;let s=i.viewFrom_;s===""&&(i.isViewFromLeft()?s="l":s="r"),e.vf=s}return i.index_!==PRIORITY_INDEX&&(e.i=i.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReadonlyRestClient extends ServerActions{constructor(e,s,o,a){super(),this.repoInfo_=e,this.onDataUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.log_=logWrapper("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,s){return s!==void 0?"tag$"+s:(assert(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,s,o,a){const c=e._path.toString();this.log_("Listen called for "+c+" "+e._queryIdentifier);const d=ReadonlyRestClient.getListenId_(e,o),h={};this.listens_[d]=h;const g=queryParamsToRestQueryStringParameters(e._queryParams);this.restRequest_(c+".json",g,(_,ft)=>{let _t=ft;if(_===404&&(_t=null,_=null),_===null&&this.onDataUpdate_(c,_t,!1,o),safeGet(this.listens_,d)===h){let $t;_?_===401?$t="permission_denied":$t="rest_error:"+_:$t="ok",a($t,null)}})}unlisten(e,s){const o=ReadonlyRestClient.getListenId_(e,s);delete this.listens_[o]}get(e){const s=queryParamsToRestQueryStringParameters(e._queryParams),o=e._path.toString(),a=new Deferred;return this.restRequest_(o+".json",s,(c,d)=>{let h=d;c===404&&(h=null,c=null),c===null?(this.onDataUpdate_(o,h,!1,null),a.resolve(h)):a.reject(new Error(h))}),a.promise}refreshAuthToken(e){}restRequest_(e,s={},o){return s.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([a,c])=>{a&&a.accessToken&&(s.auth=a.accessToken),c&&c.token&&(s.ac=c.token);const d=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+querystring(s);this.log_("Sending REST request for "+d);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(o&&h.readyState===4){this.log_("REST Response for "+d+" received. status:",h.status,"response:",h.responseText);let g=null;if(h.status>=200&&h.status<300){try{g=jsonEval(h.responseText)}catch{warn$1("Failed to parse JSON response for "+d+": "+h.responseText)}o(null,g)}else h.status!==401&&h.status!==404&&warn$1("Got unsuccessful REST response for "+d+" Status: "+h.status),o(h.status);o=null}},h.open("GET",d,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotHolder{constructor(){this.rootNode_=ChildrenNode.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,s){this.rootNode_=this.rootNode_.updateChild(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(i,e,s){if(pathIsEmpty(e))i.value=s,i.children.clear();else if(i.value!==null)i.value=i.value.updateChild(e,s);else{const o=pathGetFront(e);i.children.has(o)||i.children.set(o,newSparseSnapshotTree());const a=i.children.get(o);e=pathPopFront(e),sparseSnapshotTreeRemember(a,e,s)}}function sparseSnapshotTreeForget(i,e){if(pathIsEmpty(e))return i.value=null,i.children.clear(),!0;if(i.value!==null){if(i.value.isLeafNode())return!1;{const s=i.value;return i.value=null,s.forEachChild(PRIORITY_INDEX,(o,a)=>{sparseSnapshotTreeRemember(i,new Path(o),a)}),sparseSnapshotTreeForget(i,e)}}else if(i.children.size>0){const s=pathGetFront(e);return e=pathPopFront(e),i.children.has(s)&&sparseSnapshotTreeForget(i.children.get(s),e)&&i.children.delete(s),i.children.size===0}else return!0}function sparseSnapshotTreeForEachTree(i,e,s){i.value!==null?s(e,i.value):sparseSnapshotTreeForEachChild(i,(o,a)=>{const c=new Path(e.toString()+"/"+o);sparseSnapshotTreeForEachTree(a,c,s)})}function sparseSnapshotTreeForEachChild(i,e){i.children.forEach((s,o)=>{e(o,s)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsListener{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),s=Object.assign({},e);return this.last_&&each(this.last_,(o,a)=>{s[o]=s[o]-a}),this.last_=e,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3;class StatsReporter{constructor(e,s){this.server_=s,this.statsToReport_={},this.statsListener_=new StatsListener(e);const o=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(o))}reportStats_(){const e=this.statsListener_.get(),s={};let o=!1;each(e,(a,c)=>{c>0&&contains(this.statsToReport_,a)&&(s[a]=c,o=!0)}),o&&this.server_.reportStats(s),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OperationType;(function(i){i[i.OVERWRITE=0]="OVERWRITE",i[i.MERGE=1]="MERGE",i[i.ACK_USER_WRITE=2]="ACK_USER_WRITE",i[i.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));function newOperationSourceUser(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function newOperationSourceServer(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function newOperationSourceServerTaggedQuery(i){return{fromUser:!1,fromServer:!0,queryId:i,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AckUserWrite{constructor(e,s,o){this.path=e,this.affectedTree=s,this.revert=o,this.type=OperationType.ACK_USER_WRITE,this.source=newOperationSourceUser()}operationForChild(e){if(pathIsEmpty(this.path)){if(this.affectedTree.value!=null)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const s=this.affectedTree.subtree(new Path(e));return new AckUserWrite(newEmptyPath(),s,this.revert)}}else return assert(pathGetFront(this.path)===e,"operationForChild called for unrelated child."),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ListenComplete{constructor(e,s){this.source=e,this.path=s,this.type=OperationType.LISTEN_COMPLETE}operationForChild(e){return pathIsEmpty(this.path)?new ListenComplete(this.source,newEmptyPath()):new ListenComplete(this.source,pathPopFront(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overwrite{constructor(e,s,o){this.source=e,this.path=s,this.snap=o,this.type=OperationType.OVERWRITE}operationForChild(e){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(e)):new Overwrite(this.source,pathPopFront(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Merge{constructor(e,s,o){this.source=e,this.path=s,this.children=o,this.type=OperationType.MERGE}operationForChild(e){if(pathIsEmpty(this.path)){const s=this.children.subtree(new Path(e));return s.isEmpty()?null:s.value?new Overwrite(this.source,newEmptyPath(),s.value):new Merge(this.source,newEmptyPath(),s)}else return assert(pathGetFront(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,pathPopFront(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CacheNode{constructor(e,s,o){this.node_=e,this.fullyInitialized_=s,this.filtered_=o}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pathIsEmpty(e))return this.isFullyInitialized()&&!this.filtered_;const s=pathGetFront(e);return this.isCompleteForChild(s)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventGenerator{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function eventGeneratorGenerateEventsForChanges(i,e,s,o){const a=[],c=[];return e.forEach(d=>{d.type==="child_changed"&&i.index_.indexedValueChanged(d.oldSnap,d.snapshotNode)&&c.push(changeChildMoved(d.childName,d.snapshotNode))}),eventGeneratorGenerateEventsForType(i,a,"child_removed",e,o,s),eventGeneratorGenerateEventsForType(i,a,"child_added",e,o,s),eventGeneratorGenerateEventsForType(i,a,"child_moved",c,o,s),eventGeneratorGenerateEventsForType(i,a,"child_changed",e,o,s),eventGeneratorGenerateEventsForType(i,a,"value",e,o,s),a}function eventGeneratorGenerateEventsForType(i,e,s,o,a,c){const d=o.filter(h=>h.type===s);d.sort((h,g)=>eventGeneratorCompareChanges(i,h,g)),d.forEach(h=>{const g=eventGeneratorMaterializeSingleChange(i,h,c);a.forEach(_=>{_.respondsTo(h.type)&&e.push(_.createEvent(g,i.query_))})})}function eventGeneratorMaterializeSingleChange(i,e,s){return e.type==="value"||e.type==="child_removed"||(e.prevName=s.getPredecessorChildName(e.childName,e.snapshotNode,i.index_)),e}function eventGeneratorCompareChanges(i,e,s){if(e.childName==null||s.childName==null)throw assertionError("Should only compare child_ events.");const o=new NamedNode(e.childName,e.snapshotNode),a=new NamedNode(s.childName,s.snapshotNode);return i.index_.compare(o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewCache(i,e){return{eventCache:i,serverCache:e}}function viewCacheUpdateEventSnap(i,e,s,o){return newViewCache(new CacheNode(e,s,o),i.serverCache)}function viewCacheUpdateServerSnap(i,e,s,o){return newViewCache(i.eventCache,new CacheNode(e,s,o))}function viewCacheGetCompleteEventSnap(i){return i.eventCache.isFullyInitialized()?i.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(i){return i.serverCache.isFullyInitialized()?i.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let emptyChildrenSingleton;const EmptyChildren=()=>(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton);class ImmutableTree{constructor(e,s=EmptyChildren()){this.value=e,this.children=s}static fromObject(e){let s=new ImmutableTree(null);return each(e,(o,a)=>{s=s.set(new Path(o),a)}),s}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,s){if(this.value!=null&&s(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(e))return null;{const o=pathGetFront(e),a=this.children.get(o);if(a!==null){const c=a.findRootMostMatchingPathAndValue(pathPopFront(e),s);return c!=null?{path:pathChild(new Path(o),c.path),value:c.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pathIsEmpty(e))return this;{const s=pathGetFront(e),o=this.children.get(s);return o!==null?o.subtree(pathPopFront(e)):new ImmutableTree(null)}}set(e,s){if(pathIsEmpty(e))return new ImmutableTree(s,this.children);{const o=pathGetFront(e),c=(this.children.get(o)||new ImmutableTree(null)).set(pathPopFront(e),s),d=this.children.insert(o,c);return new ImmutableTree(this.value,d)}}remove(e){if(pathIsEmpty(e))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);{const s=pathGetFront(e),o=this.children.get(s);if(o){const a=o.remove(pathPopFront(e));let c;return a.isEmpty()?c=this.children.remove(s):c=this.children.insert(s,a),this.value===null&&c.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,c)}else return this}}get(e){if(pathIsEmpty(e))return this.value;{const s=pathGetFront(e),o=this.children.get(s);return o?o.get(pathPopFront(e)):null}}setTree(e,s){if(pathIsEmpty(e))return s;{const o=pathGetFront(e),c=(this.children.get(o)||new ImmutableTree(null)).setTree(pathPopFront(e),s);let d;return c.isEmpty()?d=this.children.remove(o):d=this.children.insert(o,c),new ImmutableTree(this.value,d)}}fold(e){return this.fold_(newEmptyPath(),e)}fold_(e,s){const o={};return this.children.inorderTraversal((a,c)=>{o[a]=c.fold_(pathChild(e,a),s)}),s(e,this.value,o)}findOnPath(e,s){return this.findOnPath_(e,newEmptyPath(),s)}findOnPath_(e,s,o){const a=this.value?o(s,this.value):!1;if(a)return a;if(pathIsEmpty(e))return null;{const c=pathGetFront(e),d=this.children.get(c);return d?d.findOnPath_(pathPopFront(e),pathChild(s,c),o):null}}foreachOnPath(e,s){return this.foreachOnPath_(e,newEmptyPath(),s)}foreachOnPath_(e,s,o){if(pathIsEmpty(e))return this;{this.value&&o(s,this.value);const a=pathGetFront(e),c=this.children.get(a);return c?c.foreachOnPath_(pathPopFront(e),pathChild(s,a),o):new ImmutableTree(null)}}foreach(e){this.foreach_(newEmptyPath(),e)}foreach_(e,s){this.children.inorderTraversal((o,a)=>{a.foreach_(pathChild(e,o),s)}),this.value&&s(e,this.value)}foreachChild(e){this.children.inorderTraversal((s,o)=>{o.value&&e(s,o.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CompoundWrite{constructor(e){this.writeTree_=e}static empty(){return new CompoundWrite(new ImmutableTree(null))}}function compoundWriteAddWrite(i,e,s){if(pathIsEmpty(e))return new CompoundWrite(new ImmutableTree(s));{const o=i.writeTree_.findRootMostValueAndPath(e);if(o!=null){const a=o.path;let c=o.value;const d=newRelativePath(a,e);return c=c.updateChild(d,s),new CompoundWrite(i.writeTree_.set(a,c))}else{const a=new ImmutableTree(s),c=i.writeTree_.setTree(e,a);return new CompoundWrite(c)}}}function compoundWriteAddWrites(i,e,s){let o=i;return each(s,(a,c)=>{o=compoundWriteAddWrite(o,pathChild(e,a),c)}),o}function compoundWriteRemoveWrite(i,e){if(pathIsEmpty(e))return CompoundWrite.empty();{const s=i.writeTree_.setTree(e,new ImmutableTree(null));return new CompoundWrite(s)}}function compoundWriteHasCompleteWrite(i,e){return compoundWriteGetCompleteNode(i,e)!=null}function compoundWriteGetCompleteNode(i,e){const s=i.writeTree_.findRootMostValueAndPath(e);return s!=null?i.writeTree_.get(s.path).getChild(newRelativePath(s.path,e)):null}function compoundWriteGetCompleteChildren(i){const e=[],s=i.writeTree_.value;return s!=null?s.isLeafNode()||s.forEachChild(PRIORITY_INDEX,(o,a)=>{e.push(new NamedNode(o,a))}):i.writeTree_.children.inorderTraversal((o,a)=>{a.value!=null&&e.push(new NamedNode(o,a.value))}),e}function compoundWriteChildCompoundWrite(i,e){if(pathIsEmpty(e))return i;{const s=compoundWriteGetCompleteNode(i,e);return s!=null?new CompoundWrite(new ImmutableTree(s)):new CompoundWrite(i.writeTree_.subtree(e))}}function compoundWriteIsEmpty(i){return i.writeTree_.isEmpty()}function compoundWriteApply(i,e){return applySubtreeWrite(newEmptyPath(),i.writeTree_,e)}function applySubtreeWrite(i,e,s){if(e.value!=null)return s.updateChild(i,e.value);{let o=null;return e.children.inorderTraversal((a,c)=>{a===".priority"?(assert(c.value!==null,"Priority writes must always be leaf nodes"),o=c.value):s=applySubtreeWrite(pathChild(i,a),c,s)}),!s.getChild(i).isEmpty()&&o!==null&&(s=s.updateChild(pathChild(i,".priority"),o)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeTreeChildWrites(i,e){return newWriteTreeRef(e,i)}function writeTreeAddOverwrite(i,e,s,o,a){assert(o>i.lastWriteId,"Stacking an older write on top of newer ones"),a===void 0&&(a=!0),i.allWrites.push({path:e,snap:s,writeId:o,visible:a}),a&&(i.visibleWrites=compoundWriteAddWrite(i.visibleWrites,e,s)),i.lastWriteId=o}function writeTreeAddMerge(i,e,s,o){assert(o>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:e,children:s,writeId:o,visible:!0}),i.visibleWrites=compoundWriteAddWrites(i.visibleWrites,e,s),i.lastWriteId=o}function writeTreeGetWrite(i,e){for(let s=0;s<i.allWrites.length;s++){const o=i.allWrites[s];if(o.writeId===e)return o}return null}function writeTreeRemoveWrite(i,e){const s=i.allWrites.findIndex(h=>h.writeId===e);assert(s>=0,"removeWrite called with nonexistent writeId.");const o=i.allWrites[s];i.allWrites.splice(s,1);let a=o.visible,c=!1,d=i.allWrites.length-1;for(;a&&d>=0;){const h=i.allWrites[d];h.visible&&(d>=s&&writeTreeRecordContainsPath_(h,o.path)?a=!1:pathContains(o.path,h.path)&&(c=!0)),d--}if(a){if(c)return writeTreeResetTree_(i),!0;if(o.snap)i.visibleWrites=compoundWriteRemoveWrite(i.visibleWrites,o.path);else{const h=o.children;each(h,g=>{i.visibleWrites=compoundWriteRemoveWrite(i.visibleWrites,pathChild(o.path,g))})}return!0}else return!1}function writeTreeRecordContainsPath_(i,e){if(i.snap)return pathContains(i.path,e);for(const s in i.children)if(i.children.hasOwnProperty(s)&&pathContains(pathChild(i.path,s),e))return!0;return!1}function writeTreeResetTree_(i){i.visibleWrites=writeTreeLayerTree_(i.allWrites,writeTreeDefaultFilter_,newEmptyPath()),i.allWrites.length>0?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1}function writeTreeDefaultFilter_(i){return i.visible}function writeTreeLayerTree_(i,e,s){let o=CompoundWrite.empty();for(let a=0;a<i.length;++a){const c=i[a];if(e(c)){const d=c.path;let h;if(c.snap)pathContains(s,d)?(h=newRelativePath(s,d),o=compoundWriteAddWrite(o,h,c.snap)):pathContains(d,s)&&(h=newRelativePath(d,s),o=compoundWriteAddWrite(o,newEmptyPath(),c.snap.getChild(h)));else if(c.children){if(pathContains(s,d))h=newRelativePath(s,d),o=compoundWriteAddWrites(o,h,c.children);else if(pathContains(d,s))if(h=newRelativePath(d,s),pathIsEmpty(h))o=compoundWriteAddWrites(o,newEmptyPath(),c.children);else{const g=safeGet(c.children,pathGetFront(h));if(g){const _=g.getChild(pathPopFront(h));o=compoundWriteAddWrite(o,newEmptyPath(),_)}}}else throw assertionError("WriteRecord should have .snap or .children")}}return o}function writeTreeCalcCompleteEventCache(i,e,s,o,a){if(!o&&!a){const c=compoundWriteGetCompleteNode(i.visibleWrites,e);if(c!=null)return c;{const d=compoundWriteChildCompoundWrite(i.visibleWrites,e);if(compoundWriteIsEmpty(d))return s;if(s==null&&!compoundWriteHasCompleteWrite(d,newEmptyPath()))return null;{const h=s||ChildrenNode.EMPTY_NODE;return compoundWriteApply(d,h)}}}else{const c=compoundWriteChildCompoundWrite(i.visibleWrites,e);if(!a&&compoundWriteIsEmpty(c))return s;if(!a&&s==null&&!compoundWriteHasCompleteWrite(c,newEmptyPath()))return null;{const d=function(_){return(_.visible||a)&&(!o||!~o.indexOf(_.writeId))&&(pathContains(_.path,e)||pathContains(e,_.path))},h=writeTreeLayerTree_(i.allWrites,d,e),g=s||ChildrenNode.EMPTY_NODE;return compoundWriteApply(h,g)}}}function writeTreeCalcCompleteEventChildren(i,e,s){let o=ChildrenNode.EMPTY_NODE;const a=compoundWriteGetCompleteNode(i.visibleWrites,e);if(a)return a.isLeafNode()||a.forEachChild(PRIORITY_INDEX,(c,d)=>{o=o.updateImmediateChild(c,d)}),o;if(s){const c=compoundWriteChildCompoundWrite(i.visibleWrites,e);return s.forEachChild(PRIORITY_INDEX,(d,h)=>{const g=compoundWriteApply(compoundWriteChildCompoundWrite(c,new Path(d)),h);o=o.updateImmediateChild(d,g)}),compoundWriteGetCompleteChildren(c).forEach(d=>{o=o.updateImmediateChild(d.name,d.node)}),o}else{const c=compoundWriteChildCompoundWrite(i.visibleWrites,e);return compoundWriteGetCompleteChildren(c).forEach(d=>{o=o.updateImmediateChild(d.name,d.node)}),o}}function writeTreeCalcEventCacheAfterServerOverwrite(i,e,s,o,a){assert(o||a,"Either existingEventSnap or existingServerSnap must exist");const c=pathChild(e,s);if(compoundWriteHasCompleteWrite(i.visibleWrites,c))return null;{const d=compoundWriteChildCompoundWrite(i.visibleWrites,c);return compoundWriteIsEmpty(d)?a.getChild(s):compoundWriteApply(d,a.getChild(s))}}function writeTreeCalcCompleteChild(i,e,s,o){const a=pathChild(e,s),c=compoundWriteGetCompleteNode(i.visibleWrites,a);if(c!=null)return c;if(o.isCompleteForChild(s)){const d=compoundWriteChildCompoundWrite(i.visibleWrites,a);return compoundWriteApply(d,o.getNode().getImmediateChild(s))}else return null}function writeTreeShadowingWrite(i,e){return compoundWriteGetCompleteNode(i.visibleWrites,e)}function writeTreeCalcIndexedSlice(i,e,s,o,a,c,d){let h;const g=compoundWriteChildCompoundWrite(i.visibleWrites,e),_=compoundWriteGetCompleteNode(g,newEmptyPath());if(_!=null)h=_;else if(s!=null)h=compoundWriteApply(g,s);else return[];if(h=h.withIndex(d),!h.isEmpty()&&!h.isLeafNode()){const ft=[],_t=d.getCompare(),$t=c?h.getReverseIteratorFrom(o,d):h.getIteratorFrom(o,d);let Mt=$t.getNext();for(;Mt&&ft.length<a;)_t(Mt,o)!==0&&ft.push(Mt),Mt=$t.getNext();return ft}else return[]}function newWriteTree(){return{visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1}}function writeTreeRefCalcCompleteEventCache(i,e,s,o){return writeTreeCalcCompleteEventCache(i.writeTree,i.treePath,e,s,o)}function writeTreeRefCalcCompleteEventChildren(i,e){return writeTreeCalcCompleteEventChildren(i.writeTree,i.treePath,e)}function writeTreeRefCalcEventCacheAfterServerOverwrite(i,e,s,o){return writeTreeCalcEventCacheAfterServerOverwrite(i.writeTree,i.treePath,e,s,o)}function writeTreeRefShadowingWrite(i,e){return writeTreeShadowingWrite(i.writeTree,pathChild(i.treePath,e))}function writeTreeRefCalcIndexedSlice(i,e,s,o,a,c){return writeTreeCalcIndexedSlice(i.writeTree,i.treePath,e,s,o,a,c)}function writeTreeRefCalcCompleteChild(i,e,s){return writeTreeCalcCompleteChild(i.writeTree,i.treePath,e,s)}function writeTreeRefChild(i,e){return newWriteTreeRef(pathChild(i.treePath,e),i.writeTree)}function newWriteTreeRef(i,e){return{treePath:i,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ChildChangeAccumulator{constructor(){this.changeMap=new Map}trackChildChange(e){const s=e.type,o=e.childName;assert(s==="child_added"||s==="child_changed"||s==="child_removed","Only child changes supported for tracking"),assert(o!==".priority","Only non-priority child changes can be tracked.");const a=this.changeMap.get(o);if(a){const c=a.type;if(s==="child_added"&&c==="child_removed")this.changeMap.set(o,changeChildChanged(o,e.snapshotNode,a.snapshotNode));else if(s==="child_removed"&&c==="child_added")this.changeMap.delete(o);else if(s==="child_removed"&&c==="child_changed")this.changeMap.set(o,changeChildRemoved(o,a.oldSnap));else if(s==="child_changed"&&c==="child_added")this.changeMap.set(o,changeChildAdded(o,e.snapshotNode));else if(s==="child_changed"&&c==="child_changed")this.changeMap.set(o,changeChildChanged(o,e.snapshotNode,a.oldSnap));else throw assertionError("Illegal combination of changes: "+e+" occurred after "+a)}else this.changeMap.set(o,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NoCompleteChildSource_{getCompleteChild(e){return null}getChildAfterChild(e,s,o){return null}}const NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;class WriteTreeCompleteChildSource{constructor(e,s,o=null){this.writes_=e,this.viewCache_=s,this.optCompleteServerCache_=o}getCompleteChild(e){const s=this.viewCache_.eventCache;if(s.isCompleteForChild(e))return s.getNode().getImmediateChild(e);{const o=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,e,o)}}getChildAfterChild(e,s,o){const a=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),c=writeTreeRefCalcIndexedSlice(this.writes_,a,s,1,o,e);return c.length===0?null:c[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewProcessor(i){return{filter:i}}function viewProcessorAssertIndexed(i,e){assert(e.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),assert(e.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed")}function viewProcessorApplyOperation(i,e,s,o,a){const c=new ChildChangeAccumulator;let d,h;if(s.type===OperationType.OVERWRITE){const _=s;_.source.fromUser?d=viewProcessorApplyUserOverwrite(i,e,_.path,_.snap,o,a,c):(assert(_.source.fromServer,"Unknown source."),h=_.source.tagged||e.serverCache.isFiltered()&&!pathIsEmpty(_.path),d=viewProcessorApplyServerOverwrite(i,e,_.path,_.snap,o,a,h,c))}else if(s.type===OperationType.MERGE){const _=s;_.source.fromUser?d=viewProcessorApplyUserMerge(i,e,_.path,_.children,o,a,c):(assert(_.source.fromServer,"Unknown source."),h=_.source.tagged||e.serverCache.isFiltered(),d=viewProcessorApplyServerMerge(i,e,_.path,_.children,o,a,h,c))}else if(s.type===OperationType.ACK_USER_WRITE){const _=s;_.revert?d=viewProcessorRevertUserWrite(i,e,_.path,o,a,c):d=viewProcessorAckUserWrite(i,e,_.path,_.affectedTree,o,a,c)}else if(s.type===OperationType.LISTEN_COMPLETE)d=viewProcessorListenComplete(i,e,s.path,o,c);else throw assertionError("Unknown operation type: "+s.type);const g=c.getChanges();return viewProcessorMaybeAddValueEvent(e,d,g),{viewCache:d,changes:g}}function viewProcessorMaybeAddValueEvent(i,e,s){const o=e.eventCache;if(o.isFullyInitialized()){const a=o.getNode().isLeafNode()||o.getNode().isEmpty(),c=viewCacheGetCompleteEventSnap(i);(s.length>0||!i.eventCache.isFullyInitialized()||a&&!o.getNode().equals(c)||!o.getNode().getPriority().equals(c.getPriority()))&&s.push(changeValue(viewCacheGetCompleteEventSnap(e)))}}function viewProcessorGenerateEventCacheAfterServerEvent(i,e,s,o,a,c){const d=e.eventCache;if(writeTreeRefShadowingWrite(o,s)!=null)return e;{let h,g;if(pathIsEmpty(s))if(assert(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const _=viewCacheGetCompleteServerSnap(e),ft=_ instanceof ChildrenNode?_:ChildrenNode.EMPTY_NODE,_t=writeTreeRefCalcCompleteEventChildren(o,ft);h=i.filter.updateFullNode(e.eventCache.getNode(),_t,c)}else{const _=writeTreeRefCalcCompleteEventCache(o,viewCacheGetCompleteServerSnap(e));h=i.filter.updateFullNode(e.eventCache.getNode(),_,c)}else{const _=pathGetFront(s);if(_===".priority"){assert(pathGetLength(s)===1,"Can't have a priority with additional path components");const ft=d.getNode();g=e.serverCache.getNode();const _t=writeTreeRefCalcEventCacheAfterServerOverwrite(o,s,ft,g);_t!=null?h=i.filter.updatePriority(ft,_t):h=d.getNode()}else{const ft=pathPopFront(s);let _t;if(d.isCompleteForChild(_)){g=e.serverCache.getNode();const $t=writeTreeRefCalcEventCacheAfterServerOverwrite(o,s,d.getNode(),g);$t!=null?_t=d.getNode().getImmediateChild(_).updateChild(ft,$t):_t=d.getNode().getImmediateChild(_)}else _t=writeTreeRefCalcCompleteChild(o,_,e.serverCache);_t!=null?h=i.filter.updateChild(d.getNode(),_,_t,ft,a,c):h=d.getNode()}}return viewCacheUpdateEventSnap(e,h,d.isFullyInitialized()||pathIsEmpty(s),i.filter.filtersNodes())}}function viewProcessorApplyServerOverwrite(i,e,s,o,a,c,d,h){const g=e.serverCache;let _;const ft=d?i.filter:i.filter.getIndexedFilter();if(pathIsEmpty(s))_=ft.updateFullNode(g.getNode(),o,null);else if(ft.filtersNodes()&&!g.isFiltered()){const Mt=g.getNode().updateChild(s,o);_=ft.updateFullNode(g.getNode(),Mt,null)}else{const Mt=pathGetFront(s);if(!g.isCompleteForPath(s)&&pathGetLength(s)>1)return e;const Ft=pathPopFront(s),Vl=g.getNode().getImmediateChild(Mt).updateChild(Ft,o);Mt===".priority"?_=ft.updatePriority(g.getNode(),Vl):_=ft.updateChild(g.getNode(),Mt,Vl,Ft,NO_COMPLETE_CHILD_SOURCE,null)}const _t=viewCacheUpdateServerSnap(e,_,g.isFullyInitialized()||pathIsEmpty(s),ft.filtersNodes()),$t=new WriteTreeCompleteChildSource(a,_t,c);return viewProcessorGenerateEventCacheAfterServerEvent(i,_t,s,a,$t,h)}function viewProcessorApplyUserOverwrite(i,e,s,o,a,c,d){const h=e.eventCache;let g,_;const ft=new WriteTreeCompleteChildSource(a,e,c);if(pathIsEmpty(s))_=i.filter.updateFullNode(e.eventCache.getNode(),o,d),g=viewCacheUpdateEventSnap(e,_,!0,i.filter.filtersNodes());else{const _t=pathGetFront(s);if(_t===".priority")_=i.filter.updatePriority(e.eventCache.getNode(),o),g=viewCacheUpdateEventSnap(e,_,h.isFullyInitialized(),h.isFiltered());else{const $t=pathPopFront(s),Mt=h.getNode().getImmediateChild(_t);let Ft;if(pathIsEmpty($t))Ft=o;else{const Ol=ft.getCompleteChild(_t);Ol!=null?pathGetBack($t)===".priority"&&Ol.getChild(pathParent($t)).isEmpty()?Ft=Ol:Ft=Ol.updateChild($t,o):Ft=ChildrenNode.EMPTY_NODE}if(Mt.equals(Ft))g=e;else{const Ol=i.filter.updateChild(h.getNode(),_t,Ft,$t,ft,d);g=viewCacheUpdateEventSnap(e,Ol,h.isFullyInitialized(),i.filter.filtersNodes())}}}return g}function viewProcessorCacheHasChild(i,e){return i.eventCache.isCompleteForChild(e)}function viewProcessorApplyUserMerge(i,e,s,o,a,c,d){let h=e;return o.foreach((g,_)=>{const ft=pathChild(s,g);viewProcessorCacheHasChild(e,pathGetFront(ft))&&(h=viewProcessorApplyUserOverwrite(i,h,ft,_,a,c,d))}),o.foreach((g,_)=>{const ft=pathChild(s,g);viewProcessorCacheHasChild(e,pathGetFront(ft))||(h=viewProcessorApplyUserOverwrite(i,h,ft,_,a,c,d))}),h}function viewProcessorApplyMerge(i,e,s){return s.foreach((o,a)=>{e=e.updateChild(o,a)}),e}function viewProcessorApplyServerMerge(i,e,s,o,a,c,d,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let g=e,_;pathIsEmpty(s)?_=o:_=new ImmutableTree(null).setTree(s,o);const ft=e.serverCache.getNode();return _.children.inorderTraversal((_t,$t)=>{if(ft.hasChild(_t)){const Mt=e.serverCache.getNode().getImmediateChild(_t),Ft=viewProcessorApplyMerge(i,Mt,$t);g=viewProcessorApplyServerOverwrite(i,g,new Path(_t),Ft,a,c,d,h)}}),_.children.inorderTraversal((_t,$t)=>{const Mt=!e.serverCache.isCompleteForChild(_t)&&$t.value===null;if(!ft.hasChild(_t)&&!Mt){const Ft=e.serverCache.getNode().getImmediateChild(_t),Ol=viewProcessorApplyMerge(i,Ft,$t);g=viewProcessorApplyServerOverwrite(i,g,new Path(_t),Ol,a,c,d,h)}}),g}function viewProcessorAckUserWrite(i,e,s,o,a,c,d){if(writeTreeRefShadowingWrite(a,s)!=null)return e;const h=e.serverCache.isFiltered(),g=e.serverCache;if(o.value!=null){if(pathIsEmpty(s)&&g.isFullyInitialized()||g.isCompleteForPath(s))return viewProcessorApplyServerOverwrite(i,e,s,g.getNode().getChild(s),a,c,h,d);if(pathIsEmpty(s)){let _=new ImmutableTree(null);return g.getNode().forEachChild(KEY_INDEX,(ft,_t)=>{_=_.set(new Path(ft),_t)}),viewProcessorApplyServerMerge(i,e,s,_,a,c,h,d)}else return e}else{let _=new ImmutableTree(null);return o.foreach((ft,_t)=>{const $t=pathChild(s,ft);g.isCompleteForPath($t)&&(_=_.set(ft,g.getNode().getChild($t)))}),viewProcessorApplyServerMerge(i,e,s,_,a,c,h,d)}}function viewProcessorListenComplete(i,e,s,o,a){const c=e.serverCache,d=viewCacheUpdateServerSnap(e,c.getNode(),c.isFullyInitialized()||pathIsEmpty(s),c.isFiltered());return viewProcessorGenerateEventCacheAfterServerEvent(i,d,s,o,NO_COMPLETE_CHILD_SOURCE,a)}function viewProcessorRevertUserWrite(i,e,s,o,a,c){let d;if(writeTreeRefShadowingWrite(o,s)!=null)return e;{const h=new WriteTreeCompleteChildSource(o,e,a),g=e.eventCache.getNode();let _;if(pathIsEmpty(s)||pathGetFront(s)===".priority"){let ft;if(e.serverCache.isFullyInitialized())ft=writeTreeRefCalcCompleteEventCache(o,viewCacheGetCompleteServerSnap(e));else{const _t=e.serverCache.getNode();assert(_t instanceof ChildrenNode,"serverChildren would be complete if leaf node"),ft=writeTreeRefCalcCompleteEventChildren(o,_t)}ft=ft,_=i.filter.updateFullNode(g,ft,c)}else{const ft=pathGetFront(s);let _t=writeTreeRefCalcCompleteChild(o,ft,e.serverCache);_t==null&&e.serverCache.isCompleteForChild(ft)&&(_t=g.getImmediateChild(ft)),_t!=null?_=i.filter.updateChild(g,ft,_t,pathPopFront(s),h,c):e.eventCache.getNode().hasChild(ft)?_=i.filter.updateChild(g,ft,ChildrenNode.EMPTY_NODE,pathPopFront(s),h,c):_=g,_.isEmpty()&&e.serverCache.isFullyInitialized()&&(d=writeTreeRefCalcCompleteEventCache(o,viewCacheGetCompleteServerSnap(e)),d.isLeafNode()&&(_=i.filter.updateFullNode(_,d,c)))}return d=e.serverCache.isFullyInitialized()||writeTreeRefShadowingWrite(o,newEmptyPath())!=null,viewCacheUpdateEventSnap(e,_,d,i.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class View{constructor(e,s){this.query_=e,this.eventRegistrations_=[];const o=this.query_._queryParams,a=new IndexedFilter(o.getIndex()),c=queryParamsGetNodeFilter(o);this.processor_=newViewProcessor(c);const d=s.serverCache,h=s.eventCache,g=a.updateFullNode(ChildrenNode.EMPTY_NODE,d.getNode(),null),_=c.updateFullNode(ChildrenNode.EMPTY_NODE,h.getNode(),null),ft=new CacheNode(g,d.isFullyInitialized(),a.filtersNodes()),_t=new CacheNode(_,h.isFullyInitialized(),c.filtersNodes());this.viewCache_=newViewCache(_t,ft),this.eventGenerator_=new EventGenerator(this.query_)}get query(){return this.query_}}function viewGetServerCache(i){return i.viewCache_.serverCache.getNode()}function viewGetCompleteNode(i){return viewCacheGetCompleteEventSnap(i.viewCache_)}function viewGetCompleteServerCache(i,e){const s=viewCacheGetCompleteServerSnap(i.viewCache_);return s&&(i.query._queryParams.loadsAllData()||!pathIsEmpty(e)&&!s.getImmediateChild(pathGetFront(e)).isEmpty())?s.getChild(e):null}function viewIsEmpty(i){return i.eventRegistrations_.length===0}function viewAddEventRegistration(i,e){i.eventRegistrations_.push(e)}function viewRemoveEventRegistration(i,e,s){const o=[];if(s){assert(e==null,"A cancel should cancel all event registrations.");const a=i.query._path;i.eventRegistrations_.forEach(c=>{const d=c.createCancelEvent(s,a);d&&o.push(d)})}if(e){let a=[];for(let c=0;c<i.eventRegistrations_.length;++c){const d=i.eventRegistrations_[c];if(!d.matches(e))a.push(d);else if(e.hasAnyCallback()){a=a.concat(i.eventRegistrations_.slice(c+1));break}}i.eventRegistrations_=a}else i.eventRegistrations_=[];return o}function viewApplyOperation(i,e,s,o){e.type===OperationType.MERGE&&e.source.queryId!==null&&(assert(viewCacheGetCompleteServerSnap(i.viewCache_),"We should always have a full cache before handling merges"),assert(viewCacheGetCompleteEventSnap(i.viewCache_),"Missing event cache, even though we have a server cache"));const a=i.viewCache_,c=viewProcessorApplyOperation(i.processor_,a,e,s,o);return viewProcessorAssertIndexed(i.processor_,c.viewCache),assert(c.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),i.viewCache_=c.viewCache,viewGenerateEventsForChanges_(i,c.changes,c.viewCache.eventCache.getNode(),null)}function viewGetInitialEvents(i,e){const s=i.viewCache_.eventCache,o=[];return s.getNode().isLeafNode()||s.getNode().forEachChild(PRIORITY_INDEX,(c,d)=>{o.push(changeChildAdded(c,d))}),s.isFullyInitialized()&&o.push(changeValue(s.getNode())),viewGenerateEventsForChanges_(i,o,s.getNode(),e)}function viewGenerateEventsForChanges_(i,e,s,o){const a=o?[o]:i.eventRegistrations_;return eventGeneratorGenerateEventsForChanges(i.eventGenerator_,e,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor$1;class SyncPoint{constructor(){this.views=new Map}}function syncPointSetReferenceConstructor(i){assert(!referenceConstructor$1,"__referenceConstructor has already been defined"),referenceConstructor$1=i}function syncPointGetReferenceConstructor(){return assert(referenceConstructor$1,"Reference.ts has not been loaded"),referenceConstructor$1}function syncPointIsEmpty(i){return i.views.size===0}function syncPointApplyOperation(i,e,s,o){const a=e.source.queryId;if(a!==null){const c=i.views.get(a);return assert(c!=null,"SyncTree gave us an op for an invalid query."),viewApplyOperation(c,e,s,o)}else{let c=[];for(const d of i.views.values())c=c.concat(viewApplyOperation(d,e,s,o));return c}}function syncPointGetView(i,e,s,o,a){const c=e._queryIdentifier,d=i.views.get(c);if(!d){let h=writeTreeRefCalcCompleteEventCache(s,a?o:null),g=!1;h?g=!0:o instanceof ChildrenNode?(h=writeTreeRefCalcCompleteEventChildren(s,o),g=!1):(h=ChildrenNode.EMPTY_NODE,g=!1);const _=newViewCache(new CacheNode(h,g,!1),new CacheNode(o,a,!1));return new View(e,_)}return d}function syncPointAddEventRegistration(i,e,s,o,a,c){const d=syncPointGetView(i,e,o,a,c);return i.views.has(e._queryIdentifier)||i.views.set(e._queryIdentifier,d),viewAddEventRegistration(d,s),viewGetInitialEvents(d,s)}function syncPointRemoveEventRegistration(i,e,s,o){const a=e._queryIdentifier,c=[];let d=[];const h=syncPointHasCompleteView(i);if(a==="default")for(const[g,_]of i.views.entries())d=d.concat(viewRemoveEventRegistration(_,s,o)),viewIsEmpty(_)&&(i.views.delete(g),_.query._queryParams.loadsAllData()||c.push(_.query));else{const g=i.views.get(a);g&&(d=d.concat(viewRemoveEventRegistration(g,s,o)),viewIsEmpty(g)&&(i.views.delete(a),g.query._queryParams.loadsAllData()||c.push(g.query)))}return h&&!syncPointHasCompleteView(i)&&c.push(new(syncPointGetReferenceConstructor())(e._repo,e._path)),{removed:c,events:d}}function syncPointGetQueryViews(i){const e=[];for(const s of i.views.values())s.query._queryParams.loadsAllData()||e.push(s);return e}function syncPointGetCompleteServerCache(i,e){let s=null;for(const o of i.views.values())s=s||viewGetCompleteServerCache(o,e);return s}function syncPointViewForQuery(i,e){if(e._queryParams.loadsAllData())return syncPointGetCompleteView(i);{const o=e._queryIdentifier;return i.views.get(o)}}function syncPointViewExistsForQuery(i,e){return syncPointViewForQuery(i,e)!=null}function syncPointHasCompleteView(i){return syncPointGetCompleteView(i)!=null}function syncPointGetCompleteView(i){for(const e of i.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor;function syncTreeSetReferenceConstructor(i){assert(!referenceConstructor,"__referenceConstructor has already been defined"),referenceConstructor=i}function syncTreeGetReferenceConstructor(){return assert(referenceConstructor,"Reference.ts has not been loaded"),referenceConstructor}let syncTreeNextQueryTag_=1;class SyncTree{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_=newWriteTree(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function syncTreeApplyUserOverwrite(i,e,s,o,a){return writeTreeAddOverwrite(i.pendingWriteTree_,e,s,o,a),a?syncTreeApplyOperationToSyncPoints_(i,new Overwrite(newOperationSourceUser(),e,s)):[]}function syncTreeApplyUserMerge(i,e,s,o){writeTreeAddMerge(i.pendingWriteTree_,e,s,o);const a=ImmutableTree.fromObject(s);return syncTreeApplyOperationToSyncPoints_(i,new Merge(newOperationSourceUser(),e,a))}function syncTreeAckUserWrite(i,e,s=!1){const o=writeTreeGetWrite(i.pendingWriteTree_,e);if(writeTreeRemoveWrite(i.pendingWriteTree_,e)){let c=new ImmutableTree(null);return o.snap!=null?c=c.set(newEmptyPath(),!0):each(o.children,d=>{c=c.set(new Path(d),!0)}),syncTreeApplyOperationToSyncPoints_(i,new AckUserWrite(o.path,c,s))}else return[]}function syncTreeApplyServerOverwrite(i,e,s){return syncTreeApplyOperationToSyncPoints_(i,new Overwrite(newOperationSourceServer(),e,s))}function syncTreeApplyServerMerge(i,e,s){const o=ImmutableTree.fromObject(s);return syncTreeApplyOperationToSyncPoints_(i,new Merge(newOperationSourceServer(),e,o))}function syncTreeApplyListenComplete(i,e){return syncTreeApplyOperationToSyncPoints_(i,new ListenComplete(newOperationSourceServer(),e))}function syncTreeApplyTaggedListenComplete(i,e,s){const o=syncTreeQueryKeyForTag_(i,s);if(o){const a=syncTreeParseQueryKey_(o),c=a.path,d=a.queryId,h=newRelativePath(c,e),g=new ListenComplete(newOperationSourceServerTaggedQuery(d),h);return syncTreeApplyTaggedOperation_(i,c,g)}else return[]}function syncTreeRemoveEventRegistration(i,e,s,o,a=!1){const c=e._path,d=i.syncPointTree_.get(c);let h=[];if(d&&(e._queryIdentifier==="default"||syncPointViewExistsForQuery(d,e))){const g=syncPointRemoveEventRegistration(d,e,s,o);syncPointIsEmpty(d)&&(i.syncPointTree_=i.syncPointTree_.remove(c));const _=g.removed;if(h=g.events,!a){const ft=_.findIndex($t=>$t._queryParams.loadsAllData())!==-1,_t=i.syncPointTree_.findOnPath(c,($t,Mt)=>syncPointHasCompleteView(Mt));if(ft&&!_t){const $t=i.syncPointTree_.subtree(c);if(!$t.isEmpty()){const Mt=syncTreeCollectDistinctViewsForSubTree_($t);for(let Ft=0;Ft<Mt.length;++Ft){const Ol=Mt[Ft],Vl=Ol.query,Nl=syncTreeCreateListenerForView_(i,Ol);i.listenProvider_.startListening(syncTreeQueryForListening_(Vl),syncTreeTagForQuery(i,Vl),Nl.hashFn,Nl.onComplete)}}}!_t&&_.length>0&&!o&&(ft?i.listenProvider_.stopListening(syncTreeQueryForListening_(e),null):_.forEach($t=>{const Mt=i.queryToTagMap.get(syncTreeMakeQueryKey_($t));i.listenProvider_.stopListening(syncTreeQueryForListening_($t),Mt)}))}syncTreeRemoveTags_(i,_)}return h}function syncTreeApplyTaggedQueryOverwrite(i,e,s,o){const a=syncTreeQueryKeyForTag_(i,o);if(a!=null){const c=syncTreeParseQueryKey_(a),d=c.path,h=c.queryId,g=newRelativePath(d,e),_=new Overwrite(newOperationSourceServerTaggedQuery(h),g,s);return syncTreeApplyTaggedOperation_(i,d,_)}else return[]}function syncTreeApplyTaggedQueryMerge(i,e,s,o){const a=syncTreeQueryKeyForTag_(i,o);if(a){const c=syncTreeParseQueryKey_(a),d=c.path,h=c.queryId,g=newRelativePath(d,e),_=ImmutableTree.fromObject(s),ft=new Merge(newOperationSourceServerTaggedQuery(h),g,_);return syncTreeApplyTaggedOperation_(i,d,ft)}else return[]}function syncTreeAddEventRegistration(i,e,s,o=!1){const a=e._path;let c=null,d=!1;i.syncPointTree_.foreachOnPath(a,($t,Mt)=>{const Ft=newRelativePath($t,a);c=c||syncPointGetCompleteServerCache(Mt,Ft),d=d||syncPointHasCompleteView(Mt)});let h=i.syncPointTree_.get(a);h?(d=d||syncPointHasCompleteView(h),c=c||syncPointGetCompleteServerCache(h,newEmptyPath())):(h=new SyncPoint,i.syncPointTree_=i.syncPointTree_.set(a,h));let g;c!=null?g=!0:(g=!1,c=ChildrenNode.EMPTY_NODE,i.syncPointTree_.subtree(a).foreachChild((Mt,Ft)=>{const Ol=syncPointGetCompleteServerCache(Ft,newEmptyPath());Ol&&(c=c.updateImmediateChild(Mt,Ol))}));const _=syncPointViewExistsForQuery(h,e);if(!_&&!e._queryParams.loadsAllData()){const $t=syncTreeMakeQueryKey_(e);assert(!i.queryToTagMap.has($t),"View does not exist, but we have a tag");const Mt=syncTreeGetNextQueryTag_();i.queryToTagMap.set($t,Mt),i.tagToQueryMap.set(Mt,$t)}const ft=writeTreeChildWrites(i.pendingWriteTree_,a);let _t=syncPointAddEventRegistration(h,e,s,ft,c,g);if(!_&&!d&&!o){const $t=syncPointViewForQuery(h,e);_t=_t.concat(syncTreeSetupListener_(i,e,$t))}return _t}function syncTreeCalcCompleteEventCache(i,e,s){const a=i.pendingWriteTree_,c=i.syncPointTree_.findOnPath(e,(d,h)=>{const g=newRelativePath(d,e),_=syncPointGetCompleteServerCache(h,g);if(_)return _});return writeTreeCalcCompleteEventCache(a,e,c,s,!0)}function syncTreeGetServerValue(i,e){const s=e._path;let o=null;i.syncPointTree_.foreachOnPath(s,(_,ft)=>{const _t=newRelativePath(_,s);o=o||syncPointGetCompleteServerCache(ft,_t)});let a=i.syncPointTree_.get(s);a?o=o||syncPointGetCompleteServerCache(a,newEmptyPath()):(a=new SyncPoint,i.syncPointTree_=i.syncPointTree_.set(s,a));const c=o!=null,d=c?new CacheNode(o,!0,!1):null,h=writeTreeChildWrites(i.pendingWriteTree_,e._path),g=syncPointGetView(a,e,h,c?d.getNode():ChildrenNode.EMPTY_NODE,c);return viewGetCompleteNode(g)}function syncTreeApplyOperationToSyncPoints_(i,e){return syncTreeApplyOperationHelper_(e,i.syncPointTree_,null,writeTreeChildWrites(i.pendingWriteTree_,newEmptyPath()))}function syncTreeApplyOperationHelper_(i,e,s,o){if(pathIsEmpty(i.path))return syncTreeApplyOperationDescendantsHelper_(i,e,s,o);{const a=e.get(newEmptyPath());s==null&&a!=null&&(s=syncPointGetCompleteServerCache(a,newEmptyPath()));let c=[];const d=pathGetFront(i.path),h=i.operationForChild(d),g=e.children.get(d);if(g&&h){const _=s?s.getImmediateChild(d):null,ft=writeTreeRefChild(o,d);c=c.concat(syncTreeApplyOperationHelper_(h,g,_,ft))}return a&&(c=c.concat(syncPointApplyOperation(a,i,o,s))),c}}function syncTreeApplyOperationDescendantsHelper_(i,e,s,o){const a=e.get(newEmptyPath());s==null&&a!=null&&(s=syncPointGetCompleteServerCache(a,newEmptyPath()));let c=[];return e.children.inorderTraversal((d,h)=>{const g=s?s.getImmediateChild(d):null,_=writeTreeRefChild(o,d),ft=i.operationForChild(d);ft&&(c=c.concat(syncTreeApplyOperationDescendantsHelper_(ft,h,g,_)))}),a&&(c=c.concat(syncPointApplyOperation(a,i,o,s))),c}function syncTreeCreateListenerForView_(i,e){const s=e.query,o=syncTreeTagForQuery(i,s);return{hashFn:()=>(viewGetServerCache(e)||ChildrenNode.EMPTY_NODE).hash(),onComplete:a=>{if(a==="ok")return o?syncTreeApplyTaggedListenComplete(i,s._path,o):syncTreeApplyListenComplete(i,s._path);{const c=errorForServerCode(a,s);return syncTreeRemoveEventRegistration(i,s,null,c)}}}}function syncTreeTagForQuery(i,e){const s=syncTreeMakeQueryKey_(e);return i.queryToTagMap.get(s)}function syncTreeMakeQueryKey_(i){return i._path.toString()+"$"+i._queryIdentifier}function syncTreeQueryKeyForTag_(i,e){return i.tagToQueryMap.get(e)}function syncTreeParseQueryKey_(i){const e=i.indexOf("$");return assert(e!==-1&&e<i.length-1,"Bad queryKey."),{queryId:i.substr(e+1),path:new Path(i.substr(0,e))}}function syncTreeApplyTaggedOperation_(i,e,s){const o=i.syncPointTree_.get(e);assert(o,"Missing sync point for query tag that we're tracking");const a=writeTreeChildWrites(i.pendingWriteTree_,e);return syncPointApplyOperation(o,s,a,null)}function syncTreeCollectDistinctViewsForSubTree_(i){return i.fold((e,s,o)=>{if(s&&syncPointHasCompleteView(s))return[syncPointGetCompleteView(s)];{let a=[];return s&&(a=syncPointGetQueryViews(s)),each(o,(c,d)=>{a=a.concat(d)}),a}})}function syncTreeQueryForListening_(i){return i._queryParams.loadsAllData()&&!i._queryParams.isDefault()?new(syncTreeGetReferenceConstructor())(i._repo,i._path):i}function syncTreeRemoveTags_(i,e){for(let s=0;s<e.length;++s){const o=e[s];if(!o._queryParams.loadsAllData()){const a=syncTreeMakeQueryKey_(o),c=i.queryToTagMap.get(a);i.queryToTagMap.delete(a),i.tagToQueryMap.delete(c)}}}function syncTreeGetNextQueryTag_(){return syncTreeNextQueryTag_++}function syncTreeSetupListener_(i,e,s){const o=e._path,a=syncTreeTagForQuery(i,e),c=syncTreeCreateListenerForView_(i,s),d=i.listenProvider_.startListening(syncTreeQueryForListening_(e),a,c.hashFn,c.onComplete),h=i.syncPointTree_.subtree(o);if(a)assert(!syncPointHasCompleteView(h.value),"If we're adding a query, it shouldn't be shadowed");else{const g=h.fold((_,ft,_t)=>{if(!pathIsEmpty(_)&&ft&&syncPointHasCompleteView(ft))return[syncPointGetCompleteView(ft).query];{let $t=[];return ft&&($t=$t.concat(syncPointGetQueryViews(ft).map(Mt=>Mt.query))),each(_t,(Mt,Ft)=>{$t=$t.concat(Ft)}),$t}});for(let _=0;_<g.length;++_){const ft=g[_];i.listenProvider_.stopListening(syncTreeQueryForListening_(ft),syncTreeTagForQuery(i,ft))}}return d}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistingValueProvider{constructor(e){this.node_=e}getImmediateChild(e){const s=this.node_.getImmediateChild(e);return new ExistingValueProvider(s)}node(){return this.node_}}class DeferredValueProvider{constructor(e,s){this.syncTree_=e,this.path_=s}getImmediateChild(e){const s=pathChild(this.path_,e);return new DeferredValueProvider(this.syncTree_,s)}node(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)}}const generateWithValues=function(i){return i=i||{},i.timestamp=i.timestamp||new Date().getTime(),i},resolveDeferredLeafValue=function(i,e,s){if(!i||typeof i!="object")return i;if(assert(".sv"in i,"Unexpected leaf node or priority contents"),typeof i[".sv"]=="string")return resolveScalarDeferredValue(i[".sv"],e,s);if(typeof i[".sv"]=="object")return resolveComplexDeferredValue(i[".sv"],e);assert(!1,"Unexpected server value: "+JSON.stringify(i,null,2))},resolveScalarDeferredValue=function(i,e,s){switch(i){case"timestamp":return s.timestamp;default:assert(!1,"Unexpected server value: "+i)}},resolveComplexDeferredValue=function(i,e,s){i.hasOwnProperty("increment")||assert(!1,"Unexpected server value: "+JSON.stringify(i,null,2));const o=i.increment;typeof o!="number"&&assert(!1,"Unexpected increment value: "+o);const a=e.node();if(assert(a!==null&&typeof a<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return o;const d=a.getValue();return typeof d!="number"?o:d+o},resolveDeferredValueTree=function(i,e,s,o){return resolveDeferredValue(e,new DeferredValueProvider(s,i),o)},resolveDeferredValueSnapshot=function(i,e,s){return resolveDeferredValue(i,new ExistingValueProvider(e),s)};function resolveDeferredValue(i,e,s){const o=i.getPriority().val(),a=resolveDeferredLeafValue(o,e.getImmediateChild(".priority"),s);let c;if(i.isLeafNode()){const d=i,h=resolveDeferredLeafValue(d.getValue(),e,s);return h!==d.getValue()||a!==d.getPriority().val()?new LeafNode(h,nodeFromJSON(a)):i}else{const d=i;return c=d,a!==d.getPriority().val()&&(c=c.updatePriority(new LeafNode(a))),d.forEachChild(PRIORITY_INDEX,(h,g)=>{const _=resolveDeferredValue(g,e.getImmediateChild(h),s);_!==g&&(c=c.updateImmediateChild(h,_))}),c}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tree{constructor(e="",s=null,o={children:{},childCount:0}){this.name=e,this.parent=s,this.node=o}}function treeSubTree(i,e){let s=e instanceof Path?e:new Path(e),o=i,a=pathGetFront(s);for(;a!==null;){const c=safeGet(o.node.children,a)||{children:{},childCount:0};o=new Tree(a,o,c),s=pathPopFront(s),a=pathGetFront(s)}return o}function treeGetValue(i){return i.node.value}function treeSetValue(i,e){i.node.value=e,treeUpdateParents(i)}function treeHasChildren(i){return i.node.childCount>0}function treeIsEmpty(i){return treeGetValue(i)===void 0&&!treeHasChildren(i)}function treeForEachChild(i,e){each(i.node.children,(s,o)=>{e(new Tree(s,i,o))})}function treeForEachDescendant(i,e,s,o){s&&!o&&e(i),treeForEachChild(i,a=>{treeForEachDescendant(a,e,!0,o)}),s&&o&&e(i)}function treeForEachAncestor(i,e,s){let o=s?i:i.parent;for(;o!==null;){if(e(o))return!0;o=o.parent}return!1}function treeGetPath(i){return new Path(i.parent===null?i.name:treeGetPath(i.parent)+"/"+i.name)}function treeUpdateParents(i){i.parent!==null&&treeUpdateChild(i.parent,i.name,i)}function treeUpdateChild(i,e,s){const o=treeIsEmpty(s),a=contains(i.node.children,e);o&&a?(delete i.node.children[e],i.node.childCount--,treeUpdateParents(i)):!o&&!a&&(i.node.children[e]=s.node,i.node.childCount++,treeUpdateParents(i))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey=function(i){return typeof i=="string"&&i.length!==0&&!INVALID_KEY_REGEX_.test(i)},isValidPathString=function(i){return typeof i=="string"&&i.length!==0&&!INVALID_PATH_REGEX_.test(i)},isValidRootPathString=function(i){return i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(i)},isValidPriority=function(i){return i===null||typeof i=="string"||typeof i=="number"&&!isInvalidJSONNumber(i)||i&&typeof i=="object"&&contains(i,".sv")},validateFirebaseDataArg=function(i,e,s,o){o&&e===void 0||validateFirebaseData(errorPrefix(i,"value"),e,s)},validateFirebaseData=function(i,e,s){const o=s instanceof Path?new ValidationPath(s,i):s;if(e===void 0)throw new Error(i+"contains undefined "+validationPathToErrorString(o));if(typeof e=="function")throw new Error(i+"contains a function "+validationPathToErrorString(o)+" with contents = "+e.toString());if(isInvalidJSONNumber(e))throw new Error(i+"contains "+e.toString()+" "+validationPathToErrorString(o));if(typeof e=="string"&&e.length>MAX_LEAF_SIZE_/3&&stringLength(e)>MAX_LEAF_SIZE_)throw new Error(i+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+validationPathToErrorString(o)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let a=!1,c=!1;if(each(e,(d,h)=>{if(d===".value")a=!0;else if(d!==".priority"&&d!==".sv"&&(c=!0,!isValidKey(d)))throw new Error(i+" contains an invalid key ("+d+") "+validationPathToErrorString(o)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);validationPathPush(o,d),validateFirebaseData(i,h,o),validationPathPop(o)}),a&&c)throw new Error(i+' contains ".value" child '+validationPathToErrorString(o)+" in addition to actual children.")}},validateFirebaseMergePaths=function(i,e){let s,o;for(s=0;s<e.length;s++){o=e[s];const c=pathSlice(o);for(let d=0;d<c.length;d++)if(!(c[d]===".priority"&&d===c.length-1)){if(!isValidKey(c[d]))throw new Error(i+"contains an invalid key ("+c[d]+") in path "+o.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(pathCompare);let a=null;for(s=0;s<e.length;s++){if(o=e[s],a!==null&&pathContains(a,o))throw new Error(i+"contains a path "+a.toString()+" that is ancestor of another path "+o.toString());a=o}},validateFirebaseMergeDataArg=function(i,e,s,o){if(o&&e===void 0)return;const a=errorPrefix(i,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(a+" must be an object containing the children to replace.");const c=[];each(e,(d,h)=>{const g=new Path(d);if(validateFirebaseData(a,h,pathChild(s,g)),pathGetBack(g)===".priority"&&!isValidPriority(h))throw new Error(a+"contains an invalid value for '"+g.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");c.push(g)}),validateFirebaseMergePaths(a,c)},validatePriority=function(i,e,s){if(!(s&&e===void 0)){if(isInvalidJSONNumber(e))throw new Error(errorPrefix(i,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!isValidPriority(e))throw new Error(errorPrefix(i,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},validateKey=function(i,e,s,o){if(!(o&&s===void 0)&&!isValidKey(s))throw new Error(errorPrefix(i,e)+'was an invalid key = "'+s+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},validatePathString=function(i,e,s,o){if(!(o&&s===void 0)&&!isValidPathString(s))throw new Error(errorPrefix(i,e)+'was an invalid path = "'+s+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},validateRootPathString=function(i,e,s,o){s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(i,e,s,o)},validateWritablePath=function(i,e){if(pathGetFront(e)===".info")throw new Error(i+" failed = Can't modify data under /.info/")},validateUrl=function(i,e){const s=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!isValidKey(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||s.length!==0&&!isValidRootPathString(s))throw new Error(errorPrefix(i,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventQueue{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eventQueueQueueEvents(i,e){let s=null;for(let o=0;o<e.length;o++){const a=e[o],c=a.getPath();s!==null&&!pathEquals(c,s.path)&&(i.eventLists_.push(s),s=null),s===null&&(s={events:[],path:c}),s.events.push(a)}s&&i.eventLists_.push(s)}function eventQueueRaiseEventsAtPath(i,e,s){eventQueueQueueEvents(i,s),eventQueueRaiseQueuedEventsMatchingPredicate(i,o=>pathEquals(o,e))}function eventQueueRaiseEventsForChangedPath(i,e,s){eventQueueQueueEvents(i,s),eventQueueRaiseQueuedEventsMatchingPredicate(i,o=>pathContains(o,e)||pathContains(e,o))}function eventQueueRaiseQueuedEventsMatchingPredicate(i,e){i.recursionDepth_++;let s=!0;for(let o=0;o<i.eventLists_.length;o++){const a=i.eventLists_[o];if(a){const c=a.path;e(c)?(eventListRaise(i.eventLists_[o]),i.eventLists_[o]=null):s=!1}}s&&(i.eventLists_=[]),i.recursionDepth_--}function eventListRaise(i){for(let e=0;e<i.events.length;e++){const s=i.events[e];if(s!==null){i.events[e]=null;const o=s.getEventRunner();logger&&log("event: "+s.toString()),exceptionGuard(o)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INTERRUPT_REASON="repo_interrupt",MAX_TRANSACTION_RETRIES=25;class Repo{constructor(e,s,o,a){this.repoInfo_=e,this.forceRestClient_=s,this.authTokenProvider_=o,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function repoStart(i,e,s){if(i.stats_=statsManagerGetCollection(i.repoInfo_),i.forceRestClient_||beingCrawled())i.server_=new ReadonlyRestClient(i.repoInfo_,(o,a,c,d)=>{repoOnDataUpdate(i,o,a,c,d)},i.authTokenProvider_,i.appCheckProvider_),setTimeout(()=>repoOnConnectStatus(i,!0),0);else{if(typeof s<"u"&&s!==null){if(typeof s!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(s)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}i.persistentConnection_=new PersistentConnection(i.repoInfo_,e,(o,a,c,d)=>{repoOnDataUpdate(i,o,a,c,d)},o=>{repoOnConnectStatus(i,o)},o=>{repoOnServerInfoUpdate(i,o)},i.authTokenProvider_,i.appCheckProvider_,s),i.server_=i.persistentConnection_}i.authTokenProvider_.addTokenChangeListener(o=>{i.server_.refreshAuthToken(o)}),i.appCheckProvider_.addTokenChangeListener(o=>{i.server_.refreshAppCheckToken(o.token)}),i.statsReporter_=statsManagerGetOrCreateReporter(i.repoInfo_,()=>new StatsReporter(i.stats_,i.server_)),i.infoData_=new SnapshotHolder,i.infoSyncTree_=new SyncTree({startListening:(o,a,c,d)=>{let h=[];const g=i.infoData_.getNode(o._path);return g.isEmpty()||(h=syncTreeApplyServerOverwrite(i.infoSyncTree_,o._path,g),setTimeout(()=>{d("ok")},0)),h},stopListening:()=>{}}),repoUpdateInfo(i,"connected",!1),i.serverSyncTree_=new SyncTree({startListening:(o,a,c,d)=>(i.server_.listen(o,c,a,(h,g)=>{const _=d(h,g);eventQueueRaiseEventsForChangedPath(i.eventQueue_,o._path,_)}),[]),stopListening:(o,a)=>{i.server_.unlisten(o,a)}})}function repoServerTime(i){const s=i.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return new Date().getTime()+s}function repoGenerateServerValues(i){return generateWithValues({timestamp:repoServerTime(i)})}function repoOnDataUpdate(i,e,s,o,a){i.dataUpdateCount++;const c=new Path(e);s=i.interceptServerDataCallback_?i.interceptServerDataCallback_(e,s):s;let d=[];if(a)if(o){const g=map(s,_=>nodeFromJSON(_));d=syncTreeApplyTaggedQueryMerge(i.serverSyncTree_,c,g,a)}else{const g=nodeFromJSON(s);d=syncTreeApplyTaggedQueryOverwrite(i.serverSyncTree_,c,g,a)}else if(o){const g=map(s,_=>nodeFromJSON(_));d=syncTreeApplyServerMerge(i.serverSyncTree_,c,g)}else{const g=nodeFromJSON(s);d=syncTreeApplyServerOverwrite(i.serverSyncTree_,c,g)}let h=c;d.length>0&&(h=repoRerunTransactions(i,c)),eventQueueRaiseEventsForChangedPath(i.eventQueue_,h,d)}function repoOnConnectStatus(i,e){repoUpdateInfo(i,"connected",e),e===!1&&repoRunOnDisconnectEvents(i)}function repoOnServerInfoUpdate(i,e){each(e,(s,o)=>{repoUpdateInfo(i,s,o)})}function repoUpdateInfo(i,e,s){const o=new Path("/.info/"+e),a=nodeFromJSON(s);i.infoData_.updateSnapshot(o,a);const c=syncTreeApplyServerOverwrite(i.infoSyncTree_,o,a);eventQueueRaiseEventsForChangedPath(i.eventQueue_,o,c)}function repoGetNextWriteId(i){return i.nextWriteId_++}function repoGetValue(i,e,s){const o=syncTreeGetServerValue(i.serverSyncTree_,e);return o!=null?Promise.resolve(o):i.server_.get(e).then(a=>{const c=nodeFromJSON(a).withIndex(e._queryParams.getIndex());syncTreeAddEventRegistration(i.serverSyncTree_,e,s,!0);let d;if(e._queryParams.loadsAllData())d=syncTreeApplyServerOverwrite(i.serverSyncTree_,e._path,c);else{const h=syncTreeTagForQuery(i.serverSyncTree_,e);d=syncTreeApplyTaggedQueryOverwrite(i.serverSyncTree_,e._path,c,h)}return eventQueueRaiseEventsForChangedPath(i.eventQueue_,e._path,d),syncTreeRemoveEventRegistration(i.serverSyncTree_,e,s,null,!0),c},a=>(repoLog(i,"get for query "+stringify(e)+" failed: "+a),Promise.reject(new Error(a))))}function repoSetWithPriority(i,e,s,o,a){repoLog(i,"set",{path:e.toString(),value:s,priority:o});const c=repoGenerateServerValues(i),d=nodeFromJSON(s,o),h=syncTreeCalcCompleteEventCache(i.serverSyncTree_,e),g=resolveDeferredValueSnapshot(d,h,c),_=repoGetNextWriteId(i),ft=syncTreeApplyUserOverwrite(i.serverSyncTree_,e,g,_,!0);eventQueueQueueEvents(i.eventQueue_,ft),i.server_.put(e.toString(),d.val(!0),($t,Mt)=>{const Ft=$t==="ok";Ft||warn$1("set at "+e+" failed: "+$t);const Ol=syncTreeAckUserWrite(i.serverSyncTree_,_,!Ft);eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,Ol),repoCallOnCompleteCallback(i,a,$t,Mt)});const _t=repoAbortTransactions(i,e);repoRerunTransactions(i,_t),eventQueueRaiseEventsForChangedPath(i.eventQueue_,_t,[])}function repoUpdate(i,e,s,o){repoLog(i,"update",{path:e.toString(),value:s});let a=!0;const c=repoGenerateServerValues(i),d={};if(each(s,(h,g)=>{a=!1,d[h]=resolveDeferredValueTree(pathChild(e,h),nodeFromJSON(g),i.serverSyncTree_,c)}),a)log("update() called with empty data.  Don't do anything."),repoCallOnCompleteCallback(i,o,"ok",void 0);else{const h=repoGetNextWriteId(i),g=syncTreeApplyUserMerge(i.serverSyncTree_,e,d,h);eventQueueQueueEvents(i.eventQueue_,g),i.server_.merge(e.toString(),s,(_,ft)=>{const _t=_==="ok";_t||warn$1("update at "+e+" failed: "+_);const $t=syncTreeAckUserWrite(i.serverSyncTree_,h,!_t),Mt=$t.length>0?repoRerunTransactions(i,e):e;eventQueueRaiseEventsForChangedPath(i.eventQueue_,Mt,$t),repoCallOnCompleteCallback(i,o,_,ft)}),each(s,_=>{const ft=repoAbortTransactions(i,pathChild(e,_));repoRerunTransactions(i,ft)}),eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,[])}}function repoRunOnDisconnectEvents(i){repoLog(i,"onDisconnectEvents");const e=repoGenerateServerValues(i),s=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(i.onDisconnect_,newEmptyPath(),(a,c)=>{const d=resolveDeferredValueTree(a,c,i.serverSyncTree_,e);sparseSnapshotTreeRemember(s,a,d)});let o=[];sparseSnapshotTreeForEachTree(s,newEmptyPath(),(a,c)=>{o=o.concat(syncTreeApplyServerOverwrite(i.serverSyncTree_,a,c));const d=repoAbortTransactions(i,a);repoRerunTransactions(i,d)}),i.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(i.eventQueue_,newEmptyPath(),o)}function repoOnDisconnectCancel(i,e,s){i.server_.onDisconnectCancel(e.toString(),(o,a)=>{o==="ok"&&sparseSnapshotTreeForget(i.onDisconnect_,e),repoCallOnCompleteCallback(i,s,o,a)})}function repoOnDisconnectSet(i,e,s,o){const a=nodeFromJSON(s);i.server_.onDisconnectPut(e.toString(),a.val(!0),(c,d)=>{c==="ok"&&sparseSnapshotTreeRemember(i.onDisconnect_,e,a),repoCallOnCompleteCallback(i,o,c,d)})}function repoOnDisconnectSetWithPriority(i,e,s,o,a){const c=nodeFromJSON(s,o);i.server_.onDisconnectPut(e.toString(),c.val(!0),(d,h)=>{d==="ok"&&sparseSnapshotTreeRemember(i.onDisconnect_,e,c),repoCallOnCompleteCallback(i,a,d,h)})}function repoOnDisconnectUpdate(i,e,s,o){if(isEmpty(s)){log("onDisconnect().update() called with empty data.  Don't do anything."),repoCallOnCompleteCallback(i,o,"ok",void 0);return}i.server_.onDisconnectMerge(e.toString(),s,(a,c)=>{a==="ok"&&each(s,(d,h)=>{const g=nodeFromJSON(h);sparseSnapshotTreeRemember(i.onDisconnect_,pathChild(e,d),g)}),repoCallOnCompleteCallback(i,o,a,c)})}function repoAddEventCallbackForQuery(i,e,s){let o;pathGetFront(e._path)===".info"?o=syncTreeAddEventRegistration(i.infoSyncTree_,e,s):o=syncTreeAddEventRegistration(i.serverSyncTree_,e,s),eventQueueRaiseEventsAtPath(i.eventQueue_,e._path,o)}function repoRemoveEventCallbackForQuery(i,e,s){let o;pathGetFront(e._path)===".info"?o=syncTreeRemoveEventRegistration(i.infoSyncTree_,e,s):o=syncTreeRemoveEventRegistration(i.serverSyncTree_,e,s),eventQueueRaiseEventsAtPath(i.eventQueue_,e._path,o)}function repoInterrupt(i){i.persistentConnection_&&i.persistentConnection_.interrupt(INTERRUPT_REASON)}function repoResume(i){i.persistentConnection_&&i.persistentConnection_.resume(INTERRUPT_REASON)}function repoLog(i,...e){let s="";i.persistentConnection_&&(s=i.persistentConnection_.id+":"),log(s,...e)}function repoCallOnCompleteCallback(i,e,s,o){e&&exceptionGuard(()=>{if(s==="ok")e(null);else{const a=(s||"error").toUpperCase();let c=a;o&&(c+=": "+o);const d=new Error(c);d.code=a,e(d)}})}function repoStartTransaction(i,e,s,o,a,c){repoLog(i,"transaction on "+e);const d={path:e,update:s,onComplete:o,status:null,order:LUIDGenerator(),applyLocally:c,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=repoGetLatestState(i,e,void 0);d.currentInputSnapshot=h;const g=d.update(h.val());if(g===void 0)d.unwatcher(),d.currentOutputSnapshotRaw=null,d.currentOutputSnapshotResolved=null,d.onComplete&&d.onComplete(null,!1,d.currentInputSnapshot);else{validateFirebaseData("transaction failed: Data returned ",g,d.path),d.status=0;const _=treeSubTree(i.transactionQueueTree_,e),ft=treeGetValue(_)||[];ft.push(d),treeSetValue(_,ft);let _t;typeof g=="object"&&g!==null&&contains(g,".priority")?(_t=safeGet(g,".priority"),assert(isValidPriority(_t),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):_t=(syncTreeCalcCompleteEventCache(i.serverSyncTree_,e)||ChildrenNode.EMPTY_NODE).getPriority().val();const $t=repoGenerateServerValues(i),Mt=nodeFromJSON(g,_t),Ft=resolveDeferredValueSnapshot(Mt,h,$t);d.currentOutputSnapshotRaw=Mt,d.currentOutputSnapshotResolved=Ft,d.currentWriteId=repoGetNextWriteId(i);const Ol=syncTreeApplyUserOverwrite(i.serverSyncTree_,e,Ft,d.currentWriteId,d.applyLocally);eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,Ol),repoSendReadyTransactions(i,i.transactionQueueTree_)}}function repoGetLatestState(i,e,s){return syncTreeCalcCompleteEventCache(i.serverSyncTree_,e,s)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(i,e=i.transactionQueueTree_){if(e||repoPruneCompletedTransactionsBelowNode(i,e),treeGetValue(e)){const s=repoBuildTransactionQueue(i,e);assert(s.length>0,"Sending zero length transaction queue"),s.every(a=>a.status===0)&&repoSendTransactionQueue(i,treeGetPath(e),s)}else treeHasChildren(e)&&treeForEachChild(e,s=>{repoSendReadyTransactions(i,s)})}function repoSendTransactionQueue(i,e,s){const o=s.map(_=>_.currentWriteId),a=repoGetLatestState(i,e,o);let c=a;const d=a.hash();for(let _=0;_<s.length;_++){const ft=s[_];assert(ft.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),ft.status=1,ft.retryCount++;const _t=newRelativePath(e,ft.path);c=c.updateChild(_t,ft.currentOutputSnapshotRaw)}const h=c.val(!0),g=e;i.server_.put(g.toString(),h,_=>{repoLog(i,"transaction put response",{path:g.toString(),status:_});let ft=[];if(_==="ok"){const _t=[];for(let $t=0;$t<s.length;$t++)s[$t].status=2,ft=ft.concat(syncTreeAckUserWrite(i.serverSyncTree_,s[$t].currentWriteId)),s[$t].onComplete&&_t.push(()=>s[$t].onComplete(null,!0,s[$t].currentOutputSnapshotResolved)),s[$t].unwatcher();repoPruneCompletedTransactionsBelowNode(i,treeSubTree(i.transactionQueueTree_,e)),repoSendReadyTransactions(i,i.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,ft);for(let $t=0;$t<_t.length;$t++)exceptionGuard(_t[$t])}else{if(_==="datastale")for(let _t=0;_t<s.length;_t++)s[_t].status===3?s[_t].status=4:s[_t].status=0;else{warn$1("transaction at "+g.toString()+" failed: "+_);for(let _t=0;_t<s.length;_t++)s[_t].status=4,s[_t].abortReason=_}repoRerunTransactions(i,e)}},d)}function repoRerunTransactions(i,e){const s=repoGetAncestorTransactionNode(i,e),o=treeGetPath(s),a=repoBuildTransactionQueue(i,s);return repoRerunTransactionQueue(i,a,o),o}function repoRerunTransactionQueue(i,e,s){if(e.length===0)return;const o=[];let a=[];const d=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const g=e[h],_=newRelativePath(s,g.path);let ft=!1,_t;if(assert(_!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===4)ft=!0,_t=g.abortReason,a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,g.currentWriteId,!0));else if(g.status===0)if(g.retryCount>=MAX_TRANSACTION_RETRIES)ft=!0,_t="maxretry",a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,g.currentWriteId,!0));else{const $t=repoGetLatestState(i,g.path,d);g.currentInputSnapshot=$t;const Mt=e[h].update($t.val());if(Mt!==void 0){validateFirebaseData("transaction failed: Data returned ",Mt,g.path);let Ft=nodeFromJSON(Mt);typeof Mt=="object"&&Mt!=null&&contains(Mt,".priority")||(Ft=Ft.updatePriority($t.getPriority()));const Vl=g.currentWriteId,Nl=repoGenerateServerValues(i),xl=resolveDeferredValueSnapshot(Ft,$t,Nl);g.currentOutputSnapshotRaw=Ft,g.currentOutputSnapshotResolved=xl,g.currentWriteId=repoGetNextWriteId(i),d.splice(d.indexOf(Vl),1),a=a.concat(syncTreeApplyUserOverwrite(i.serverSyncTree_,g.path,xl,g.currentWriteId,g.applyLocally)),a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,Vl,!0))}else ft=!0,_t="nodata",a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,g.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(i.eventQueue_,s,a),a=[],ft&&(e[h].status=2,function($t){setTimeout($t,Math.floor(0))}(e[h].unwatcher),e[h].onComplete&&(_t==="nodata"?o.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):o.push(()=>e[h].onComplete(new Error(_t),!1,null))))}repoPruneCompletedTransactionsBelowNode(i,i.transactionQueueTree_);for(let h=0;h<o.length;h++)exceptionGuard(o[h]);repoSendReadyTransactions(i,i.transactionQueueTree_)}function repoGetAncestorTransactionNode(i,e){let s,o=i.transactionQueueTree_;for(s=pathGetFront(e);s!==null&&treeGetValue(o)===void 0;)o=treeSubTree(o,s),e=pathPopFront(e),s=pathGetFront(e);return o}function repoBuildTransactionQueue(i,e){const s=[];return repoAggregateTransactionQueuesForNode(i,e,s),s.sort((o,a)=>o.order-a.order),s}function repoAggregateTransactionQueuesForNode(i,e,s){const o=treeGetValue(e);if(o)for(let a=0;a<o.length;a++)s.push(o[a]);treeForEachChild(e,a=>{repoAggregateTransactionQueuesForNode(i,a,s)})}function repoPruneCompletedTransactionsBelowNode(i,e){const s=treeGetValue(e);if(s){let o=0;for(let a=0;a<s.length;a++)s[a].status!==2&&(s[o]=s[a],o++);s.length=o,treeSetValue(e,s.length>0?s:void 0)}treeForEachChild(e,o=>{repoPruneCompletedTransactionsBelowNode(i,o)})}function repoAbortTransactions(i,e){const s=treeGetPath(repoGetAncestorTransactionNode(i,e)),o=treeSubTree(i.transactionQueueTree_,e);return treeForEachAncestor(o,a=>{repoAbortTransactionsOnNode(i,a)}),repoAbortTransactionsOnNode(i,o),treeForEachDescendant(o,a=>{repoAbortTransactionsOnNode(i,a)}),s}function repoAbortTransactionsOnNode(i,e){const s=treeGetValue(e);if(s){const o=[];let a=[],c=-1;for(let d=0;d<s.length;d++)s[d].status===3||(s[d].status===1?(assert(c===d-1,"All SENT items should be at beginning of queue."),c=d,s[d].status=3,s[d].abortReason="set"):(assert(s[d].status===0,"Unexpected transaction status in abort"),s[d].unwatcher(),a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,s[d].currentWriteId,!0)),s[d].onComplete&&o.push(s[d].onComplete.bind(null,new Error("set"),!1,null))));c===-1?treeSetValue(e,void 0):s.length=c+1,eventQueueRaiseEventsForChangedPath(i.eventQueue_,treeGetPath(e),a);for(let d=0;d<o.length;d++)exceptionGuard(o[d])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodePath(i){let e="";const s=i.split("/");for(let o=0;o<s.length;o++)if(s[o].length>0){let a=s[o];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch{}e+="/"+a}return e}function decodeQuery(i){const e={};i.charAt(0)==="?"&&(i=i.substring(1));for(const s of i.split("&")){if(s.length===0)continue;const o=s.split("=");o.length===2?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):warn$1(`Invalid query segment '${s}' in query '${i}'`)}return e}const parseRepoInfo=function(i,e){const s=parseDatabaseURL(i),o=s.namespace;s.domain==="firebase.com"&&fatal(s.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!o||o==="undefined")&&s.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),s.secure||warnIfPageIsSecure();const a=s.scheme==="ws"||s.scheme==="wss";return{repoInfo:new RepoInfo(s.host,s.secure,o,a,e,"",o!==s.subdomain),path:new Path(s.pathString)}},parseDatabaseURL=function(i){let e="",s="",o="",a="",c="",d=!0,h="https",g=443;if(typeof i=="string"){let _=i.indexOf("//");_>=0&&(h=i.substring(0,_-1),i=i.substring(_+2));let ft=i.indexOf("/");ft===-1&&(ft=i.length);let _t=i.indexOf("?");_t===-1&&(_t=i.length),e=i.substring(0,Math.min(ft,_t)),ft<_t&&(a=decodePath(i.substring(ft,_t)));const $t=decodeQuery(i.substring(Math.min(i.length,_t)));_=e.indexOf(":"),_>=0?(d=h==="https"||h==="wss",g=parseInt(e.substring(_+1),10)):_=e.length;const Mt=e.slice(0,_);if(Mt.toLowerCase()==="localhost")s="localhost";else if(Mt.split(".").length<=2)s=Mt;else{const Ft=e.indexOf(".");o=e.substring(0,Ft).toLowerCase(),s=e.substring(Ft+1),c=o}"ns"in $t&&(c=$t.ns)}return{host:e,port:g,domain:s,subdomain:o,secure:d,scheme:h,pathString:a,namespace:c}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",nextPushId=function(){let i=0;const e=[];return function(s){const o=s===i;i=s;let a;const c=new Array(8);for(a=7;a>=0;a--)c[a]=PUSH_CHARS.charAt(s%64),s=Math.floor(s/64);assert(s===0,"Cannot push at time == 0");let d=c.join("");if(o){for(a=11;a>=0&&e[a]===63;a--)e[a]=0;e[a]++}else for(a=0;a<12;a++)e[a]=Math.floor(Math.random()*64);for(a=0;a<12;a++)d+=PUSH_CHARS.charAt(e[a]);return assert(d.length===20,"nextPushId: Length should be 20."),d}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataEvent{constructor(e,s,o,a){this.eventType=e,this.eventRegistration=s,this.snapshot=o,this.prevName=a}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+stringify(this.snapshot.exportVal())}}class CancelEvent{constructor(e,s,o){this.eventRegistration=e,this.error=s,this.path=o}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CallbackContext{constructor(e,s){this.snapshotCallback=e,this.cancelCallback=s}onValue(e,s){this.snapshotCallback.call(null,e,s)}onCancel(e){return assert(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OnDisconnect$1=class{constructor(e,s){this._repo=e,this._path=s}cancel(){const e=new Deferred;return repoOnDisconnectCancel(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){validateWritablePath("OnDisconnect.remove",this._path);const e=new Deferred;return repoOnDisconnectSet(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){validateWritablePath("OnDisconnect.set",this._path),validateFirebaseDataArg("OnDisconnect.set",e,this._path,!1);const s=new Deferred;return repoOnDisconnectSet(this._repo,this._path,e,s.wrapCallback(()=>{})),s.promise}setWithPriority(e,s){validateWritablePath("OnDisconnect.setWithPriority",this._path),validateFirebaseDataArg("OnDisconnect.setWithPriority",e,this._path,!1),validatePriority("OnDisconnect.setWithPriority",s,!1);const o=new Deferred;return repoOnDisconnectSetWithPriority(this._repo,this._path,e,s,o.wrapCallback(()=>{})),o.promise}update(e){validateWritablePath("OnDisconnect.update",this._path),validateFirebaseMergeDataArg("OnDisconnect.update",e,this._path,!1);const s=new Deferred;return repoOnDisconnectUpdate(this._repo,this._path,e,s.wrapCallback(()=>{})),s.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryImpl{constructor(e,s,o,a){this._repo=e,this._path=s,this._queryParams=o,this._orderByCalled=a}get key(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)}get ref(){return new ReferenceImpl(this._repo,this._path)}get _queryIdentifier(){const e=queryParamsGetQueryObject(this._queryParams),s=ObjectToUniqueKey(e);return s==="{}"?"default":s}get _queryObject(){return queryParamsGetQueryObject(this._queryParams)}isEqual(e){if(e=getModularInstance(e),!(e instanceof QueryImpl))return!1;const s=this._repo===e._repo,o=pathEquals(this._path,e._path),a=this._queryIdentifier===e._queryIdentifier;return s&&o&&a}toJSON(){return this.toString()}toString(){return this._repo.toString()+pathToUrlEncodedString(this._path)}}function validateNoPreviousOrderByCall(i,e){if(i._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function validateQueryEndpoints(i){let e=null,s=null;if(i.hasStart()&&(e=i.getIndexStartValue()),i.hasEnd()&&(s=i.getIndexEndValue()),i.getIndex()===KEY_INDEX){const o="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",a="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(i.hasStart()){if(i.getIndexStartName()!==MIN_NAME)throw new Error(o);if(typeof e!="string")throw new Error(a)}if(i.hasEnd()){if(i.getIndexEndName()!==MAX_NAME)throw new Error(o);if(typeof s!="string")throw new Error(a)}}else if(i.getIndex()===PRIORITY_INDEX){if(e!=null&&!isValidPriority(e)||s!=null&&!isValidPriority(s))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(assert(i.getIndex()instanceof PathIndex||i.getIndex()===VALUE_INDEX,"unknown index type."),e!=null&&typeof e=="object"||s!=null&&typeof s=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function validateLimit(i){if(i.hasStart()&&i.hasEnd()&&i.hasLimit()&&!i.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ReferenceImpl extends QueryImpl{constructor(e,s){super(e,s,new QueryParams,!1)}get parent(){const e=pathParent(this._path);return e===null?null:new ReferenceImpl(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let DataSnapshot$1=class Mp{constructor(e,s,o){this._node=e,this.ref=s,this._index=o}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const s=new Path(e),o=child$1(this.ref,e);return new Mp(this._node.getChild(s),o,PRIORITY_INDEX)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(o,a)=>e(new Mp(a,child$1(this.ref,o),PRIORITY_INDEX)))}hasChild(e){const s=new Path(e);return!this._node.getChild(s).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ref$2(i,e){return i=getModularInstance(i),i._checkNotDeleted("ref"),e!==void 0?child$1(i._root,e):i._root}function refFromURL$1(i,e){i=getModularInstance(i),i._checkNotDeleted("refFromURL");const s=parseRepoInfo(e,i._repo.repoInfo_.nodeAdmin);validateUrl("refFromURL",s);const o=s.repoInfo;return!i._repo.repoInfo_.isCustomHost()&&o.host!==i._repo.repoInfo_.host&&fatal("refFromURL: Host name does not match the current database: (found "+o.host+" but expected "+i._repo.repoInfo_.host+")"),ref$2(i,s.path.toString())}function child$1(i,e){return i=getModularInstance(i),pathGetFront(i._path)===null?validateRootPathString("child","path",e,!1):validatePathString("child","path",e,!1),new ReferenceImpl(i._repo,pathChild(i._path,e))}function push(i,e){i=getModularInstance(i),validateWritablePath("push",i._path),validateFirebaseDataArg("push",e,i._path,!0);const s=repoServerTime(i._repo),o=nextPushId(s),a=child$1(i,o),c=child$1(i,o);let d;return e!=null?d=set(c,e).then(()=>c):d=Promise.resolve(c),a.then=d.then.bind(d),a.catch=d.then.bind(d,void 0),a}function remove(i){return validateWritablePath("remove",i._path),set(i,null)}function set(i,e){i=getModularInstance(i),validateWritablePath("set",i._path),validateFirebaseDataArg("set",e,i._path,!1);const s=new Deferred;return repoSetWithPriority(i._repo,i._path,e,null,s.wrapCallback(()=>{})),s.promise}function setPriority(i,e){i=getModularInstance(i),validateWritablePath("setPriority",i._path),validatePriority("setPriority",e,!1);const s=new Deferred;return repoSetWithPriority(i._repo,pathChild(i._path,".priority"),e,null,s.wrapCallback(()=>{})),s.promise}function setWithPriority(i,e,s){if(validateWritablePath("setWithPriority",i._path),validateFirebaseDataArg("setWithPriority",e,i._path,!1),validatePriority("setWithPriority",s,!1),i.key===".length"||i.key===".keys")throw"setWithPriority failed: "+i.key+" is a read-only object.";const o=new Deferred;return repoSetWithPriority(i._repo,i._path,e,s,o.wrapCallback(()=>{})),o.promise}function update(i,e){validateFirebaseMergeDataArg("update",e,i._path,!1);const s=new Deferred;return repoUpdate(i._repo,i._path,e,s.wrapCallback(()=>{})),s.promise}function get(i){i=getModularInstance(i);const e=new CallbackContext(()=>{}),s=new ValueEventRegistration(e);return repoGetValue(i._repo,i,s).then(o=>new DataSnapshot$1(o,new ReferenceImpl(i._repo,i._path),i._queryParams.getIndex()))}class ValueEventRegistration{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,s){const o=s._queryParams.getIndex();return new DataEvent("value",this,new DataSnapshot$1(e.snapshotNode,new ReferenceImpl(s._repo,s._path),o))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,s){return this.callbackContext.hasCancelCallback?new CancelEvent(this,e,s):null}matches(e){return e instanceof ValueEventRegistration?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class ChildEventRegistration{constructor(e,s){this.eventType=e,this.callbackContext=s}respondsTo(e){let s=e==="children_added"?"child_added":e;return s=s==="children_removed"?"child_removed":s,this.eventType===s}createCancelEvent(e,s){return this.callbackContext.hasCancelCallback?new CancelEvent(this,e,s):null}createEvent(e,s){assert(e.childName!=null,"Child events should have a childName.");const o=child$1(new ReferenceImpl(s._repo,s._path),e.childName),a=s._queryParams.getIndex();return new DataEvent(e.type,this,new DataSnapshot$1(e.snapshotNode,o,a),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ChildEventRegistration?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function addEventListener(i,e,s,o,a){let c;if(typeof o=="object"&&(c=void 0,a=o),typeof o=="function"&&(c=o),a&&a.onlyOnce){const g=s,_=(ft,_t)=>{repoRemoveEventCallbackForQuery(i._repo,i,h),g(ft,_t)};_.userCallback=s.userCallback,_.context=s.context,s=_}const d=new CallbackContext(s,c||void 0),h=e==="value"?new ValueEventRegistration(d):new ChildEventRegistration(e,d);return repoAddEventCallbackForQuery(i._repo,i,h),()=>repoRemoveEventCallbackForQuery(i._repo,i,h)}function onValue(i,e,s,o){return addEventListener(i,"value",e,s,o)}function onChildAdded(i,e,s,o){return addEventListener(i,"child_added",e,s,o)}function onChildChanged(i,e,s,o){return addEventListener(i,"child_changed",e,s,o)}function onChildMoved(i,e,s,o){return addEventListener(i,"child_moved",e,s,o)}function onChildRemoved(i,e,s,o){return addEventListener(i,"child_removed",e,s,o)}function off(i,e,s){let o=null;const a=s?new CallbackContext(s):null;e==="value"?o=new ValueEventRegistration(a):e&&(o=new ChildEventRegistration(e,a)),repoRemoveEventCallbackForQuery(i._repo,i,o)}class QueryConstraint{}class QueryEndAtConstraint extends QueryConstraint{constructor(e,s){super(),this._value=e,this._key=s}_apply(e){validateFirebaseDataArg("endAt",this._value,e._path,!0);const s=queryParamsEndAt(e._queryParams,this._value,this._key);if(validateLimit(s),validateQueryEndpoints(s),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new QueryImpl(e._repo,e._path,s,e._orderByCalled)}}function endAt(i,e){return validateKey("endAt","key",e,!0),new QueryEndAtConstraint(i,e)}class QueryEndBeforeConstraint extends QueryConstraint{constructor(e,s){super(),this._value=e,this._key=s}_apply(e){validateFirebaseDataArg("endBefore",this._value,e._path,!1);const s=queryParamsEndBefore(e._queryParams,this._value,this._key);if(validateLimit(s),validateQueryEndpoints(s),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new QueryImpl(e._repo,e._path,s,e._orderByCalled)}}function endBefore(i,e){return validateKey("endBefore","key",e,!0),new QueryEndBeforeConstraint(i,e)}class QueryStartAtConstraint extends QueryConstraint{constructor(e,s){super(),this._value=e,this._key=s}_apply(e){validateFirebaseDataArg("startAt",this._value,e._path,!0);const s=queryParamsStartAt(e._queryParams,this._value,this._key);if(validateLimit(s),validateQueryEndpoints(s),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new QueryImpl(e._repo,e._path,s,e._orderByCalled)}}function startAt(i=null,e){return validateKey("startAt","key",e,!0),new QueryStartAtConstraint(i,e)}class QueryStartAfterConstraint extends QueryConstraint{constructor(e,s){super(),this._value=e,this._key=s}_apply(e){validateFirebaseDataArg("startAfter",this._value,e._path,!1);const s=queryParamsStartAfter(e._queryParams,this._value,this._key);if(validateLimit(s),validateQueryEndpoints(s),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new QueryImpl(e._repo,e._path,s,e._orderByCalled)}}function startAfter(i,e){return validateKey("startAfter","key",e,!0),new QueryStartAfterConstraint(i,e)}class QueryLimitToFirstConstraint extends QueryConstraint{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new QueryImpl(e._repo,e._path,queryParamsLimitToFirst(e._queryParams,this._limit),e._orderByCalled)}}function limitToFirst(i){if(typeof i!="number"||Math.floor(i)!==i||i<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new QueryLimitToFirstConstraint(i)}class QueryLimitToLastConstraint extends QueryConstraint{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new QueryImpl(e._repo,e._path,queryParamsLimitToLast(e._queryParams,this._limit),e._orderByCalled)}}function limitToLast(i){if(typeof i!="number"||Math.floor(i)!==i||i<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new QueryLimitToLastConstraint(i)}class QueryOrderByChildConstraint extends QueryConstraint{constructor(e){super(),this._path=e}_apply(e){validateNoPreviousOrderByCall(e,"orderByChild");const s=new Path(this._path);if(pathIsEmpty(s))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const o=new PathIndex(s),a=queryParamsOrderBy(e._queryParams,o);return validateQueryEndpoints(a),new QueryImpl(e._repo,e._path,a,!0)}}function orderByChild(i){if(i==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(i==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(i==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return validatePathString("orderByChild","path",i,!1),new QueryOrderByChildConstraint(i)}class QueryOrderByKeyConstraint extends QueryConstraint{_apply(e){validateNoPreviousOrderByCall(e,"orderByKey");const s=queryParamsOrderBy(e._queryParams,KEY_INDEX);return validateQueryEndpoints(s),new QueryImpl(e._repo,e._path,s,!0)}}function orderByKey(){return new QueryOrderByKeyConstraint}class QueryOrderByPriorityConstraint extends QueryConstraint{_apply(e){validateNoPreviousOrderByCall(e,"orderByPriority");const s=queryParamsOrderBy(e._queryParams,PRIORITY_INDEX);return validateQueryEndpoints(s),new QueryImpl(e._repo,e._path,s,!0)}}function orderByPriority(){return new QueryOrderByPriorityConstraint}class QueryOrderByValueConstraint extends QueryConstraint{_apply(e){validateNoPreviousOrderByCall(e,"orderByValue");const s=queryParamsOrderBy(e._queryParams,VALUE_INDEX);return validateQueryEndpoints(s),new QueryImpl(e._repo,e._path,s,!0)}}function orderByValue(){return new QueryOrderByValueConstraint}class QueryEqualToValueConstraint extends QueryConstraint{constructor(e,s){super(),this._value=e,this._key=s}_apply(e){if(validateFirebaseDataArg("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new QueryEndAtConstraint(this._value,this._key)._apply(new QueryStartAtConstraint(this._value,this._key)._apply(e))}}function equalTo(i,e){return validateKey("equalTo","key",e,!0),new QueryEqualToValueConstraint(i,e)}function query(i,...e){let s=getModularInstance(i);for(const o of e)s=o._apply(s);return s}syncPointSetReferenceConstructor(ReferenceImpl);syncTreeSetReferenceConstructor(ReferenceImpl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",repos={};let useRestClient=!1;function repoManagerApplyEmulatorSettings(i,e,s,o){i.repoInfo_=new RepoInfo(`${e}:${s}`,!1,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams,!0),o&&(i.authTokenProvider_=o)}function repoManagerDatabaseFromApp(i,e,s,o,a){let c=o||i.options.databaseURL;c===void 0&&(i.options.projectId||fatal("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),log("Using default host for project ",i.options.projectId),c=`${i.options.projectId}-default-rtdb.firebaseio.com`);let d=parseRepoInfo(c,a),h=d.repoInfo,g,_;typeof process<"u"&&process.env&&(_=process.env[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),_?(g=!0,c=`http://${_}?ns=${h.namespace}`,d=parseRepoInfo(c,a),h=d.repoInfo):g=!d.repoInfo.secure;const ft=a&&g?new EmulatorTokenProvider(EmulatorTokenProvider.OWNER):new FirebaseAuthTokenProvider(i.name,i.options,e);validateUrl("Invalid Firebase Database URL",d),pathIsEmpty(d.path)||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");const _t=repoManagerCreateRepo(h,i,ft,new AppCheckTokenProvider(i.name,s));return new Database$1(_t,i)}function repoManagerDeleteRepo(i,e){const s=repos[e];(!s||s[i.key]!==i)&&fatal(`Database ${e}(${i.repoInfo_}) has already been deleted.`),repoInterrupt(i),delete s[i.key]}function repoManagerCreateRepo(i,e,s,o){let a=repos[e.name];a||(a={},repos[e.name]=a);let c=a[i.toURLString()];return c&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),c=new Repo(i,useRestClient,s,o),a[i.toURLString()]=c,c}let Database$1=class{constructor(e,s){this._repoInternal=e,this.app=s,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(repoStart(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal}_delete(){return this._rootInternal!==null&&(repoManagerDeleteRepo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&fatal("Cannot call "+e+" on a deleted database.")}};function checkTransportInit(){TransportManager.IS_TRANSPORT_INITIALIZED&&warn$1("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function forceWebSockets(){checkTransportInit(),BrowserPollConnection.forceDisallow()}function forceLongPolling(){checkTransportInit(),WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()}function connectDatabaseEmulator(i,e,s,o={}){i=getModularInstance(i),i._checkNotDeleted("useEmulator"),i._instanceStarted&&fatal("Cannot call useEmulator() after instance has already been initialized.");const a=i._repoInternal;let c;if(a.repoInfo_.nodeAdmin)o.mockUserToken&&fatal('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new EmulatorTokenProvider(EmulatorTokenProvider.OWNER);else if(o.mockUserToken){const d=typeof o.mockUserToken=="string"?o.mockUserToken:createMockUserToken(o.mockUserToken,i.app.options.projectId);c=new EmulatorTokenProvider(d)}repoManagerApplyEmulatorSettings(a,e,s,c)}function goOffline(i){i=getModularInstance(i),i._checkNotDeleted("goOffline"),repoInterrupt(i._repo)}function goOnline(i){i=getModularInstance(i),i._checkNotDeleted("goOnline"),repoResume(i._repo)}function enableLogging(i,e){enableLogging$1(i,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerDatabase$1(i){setSDKVersion(SDK_VERSION$1),_registerComponent(new Component("database",(e,{instanceIdentifier:s})=>{const o=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),c=e.getProvider("app-check-internal");return repoManagerDatabaseFromApp(o,a,c,s)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name$3,version$3,i),registerVersion(name$3,version$3,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_TIMESTAMP={".sv":"timestamp"};function serverTimestamp(){return SERVER_TIMESTAMP}function increment(i){return{".sv":{increment:i}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TransactionResult$1=class{constructor(e,s){this.committed=e,this.snapshot=s}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function runTransaction(i,e,s){var o;if(i=getModularInstance(i),validateWritablePath("Reference.transaction",i._path),i.key===".length"||i.key===".keys")throw"Reference.transaction failed: "+i.key+" is a read-only object.";const a=(o=s==null?void 0:s.applyLocally)!==null&&o!==void 0?o:!0,c=new Deferred,d=(g,_,ft)=>{let _t=null;g?c.reject(g):(_t=new DataSnapshot$1(ft,new ReferenceImpl(i._repo,i._path),PRIORITY_INDEX),c.resolve(new TransactionResult$1(_,_t)))},h=onValue(i,()=>{});return repoStartTransaction(i._repo,i._path,e,d,h,a),c.promise}PersistentConnection.prototype.simpleListen=function(i,e){this.sendRequest("q",{p:i},e)};PersistentConnection.prototype.echo=function(i,e){this.sendRequest("echo",{d:i},e)};registerDatabase$1();const name$2="@firebase/database-compat",version$2="0.3.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/database-compat"),warn=function(i){const e="FIREBASE WARNING: "+i;logClient.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const validateBoolean=function(i,e,s,o){if(!(o&&s===void 0)&&typeof s!="boolean")throw new Error(errorPrefix(i,e)+"must be a boolean.")},validateEventType=function(i,e,s){if(!(s&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(errorPrefix(i,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnDisconnect{constructor(e){this._delegate=e}cancel(e){validateArgCount("OnDisconnect.cancel",0,1,arguments.length),validateCallback("OnDisconnect.cancel","onComplete",e,!0);const s=this._delegate.cancel();return e&&s.then(()=>e(null),o=>e(o)),s}remove(e){validateArgCount("OnDisconnect.remove",0,1,arguments.length),validateCallback("OnDisconnect.remove","onComplete",e,!0);const s=this._delegate.remove();return e&&s.then(()=>e(null),o=>e(o)),s}set(e,s){validateArgCount("OnDisconnect.set",1,2,arguments.length),validateCallback("OnDisconnect.set","onComplete",s,!0);const o=this._delegate.set(e);return s&&o.then(()=>s(null),a=>s(a)),o}setWithPriority(e,s,o){validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validateCallback("OnDisconnect.setWithPriority","onComplete",o,!0);const a=this._delegate.setWithPriority(e,s);return o&&a.then(()=>o(null),c=>o(c)),a}update(e,s){if(validateArgCount("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const a={};for(let c=0;c<e.length;++c)a[""+c]=e[c];e=a,warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateCallback("OnDisconnect.update","onComplete",s,!0);const o=this._delegate.update(e);return s&&o.then(()=>s(null),a=>s(a)),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransactionResult{constructor(e,s){this.committed=e,this.snapshot=s}toJSON(){return validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataSnapshot{constructor(e,s){this._database=e,this._delegate=s}val(){return validateArgCount("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return validateArgCount("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),validatePathString("DataSnapshot.child","path",e,!1),new DataSnapshot(this._database,this._delegate.child(e))}hasChild(e){return validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validatePathString("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return validateArgCount("DataSnapshot.forEach",1,1,arguments.length),validateCallback("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(s=>e(new DataSnapshot(this._database,s)))}hasChildren(){return validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return validateArgCount("DataSnapshot.ref",0,0,arguments.length),new Reference$1(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Query{constructor(e,s){this.database=e,this._delegate=s}on(e,s,o,a){var c;validateArgCount("Query.on",2,4,arguments.length),validateCallback("Query.on","callback",s,!1);const d=Query.getCancelAndContextArgs_("Query.on",o,a),h=(_,ft)=>{s.call(d.context,new DataSnapshot(this.database,_),ft)};h.userCallback=s,h.context=d.context;const g=(c=d.cancel)===null||c===void 0?void 0:c.bind(d.context);switch(e){case"value":return onValue(this._delegate,h,g),s;case"child_added":return onChildAdded(this._delegate,h,g),s;case"child_removed":return onChildRemoved(this._delegate,h,g),s;case"child_changed":return onChildChanged(this._delegate,h,g),s;case"child_moved":return onChildMoved(this._delegate,h,g),s;default:throw new Error(errorPrefix("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,s,o){if(validateArgCount("Query.off",0,3,arguments.length),validateEventType("Query.off",e,!0),validateCallback("Query.off","callback",s,!0),validateContextObject("Query.off","context",o,!0),s){const a=()=>{};a.userCallback=s,a.context=o,off(this._delegate,e,a)}else off(this._delegate,e)}get(){return get(this._delegate).then(e=>new DataSnapshot(this.database,e))}once(e,s,o,a){validateArgCount("Query.once",1,4,arguments.length),validateCallback("Query.once","callback",s,!0);const c=Query.getCancelAndContextArgs_("Query.once",o,a),d=new Deferred,h=(_,ft)=>{const _t=new DataSnapshot(this.database,_);s&&s.call(c.context,_t,ft),d.resolve(_t)};h.userCallback=s,h.context=c.context;const g=_=>{c.cancel&&c.cancel.call(c.context,_),d.reject(_)};switch(e){case"value":onValue(this._delegate,h,g,{onlyOnce:!0});break;case"child_added":onChildAdded(this._delegate,h,g,{onlyOnce:!0});break;case"child_removed":onChildRemoved(this._delegate,h,g,{onlyOnce:!0});break;case"child_changed":onChildChanged(this._delegate,h,g,{onlyOnce:!0});break;case"child_moved":onChildMoved(this._delegate,h,g,{onlyOnce:!0});break;default:throw new Error(errorPrefix("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return d.promise}limitToFirst(e){return validateArgCount("Query.limitToFirst",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToFirst(e)))}limitToLast(e){return validateArgCount("Query.limitToLast",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToLast(e)))}orderByChild(e){return validateArgCount("Query.orderByChild",1,1,arguments.length),new Query(this.database,query(this._delegate,orderByChild(e)))}orderByKey(){return validateArgCount("Query.orderByKey",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByKey()))}orderByPriority(){return validateArgCount("Query.orderByPriority",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByPriority()))}orderByValue(){return validateArgCount("Query.orderByValue",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByValue()))}startAt(e=null,s){return validateArgCount("Query.startAt",0,2,arguments.length),new Query(this.database,query(this._delegate,startAt(e,s)))}startAfter(e=null,s){return validateArgCount("Query.startAfter",0,2,arguments.length),new Query(this.database,query(this._delegate,startAfter(e,s)))}endAt(e=null,s){return validateArgCount("Query.endAt",0,2,arguments.length),new Query(this.database,query(this._delegate,endAt(e,s)))}endBefore(e=null,s){return validateArgCount("Query.endBefore",0,2,arguments.length),new Query(this.database,query(this._delegate,endBefore(e,s)))}equalTo(e,s){return validateArgCount("Query.equalTo",1,2,arguments.length),new Query(this.database,query(this._delegate,equalTo(e,s)))}toString(){return validateArgCount("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return validateArgCount("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof Query)){const s="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(s)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,s,o){const a={cancel:void 0,context:void 0};if(s&&o)a.cancel=s,validateCallback(e,"cancel",a.cancel,!0),a.context=o,validateContextObject(e,"context",a.context,!0);else if(s)if(typeof s=="object"&&s!==null)a.context=s;else if(typeof s=="function")a.cancel=s;else throw new Error(errorPrefix(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return a}get ref(){return new Reference$1(this.database,new ReferenceImpl(this._delegate._repo,this._delegate._path))}}let Reference$1=class xp extends Query{constructor(e,s){super(e,new QueryImpl(s._repo,s._path,new QueryParams,!1)),this.database=e,this._delegate=s}getKey(){return validateArgCount("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return validateArgCount("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new xp(this.database,child$1(this._delegate,e))}getParent(){validateArgCount("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new xp(this.database,e):null}getRoot(){return validateArgCount("Reference.root",0,0,arguments.length),new xp(this.database,this._delegate.root)}set(e,s){validateArgCount("Reference.set",1,2,arguments.length),validateCallback("Reference.set","onComplete",s,!0);const o=set(this._delegate,e);return s&&o.then(()=>s(null),a=>s(a)),o}update(e,s){if(validateArgCount("Reference.update",1,2,arguments.length),Array.isArray(e)){const a={};for(let c=0;c<e.length;++c)a[""+c]=e[c];e=a,warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateWritablePath("Reference.update",this._delegate._path),validateCallback("Reference.update","onComplete",s,!0);const o=update(this._delegate,e);return s&&o.then(()=>s(null),a=>s(a)),o}setWithPriority(e,s,o){validateArgCount("Reference.setWithPriority",2,3,arguments.length),validateCallback("Reference.setWithPriority","onComplete",o,!0);const a=setWithPriority(this._delegate,e,s);return o&&a.then(()=>o(null),c=>o(c)),a}remove(e){validateArgCount("Reference.remove",0,1,arguments.length),validateCallback("Reference.remove","onComplete",e,!0);const s=remove(this._delegate);return e&&s.then(()=>e(null),o=>e(o)),s}transaction(e,s,o){validateArgCount("Reference.transaction",1,3,arguments.length),validateCallback("Reference.transaction","transactionUpdate",e,!1),validateCallback("Reference.transaction","onComplete",s,!0),validateBoolean("Reference.transaction","applyLocally",o,!0);const a=runTransaction(this._delegate,e,{applyLocally:o}).then(c=>new TransactionResult(c.committed,new DataSnapshot(this.database,c.snapshot)));return s&&a.then(c=>s(null,c.committed,c.snapshot),c=>s(c,!1,null)),a}setPriority(e,s){validateArgCount("Reference.setPriority",1,2,arguments.length),validateCallback("Reference.setPriority","onComplete",s,!0);const o=setPriority(this._delegate,e);return s&&o.then(()=>s(null),a=>s(a)),o}push(e,s){validateArgCount("Reference.push",0,2,arguments.length),validateCallback("Reference.push","onComplete",s,!0);const o=push(this._delegate,e),a=o.then(d=>new xp(this.database,d));s&&a.then(()=>s(null),d=>s(d));const c=new xp(this.database,o);return c.then=a.then.bind(a),c.catch=a.catch.bind(a,void 0),c}onDisconnect(){return validateWritablePath("Reference.onDisconnect",this._delegate._path),new OnDisconnect(new OnDisconnect$1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Database{constructor(e,s){this._delegate=e,this.app=s,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets,forceLongPolling}}useEmulator(e,s,o={}){connectDatabaseEmulator(this._delegate,e,s,o)}ref(e){if(validateArgCount("database.ref",0,1,arguments.length),e instanceof Reference$1){const s=refFromURL$1(this._delegate,e.toString());return new Reference$1(this,s)}else{const s=ref$2(this._delegate,e);return new Reference$1(this,s)}}refFromURL(e){validateArgCount("database.refFromURL",1,1,arguments.length);const o=refFromURL$1(this._delegate,e);return new Reference$1(this,o)}goOffline(){return validateArgCount("database.goOffline",0,0,arguments.length),goOffline(this._delegate)}goOnline(){return validateArgCount("database.goOnline",0,0,arguments.length),goOnline(this._delegate)}}Database.ServerValue={TIMESTAMP:serverTimestamp(),increment:i=>increment(i)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initStandalone({app:i,url:e,version:s,customAuthImpl:o,namespace:a,nodeAdmin:c=!1}){setSDKVersion(s);const d=new Provider("auth-internal",new ComponentContainer("database-standalone"));return d.setComponent(new Component("auth-internal",()=>o,"PRIVATE")),{instance:new Database(repoManagerDatabaseFromApp(i,d,void 0,e,c),i),namespace:a}}var INTERNAL=Object.freeze({__proto__:null,initStandalone});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ServerValue=Database.ServerValue;function registerDatabase(i){i.INTERNAL.registerComponent(new Component("database-compat",(e,{instanceIdentifier:s})=>{const o=e.getProvider("app-compat").getImmediate(),a=e.getProvider("database").getImmediate({identifier:s});return new Database(a,o)},"PUBLIC").setServiceProps({Reference:Reference$1,Query,Database,DataSnapshot,enableLogging,INTERNAL,ServerValue}).setMultipleInstances(!0)),i.registerVersion(name$2,version$2)}registerDatabase(firebase);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_HOST="firebasestorage.googleapis.com",CONFIG_STORAGE_BUCKET_KEY="storageBucket",DEFAULT_MAX_OPERATION_RETRY_TIME=2*60*1e3,DEFAULT_MAX_UPLOAD_RETRY_TIME=10*60*1e3,DEFAULT_MIN_SLEEP_TIME_MILLIS=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageError extends FirebaseError{constructor(e,s,o=0){super(prependCode(e),`Firebase Storage: ${s} (${prependCode(e)})`),this.status_=o,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return prependCode(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var StorageErrorCode;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(StorageErrorCode||(StorageErrorCode={}));function prependCode(i){return"storage/"+i}function unknown(){const i="An unknown error occurred, please check the error payload for server response.";return new StorageError(StorageErrorCode.UNKNOWN,i)}function objectNotFound(i){return new StorageError(StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}function quotaExceeded(i){return new StorageError(StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){const i="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new StorageError(StorageErrorCode.UNAUTHENTICATED,i)}function unauthorizedApp(){return new StorageError(StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function unauthorized(i){return new StorageError(StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}function retryLimitExceeded(){return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new StorageError(StorageErrorCode.CANCELED,"User canceled the upload/download.")}function invalidUrl(i){return new StorageError(StorageErrorCode.INVALID_URL,"Invalid URL '"+i+"'.")}function invalidDefaultBucket(i){return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function noDefaultBucket(){return new StorageError(StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+CONFIG_STORAGE_BUCKET_KEY+"' property when initializing the app?")}function cannotSliceBlob(){return new StorageError(StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function serverFileWrongSize(){return new StorageError(StorageErrorCode.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function noDownloadURL(){return new StorageError(StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function missingPolyFill(i){return new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function invalidArgument(i){return new StorageError(StorageErrorCode.INVALID_ARGUMENT,i)}function appDeleted(){return new StorageError(StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(i){return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(i,e){return new StorageError(StorageErrorCode.INVALID_FORMAT,"String does not match format '"+i+"': "+e)}function internalError(i){throw new StorageError(StorageErrorCode.INTERNAL_ERROR,"Internal error: "+i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Location{constructor(e,s){this.bucket=e,this.path_=s}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,s){let o;try{o=Location.makeFromUrl(e,s)}catch{return new Location(e,"")}if(o.path==="")return o;throw invalidDefaultBucket(e)}static makeFromUrl(e,s){let o=null;const a="([A-Za-z0-9.\\-_]+)";function c(Su){Su.path.charAt(Su.path.length-1)==="/"&&(Su.path_=Su.path_.slice(0,-1))}const d="(/(.*))?$",h=new RegExp("^gs://"+a+d,"i"),g={bucket:1,path:3};function _(Su){Su.path_=decodeURIComponent(Su.path)}const ft="v[A-Za-z0-9_]+",_t=s.replace(/[.]/g,"\\."),$t="(/([^?#]*).*)?$",Mt=new RegExp(`^https?://${_t}/${ft}/b/${a}/o${$t}`,"i"),Ft={bucket:1,path:3},Ol=s===DEFAULT_HOST?"(?:storage.googleapis.com|storage.cloud.google.com)":s,Vl="([^?#]*)",Nl=new RegExp(`^https?://${Ol}/${a}/${Vl}`,"i"),Ml=[{regex:h,indices:g,postModify:c},{regex:Mt,indices:Ft,postModify:_},{regex:Nl,indices:{bucket:1,path:2},postModify:_}];for(let Su=0;Su<Ml.length;Su++){const _d=Ml[Su],ep=_d.regex.exec(e);if(ep){const tp=ep[_d.indices.bucket];let np=ep[_d.indices.path];np||(np=""),o=new Location(tp,np),_d.postModify(o);break}}if(o==null)throw invalidUrl(e);return o}}class FailRequest{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function start(i,e,s){let o=1,a=null,c=null,d=!1,h=0;function g(){return h===2}let _=!1;function ft(...Vl){_||(_=!0,e.apply(null,Vl))}function _t(Vl){a=setTimeout(()=>{a=null,i(Mt,g())},Vl)}function $t(){c&&clearTimeout(c)}function Mt(Vl,...Nl){if(_){$t();return}if(Vl){$t(),ft.call(null,Vl,...Nl);return}if(g()||d){$t(),ft.call(null,Vl,...Nl);return}o<64&&(o*=2);let Ml;h===1?(h=2,Ml=0):Ml=(o+Math.random())*1e3,_t(Ml)}let Ft=!1;function Ol(Vl){Ft||(Ft=!0,$t(),!_&&(a!==null?(Vl||(h=2),clearTimeout(a),_t(0)):Vl||(h=1)))}return _t(0),c=setTimeout(()=>{d=!0,Ol(!0)},s),Ol}function stop(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isJustDef(i){return i!==void 0}function isFunction(i){return typeof i=="function"}function isNonArrayObject(i){return typeof i=="object"&&!Array.isArray(i)}function isString(i){return typeof i=="string"||i instanceof String}function isNativeBlob(i){return isNativeBlobDefined()&&i instanceof Blob}function isNativeBlobDefined(){return typeof Blob<"u"&&!isNode()}function validateNumber(i,e,s,o){if(o<e)throw invalidArgument(`Invalid value for '${i}'. Expected ${e} or greater.`);if(o>s)throw invalidArgument(`Invalid value for '${i}'. Expected ${s} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function makeUrl(i,e,s){let o=e;return s==null&&(o=`https://${e}`),`${s}://${o}/v0${i}`}function makeQueryString(i){const e=encodeURIComponent;let s="?";for(const o in i)if(i.hasOwnProperty(o)){const a=e(o)+"="+e(i[o]);s=s+a+"&"}return s=s.slice(0,-1),s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ErrorCode;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(ErrorCode||(ErrorCode={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isRetryStatusCode(i,e){const s=i>=500&&i<600,a=[408,429].indexOf(i)!==-1,c=e.indexOf(i)!==-1;return s||a||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NetworkRequest{constructor(e,s,o,a,c,d,h,g,_,ft,_t,$t=!0){this.url_=e,this.method_=s,this.headers_=o,this.body_=a,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=h,this.errorCallback_=g,this.timeout_=_,this.progressCallback_=ft,this.connectionFactory_=_t,this.retry=$t,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Mt,Ft)=>{this.resolve_=Mt,this.reject_=Ft,this.start_()})}start_(){const e=(o,a)=>{if(a){o(!1,new RequestEndStatus(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=h=>{const g=h.loaded,_=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,_)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const h=c.getErrorCode()===ErrorCode.NO_ERROR,g=c.getStatus();if(!h||isRetryStatusCode(g,this.additionalRetryCodes_)&&this.retry){const ft=c.getErrorCode()===ErrorCode.ABORT;o(!1,new RequestEndStatus(!1,null,ft));return}const _=this.successCodes_.indexOf(g)!==-1;o(!0,new RequestEndStatus(_,c))})},s=(o,a)=>{const c=this.resolve_,d=this.reject_,h=a.connection;if(a.wasSuccessCode)try{const g=this.callback_(h,h.getResponse());isJustDef(g)?c(g):c()}catch(g){d(g)}else if(h!==null){const g=unknown();g.serverResponse=h.getErrorText(),this.errorCallback_?d(this.errorCallback_(h,g)):d(g)}else if(a.canceled){const g=this.appDelete_?appDeleted():canceled();d(g)}else{const g=retryLimitExceeded();d(g)}};this.canceled_?s(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=start(e,s,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&stop(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class RequestEndStatus{constructor(e,s,o){this.wasSuccessCode=e,this.connection=s,this.canceled=!!o}}function addAuthHeader_(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function addVersionHeader_(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function addGmpidHeader_(i,e){e&&(i["X-Firebase-GMPID"]=e)}function addAppCheckHeader_(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function makeRequest(i,e,s,o,a,c,d=!0){const h=makeQueryString(i.urlParams),g=i.url+h,_=Object.assign({},i.headers);return addGmpidHeader_(_,e),addAuthHeader_(_,s),addVersionHeader_(_,c),addAppCheckHeader_(_,o),new NetworkRequest(g,i.method,_,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,a,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getBlobBuilder(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function getBlob$1(...i){const e=getBlobBuilder();if(e!==void 0){const s=new e;for(let o=0;o<i.length;o++)s.append(i[o]);return s.getBlob()}else{if(isNativeBlobDefined())return new Blob(i);throw new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sliceBlob(i,e,s){return i.webkitSlice?i.webkitSlice(e,s):i.mozSlice?i.mozSlice(e,s):i.slice?i.slice(e,s):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodeBase64(i){if(typeof atob>"u")throw missingPolyFill("base-64");return atob(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class StringData{constructor(e,s){this.data=e,this.contentType=s||null}}function dataFromString(i,e){switch(i){case StringFormat.RAW:return new StringData(utf8Bytes_(e));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(i,e));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(e),dataURLContentType_(e))}throw unknown()}function utf8Bytes_(i){const e=[];for(let s=0;s<i.length;s++){let o=i.charCodeAt(s);if(o<=127)e.push(o);else if(o<=2047)e.push(192|o>>6,128|o&63);else if((o&64512)===55296)if(!(s<i.length-1&&(i.charCodeAt(s+1)&64512)===56320))e.push(239,191,189);else{const c=o,d=i.charCodeAt(++s);o=65536|(c&1023)<<10|d&1023,e.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63)}else(o&64512)===56320?e.push(239,191,189):e.push(224|o>>12,128|o>>6&63,128|o&63)}return new Uint8Array(e)}function percentEncodedBytes_(i){let e;try{e=decodeURIComponent(i)}catch{throw invalidFormat(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(e)}function base64Bytes_(i,e){switch(i){case StringFormat.BASE64:{const a=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(a||c)throw invalidFormat(i,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case StringFormat.BASE64URL:{const a=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(a||c)throw invalidFormat(i,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let s;try{s=decodeBase64(e)}catch(a){throw a.message.includes("polyfill")?a:invalidFormat(i,"Invalid character found")}const o=new Uint8Array(s.length);for(let a=0;a<s.length;a++)o[a]=s.charCodeAt(a);return o}class DataURLParts{constructor(e){this.base64=!1,this.contentType=null;const s=e.match(/^data:([^,]+)?,/);if(s===null)throw invalidFormat(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const o=s[1]||null;o!=null&&(this.base64=endsWith(o,";base64"),this.contentType=this.base64?o.substring(0,o.length-7):o),this.rest=e.substring(e.indexOf(",")+1)}}function dataURLBytes_(i){const e=new DataURLParts(i);return e.base64?base64Bytes_(StringFormat.BASE64,e.rest):percentEncodedBytes_(e.rest)}function dataURLContentType_(i){return new DataURLParts(i).contentType}function endsWith(i,e){return i.length>=e.length?i.substring(i.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FbsBlob{constructor(e,s){let o=0,a="";isNativeBlob(e)?(this.data_=e,o=e.size,a=e.type):e instanceof ArrayBuffer?(s?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),o=this.data_.length):e instanceof Uint8Array&&(s?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),o=e.length),this.size_=o,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,s){if(isNativeBlob(this.data_)){const o=this.data_,a=sliceBlob(o,e,s);return a===null?null:new FbsBlob(a)}else{const o=new Uint8Array(this.data_.buffer,e,s-e);return new FbsBlob(o,!0)}}static getBlob(...e){if(isNativeBlobDefined()){const s=e.map(o=>o instanceof FbsBlob?o.data_:o);return new FbsBlob(getBlob$1.apply(null,s))}else{const s=e.map(d=>isString(d)?dataFromString(StringFormat.RAW,d).data:d.data_);let o=0;s.forEach(d=>{o+=d.byteLength});const a=new Uint8Array(o);let c=0;return s.forEach(d=>{for(let h=0;h<d.length;h++)a[c++]=d[h]}),new FbsBlob(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonObjectOrNull(i){let e;try{e=JSON.parse(i)}catch{return null}return isNonArrayObject(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parent(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function child(i,e){const s=e.split("/").filter(o=>o.length>0).join("/");return i.length===0?s:i+"/"+s}function lastComponent(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function noXform_(i,e){return e}class Mapping{constructor(e,s,o,a){this.server=e,this.local=s||e,this.writable=!!o,this.xform=a||noXform_}}let mappings_=null;function xformPath(i){return!isString(i)||i.length<2?i:lastComponent(i)}function getMappings(){if(mappings_)return mappings_;const i=[];i.push(new Mapping("bucket")),i.push(new Mapping("generation")),i.push(new Mapping("metageneration")),i.push(new Mapping("name","fullPath",!0));function e(c,d){return xformPath(d)}const s=new Mapping("name");s.xform=e,i.push(s);function o(c,d){return d!==void 0?Number(d):d}const a=new Mapping("size");return a.xform=o,i.push(a),i.push(new Mapping("timeCreated")),i.push(new Mapping("updated")),i.push(new Mapping("md5Hash",null,!0)),i.push(new Mapping("cacheControl",null,!0)),i.push(new Mapping("contentDisposition",null,!0)),i.push(new Mapping("contentEncoding",null,!0)),i.push(new Mapping("contentLanguage",null,!0)),i.push(new Mapping("contentType",null,!0)),i.push(new Mapping("metadata","customMetadata",!0)),mappings_=i,mappings_}function addRef(i,e){function s(){const o=i.bucket,a=i.fullPath,c=new Location(o,a);return e._makeStorageReference(c)}Object.defineProperty(i,"ref",{get:s})}function fromResource(i,e,s){const o={};o.type="file";const a=s.length;for(let c=0;c<a;c++){const d=s[c];o[d.local]=d.xform(o,e[d.server])}return addRef(o,i),o}function fromResourceString(i,e,s){const o=jsonObjectOrNull(e);return o===null?null:fromResource(i,o,s)}function downloadUrlFromResourceString(i,e,s,o){const a=jsonObjectOrNull(e);if(a===null||!isString(a.downloadTokens))return null;const c=a.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(_=>{const ft=i.bucket,_t=i.fullPath,$t="/b/"+d(ft)+"/o/"+d(_t),Mt=makeUrl($t,s,o),Ft=makeQueryString({alt:"media",token:_});return Mt+Ft})[0]}function toResourceString(i,e){const s={},o=e.length;for(let a=0;a<o;a++){const c=e[a];c.writable&&(s[c.server]=i[c.local])}return JSON.stringify(s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PREFIXES_KEY="prefixes",ITEMS_KEY="items";function fromBackendResponse(i,e,s){const o={prefixes:[],items:[],nextPageToken:s.nextPageToken};if(s[PREFIXES_KEY])for(const a of s[PREFIXES_KEY]){const c=a.replace(/\/$/,""),d=i._makeStorageReference(new Location(e,c));o.prefixes.push(d)}if(s[ITEMS_KEY])for(const a of s[ITEMS_KEY]){const c=i._makeStorageReference(new Location(e,a.name));o.items.push(c)}return o}function fromResponseString(i,e,s){const o=jsonObjectOrNull(s);return o===null?null:fromBackendResponse(i,e,o)}class RequestInfo{constructor(e,s,o,a){this.url=e,this.method=s,this.handler=o,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function handlerCheck(i){if(!i)throw unknown()}function metadataHandler(i,e){function s(o,a){const c=fromResourceString(i,a,e);return handlerCheck(c!==null),c}return s}function listHandler(i,e){function s(o,a){const c=fromResponseString(i,e,a);return handlerCheck(c!==null),c}return s}function downloadUrlHandler(i,e){function s(o,a){const c=fromResourceString(i,a,e);return handlerCheck(c!==null),downloadUrlFromResourceString(c,a,i.host,i._protocol)}return s}function sharedErrorHandler(i){function e(s,o){let a;return s.getStatus()===401?s.getErrorText().includes("Firebase App Check token is invalid")?a=unauthorizedApp():a=unauthenticated():s.getStatus()===402?a=quotaExceeded(i.bucket):s.getStatus()===403?a=unauthorized(i.path):a=o,a.status=s.getStatus(),a.serverResponse=o.serverResponse,a}return e}function objectErrorHandler(i){const e=sharedErrorHandler(i);function s(o,a){let c=e(o,a);return o.getStatus()===404&&(c=objectNotFound(i.path)),c.serverResponse=a.serverResponse,c}return s}function getMetadata$2(i,e,s){const o=e.fullServerUrl(),a=makeUrl(o,i.host,i._protocol),c="GET",d=i.maxOperationRetryTime,h=new RequestInfo(a,c,metadataHandler(i,s),d);return h.errorHandler=objectErrorHandler(e),h}function list$2(i,e,s,o,a){const c={};e.isRoot?c.prefix="":c.prefix=e.path+"/",s&&s.length>0&&(c.delimiter=s),o&&(c.pageToken=o),a&&(c.maxResults=a);const d=e.bucketOnlyServerUrl(),h=makeUrl(d,i.host,i._protocol),g="GET",_=i.maxOperationRetryTime,ft=new RequestInfo(h,g,listHandler(i,e.bucket),_);return ft.urlParams=c,ft.errorHandler=sharedErrorHandler(e),ft}function getDownloadUrl(i,e,s){const o=e.fullServerUrl(),a=makeUrl(o,i.host,i._protocol),c="GET",d=i.maxOperationRetryTime,h=new RequestInfo(a,c,downloadUrlHandler(i,s),d);return h.errorHandler=objectErrorHandler(e),h}function updateMetadata$2(i,e,s,o){const a=e.fullServerUrl(),c=makeUrl(a,i.host,i._protocol),d="PATCH",h=toResourceString(s,o),g={"Content-Type":"application/json; charset=utf-8"},_=i.maxOperationRetryTime,ft=new RequestInfo(c,d,metadataHandler(i,o),_);return ft.headers=g,ft.body=h,ft.errorHandler=objectErrorHandler(e),ft}function deleteObject$2(i,e){const s=e.fullServerUrl(),o=makeUrl(s,i.host,i._protocol),a="DELETE",c=i.maxOperationRetryTime;function d(g,_){}const h=new RequestInfo(o,a,d,c);return h.successCodes=[200,204],h.errorHandler=objectErrorHandler(e),h}function determineContentType_(i,e){return i&&i.contentType||e&&e.type()||"application/octet-stream"}function metadataForUpload_(i,e,s){const o=Object.assign({},s);return o.fullPath=i.path,o.size=e.size(),o.contentType||(o.contentType=determineContentType_(null,e)),o}function multipartUpload(i,e,s,o,a){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function h(){let Ml="";for(let Su=0;Su<2;Su++)Ml=Ml+Math.random().toString().slice(2);return Ml}const g=h();d["Content-Type"]="multipart/related; boundary="+g;const _=metadataForUpload_(e,o,a),ft=toResourceString(_,s),_t="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+ft+`\r
--`+g+`\r
Content-Type: `+_.contentType+`\r
\r
`,$t=`\r
--`+g+"--",Mt=FbsBlob.getBlob(_t,o,$t);if(Mt===null)throw cannotSliceBlob();const Ft={name:_.fullPath},Ol=makeUrl(c,i.host,i._protocol),Vl="POST",Nl=i.maxUploadRetryTime,xl=new RequestInfo(Ol,Vl,metadataHandler(i,s),Nl);return xl.urlParams=Ft,xl.headers=d,xl.body=Mt.uploadData(),xl.errorHandler=sharedErrorHandler(e),xl}class ResumableUploadStatus{constructor(e,s,o,a){this.current=e,this.total=s,this.finalized=!!o,this.metadata=a||null}}function checkResumeHeader_(i,e){let s=null;try{s=i.getResponseHeader("X-Goog-Upload-Status")}catch{handlerCheck(!1)}return handlerCheck(!!s&&(e||["active"]).indexOf(s)!==-1),s}function createResumableUpload(i,e,s,o,a){const c=e.bucketOnlyServerUrl(),d=metadataForUpload_(e,o,a),h={name:d.fullPath},g=makeUrl(c,i.host,i._protocol),_="POST",ft={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${o.size()}`,"X-Goog-Upload-Header-Content-Type":d.contentType,"Content-Type":"application/json; charset=utf-8"},_t=toResourceString(d,s),$t=i.maxUploadRetryTime;function Mt(Ol){checkResumeHeader_(Ol);let Vl;try{Vl=Ol.getResponseHeader("X-Goog-Upload-URL")}catch{handlerCheck(!1)}return handlerCheck(isString(Vl)),Vl}const Ft=new RequestInfo(g,_,Mt,$t);return Ft.urlParams=h,Ft.headers=ft,Ft.body=_t,Ft.errorHandler=sharedErrorHandler(e),Ft}function getResumableUploadStatus(i,e,s,o){const a={"X-Goog-Upload-Command":"query"};function c(_){const ft=checkResumeHeader_(_,["active","final"]);let _t=null;try{_t=_.getResponseHeader("X-Goog-Upload-Size-Received")}catch{handlerCheck(!1)}_t||handlerCheck(!1);const $t=Number(_t);return handlerCheck(!isNaN($t)),new ResumableUploadStatus($t,o.size(),ft==="final")}const d="POST",h=i.maxUploadRetryTime,g=new RequestInfo(s,d,c,h);return g.headers=a,g.errorHandler=sharedErrorHandler(e),g}const RESUMABLE_UPLOAD_CHUNK_SIZE=256*1024;function continueResumableUpload(i,e,s,o,a,c,d,h){const g=new ResumableUploadStatus(0,0);if(d?(g.current=d.current,g.total=d.total):(g.current=0,g.total=o.size()),o.size()!==g.total)throw serverFileWrongSize();const _=g.total-g.current;let ft=_;a>0&&(ft=Math.min(ft,a));const _t=g.current,$t=_t+ft;let Mt="";ft===0?Mt="finalize":_===ft?Mt="upload, finalize":Mt="upload";const Ft={"X-Goog-Upload-Command":Mt,"X-Goog-Upload-Offset":`${g.current}`},Ol=o.slice(_t,$t);if(Ol===null)throw cannotSliceBlob();function Vl(Su,_d){const ep=checkResumeHeader_(Su,["active","final"]),tp=g.current+ft,np=o.size();let op;return ep==="final"?op=metadataHandler(e,c)(Su,_d):op=null,new ResumableUploadStatus(tp,np,ep==="final",op)}const Nl="POST",xl=e.maxUploadRetryTime,Ml=new RequestInfo(s,Nl,Vl,xl);return Ml.headers=Ft,Ml.body=Ol.uploadData(),Ml.progressCallback=h||null,Ml.errorHandler=sharedErrorHandler(i),Ml}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TaskEvent={STATE_CHANGED:"state_changed"},TaskState={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function taskStateFromInternalTaskState(i){switch(i){case"running":case"pausing":case"canceling":return TaskState.RUNNING;case"paused":return TaskState.PAUSED;case"success":return TaskState.SUCCESS;case"canceled":return TaskState.CANCELED;case"error":return TaskState.ERROR;default:return TaskState.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Observer{constructor(e,s,o){if(isFunction(e)||s!=null||o!=null)this.next=e,this.error=s??void 0,this.complete=o??void 0;else{const c=e;this.next=c.next,this.error=c.error,this.complete=c.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function async(i){return(...e)=>{Promise.resolve().then(()=>i(...e))}}class XhrConnection{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ErrorCode.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ErrorCode.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ErrorCode.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,s,o,a){if(this.sent_)throw internalError("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(s,e,!0),a!==void 0)for(const c in a)a.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,a[c].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw internalError("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw internalError("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw internalError("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw internalError("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XhrTextConnection extends XhrConnection{initXhr(){this.xhr_.responseType="text"}}function newTextConnection(){return new XhrTextConnection}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTask{constructor(e,s,o=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=s,this._metadata=o,this._mappings=getMappings(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{if(this._request=void 0,this._chunkMultiplier=1,a._codeEquals(StorageErrorCode.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const c=this.isExponentialBackoffExpired();if(isRetryStatusCode(a.status,[]))if(c)a=retryLimitExceeded();else{this.sleepTime=Math.max(this.sleepTime*2,DEFAULT_MIN_SLEEP_TIME_MILLIS),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=a,this._transition("error")}},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals(StorageErrorCode.CANCELED)?this.completeTransitions_():(this._error=a,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((a,c)=>{this._resolve=a,this._reject=c,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return s=>this._updateProgress(e+s)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([s,o])=>{switch(this._state){case"running":e(s,o);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,s)=>{const o=createResumableUpload(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(o,newTextConnection,e,s);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._uploadUrl=c,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((s,o)=>{const a=getResumableUploadStatus(this._ref.storage,this._ref._location,e,this._blob),c=this._ref.storage._makeRequest(a,newTextConnection,s,o);this._request=c,c.getPromise().then(d=>{d=d,this._request=void 0,this._updateProgress(d.current),this._needToFetchStatus=!1,d.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=RESUMABLE_UPLOAD_CHUNK_SIZE*this._chunkMultiplier,s=new ResumableUploadStatus(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken((a,c)=>{let d;try{d=continueResumableUpload(this._ref._location,this._ref.storage,o,this._blob,e,this._mappings,s,this._makeProgressCallback())}catch(g){this._error=g,this._transition("error");return}const h=this._ref.storage._makeRequest(d,newTextConnection,a,c,!1);this._request=h,h.getPromise().then(g=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(g.current),g.finalized?(this._metadata=g.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){RESUMABLE_UPLOAD_CHUNK_SIZE*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,s)=>{const o=getMetadata$2(this._ref.storage,this._ref._location,this._mappings),a=this._ref.storage._makeRequest(o,newTextConnection,e,s);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._metadata=c,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,s)=>{const o=multipartUpload(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(o,newTextConnection,e,s);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._metadata=c,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const s=this._transferred;this._transferred=e,this._transferred!==s&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const s=this._state==="paused";this._state=e,s&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=canceled(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=taskStateFromInternalTaskState(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,s,o,a){const c=new Observer(s||void 0,o||void 0,a||void 0);return this._addObserver(c),()=>{this._removeObserver(c)}}then(e,s){return this._promise.then(e,s)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const s=this._observers.indexOf(e);s!==-1&&this._observers.splice(s,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(s=>{this._notifyObserver(s)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(taskStateFromInternalTaskState(this._state)){case TaskState.SUCCESS:async(this._resolve.bind(null,this.snapshot))();break;case TaskState.CANCELED:case TaskState.ERROR:const s=this._reject;async(s.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(taskStateFromInternalTaskState(this._state)){case TaskState.RUNNING:case TaskState.PAUSED:e.next&&async(e.next.bind(e,this.snapshot))();break;case TaskState.SUCCESS:e.complete&&async(e.complete.bind(e))();break;case TaskState.CANCELED:case TaskState.ERROR:e.error&&async(e.error.bind(e,this._error))();break;default:e.error&&async(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Reference{constructor(e,s){this._service=e,s instanceof Location?this._location=s:this._location=Location.makeFromUrl(s,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,s){return new Reference(e,s)}get root(){const e=new Location(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lastComponent(this._location.path)}get storage(){return this._service}get parent(){const e=parent(this._location.path);if(e===null)return null;const s=new Location(this._location.bucket,e);return new Reference(this._service,s)}_throwIfRoot(e){if(this._location.path==="")throw invalidRootOperation(e)}}function uploadBytesResumable$1(i,e,s){return i._throwIfRoot("uploadBytesResumable"),new UploadTask(i,new FbsBlob(e),s)}function listAll$1(i){const e={prefixes:[],items:[]};return listAllHelper(i,e).then(()=>e)}async function listAllHelper(i,e,s){const a=await list$1(i,{pageToken:s});e.prefixes.push(...a.prefixes),e.items.push(...a.items),a.nextPageToken!=null&&await listAllHelper(i,e,a.nextPageToken)}function list$1(i,e){e!=null&&typeof e.maxResults=="number"&&validateNumber("options.maxResults",1,1e3,e.maxResults);const s=e||{},o=list$2(i.storage,i._location,"/",s.pageToken,s.maxResults);return i.storage.makeRequestWithTokens(o,newTextConnection)}function getMetadata$1(i){i._throwIfRoot("getMetadata");const e=getMetadata$2(i.storage,i._location,getMappings());return i.storage.makeRequestWithTokens(e,newTextConnection)}function updateMetadata$1(i,e){i._throwIfRoot("updateMetadata");const s=updateMetadata$2(i.storage,i._location,e,getMappings());return i.storage.makeRequestWithTokens(s,newTextConnection)}function getDownloadURL$1(i){i._throwIfRoot("getDownloadURL");const e=getDownloadUrl(i.storage,i._location,getMappings());return i.storage.makeRequestWithTokens(e,newTextConnection).then(s=>{if(s===null)throw noDownloadURL();return s})}function deleteObject$1(i){i._throwIfRoot("deleteObject");const e=deleteObject$2(i.storage,i._location);return i.storage.makeRequestWithTokens(e,newTextConnection)}function _getChild$1(i,e){const s=child(i._location.path,e),o=new Location(i._location.bucket,s);return new Reference(i.storage,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isUrl$1(i){return/^[A-Za-z]+:\/\//.test(i)}function refFromURL(i,e){return new Reference(i,e)}function refFromPath(i,e){if(i instanceof FirebaseStorageImpl){const s=i;if(s._bucket==null)throw noDefaultBucket();const o=new Reference(s,s._bucket);return e!=null?refFromPath(o,e):o}else return e!==void 0?_getChild$1(i,e):i}function ref$1(i,e){if(e&&isUrl$1(e)){if(i instanceof FirebaseStorageImpl)return refFromURL(i,e);throw invalidArgument("To use ref(service, url), the first argument must be a Storage instance.")}else return refFromPath(i,e)}function extractBucket(i,e){const s=e==null?void 0:e[CONFIG_STORAGE_BUCKET_KEY];return s==null?null:Location.makeFromBucketSpec(s,i)}function connectStorageEmulator$1(i,e,s,o={}){i.host=`${e}:${s}`,i._protocol="http";const{mockUserToken:a}=o;a&&(i._overrideAuthToken=typeof a=="string"?a:createMockUserToken(a,i.app.options.projectId))}class FirebaseStorageImpl{constructor(e,s,o,a,c){this.app=e,this._authProvider=s,this._appCheckProvider=o,this._url=a,this._firebaseVersion=c,this._bucket=null,this._host=DEFAULT_HOST,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DEFAULT_MAX_OPERATION_RETRY_TIME,this._maxUploadRetryTime=DEFAULT_MAX_UPLOAD_RETRY_TIME,this._requests=new Set,a!=null?this._bucket=Location.makeFromBucketSpec(a,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Location.makeFromBucketSpec(this._url,e):this._bucket=extractBucket(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const s=await e.getToken();if(s!==null)return s.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Reference(this,e)}_makeRequest(e,s,o,a,c=!0){if(this._deleted)return new FailRequest(appDeleted());{const d=makeRequest(e,this._appId,o,a,s,this._firebaseVersion,c);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,s){const[o,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,s,o,a).getPromise()}}const name$1="@firebase/storage",version$1="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE$1="storage";function uploadBytesResumable(i,e,s){return i=getModularInstance(i),uploadBytesResumable$1(i,e,s)}function getMetadata(i){return i=getModularInstance(i),getMetadata$1(i)}function updateMetadata(i,e){return i=getModularInstance(i),updateMetadata$1(i,e)}function list(i,e){return i=getModularInstance(i),list$1(i,e)}function listAll(i){return i=getModularInstance(i),listAll$1(i)}function getDownloadURL(i){return i=getModularInstance(i),getDownloadURL$1(i)}function deleteObject(i){return i=getModularInstance(i),deleteObject$1(i)}function ref(i,e){return i=getModularInstance(i),ref$1(i,e)}function _getChild(i,e){return _getChild$1(i,e)}function connectStorageEmulator(i,e,s,o={}){connectStorageEmulator$1(i,e,s,o)}function factory$1(i,{instanceIdentifier:e}){const s=i.getProvider("app").getImmediate(),o=i.getProvider("auth-internal"),a=i.getProvider("app-check-internal");return new FirebaseStorageImpl(s,o,a,e,SDK_VERSION$1)}function registerStorage$1(){_registerComponent(new Component(STORAGE_TYPE$1,factory$1,"PUBLIC").setMultipleInstances(!0)),registerVersion(name$1,version$1,""),registerVersion(name$1,version$1,"esm2017")}registerStorage$1();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTaskSnapshotCompat{constructor(e,s,o){this._delegate=e,this.task=s,this.ref=o}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTaskCompat{constructor(e,s){this._delegate=e,this._ref=s,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new UploadTaskSnapshotCompat(this._delegate.snapshot,this,this._ref)}then(e,s){return this._delegate.then(o=>{if(e)return e(new UploadTaskSnapshotCompat(o,this,this._ref))},s)}on(e,s,o,a){let c;return s&&(typeof s=="function"?c=d=>s(new UploadTaskSnapshotCompat(d,this,this._ref)):c={next:s.next?d=>s.next(new UploadTaskSnapshotCompat(d,this,this._ref)):void 0,complete:s.complete||void 0,error:s.error||void 0}),this._delegate.on(e,c,o||void 0,a||void 0)}}class ListResultCompat{constructor(e,s){this._delegate=e,this._service=s}get prefixes(){return this._delegate.prefixes.map(e=>new ReferenceCompat(e,this._service))}get items(){return this._delegate.items.map(e=>new ReferenceCompat(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReferenceCompat{constructor(e,s){this._delegate=e,this.storage=s}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const s=_getChild(this._delegate,e);return new ReferenceCompat(s,this.storage)}get root(){return new ReferenceCompat(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new ReferenceCompat(e,this.storage)}put(e,s){return this._throwIfRoot("put"),new UploadTaskCompat(uploadBytesResumable(this._delegate,e,s),this)}putString(e,s=StringFormat.RAW,o){this._throwIfRoot("putString");const a=dataFromString(s,e),c=Object.assign({},o);return c.contentType==null&&a.contentType!=null&&(c.contentType=a.contentType),new UploadTaskCompat(new UploadTask(this._delegate,new FbsBlob(a.data,!0),c),this)}listAll(){return listAll(this._delegate).then(e=>new ListResultCompat(e,this.storage))}list(e){return list(this._delegate,e||void 0).then(s=>new ListResultCompat(s,this.storage))}getMetadata(){return getMetadata(this._delegate)}updateMetadata(e){return updateMetadata(this._delegate,e)}getDownloadURL(){return getDownloadURL(this._delegate)}delete(){return this._throwIfRoot("delete"),deleteObject(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw invalidRootOperation(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageServiceCompat{constructor(e,s){this.app=e,this._delegate=s}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(isUrl(e))throw invalidArgument("ref() expected a child path but got a URL, use refFromURL instead.");return new ReferenceCompat(ref(this._delegate,e),this)}refFromURL(e){if(!isUrl(e))throw invalidArgument("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Location.makeFromUrl(e,this._delegate.host)}catch{throw invalidArgument("refFromUrl() expected a valid full URL but got an invalid one.")}return new ReferenceCompat(ref(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,s,o={}){connectStorageEmulator(this._delegate,e,s,o)}}function isUrl(i){return/^[A-Za-z]+:\/\//.test(i)}const name="@firebase/storage-compat",version="0.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE="storage-compat";function factory(i,{instanceIdentifier:e}){const s=i.getProvider("app-compat").getImmediate(),o=i.getProvider("storage").getImmediate({identifier:e});return new StorageServiceCompat(s,o)}function registerStorage(i){const e={TaskState,TaskEvent,StringFormat,Storage:StorageServiceCompat,Reference:ReferenceCompat};i.INTERNAL.registerComponent(new Component(STORAGE_TYPE,factory,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),i.registerVersion(name,version)}registerStorage(firebase);const firebaseConfig={apiKey:"AIzaSyBTCJ2aIIxdaq9KVmkd4KcM01IVMS3yKA4",authDomain:"deepchallenge-6df3d.firebaseapp.com",projectId:"deepchallenge-6df3d",storageBucket:"deepchallenge-6df3d.appspot.com",messagingSenderId:"828787000033",appId:"1:828787000033:web:802f299f5975fc6bda6da0",measurementId:"G-ESJSGF15JJ"};firebase.initializeApp(firebaseConfig);const db=firebase.firestore(),RegisterForm=()=>{const[i,e]=reactExports.useState(""),[s,o]=reactExports.useState(""),[a,c]=reactExports.useState(""),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState("");return jsxs("form",{className:"register-form",onSubmit:async _t=>{_t.preventDefault();try{const $t=await firebase.auth().createUserWithEmailAndPassword(a,s),Mt={username:i,email:a,dob:d,gender:g};await db.collection("users").doc($t.user.uid).set(Mt),console.log("Data saved to Firebase!"),e(""),o(""),c(""),h(""),_("")}catch($t){console.error("Error saving data: ",$t)}},children:[jsxs("div",{className:"form-group",children:[jsx("label",{htmlFor:"username",className:"form-label",children:"Username:"}),jsx("input",{className:"form-input",type:"text",id:"username",value:i,onChange:_t=>e(_t.target.value)})]}),jsxs("div",{className:"form-group",children:[jsx("label",{htmlFor:"password",className:"form-label",children:"Password:"}),jsx("input",{className:"form-input",type:"password",id:"password",value:s,onChange:_t=>o(_t.target.value)})]}),jsxs("div",{className:"form-group",children:[jsx("label",{htmlFor:"email",className:"form-label",children:"Email:"}),jsx("input",{className:"form-input",type:"email",id:"email",value:a,onChange:_t=>c(_t.target.value)})]}),jsxs("div",{className:"form-group",children:[jsx("label",{htmlFor:"dob",className:"form-label",children:"Date of Birth:"}),jsx("input",{className:"form-input",type:"date",id:"dob",value:d,onChange:_t=>h(_t.target.value)})]}),jsxs("div",{className:"form-group",children:[jsx("label",{htmlFor:"gender",className:"form-label",children:"Gender:"}),jsxs("select",{className:"form-input",id:"gender",value:g,onChange:_t=>_(_t.target.value),children:[jsx("option",{value:"",children:"Select Gender"}),jsx("option",{value:"male",children:"Male"}),jsx("option",{value:"female",children:"Female"}),jsx("option",{value:"other",children:"Other"})]})]}),jsx("button",{type:"submit",className:"submit-button",children:"Submit"})]})},Footer$1="",Footer=()=>jsx("footer",{className:"footer",children:jsxs("div",{className:"container",children:[jsxs("nav",{className:"footer__nav",children:[jsx("a",{href:"#",className:"footer__link",children:"About"}),jsx("a",{href:"#",className:"footer__link",children:"Contact"}),jsx("a",{href:"#",className:"footer__link",children:"Privacy Policy"})]}),jsx("p",{className:"footer__text",children:" Deep Challenge 2023"})]})}),bootstrap_min="";firebase.initializeApp({apiKey:"AIzaSyBTCJ2aIIxdaq9KVmkd4KcM01IVMS3yKA4",authDomain:"deepchallenge-6df3d.firebaseapp.com",projectId:"deepchallenge-6df3d",storageBucket:"deepchallenge-6df3d.appspot.com",messagingSenderId:"828787000033",appId:"1:828787000033:web:802f299f5975fc6bda6da0",measurementId:"G-ESJSGF15JJ"});firebase.firestore();const App=()=>jsxs(Fragment,{children:[jsx(Header,{}),jsxs(Routes,{children:[jsx(Route,{path:"/home",element:jsx(Home,{})}),jsx(Route,{path:"/tracks",element:jsx(OnlineIDE,{})}),jsx(Route,{path:"/html",element:jsx(HTMLSlider,{})}),jsx(Route,{path:"/challenges",element:jsx(RoomChallengeApp,{})}),jsx(Route,{path:"/register",element:jsx(RegisterForm,{})})]}),jsx(Footer,{})]}),root=client.createRoot(document.getElementById("root"));root.render(jsx(React.StrictMode,{children:jsx(BrowserRouter,{children:jsx(App,{})})}));
